/* X_ITE v10.2.0 */
const e=window[Symbol.for("X_ITE.X3D-10.2.0")];(()=>{var t={254:t=>{t.exports=e.jquery}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const a=e.Components;var r=o.n(a);const i=e.X3DBaseNode;var s=o.n(i);const l=e.X3DFieldDefinition;var c=o.n(l);const u=e.FieldDefinitionArray;var d=o.n(u);const p=e.X3DField;var v=o.n(p);const f=e.X3DArrayField;var F=o.n(f);const h=e.Fields;var g=o.n(h);const y=e.X3DBrowser;var S=o.n(y);const m=e.ComponentInfo;var D=o.n(m);const M=e.ComponentInfoArray;var x=o.n(M);const w=e.ProfileInfo;var b=o.n(w);const _=e.ProfileInfoArray;var N=o.n(_);const A=e.ConcreteNodesArray;var O=o.n(A);const I=e.AbstractNodesArray;var E=o.n(I);const X=e.UnitInfo;var T=o.n(X);const C=e.UnitInfoArray;var V=o.n(C);const P=e.NamedNodesArray;var j=o.n(P);const R=e.ImportedNodesArray;var B=o.n(R);const U=e.X3DImportedNode;var z=o.n(U);const L=e.ExportedNodesArray;var $=o.n(L);const G=e.X3DExportedNode;var q=o.n(G);const k=e.X3DExecutionContext;var W=o.n(k);const H=e.X3DScene;var J=o.n(H);const K=e.ExternProtoDeclarationArray;var Q=o.n(K);const Y=e.ProtoDeclarationArray;var Z=o.n(Y);const ee=e.X3DExternProtoDeclaration;var te=o.n(ee);const ne=e.X3DProtoDeclaration;var oe=o.n(ne);const ae=e.X3DProtoDeclarationNode;var re=o.n(ae);const ie=e.RouteArray;var se=o.n(ie);const le=e.X3DRoute;var ce=o.n(le);const ue=e.Namespace;var de=o.n(ue);const pe=function(e,t,n){return new Function("with (arguments [0])\n   {\n      return eval ((() =>\n      {\n         const sourceText = arguments [1];\n\n         delete arguments [0];\n         delete arguments [1];\n\n         arguments .length = 0;\n\n         return sourceText;\n      })\n      ());\n   }").call(e,t,n)},ve=de().add("evaluate",pe),fe=e.X3DChildNode;var Fe=o.n(fe);const he=e.X3DUrlObject;var ge=o.n(he);const ye=e.X3DConstants;var Se=o.n(ye);function me(e){Fe().call(this,e),ge().call(this,e),this.addType(Se().X3DScriptNode)}Object.assign(Object.setPrototypeOf(me.prototype,Fe().prototype),ge().prototype,{initialize(){Fe().prototype.initialize.call(this),ge().prototype.initialize.call(this)},dispose(){ge().prototype.dispose.call(this),Fe().prototype.dispose.call(this)}}),Object.defineProperties(me,{typeName:{value:"X3DScriptNode",enumerable:!0},componentInfo:{value:Object.freeze({name:"Scripting",level:1}),enumerable:!0}});const De=me,Me=de().add("X3DScriptNode",De),xe=e.FileLoader;var we=o.n(xe);const be=e.SFNodeCache;var _e=o.n(be),Ne=o(254);function Ae(e){Me.call(this,e),this.addType(Se().Script)}Object.assign(Object.setPrototypeOf(Ae.prototype,Me.prototype),{initialize(){Me.prototype.initialize.call(this),this.requestImmediateLoad().catch(Function.prototype)},getExtendedEventHandling:()=>!1,canUserDefinedFields:()=>!0,addUserDefinedField(e,t,n){Me.prototype.addUserDefinedField.call(this,e,t,n),this.isInitialized()&&(this.setLoadState(Se().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},removeUserDefinedField(e){this.getUserDefinedFields().get(e)?.removeInterest("set_field__",this),Me.prototype.removeUserDefinedField.call(this,e),this.isInitialized()&&(this.setLoadState(Se().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},getSourceText(){return this._url},unloadData(){const e=this.context?.get("shutdown");"function"==typeof e&&this.call__(e,"shutdown"),Ne(window).off(`.Script${this.getId()}`),this.getBrowser().prepareEvents().removeInterest("call__",this),this.removeInterest("call__",this);for(const e of this.getUserDefinedFields())e.removeInterest("set_field__",this)},async loadData(){await this.unloadData(),new(we())(this).loadDocument(this._url,(e=>{null===e?this.setLoadState(Se().FAILED_STATE):(this.initialize__(Ne.decodeText(e)),this.setLoadState(Se().COMPLETE_STATE))}))},createGlobalObject(){const e=()=>this,t={get(t,n){switch(n){case"getScriptNode":return e;case"currentScene":return e().getExecutionContext();default:return t[n]}}},n=new Proxy(this.getBrowser(),t);function o(e){const t=n.createVrmlFromString(e);if(t.length&&t[0])return t[0];throw new Error("SFNode.new: invalid argument.")}o.prototype=g().SFNode.prototype;const a={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:n.println.bind(n)},trace:{value:n.println.bind(n)},Browser:{value:n},X3DConstants:{value:Se()},X3DBrowser:{value:S()},X3DExecutionContext:{value:W()},X3DScene:{value:J()},ComponentInfo:{value:D()},ComponentInfoArray:{value:x()},ProfileInfo:{value:b()},ProfileInfoArray:{value:N()},ConcreteNodesArray:{value:O()},AbstractNodesArray:{value:E()},UnitInfo:{value:T()},UnitInfoArray:{value:V()},NamedNodesArray:{value:j()},ImportedNodesArray:{value:B()},X3DImportedNode:{value:z()},ExportedNodesArray:{value:$()},X3DExportedNode:{value:q()},ExternProtoDeclarationArray:{value:Q()},ProtoDeclarationArray:{value:Z()},X3DExternProtoDeclaration:{value:te()},X3DProtoDeclaration:{value:oe()},X3DProtoDeclarationNode:{value:re()},RouteArray:{value:se()},X3DRoute:{value:ce()},X3DBaseNode:{value:s()},X3DFieldDefinition:{value:c()},FieldDefinitionArray:{value:d()},X3DField:{value:v()},X3DArrayField:{value:F()},SFColor:{value:g().SFColor},SFColorRGBA:{value:g().SFColorRGBA},SFImage:{value:g().SFImage},SFMatrix3d:{value:g().SFMatrix3d},SFMatrix3f:{value:g().SFMatrix3f},SFMatrix4d:{value:g().SFMatrix4d},SFMatrix4f:{value:g().SFMatrix4f},SFNode:{value:o},SFRotation:{value:g().SFRotation},SFString:{value:g().SFString},SFVec2d:{value:g().SFVec2d},SFVec2f:{value:g().SFVec2f},SFVec3d:{value:g().SFVec3d},SFVec3f:{value:g().SFVec3f},SFVec4d:{value:g().SFVec4d},SFVec4f:{value:g().SFVec4f},VrmlMatrix:{value:g().VrmlMatrix},MFBool:{value:g().MFBool},MFColor:{value:g().MFColor},MFColorRGBA:{value:g().MFColorRGBA},MFDouble:{value:g().MFDouble},MFFloat:{value:g().MFFloat},MFImage:{value:g().MFImage},MFInt32:{value:g().MFInt32},MFMatrix3d:{value:g().MFMatrix3d},MFMatrix3f:{value:g().MFMatrix3f},MFMatrix4d:{value:g().MFMatrix4d},MFMatrix4f:{value:g().MFMatrix4f},MFNode:{value:g().MFNode},MFRotation:{value:g().MFRotation},MFString:{value:g().MFString},MFTime:{value:g().MFTime},MFVec2d:{value:g().MFVec2d},MFVec2f:{value:g().MFVec2f},MFVec3d:{value:g().MFVec3d},MFVec3f:{value:g().MFVec3f},MFVec4d:{value:g().MFVec4d},MFVec4f:{value:g().MFVec4f}};for(const e of this.getUserDefinedFields()){if(e.getAccessType()===Se().inputOnly)continue;const t=[e.getName()];e.getAccessType()===Se().inputOutput&&t.push(e.getName()+"_changed");for(const n of t)n in a||(a[n]={get:e.valueOf.bind(e),set:e.setValue.bind(e)})}return Object.create(Object.prototype,a)},createContext(e){const t=["initialize","prepareEvents","eventsProcessed","shutdown"];for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Se().inputOnly:t.push(e.getName());break;case Se().inputOutput:t.push("set_"+e.getName())}e+=";\n["+t.map((e=>`typeof ${e} !== "undefined" ? ${e} : undefined`)).join(",")+"];";const n=this.evaluate(e),o=new Map;for(let e=0;e<t.length;++e)o.set(t[e],n[e]);return o},evaluate(e){return this.globalObject||(this.globalObject=this.createGlobalObject()),ve(_e().get(this),this.globalObject,e)},async initialize__(e){const t=this.getBrowser();this.globalObject=this.createGlobalObject(),this.context=this.createContext(e);const n=this.context.get("shutdown");"function"==typeof n&&Ne(window).on(`unload.Script${this.getId()}`,(()=>this.call__(n,"shutdown")));const o=this.context.get("prepareEvents");"function"==typeof o&&t.prepareEvents().addInterest("call__",this,o,"prepareEvents");const a=this.context.get("eventsProcessed");"function"==typeof a&&this.addInterest("call__",this,a,"eventsProcessed");for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Se().inputOnly:{const t=this.context.get(e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t,[]);break}case Se().inputOutput:{const t=this.context.get("set_"+e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t,[]);break}}const r=this.context.get("initialize");"function"==typeof r&&await this.call__(r,"initialize")},async call__(e,t){try{await e.call(_e().get(this),this.getBrowser().getCurrentTime())}catch(e){this.setError(`in function '${t}'`,e)}},async set_field__(e,t,n){const o=t.pop()??n.create();try{o.assign(n),await e.call(_e().get(this),o.valueOf(),this.getBrowser().getCurrentTime())}catch(e){this.setError(`in function '${n.getName()}'`,e)}finally{t.push(o)}},setError(e,t){const n=this.getExecutionContext().getWorldURL().startsWith("data:")?"data:":this.getExecutionContext().getWorldURL();console.error(`JavaScript Error in Script '${this.getName()}', ${e}\nworld url is '${n}':`),console.error(t)},dispose(){this.unloadData(),Me.prototype.dispose.call(this)}}),Object.defineProperties(Ae,{typeName:{value:"Script",enumerable:!0},componentInfo:{value:Object.freeze({name:"Scripting",level:1}),enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze({from:"2.0",to:"Infinity"}),enumerable:!0},fieldDefinitions:{value:new(d())([new(c())(Se().inputOutput,"metadata",new(g().SFNode)),new(c())(Se().inputOutput,"description",new(g().SFString)),new(c())(Se().inputOutput,"load",new(g().SFBool)(!0)),new(c())(Se().inputOutput,"url",new(g().MFString)),new(c())(Se().inputOutput,"autoRefresh",new(g().SFTime)),new(c())(Se().inputOutput,"autoRefreshTimeLimit",new(g().SFTime)(3600)),new(c())(Se().initializeOnly,"directOutput",new(g().SFBool)),new(c())(Se().initializeOnly,"mustEvaluate",new(g().SFBool))]),enumerable:!0}});const Oe=Ae,Ie=de().add("Script",Oe);r().add({name:"Scripting",concreteNodes:[Ie],abstractNodes:[Me]});de().add("ScriptingComponent",undefined)})();