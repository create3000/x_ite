/* X_ITE v10.0.5 */(()=>{"use strict";var e={823:e=>{e.exports=window[Symbol.for("X_ITE.X3D-10.0.5")].require("lib/jquery")}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const r=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Components");var n=o.n(r);const i=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/X3DBaseNode");var a=o.n(i);const s=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/X3DFieldDefinition");var l=o.n(s);const c=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/FieldDefinitionArray");var u=o.n(c);const d=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/X3DField");var p=o.n(d);const f=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/X3DArrayField");var v=o.n(f);const w=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Fields");var _=o.n(w);const y=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Browser/X3DBrowser");var S=o.n(y);const m=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/ComponentInfo");var F=o.n(m);const h=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/ComponentInfoArray");var X=o.n(h);const D=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/ProfileInfo");var x=o.n(D);const g=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/ProfileInfoArray");var b=o.n(g);const E=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/ConcreteNodesArray");var I=o.n(E);const T=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/AbstractNodesArray");var M=o.n(T);const N=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/UnitInfo");var O=o.n(N);const A=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Configuration/UnitInfoArray");var C=o.n(A);const q=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/NamedNodesArray");var P=o.n(q);const V=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/ImportedNodesArray");var B=o.n(V);const j=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/X3DImportedNode");var R=o.n(j);const U=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/ExportedNodesArray");var z=o.n(U);const L=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/X3DExportedNode");var $=o.n(L);const G=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/X3DExecutionContext");var k=o.n(G);const W=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Execution/X3DScene");var H=o.n(W);const J=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Prototype/ExternProtoDeclarationArray");var K=o.n(J);const Q=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Prototype/ProtoDeclarationArray");var Y=o.n(Q);const Z=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Prototype/X3DExternProtoDeclaration");var ee=o.n(Z);const te=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Prototype/X3DProtoDeclaration");var oe=o.n(te);const re=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Prototype/X3DProtoDeclarationNode");var ne=o.n(re);const ie=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Routing/RouteArray");var ae=o.n(ie);const se=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Routing/X3DRoute");var le=o.n(se);const ce=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Namespace");var ue=o.n(ce);const de=function(e,t,o){return new Function("with (arguments [0])\n   {\n      return eval ((() =>\n      {\n         const sourceText = arguments [1];\n\n         delete arguments [0];\n         delete arguments [1];\n\n         arguments .length = 0;\n\n         return sourceText;\n      })\n      ());\n   }").call(e,t,o)};ue().add("evaluate","x_ite/Browser/Scripting/evaluate",de);const pe=de,fe=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Components/Core/X3DChildNode");var ve=o.n(fe);const we=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Components/Networking/X3DUrlObject");var _e=o.n(we);const ye=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Base/X3DConstants");var Se=o.n(ye);function me(e){ve().call(this,e),_e().call(this,e),this.addType(Se().X3DScriptNode)}Object.assign(Object.setPrototypeOf(me.prototype,ve().prototype),_e().prototype,{initialize(){ve().prototype.initialize.call(this),_e().prototype.initialize.call(this)},dispose(){_e().prototype.dispose.call(this),ve().prototype.dispose.call(this)}}),Object.defineProperties(me,{typeName:{value:"X3DScriptNode",enumerable:!0},componentInfo:{value:Object.freeze({name:"Scripting",level:1}),enumerable:!0}});const Fe=me;ue().add("X3DScriptNode","x_ite/Components/Scripting/X3DScriptNode",Fe);const he=Fe,Xe=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/InputOutput/FileLoader");var De=o.n(Xe);const xe=window[Symbol.for("X_ITE.X3D-10.0.5")].require("x_ite/Fields/SFNodeCache");var ge=o.n(xe),be=o(823);function Ee(e){he.call(this,e),this.addType(Se().Script)}Object.assign(Object.setPrototypeOf(Ee.prototype,he.prototype),{initialize(){he.prototype.initialize.call(this),this.requestImmediateLoad().catch(Function.prototype)},getExtendedEventHandling:()=>!1,canUserDefinedFields:()=>!0,addUserDefinedField(e,t,o){he.prototype.addUserDefinedField.call(this,e,t,o),this.isInitialized()&&(this.setLoadState(Se().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},removeUserDefinedField(e){this.getUserDefinedFields().get(e)?.removeInterest("set_field__",this),he.prototype.removeUserDefinedField.call(this,e),this.isInitialized()&&(this.setLoadState(Se().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},getSourceText(){return this._url},unloadData(){const e=this.context?.get("shutdown");"function"==typeof e&&this.call__(e,"shutdown"),be(window).off(`.Script${this.getId()}`),this.getBrowser().prepareEvents().removeInterest("call__",this),this.removeInterest("call__",this);for(const e of this.getUserDefinedFields())e.removeInterest("set_field__",this)},async loadData(){await this.unloadData(),new(De())(this).loadDocument(this._url,(e=>{null===e?this.setLoadState(Se().FAILED_STATE):(this.initialize__(be.decodeText(e)),this.setLoadState(Se().COMPLETE_STATE))}))},createGlobalObject(){const e=()=>this,t={get(t,o){switch(o){case"getScriptNode":return e;case"currentScene":return e().getExecutionContext();default:return t[o]}}},o=new Proxy(this.getBrowser(),t);function r(e){const t=o.createVrmlFromString(e);if(t.length&&t[0])return t[0];throw new Error("SFNode.new: invalid argument.")}r.prototype=_().SFNode.prototype;const n={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:o.println.bind(o)},trace:{value:o.println.bind(o)},Browser:{value:o},X3DConstants:{value:Se()},X3DBrowser:{value:S()},X3DExecutionContext:{value:k()},X3DScene:{value:H()},ComponentInfo:{value:F()},ComponentInfoArray:{value:X()},ProfileInfo:{value:x()},ProfileInfoArray:{value:b()},ConcreteNodesArray:{value:I()},AbstractNodesArray:{value:M()},UnitInfo:{value:O()},UnitInfoArray:{value:C()},NamedNodesArray:{value:P()},ImportedNodesArray:{value:B()},X3DImportedNode:{value:R()},ExportedNodesArray:{value:z()},X3DExportedNode:{value:$()},ExternProtoDeclarationArray:{value:K()},ProtoDeclarationArray:{value:Y()},X3DExternProtoDeclaration:{value:ee()},X3DProtoDeclaration:{value:oe()},X3DProtoDeclarationNode:{value:ne()},RouteArray:{value:ae()},X3DRoute:{value:le()},X3DBaseNode:{value:a()},X3DFieldDefinition:{value:l()},FieldDefinitionArray:{value:u()},X3DField:{value:p()},X3DArrayField:{value:v()},SFColor:{value:_().SFColor},SFColorRGBA:{value:_().SFColorRGBA},SFImage:{value:_().SFImage},SFMatrix3d:{value:_().SFMatrix3d},SFMatrix3f:{value:_().SFMatrix3f},SFMatrix4d:{value:_().SFMatrix4d},SFMatrix4f:{value:_().SFMatrix4f},SFNode:{value:r},SFRotation:{value:_().SFRotation},SFString:{value:_().SFString},SFVec2d:{value:_().SFVec2d},SFVec2f:{value:_().SFVec2f},SFVec3d:{value:_().SFVec3d},SFVec3f:{value:_().SFVec3f},SFVec4d:{value:_().SFVec4d},SFVec4f:{value:_().SFVec4f},VrmlMatrix:{value:_().VrmlMatrix},MFBool:{value:_().MFBool},MFColor:{value:_().MFColor},MFColorRGBA:{value:_().MFColorRGBA},MFDouble:{value:_().MFDouble},MFFloat:{value:_().MFFloat},MFImage:{value:_().MFImage},MFInt32:{value:_().MFInt32},MFMatrix3d:{value:_().MFMatrix3d},MFMatrix3f:{value:_().MFMatrix3f},MFMatrix4d:{value:_().MFMatrix4d},MFMatrix4f:{value:_().MFMatrix4f},MFNode:{value:_().MFNode},MFRotation:{value:_().MFRotation},MFString:{value:_().MFString},MFTime:{value:_().MFTime},MFVec2d:{value:_().MFVec2d},MFVec2f:{value:_().MFVec2f},MFVec3d:{value:_().MFVec3d},MFVec3f:{value:_().MFVec3f},MFVec4d:{value:_().MFVec4d},MFVec4f:{value:_().MFVec4f}};for(const e of this.getUserDefinedFields()){if(e.getAccessType()===Se().inputOnly)continue;const t=[e.getName()];e.getAccessType()===Se().inputOutput&&t.push(e.getName()+"_changed");for(const o of t)o in n||(n[o]={get:e.valueOf.bind(e),set:e.setValue.bind(e)})}return Object.create(Object.prototype,n)},createContext(e){const t=["initialize","prepareEvents","eventsProcessed","shutdown"];for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Se().inputOnly:t.push(e.getName());break;case Se().inputOutput:t.push("set_"+e.getName())}e+=";\n["+t.map((e=>`typeof ${e} !== "undefined" ? ${e} : undefined`)).join(",")+"];";const o=this.evaluate(e),r=new Map;for(let e=0;e<t.length;++e)r.set(t[e],o[e]);return r},evaluate(e){return this.globalObject||(this.globalObject=this.createGlobalObject()),pe(ge().get(this),this.globalObject,e)},async initialize__(e){const t=this.getBrowser();this.globalObject=this.createGlobalObject(),this.context=this.createContext(e);const o=this.context.get("shutdown");"function"==typeof o&&be(window).on(`unload.Script${this.getId()}`,(()=>this.call__(o,"shutdown")));const r=this.context.get("prepareEvents");"function"==typeof r&&t.prepareEvents().addInterest("call__",this,r,"prepareEvents");const n=this.context.get("eventsProcessed");"function"==typeof n&&this.addInterest("call__",this,n,"eventsProcessed");for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Se().inputOnly:{const t=this.context.get(e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t,[]);break}case Se().inputOutput:{const t=this.context.get("set_"+e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t,[]);break}}const i=this.context.get("initialize");"function"==typeof i&&await this.call__(i,"initialize")},async call__(e,t){try{await e.call(ge().get(this),this.getBrowser().getCurrentTime())}catch(e){this.setError(`in function '${t}'`,e)}},async set_field__(e,t,o){const r=t.pop()??o.create();try{r.assign(o),await e.call(ge().get(this),r.valueOf(),this.getBrowser().getCurrentTime())}catch(e){this.setError(`in function '${o.getName()}'`,e)}finally{t.push(r)}},setError(e,t){const o=this.getExecutionContext().getWorldURL().startsWith("data:")?"data:":this.getExecutionContext().getWorldURL();console.error(`JavaScript Error in Script '${this.getName()}', ${e}\nworld url is '${o}':`),console.error(t)},dispose(){this.unloadData(),he.prototype.dispose.call(this)}}),Object.defineProperties(Ee,{typeName:{value:"Script",enumerable:!0},componentInfo:{value:Object.freeze({name:"Scripting",level:1}),enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze({from:"2.0",to:"Infinity"}),enumerable:!0},fieldDefinitions:{value:new(u())([new(l())(Se().inputOutput,"metadata",new(_().SFNode)),new(l())(Se().inputOutput,"description",new(_().SFString)),new(l())(Se().inputOutput,"load",new(_().SFBool)(!0)),new(l())(Se().inputOutput,"url",new(_().MFString)),new(l())(Se().inputOutput,"autoRefresh",new(_().SFTime)),new(l())(Se().inputOutput,"autoRefreshTimeLimit",new(_().SFTime)(3600)),new(l())(Se().initializeOnly,"directOutput",new(_().SFBool)),new(l())(Se().initializeOnly,"mustEvaluate",new(_().SFBool))]),enumerable:!0}});const Ie=Ee;ue().add("Script","x_ite/Components/Scripting/Script",Ie);const Te=Ie;n().add({name:"Scripting",concreteNodes:[Te],abstractNodes:[he]});const Me=void 0;ue().add("Scripting","assets/components/Scripting",Me)})();