/* X_ITE X3D v4.1.0-145
 * See LICENCES.txt for a detailed listing of used licences. */
!function(){var x_iteNoConfict={sprintf:window.sprintf,vsprintf:window.vsprintf},requirejs,require,define;!function(global,setTimeout){function commentReplace(t,e){return e||""}function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,function(e,r){!i&&hasProp(t,r)||(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[r]=e:(t[r]||(t[r]={}),mixin(t[r],e,i,n)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,n){var r=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return r.requireType=t,r.requireModules=n,i&&(r.originalError=i),r}function newContext(t){function e(t){var e,i;for(e=0;e<t.length;e++)if("."===(i=t[e]))t.splice(e,1),e-=1;else if(".."===i){if(0===e||1===e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,n){var r,o,s,a,u,l,h,c,d,p,f,g=i&&i.split("/"),m=S.map,x=m&&m["*"];if(t&&(t=t.split("/"),l=t.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(t[l])&&(t[l]=t[l].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&g&&(f=g.slice(0,g.length-1),t=f.concat(t)),e(t),t=t.join("/")),n&&m&&(g||x)){o=t.split("/");t:for(s=o.length;s>0;s-=1){if(u=o.slice(0,s).join("/"),g)for(a=g.length;a>0;a-=1)if((r=getOwn(m,g.slice(0,a).join("/")))&&(r=getOwn(r,u))){h=r,c=s;break t}!d&&x&&getOwn(x,u)&&(d=getOwn(x,u),p=s)}!h&&d&&(h=d,c=p),h&&(o.splice(0,c,h),t=o.join("/"))}return getOwn(S.pkgs,t)||t}function n(t){isBrowser&&each(scripts(),function(e){if(e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===v.contextName)return e.parentNode.removeChild(e),!0})}function r(t){var e=getOwn(S.paths,t);if(e&&isArray(e)&&e.length>1)return e.shift(),v.require.undef(t),v.makeRequire(null,{skipMap:!0})([t]),!0}function o(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function s(t,e,n,r){var s,a,u,l,h=null,c=e?e.name:null,d=t,p=!0,f="";return t||(p=!1,t="_@r"+(D+=1)),l=o(t),h=l[0],t=l[1],h&&(h=i(h,c,r),a=getOwn(O,h)),t&&(h?f=n?t:a&&a.normalize?a.normalize(t,function(t){return i(t,c,r)}):-1===t.indexOf("!")?i(t,c,r):t:(f=i(t,c,r),l=o(f),h=l[0],f=l[1],n=!0,s=v.nameToUrl(f))),u=!h||a||n?"":"_unnormalized"+(B+=1),{prefix:h,name:f,parentMap:e,unnormalized:!!u,url:s,originalName:d,isDefine:p,id:(h?h+"!"+f:f)+u}}function a(t){var e=t.id,i=getOwn(C,e);return i||(i=C[e]=new v.Module(t)),i}function u(t,e,i){var n=t.id,r=getOwn(C,n);!hasProp(O,n)||r&&!r.defineEmitComplete?(r=a(t),r.error&&"error"===e?i(r.error):r.on(e,i)):"defined"===e&&i(O[n])}function l(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,function(e){var i=getOwn(C,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))}),n||req.onError(t))}function h(){globalDefQueue.length&&(each(globalDefQueue,function(t){var e=t[0];"string"==typeof e&&(v.defQueueMap[e]=!0),N.push(t)}),globalDefQueue=[])}function c(t){delete C[t],delete F[t]}function d(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,r){var o=n.id,s=getOwn(C,o);!s||t.depMatched[r]||i[o]||(getOwn(e,o)?(t.defineDep(r,O[o]),t.check()):d(s,e,i))}),i[n]=!0)}function p(){var t,e,i=1e3*S.waitSeconds,o=i&&v.startTime+i<(new Date).getTime(),s=[],a=[],u=!1,h=!0;if(!y){if(y=!0,eachProp(F,function(t){var i=t.map,l=i.id;if(t.enabled&&(i.isDefine||a.push(t),!t.error))if(!t.inited&&o)r(l)?(e=!0,u=!0):(s.push(l),n(l));else if(!t.inited&&t.fetched&&i.isDefine&&(u=!0,!i.prefix))return h=!1}),o&&s.length)return t=makeError("timeout","Load timeout for modules: "+s,null,s),t.contextName=v.contextName,l(t);h&&each(a,function(t){d(t,{},{})}),o&&!e||!u||!isBrowser&&!isWebWorker||b||(b=setTimeout(function(){b=0,p()},50)),y=!1}}function f(t){hasProp(O,t[0])||a(s(t[0],null,!0)).init(t[1],t[2])}function g(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,v.onScriptLoad,"load","onreadystatechange"),g(e,v.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function x(){var t;for(h();N.length;){if(t=N.shift(),null===t[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}v.defQueueMap={}}var y,_,v,w,b,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},F={},T={},N=[],O={},M={},V={},D=1,B=1;return w={require:function(t){return t.require?t.require:t.require=v.makeRequire(t.map)},exports:function(t){if(t.usingExports=!0,t.map.isDefine)return t.exports?O[t.map.id]=t.exports:t.exports=O[t.map.id]={}},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(S.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},_=function(t){this.events=getOwn(T,t.id)||{},this.map=t,this.shim=getOwn(S.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},_.prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,v.startTime=(new Date).getTime();var t=this.map;if(!this.shim)return t.prefix?this.callPlugin():this.load();v.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()}))}},load:function(){var t=this.map.url;M[t]||(M[t]=!0,v.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,n=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=v.execCb(i,o,n,r)}catch(e){t=e}else r=v.execCb(i,o,n,r);if(this.map.isDefine&&void 0===r&&(e=this.module,e?r=e.exports:this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",l(this.error=t)}else r=o;if(this.exports=r,this.map.isDefine&&!this.ignore&&(O[i]=r,req.onResourceLoad)){var s=[];each(this.depMaps,function(t){s.push(t.normalizedMap||t)}),req.onResourceLoad(v,this.map,s)}c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(v.defQueueMap,i)||this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=s(t.prefix);this.depMaps.push(n),u(n,"defined",bind(this,function(n){var r,o,h,d=getOwn(V,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=v.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(t){return i(t,f,!0)})||""),o=s(t.prefix+"!"+p,this.map.parentMap,!0),u(o,"defined",bind(this,function(t){this.map.normalizedMap=o,this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),void((h=getOwn(C,o.id))&&(this.depMaps.push(o),this.events.error&&h.on("error",bind(this,function(t){this.emit("error",t)})),h.enable()))):d?(this.map.url=v.nameToUrl(d),void this.load()):(r=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),r.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(C,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&c(t.map.id)}),l(t)}),r.fromText=bind(this,function(i,n){var o=t.name,u=s(o),h=useInteractive;n&&(i=n),h&&(useInteractive=!1),a(u),hasProp(S.config,e)&&(S.config[o]=S.config[e]);try{req.exec(i)}catch(t){return l(makeError("fromtexteval","fromText eval for "+e+" failed: "+t,t,[e]))}h&&(useInteractive=!0),this.depMaps.push(u),v.completeLoad(o),g([o],r)}),void n.load(t.name,g,r,S))})),v.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){F[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,n,r;if("string"==typeof t){if(t=s(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,r=getOwn(w,t.id))return void(this.depExports[e]=r(this));this.depCount+=1,u(t,"defined",bind(this,function(t){this.undefed||(this.defineDep(e,t),this.check())})),this.errback?u(t,"error",bind(this,this.errback)):this.events.error&&u(t,"error",bind(this,function(t){this.emit("error",t)}))}i=t.id,n=C[i],hasProp(w,i)||!n||n.enabled||v.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(C,t.id);e&&!e.enabled&&v.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},v={config:S,contextName:t,registry:C,defined:O,urlFetched:M,defQueue:N,defQueueMap:{},Module:_,makeModuleMap:s,nextTick:req.nextTick,onError:l,configure:function(t){if(t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/"),"string"==typeof t.urlArgs){var e=t.urlArgs;t.urlArgs=function(t,i){return(-1===i.indexOf("?")?"?":"&")+e}}var i=S.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){n[e]?(S[e]||(S[e]={}),mixin(S[e],t,!0,!0)):S[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(V[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=v.makeShimExports(t)),i[e]=t}),S.shim=i),t.packages&&each(t.packages,function(t){var e,i;t="string"==typeof t?{name:t}:t,i=t.name,e=t.location,e&&(S.paths[i]=t.location),S.pkgs[i]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(t,e){t.inited||t.map.unnormalized||(t.map=s(e,null,!0))}),(t.deps||t.callback)&&v.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,r){function o(i,n,u){var h,c,d;return r.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),u):e&&hasProp(w,i)?w[i](C[e.id]):req.get?req.get(v,i,e,o):(c=s(i,e,!1,!0),h=c.id,hasProp(O,h)?O[h]:l(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(x(),v.nextTick(function(){x(),d=a(s(null,e)),d.skipMap=r.skipMap,d.init(i,n,u,{enabled:!0}),p()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(t){var n,r=t.lastIndexOf("."),o=t.split("/")[0],s="."===o||".."===o;return-1!==r&&(!s||r>1)&&(n=t.substring(r,t.length),t=t.substring(0,r)),v.nameToUrl(i(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(O,s(t,e,!1,!0).id)},specified:function(t){return t=s(t,e,!1,!0).id,hasProp(O,t)||hasProp(C,t)}}),e||(o.undef=function(t){h();var i=s(t,e,!0),r=getOwn(C,t);r.undefed=!0,n(t),delete O[t],delete M[i.url],delete T[t],eachReverse(N,function(e,i){e[0]===t&&N.splice(i,1)}),delete v.defQueueMap[t],r&&(r.events.defined&&(T[t]=r.events),c(t))}),o},enable:function(t){getOwn(C,t.id)&&a(t).enable()},completeLoad:function(t){var e,i,n,o=getOwn(S.shim,t)||{},s=o.exports;for(h();N.length;){if(i=N.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(v.defQueueMap={},n=getOwn(C,t),!e&&!hasProp(O,t)&&n&&!n.inited){if(!(!S.enforceDefine||s&&getGlobal(s)))return r(t)?void 0:l(makeError("nodefine","No define call for "+t,null,[t]));f([t,o.deps||[],o.exportsFn])}p()},nameToUrl:function(t,e,i){var n,r,o,s,a,u,l,h=getOwn(S.pkgs,t);if(h&&(t=h),l=getOwn(V,t))return v.nameToUrl(l,e,i);if(req.jsExtRegExp.test(t))a=t+(e||"");else{for(n=S.paths,r=t.split("/"),o=r.length;o>0;o-=1)if(s=r.slice(0,o).join("/"),u=getOwn(n,s)){isArray(u)&&(u=u[0]),r.splice(0,o,u);break}a=r.join("/"),a+=e||(/^data\:|^blob\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+a}return S.urlArgs&&!/^blob\:/.test(a)?a+S.urlArgs(t,a):a},load:function(t,e){req.load(v,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);v.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);if(!r(e.id)){var i=[];return eachProp(C,function(t,n){0!==n.indexOf("_@r")&&each(t.depMaps,function(t){if(t.id===e.id)return i.push(n),!0})}),l(makeError("scripterror",'Script error for "'+e.id+(i.length?'", needed by: '+i.join(", "):'"'),t,[e.id]))}}},v.require=v.makeRequire(),v}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){if("interactive"===t.readyState)return interactiveScript=t}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.5",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var r,o,s=defContextName;return isArray(t)||"string"==typeof t||(o=t,isArray(e)?(t=e,e=i,i=n):t=[]),o&&o.context&&(s=o.context),r=getOwn(contexts,s),r||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick=void 0!==setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t,e,i){var n=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return n.type=t.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n},req.load=function(t,e,i){var n,r=t&&t.config||{};if(isBrowser)return n=req.createNode(r,e,i),n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,r.onNodeCreated&&r.onNodeCreated(n,r,e,i),currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),t.completeLoad(e)}catch(n){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,n,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){if(head||(head=t.parentNode),dataMain=t.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(t,e,i){var n,r;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript())&&(t||(t=n.getAttribute("data-requiremodule")),r=contexts[n.getAttribute("data-requirecontext")]),r?(r.defQueue.push([t,e,i]),r.defQueueMap[t]=!0):globalDefQueue.push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("../node_modules/requirejs/require.js",function(){}),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t,e){e=e||it;var i=e.createElement("script");i.text=t,e.head.appendChild(i).parentNode.removeChild(i)}function n(t){var e=!!t&&"length"in t&&t.length,i=ft.type(t);return"function"!==i&&!ft.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function r(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function o(t,e,i){return ft.isFunction(e)?ft.grep(t,function(t,n){return!!e.call(t,n,t)!==i}):e.nodeType?ft.grep(t,function(t){return t===e!==i}):"string"!=typeof e?ft.grep(t,function(t){return at.call(e,t)>-1!==i}):Ct.test(e)?ft.filter(e,t,i):(e=ft.filter(e,t),ft.grep(t,function(t){return at.call(e,t)>-1!==i&&1===t.nodeType}))}function s(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function a(t){var e={};return ft.each(t.match(Mt)||[],function(t,i){e[i]=!0}),e}function u(t){return t}function l(t){throw t}function h(t,e,i,n){var r;try{t&&ft.isFunction(r=t.promise)?r.call(t).done(e).fail(i):t&&ft.isFunction(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}function c(){it.removeEventListener("DOMContentLoaded",c),t.removeEventListener("load",c),ft.ready()}function d(){this.expando=ft.expando+d.uid++}function p(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Pt.test(t)?JSON.parse(t):t)}function f(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Lt,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=p(i)}catch(t){}At.set(t,e,i)}else i=void 0;return i}function g(t,e,i,n){var r,o=1,s=20,a=n?function(){return n.cur()}:function(){return ft.css(t,e,"")},u=a(),l=i&&i[3]||(ft.cssNumber[e]?"":"px"),h=(ft.cssNumber[e]||"px"!==l&&+u)&&kt.exec(ft.css(t,e));if(h&&h[3]!==l){l=l||h[3],i=i||[],h=+u||1;do{o=o||".5",h/=o,ft.style(t,e,h+l)}while(o!==(o=a()/u)&&1!==o&&--s)}return i&&(h=+h||+u||0,r=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=h,n.end=r)),r}function m(t){var e,i=t.ownerDocument,n=t.nodeName,r=Ut[n];return r||(e=i.body.appendChild(i.createElement(n)),r=ft.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),Ut[n]=r,r)}function x(t,e){for(var i,n,r=[],o=0,s=t.length;o<s;o++)n=t[o],n.style&&(i=n.style.display,e?("none"===i&&(r[o]=Et.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&Xt(n)&&(r[o]=m(n))):"none"!==i&&(r[o]="none",Et.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}function y(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&r(t,e)?ft.merge([t],i):i}function _(t,e){for(var i=0,n=t.length;i<n;i++)Et.set(t[i],"globalEval",!e||Et.get(e[i],"globalEval"))}function v(t,e,i,n,r){for(var o,s,a,u,l,h,c=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===ft.type(o))ft.merge(d,o.nodeType?[o]:o);else if(Yt.test(o)){for(s=s||c.appendChild(e.createElement("div")),a=(qt.exec(o)||["",""])[1].toLowerCase(),u=Wt[a]||Wt._default,s.innerHTML=u[1]+ft.htmlPrefilter(o)+u[2],h=u[0];h--;)s=s.lastChild;ft.merge(d,s.childNodes),s=c.firstChild,s.textContent=""}else d.push(e.createTextNode(o));for(c.textContent="",p=0;o=d[p++];)if(n&&ft.inArray(o,n)>-1)r&&r.push(o);else if(l=ft.contains(o.ownerDocument,o),s=y(c.appendChild(o),"script"),l&&_(s),i)for(h=0;o=s[h++];)Ht.test(o.type||"")&&i.push(o);return c}function w(){return!0}function b(){return!1}function S(){try{return it.activeElement}catch(t){}}function C(t,e,i,n,r,o){var s,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(a in e)C(t,a,i,n,e[a],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=b;else if(!r)return t;return 1===o&&(s=r,r=function(t){return ft().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=ft.guid++)),t.each(function(){ft.event.add(this,e,r,n,i)})}function F(t,e){return r(t,"table")&&r(11!==e.nodeType?e:e.firstChild,"tr")?ft(">tbody",t)[0]||t:t}function T(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function N(t){var e=ie.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function O(t,e){var i,n,r,o,s,a,u,l;if(1===e.nodeType){if(Et.hasData(t)&&(o=Et.access(t),s=Et.set(e,o),l=o.events)){delete s.handle,s.events={};for(r in l)for(i=0,n=l[r].length;i<n;i++)ft.event.add(e,r,l[r][i])}At.hasData(t)&&(a=At.access(t),u=ft.extend({},a),At.set(e,u))}}function M(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Gt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function V(t,e,n,r){e=ot.apply([],e);var o,s,a,u,l,h,c=0,d=t.length,p=d-1,f=e[0],g=ft.isFunction(f);if(g||d>1&&"string"==typeof f&&!pt.checkClone&&ee.test(f))return t.each(function(i){var o=t.eq(i);g&&(e[0]=f.call(this,i,o.html())),V(o,e,n,r)});if(d&&(o=v(e,t[0].ownerDocument,!1,t,r),s=o.firstChild,1===o.childNodes.length&&(o=s),s||r)){for(a=ft.map(y(o,"script"),T),u=a.length;c<d;c++)l=o,c!==p&&(l=ft.clone(l,!0,!0),u&&ft.merge(a,y(l,"script"))),n.call(t[c],l,c);if(u)for(h=a[a.length-1].ownerDocument,ft.map(a,N),c=0;c<u;c++)l=a[c],Ht.test(l.type||"")&&!Et.access(l,"globalEval")&&ft.contains(h,l)&&(l.src?ft._evalUrl&&ft._evalUrl(l.src):i(l.textContent.replace(ne,""),h))}return t}function D(t,e,i){for(var n,r=e?ft.filter(e,t):t,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||ft.cleanData(y(n)),n.parentNode&&(i&&ft.contains(n.ownerDocument,n)&&_(y(n,"script")),n.parentNode.removeChild(n));return t}function B(t,e,i){var n,r,o,s,a=t.style;return i=i||se(t),i&&(s=i.getPropertyValue(e)||i[e],""!==s||ft.contains(t.ownerDocument,t)||(s=ft.style(t,e)),!pt.pixelMarginRight()&&oe.test(s)&&re.test(e)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function I(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function E(t){if(t in de)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=ce.length;i--;)if((t=ce[i]+e)in de)return t}function A(t){var e=ft.cssProps[t];return e||(e=ft.cssProps[t]=E(t)||t),e}function P(t,e,i){var n=kt.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function L(t,e,i,n,r){var o,s=0;for(o=i===(n?"border":"content")?4:"width"===e?1:0;o<4;o+=2)"margin"===i&&(s+=ft.css(t,i+zt[o],!0,r)),n?("content"===i&&(s-=ft.css(t,"padding"+zt[o],!0,r)),"margin"!==i&&(s-=ft.css(t,"border"+zt[o]+"Width",!0,r))):(s+=ft.css(t,"padding"+zt[o],!0,r),"padding"!==i&&(s+=ft.css(t,"border"+zt[o]+"Width",!0,r)));return s}function R(t,e,i){var n,r=se(t),o=B(t,e,r),s="border-box"===ft.css(t,"boxSizing",!1,r);return oe.test(o)?o:(n=s&&(pt.boxSizingReliable()||o===t.style[e]),"auto"===o&&(o=t["offset"+e[0].toUpperCase()+e.slice(1)]),(o=parseFloat(o)||0)+L(t,e,i||(s?"border":"content"),n,r)+"px")}function k(t,e,i,n,r){return new k.prototype.init(t,e,i,n,r)}function z(){fe&&(!1===it.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(z):t.setTimeout(z,ft.fx.interval),ft.fx.tick())}function X(){return t.setTimeout(function(){pe=void 0}),pe=ft.now()}function j(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)i=zt[n],r["margin"+i]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function U(t,e,i){for(var n,r=(H.tweeners[e]||[]).concat(H.tweeners["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,e,t))return n}function G(t,e,i){var n,r,o,s,a,u,l,h,c="width"in e||"height"in e,d=this,p={},f=t.style,g=t.nodeType&&Xt(t),m=Et.get(t,"fxshow");i.queue||(s=ft._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,ft.queue(t,"fx").length||s.empty.fire()})}));for(n in e)if(r=e[n],ge.test(r)){if(delete e[n],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;g=!0}p[n]=m&&m[n]||ft.style(t,n)}if((u=!ft.isEmptyObject(e))||!ft.isEmptyObject(p)){c&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],l=m&&m.display,null==l&&(l=Et.get(t,"display")),h=ft.css(t,"display"),"none"===h&&(l?h=l:(x([t],!0),l=t.style.display||l,h=ft.css(t,"display"),x([t]))),("inline"===h||"inline-block"===h&&null!=l)&&"none"===ft.css(t,"float")&&(u||(d.done(function(){f.display=l}),null==l&&(h=f.display,l="none"===h?"":h)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),u=!1;for(n in p)u||(m?"hidden"in m&&(g=m.hidden):m=Et.access(t,"fxshow",{display:l}),o&&(m.hidden=!g),g&&x([t],!0),d.done(function(){g||x([t]),Et.remove(t,"fxshow");for(n in p)ft.style(t,n,p[n])})),u=U(g?m[n]:0,n,d),n in m||(m[n]=u.start,g&&(u.end=u.start,u.start=0))}}function q(t,e){var i,n,r,o,s;for(i in t)if(n=ft.camelCase(i),r=e[n],o=t[i],Array.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),(s=ft.cssHooks[n])&&"expand"in s){o=s.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function H(t,e,i){var n,r,o=0,s=H.prefilters.length,a=ft.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=pe||X(),i=Math.max(0,l.startTime+l.duration-e),n=i/l.duration||0,o=1-n,s=0,u=l.tweens.length;s<u;s++)l.tweens[s].run(o);return a.notifyWith(t,[l,o,i]),o<1&&u?i:(u||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:ft.extend({},e),opts:ft.extend(!0,{specialEasing:{},easing:ft.easing._default},i),originalProperties:e,originalOptions:i,startTime:pe||X(),duration:i.duration,tweens:[],createTween:function(e,i){var n=ft.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),h=l.props;for(q(h,l.opts.specialEasing);o<s;o++)if(n=H.prefilters[o].call(l,t,h,l.opts))return ft.isFunction(n.stop)&&(ft._queueHooks(l.elem,l.opts.queue).stop=ft.proxy(n.stop,n)),n;return ft.map(h,U,l),ft.isFunction(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ft.fx.timer(ft.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l}function W(t){return(t.match(Mt)||[]).join(" ")}function Y(t){return t.getAttribute&&t.getAttribute("class")||""}function $(t,e,i,n){var r;if(Array.isArray(e))ft.each(e,function(e,r){i||Te.test(t)?n(t,r):$(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,i,n)});else if(i||"object"!==ft.type(e))n(t,e);else for(r in e)$(t+"["+r+"]",e[r],i,n)}function K(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(Mt)||[];if(ft.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function Z(t,e,i,n){function r(a){var u;return o[a]=!0,ft.each(t[a]||[],function(t,a){var l=a(e,i,n);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},s=t===Re;return r(e.dataTypes[0])||!o["*"]&&r("*")}function Q(t,e){var i,n,r=ft.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&ft.extend(!0,t,n),t}function J(t,e,i){for(var n,r,o,s,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){u.unshift(r);break}if(u[0]in i)o=u[0];else{for(r in i){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),i[o]}function tt(t,e,i,n){var r,o,s,a,u,l={},h=t.dataTypes.slice();if(h[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=h.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!u&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=h.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[r]:!0!==l[r]&&(o=a[0],h.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}var et=[],it=t.document,nt=Object.getPrototypeOf,rt=et.slice,ot=et.concat,st=et.push,at=et.indexOf,ut={},lt=ut.toString,ht=ut.hasOwnProperty,ct=ht.toString,dt=ct.call(Object),pt={},ft=function(t,e){return new ft.fn.init(t,e)},gt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,mt=/^-ms-/,xt=/-([a-z])/g,yt=function(t,e){return e.toUpperCase()};ft.fn=ft.prototype={jquery:"3.2.1",constructor:ft,length:0,toArray:function(){return rt.call(this)},get:function(t){return null==t?rt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=ft.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return ft.each(this,t)},map:function(t){return this.pushStack(ft.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(rt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:st,sort:et.sort,splice:et.splice},ft.extend=ft.fn.extend=function(){var t,e,i,n,r,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||ft.isFunction(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)i=s[e],n=t[e],s!==n&&(l&&n&&(ft.isPlainObject(n)||(r=Array.isArray(n)))?(r?(r=!1,o=i&&Array.isArray(i)?i:[]):o=i&&ft.isPlainObject(i)?i:{},s[e]=ft.extend(l,o,n)):void 0!==n&&(s[e]=n));return s},ft.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===ft.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=ft.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))
},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==lt.call(t))&&(!(e=nt(t))||"function"==typeof(i=ht.call(e,"constructor")&&e.constructor)&&ct.call(i)===dt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?ut[lt.call(t)]||"object":typeof t},globalEval:function(t){i(t)},camelCase:function(t){return t.replace(mt,"ms-").replace(xt,yt)},each:function(t,e){var i,r=0;if(n(t))for(i=t.length;r<i&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(gt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?ft.merge(i,"string"==typeof t?[t]:t):st.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:at.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,o=t.length,s=!i;r<o;r++)!e(t[r],r)!==s&&n.push(t[r]);return n},map:function(t,e,i){var r,o,s=0,a=[];if(n(t))for(r=t.length;s<r;s++)null!=(o=e(t[s],s,i))&&a.push(o);else for(s in t)null!=(o=e(t[s],s,i))&&a.push(o);return ot.apply([],a)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),ft.isFunction(t))return n=rt.call(arguments,2),r=function(){return t.apply(e||this,n.concat(rt.call(arguments)))},r.guid=t.guid=t.guid||ft.guid++,r},now:Date.now,support:pt}),"function"==typeof Symbol&&(ft.fn[Symbol.iterator]=et[Symbol.iterator]),ft.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){ut["[object "+e+"]"]=e.toLowerCase()});var _t=function(t){function e(t,e,i,n){var r,o,s,a,u,h,d,p=e&&e.ownerDocument,f=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return i;if(!n&&((e?e.ownerDocument||e:k)!==D&&V(e),e=e||D,I)){if(11!==f&&(u=gt.exec(t)))if(r=u[1]){if(9===f){if(!(s=e.getElementById(r)))return i;if(s.id===r)return i.push(s),i}else if(p&&(s=p.getElementById(r))&&L(e,s)&&s.id===r)return i.push(s),i}else{if(u[2])return K.apply(i,e.getElementsByTagName(t)),i;if((r=u[3])&&v.getElementsByClassName&&e.getElementsByClassName)return K.apply(i,e.getElementsByClassName(r)),i}if(v.qsa&&!G[t+" "]&&(!E||!E.test(t))){if(1!==f)p=e,d=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(_t,vt):e.setAttribute("id",a=R),h=C(t),o=h.length;o--;)h[o]="#"+a+" "+c(h[o]);d=h.join(","),p=mt.test(t)&&l(e.parentNode)||e}if(d)try{return K.apply(i,p.querySelectorAll(d)),i}catch(t){}finally{a===R&&e.removeAttribute("id")}}}return T(t.replace(ot,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>w.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[R]=!0,t}function r(t){var e=D.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=i.length;n--;)w.attrHandle[i[n]]=e}function s(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&bt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function u(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function l(t){return t&&void 0!==t.getElementsByTagName&&t}function h(){}function c(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function d(t,e,i){var n=e.dir,r=e.next,o=r||n,s=i&&"parentNode"===o,a=X++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r);return!1}:function(e,i,u){var l,h,c,d=[z,a];if(u){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,u))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(c=e[R]||(e[R]={}),h=c[e.uniqueID]||(c[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[n]||e;else{if((l=h[o])&&l[0]===z&&l[1]===a)return d[2]=l[2];if(h[o]=d,d[2]=t(e,i,u))return!0}return!1}}function p(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function f(t,i,n){for(var r=0,o=i.length;r<o;r++)e(t,i[r],n);return n}function g(t,e,i,n,r){for(var o,s=[],a=0,u=t.length,l=null!=e;a<u;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),l&&e.push(a)));return s}function m(t,e,i,r,o,s){return r&&!r[R]&&(r=m(r)),o&&!o[R]&&(o=m(o,s)),n(function(n,s,a,u){var l,h,c,d=[],p=[],m=s.length,x=n||f(e||"*",a.nodeType?[a]:a,[]),y=!t||!n&&e?x:g(x,d,t,a,u),_=i?o||(n?t:m||r)?[]:s:y;if(i&&i(y,_,a,u),r)for(l=g(_,p),r(l,[],a,u),h=l.length;h--;)(c=l[h])&&(_[p[h]]=!(y[p[h]]=c));if(n){if(o||t){if(o){for(l=[],h=_.length;h--;)(c=_[h])&&l.push(y[h]=c);o(null,_=[],l,u)}for(h=_.length;h--;)(c=_[h])&&(l=o?Q(n,c):d[h])>-1&&(n[l]=!(s[l]=c))}}else _=g(_===s?_.splice(m,_.length):_),o?o(null,s,_,u):K.apply(s,_)})}function x(t){for(var e,i,n,r=t.length,o=w.relative[t[0].type],s=o||w.relative[" "],a=o?1:0,u=d(function(t){return t===e},s,!0),l=d(function(t){return Q(e,t)>-1},s,!0),h=[function(t,i,n){var r=!o&&(n||i!==N)||((e=i).nodeType?u(t,i,n):l(t,i,n));return e=null,r}];a<r;a++)if(i=w.relative[t[a].type])h=[d(p(h),i)];else{if(i=w.filter[t[a].type].apply(null,t[a].matches),i[R]){for(n=++a;n<r&&!w.relative[t[n].type];n++);return m(a>1&&p(h),a>1&&c(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ot,"$1"),i,a<n&&x(t.slice(a,n)),n<r&&x(t=t.slice(n)),n<r&&c(t))}h.push(i)}return p(h)}function y(t,i){var r=i.length>0,o=t.length>0,s=function(n,s,a,u,l){var h,c,d,p=0,f="0",m=n&&[],x=[],y=N,_=n||o&&w.find.TAG("*",l),v=z+=null==y?1:Math.random()||.1,b=_.length;for(l&&(N=s===D||s||l);f!==b&&null!=(h=_[f]);f++){if(o&&h){for(c=0,s||h.ownerDocument===D||(V(h),a=!I);d=t[c++];)if(d(h,s||D,a)){u.push(h);break}l&&(z=v)}r&&((h=!d&&h)&&p--,n&&m.push(h))}if(p+=f,r&&f!==p){for(c=0;d=i[c++];)d(m,x,s,a);if(n){if(p>0)for(;f--;)m[f]||x[f]||(x[f]=Y.call(u));x=g(x)}K.apply(u,x),l&&!n&&x.length>0&&p+i.length>1&&e.uniqueSort(u)}return l&&(z=v,N=y),m};return r?n(s):s}var _,v,w,b,S,C,F,T,N,O,M,V,D,B,I,E,A,P,L,R="sizzle"+1*new Date,k=t.document,z=0,X=0,j=i(),U=i(),G=i(),q=function(t,e){return t===e&&(M=!0),0},H={}.hasOwnProperty,W=[],Y=W.pop,$=W.push,K=W.push,Z=W.slice,Q=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",it="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",nt=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",rt=new RegExp(tt+"+","g"),ot=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),st=new RegExp("^"+tt+"*,"+tt+"*"),at=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),ut=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),lt=new RegExp(nt),ht=new RegExp("^"+et+"$"),ct={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+nt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},dt=/^(?:input|select|textarea|button)$/i,pt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,mt=/[+~]/,xt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),yt=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},_t=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,vt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},wt=function(){V()},bt=d(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{K.apply(W=Z.call(k.childNodes),k.childNodes),W[k.childNodes.length].nodeType}catch(t){K={apply:W.length?function(t,e){$.apply(t,Z.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}v=e.support={},S=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},V=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:k;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,B=D.documentElement,I=!S(D),k!==D&&(i=D.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",wt,!1):i.attachEvent&&i.attachEvent("onunload",wt)),v.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),v.getElementsByTagName=r(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),v.getElementsByClassName=ft.test(D.getElementsByClassName),v.getById=r(function(t){return B.appendChild(t).id=R,!D.getElementsByName||!D.getElementsByName(R).length}),v.getById?(w.filter.ID=function(t){var e=t.replace(xt,yt);return function(t){return t.getAttribute("id")===e}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&I){var i=e.getElementById(t);return i?[i]:[]}}):(w.filter.ID=function(t){var e=t.replace(xt,yt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&I){var i,n,r,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(r=e.getElementsByName(t),n=0;o=r[n++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),w.find.TAG=v.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):v.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},w.find.CLASS=v.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&I)return e.getElementsByClassName(t)},A=[],E=[],(v.qsa=ft.test(D.querySelectorAll))&&(r(function(t){B.appendChild(t).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&E.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||E.push("\\["+tt+"*(?:value|"+J+")"),t.querySelectorAll("[id~="+R+"-]").length||E.push("~="),t.querySelectorAll(":checked").length||E.push(":checked"),t.querySelectorAll("a#"+R+"+*").length||E.push(".#.+[+~]")}),r(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&E.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&E.push(":enabled",":disabled"),B.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&E.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),E.push(",.*:")})),(v.matchesSelector=ft.test(P=B.matches||B.webkitMatchesSelector||B.mozMatchesSelector||B.oMatchesSelector||B.msMatchesSelector))&&r(function(t){v.disconnectedMatch=P.call(t,"*"),P.call(t,"[s!='']:x"),A.push("!=",nt)}),E=E.length&&new RegExp(E.join("|")),A=A.length&&new RegExp(A.join("|")),e=ft.test(B.compareDocumentPosition),L=e||ft.test(B.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},q=e?function(t,e){if(t===e)return M=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!v.sortDetached&&e.compareDocumentPosition(t)===i?t===D||t.ownerDocument===k&&L(k,t)?-1:e===D||e.ownerDocument===k&&L(k,e)?1:O?Q(O,t)-Q(O,e):0:4&i?-1:1)}:function(t,e){if(t===e)return M=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,a=[t],u=[e];if(!r||!o)return t===D?-1:e===D?1:r?-1:o?1:O?Q(O,t)-Q(O,e):0;if(r===o)return s(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)u.unshift(i);for(;a[n]===u[n];)n++;return n?s(a[n],u[n]):a[n]===k?-1:u[n]===k?1:0},D):D},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==D&&V(t),i=i.replace(ut,"='$1']"),v.matchesSelector&&I&&!G[i+" "]&&(!A||!A.test(i))&&(!E||!E.test(i)))try{var n=P.call(t,i);if(n||v.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(i,D,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==D&&V(t),L(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==D&&V(t);var i=w.attrHandle[e.toLowerCase()],n=i&&H.call(w.attrHandle,e.toLowerCase())?i(t,e,!I):void 0;return void 0!==n?n:v.attributes||!I?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.escape=function(t){return(t+"").replace(_t,vt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(M=!v.detectDuplicates,O=!v.sortStable&&t.slice(0),t.sort(q),M){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return O=null,t},b=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=b(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=b(e);return i},w=e.selectors={cacheLength:50,createPseudo:n,match:ct,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xt,yt),t[3]=(t[3]||t[4]||t[5]||"").replace(xt,yt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ct.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&lt.test(i)&&(e=C(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xt,yt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(rt," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,u){var l,h,c,d,p,f,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,x=a&&e.nodeName.toLowerCase(),y=!u&&!a,_=!1;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===x:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(d=m,c=d[R]||(d[R]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[t]||[],p=l[0]===z&&l[1],_=p&&l[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(_=p=0)||f.pop();)if(1===d.nodeType&&++_&&d===e){h[t]=[z,p,_];break}}else if(y&&(d=e,c=d[R]||(d[R]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[t]||[],p=l[0]===z&&l[1],_=p),!1===_)for(;(d=++p&&d&&d[g]||(_=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==x:1!==d.nodeType)||!++_||(y&&(c=d[R]||(d[R]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),h[t]=[z,_]),d!==e)););return(_-=r)===n||_%n==0&&_/n>=0}}},PSEUDO:function(t,i){var r,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[R]?o(i):o.length>1?(r=[t,t,"",i],w.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),s=r.length;s--;)n=Q(t,r[s]),t[n]=!(e[n]=r[s])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=F(t.replace(ot,"$1"));return r[R]?n(function(t,e,i,n){for(var o,s=r(t,null,n,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(xt,yt),function(e){return(e.textContent||e.innerText||b(e)).indexOf(t)>-1}}),lang:n(function(t){return ht.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(xt,yt).toLowerCase(),function(e){var i;do{if(i=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===B},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return pt.test(t.nodeName)},input:function(t){return dt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,i){return[i<0?i+e:i]}),even:u(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:u(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:u(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:u(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},w.pseudos.nth=w.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[_]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(_);for(_ in{submit:!0,reset:!0})w.pseudos[_]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(_);return h.prototype=w.filters=w.pseudos,w.setFilters=new h,C=e.tokenize=function(t,i){var n,r,o,s,a,u,l,h=U[t+" "];if(h)return i?0:h.slice(0);for(a=t,u=[],l=w.preFilter;a;){n&&!(r=st.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=at.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ot," ")}),a=a.slice(n.length));for(s in w.filter)!(r=ct[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):U(t,u).slice(0)},F=e.compile=function(t,e){var i,n=[],r=[],o=G[t+" "];if(!o){for(e||(e=C(t)),i=e.length;i--;)o=x(e[i]),o[R]?n.push(o):r.push(o);o=G(t,y(r,n)),o.selector=t}return o},T=e.select=function(t,e,i,n){var r,o,s,a,u,h="function"==typeof t&&t,d=!n&&C(t=h.selector||t);if(i=i||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===e.nodeType&&I&&w.relative[o[1].type]){if(!(e=(w.find.ID(s.matches[0].replace(xt,yt),e)||[])[0]))return i;h&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=ct.needsContext.test(t)?0:o.length;r--&&(s=o[r],!w.relative[a=s.type]);)if((u=w.find[a])&&(n=u(s.matches[0].replace(xt,yt),mt.test(o[0].type)&&l(e.parentNode)||e))){if(o.splice(r,1),!(t=n.length&&c(o)))return K.apply(i,n),i;break}}return(h||F(t,d))(n,e,!I,i,!e||mt.test(t)&&l(e.parentNode)||e),i},v.sortStable=R.split("").sort(q).join("")===R,v.detectDuplicates=!!M,V(),v.sortDetached=r(function(t){return 1&t.compareDocumentPosition(D.createElement("fieldset"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),v.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(J,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);ft.find=_t,ft.expr=_t.selectors,ft.expr[":"]=ft.expr.pseudos,ft.uniqueSort=ft.unique=_t.uniqueSort,ft.text=_t.getText,ft.isXMLDoc=_t.isXML,ft.contains=_t.contains,ft.escapeSelector=_t.escape;var vt=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&ft(t).is(i))break;n.push(t)}return n},wt=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},bt=ft.expr.match.needsContext,St=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Ct=/^.[^:#\[\.,]*$/;ft.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?ft.find.matchesSelector(n,t)?[n]:[]:ft.find.matches(t,ft.grep(e,function(t){return 1===t.nodeType}))},ft.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(ft(t).filter(function(){for(e=0;e<n;e++)if(ft.contains(r[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)ft.find(t,r[e],i);return n>1?ft.uniqueSort(i):i},filter:function(t){return this.pushStack(o(this,t||[],!1))},not:function(t){return this.pushStack(o(this,t||[],!0))},is:function(t){return!!o(this,"string"==typeof t&&bt.test(t)?ft(t):t||[],!1).length}});var Ft,Tt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ft.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||Ft,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Tt.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof ft?e[0]:e,ft.merge(this,ft.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:it,!0)),St.test(n[1])&&ft.isPlainObject(e))for(n in e)ft.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return r=it.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):ft.isFunction(t)?void 0!==i.ready?i.ready(t):t(ft):ft.makeArray(t,this)}).prototype=ft.fn,Ft=ft(it);var Nt=/^(?:parents|prev(?:Until|All))/,Ot={children:!0,contents:!0,next:!0,prev:!0};ft.fn.extend({has:function(t){var e=ft(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(ft.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,r=this.length,o=[],s="string"!=typeof t&&ft(t);if(!bt.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&ft.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?ft.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?at.call(ft(t),this[0]):at.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(ft.uniqueSort(ft.merge(this.get(),ft(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ft.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return vt(t,"parentNode")},parentsUntil:function(t,e,i){return vt(t,"parentNode",i)},next:function(t){return s(t,"nextSibling")},prev:function(t){return s(t,"previousSibling")},nextAll:function(t){return vt(t,"nextSibling")},prevAll:function(t){return vt(t,"previousSibling")},nextUntil:function(t,e,i){return vt(t,"nextSibling",i)},prevUntil:function(t,e,i){return vt(t,"previousSibling",i)},siblings:function(t){return wt((t.parentNode||{}).firstChild,t)},children:function(t){return wt(t.firstChild)},contents:function(t){return r(t,"iframe")?t.contentDocument:(r(t,"template")&&(t=t.content||t),ft.merge([],t.childNodes))}},function(t,e){ft.fn[t]=function(i,n){var r=ft.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=ft.filter(n,r)),this.length>1&&(Ot[t]||ft.uniqueSort(r),Nt.test(t)&&r.reverse()),this.pushStack(r)}});var Mt=/[^\x20\t\r\n\f]+/g;ft.Callbacks=function(t){t="string"==typeof t?a(t):ft.extend({},t);var e,i,n,r,o=[],s=[],u=-1,l=function(){for(r=r||t.once,n=e=!0;s.length;u=-1)for(i=s.shift();++u<o.length;)!1===o[u].apply(i[0],i[1])&&t.stopOnFalse&&(u=o.length,i=!1);t.memory||(i=!1),e=!1,r&&(o=i?[]:"")},h={add:function(){return o&&(i&&!e&&(u=o.length-1,s.push(i)),function e(i){ft.each(i,function(i,n){ft.isFunction(n)?t.unique&&h.has(n)||o.push(n):n&&n.length&&"string"!==ft.type(n)&&e(n)})}(arguments),i&&!e&&l()),this},remove:function(){return ft.each(arguments,function(t,e){for(var i;(i=ft.inArray(e,o,i))>-1;)o.splice(i,1),i<=u&&u--}),this},has:function(t){return t?ft.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=i="",this},disabled:function(){return!o},lock:function(){return r=s=[],i||e||(o=i=""),this},locked:function(){return!!r},fireWith:function(t,i){return r||(i=i||[],i=[t,i.slice?i.slice():i],s.push(i),e||l()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},ft.extend({Deferred:function(e){var i=[["notify","progress",ft.Callbacks("memory"),ft.Callbacks("memory"),2],["resolve","done",ft.Callbacks("once memory"),ft.Callbacks("once memory"),0,"resolved"],["reject","fail",ft.Callbacks("once memory"),ft.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return ft.Deferred(function(e){ft.each(i,function(i,n){var r=ft.isFunction(t[n[4]])&&t[n[4]];o[n[1]](function(){var t=r&&r.apply(this,arguments);t&&ft.isFunction(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(e,n,r){function o(e,i,n,r){return function(){var a=this,h=arguments,c=function(){var t,c;if(!(e<s)){if((t=n.apply(a,h))===i.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,ft.isFunction(c)?r?c.call(t,o(s,i,u,r),o(s,i,l,r)):(s++,c.call(t,o(s,i,u,r),o(s,i,l,r),o(s,i,u,i.notifyWith))):(n!==u&&(a=void 0,h=[t]),(r||i.resolveWith)(a,h))}},d=r?c:function(){try{c()}catch(t){ft.Deferred.exceptionHook&&ft.Deferred.exceptionHook(t,d.stackTrace),e+1>=s&&(n!==l&&(a=void 0,h=[t]),i.rejectWith(a,h))}};e?d():(ft.Deferred.getStackHook&&(d.stackTrace=ft.Deferred.getStackHook()),t.setTimeout(d))}}var s=0;return ft.Deferred(function(t){i[0][3].add(o(0,t,ft.isFunction(r)?r:u,t.notifyWith)),i[1][3].add(o(0,t,ft.isFunction(e)?e:u)),i[2][3].add(o(0,t,ft.isFunction(n)?n:l))}).promise()},promise:function(t){return null!=t?ft.extend(t,r):r}},o={};return ft.each(i,function(t,e){var s=e[2],a=e[5];r[e[1]]=s.add,a&&s.add(function(){n=a},i[3-t][2].disable,i[0][2].lock),s.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=s.fireWith}),r.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,i=e,n=Array(i),r=rt.call(arguments),o=ft.Deferred(),s=function(t){return function(i){n[t]=this,r[t]=arguments.length>1?rt.call(arguments):i,--e||o.resolveWith(n,r)}};if(e<=1&&(h(t,o.done(s(i)).resolve,o.reject,!e),"pending"===o.state()||ft.isFunction(r[i]&&r[i].then)))return o.then();for(;i--;)h(r[i],s(i),o.reject);return o.promise()}});var Vt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ft.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&Vt.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},ft.readyException=function(e){t.setTimeout(function(){throw e})};var Dt=ft.Deferred();ft.fn.ready=function(t){return Dt.then(t).catch(function(t){ft.readyException(t)}),this},ft.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--ft.readyWait:ft.isReady)||(ft.isReady=!0,!0!==t&&--ft.readyWait>0||Dt.resolveWith(it,[ft]))}}),ft.ready.then=Dt.then,"complete"===it.readyState||"loading"!==it.readyState&&!it.documentElement.doScroll?t.setTimeout(ft.ready):(it.addEventListener("DOMContentLoaded",c),t.addEventListener("load",c));var Bt=function(t,e,i,n,r,o,s){var a=0,u=t.length,l=null==i;if("object"===ft.type(i)){r=!0;for(a in i)Bt(t,e,a,i[a],!0,o,s)}else if(void 0!==n&&(r=!0,ft.isFunction(n)||(s=!0),l&&(s?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(ft(t),i)})),e))for(;a<u;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):u?e(t[0],i):o},It=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};d.uid=1,d.prototype={cache:function(t){var e=t[this.expando];return e||(e={},It(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[ft.camelCase(e)]=i;else for(n in e)r[ft.camelCase(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][ft.camelCase(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){Array.isArray(e)?e=e.map(ft.camelCase):(e=ft.camelCase(e),e=e in n?[e]:e.match(Mt)||[]),i=e.length;for(;i--;)delete n[e[i]]}(void 0===e||ft.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!ft.isEmptyObject(e)}};var Et=new d,At=new d,Pt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Lt=/[A-Z]/g;ft.extend({hasData:function(t){return At.hasData(t)||Et.hasData(t)},data:function(t,e,i){return At.access(t,e,i)},removeData:function(t,e){At.remove(t,e)},_data:function(t,e,i){return Et.access(t,e,i)},_removeData:function(t,e){Et.remove(t,e)}}),ft.fn.extend({data:function(t,e){var i,n,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=At.get(o),1===o.nodeType&&!Et.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=ft.camelCase(n.slice(5)),f(o,n,r[n])));Et.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){At.set(this,t)}):Bt(this,function(e){var i;if(o&&void 0===e){if(void 0!==(i=At.get(o,t)))return i;if(void 0!==(i=f(o,t)))return i}else this.each(function(){At.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){At.remove(this,t)})}}),ft.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Et.get(t,e),i&&(!n||Array.isArray(i)?n=Et.access(t,e,ft.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=ft.queue(t,e),n=i.length,r=i.shift(),o=ft._queueHooks(t,e),s=function(){ft.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,s,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Et.get(t,i)||Et.access(t,i,{empty:ft.Callbacks("once memory").add(function(){Et.remove(t,[e+"queue",i])})})}}),ft.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),
arguments.length<i?ft.queue(this[0],t):void 0===e?this:this.each(function(){var i=ft.queue(this,t,e);ft._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&ft.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ft.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=ft.Deferred(),o=this,s=this.length,a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(i=Et.get(o[s],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var Rt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,kt=new RegExp("^(?:([+-])=|)("+Rt+")([a-z%]*)$","i"),zt=["Top","Right","Bottom","Left"],Xt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&ft.contains(t.ownerDocument,t)&&"none"===ft.css(t,"display")},jt=function(t,e,i,n){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=s[o];return r},Ut={};ft.fn.extend({show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Xt(this)?ft(this).show():ft(this).hide()})}});var Gt=/^(?:checkbox|radio)$/i,qt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ht=/^$|\/(?:java|ecma)script/i,Wt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Wt.optgroup=Wt.option,Wt.tbody=Wt.tfoot=Wt.colgroup=Wt.caption=Wt.thead,Wt.th=Wt.td;var Yt=/<|&#?\w+;/;!function(){var t=it.createDocumentFragment(),e=t.appendChild(it.createElement("div")),i=it.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),pt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",pt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var $t=it.documentElement,Kt=/^key/,Zt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Qt=/^([^.]*)(?:\.(.+)|)/;ft.event={global:{},add:function(t,e,i,n,r){var o,s,a,u,l,h,c,d,p,f,g,m=Et.get(t);if(m)for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&ft.find.matchesSelector($t,r),i.guid||(i.guid=ft.guid++),(u=m.events)||(u=m.events={}),(s=m.handle)||(s=m.handle=function(e){return void 0!==ft&&ft.event.triggered!==e.type?ft.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Mt)||[""],l=e.length;l--;)a=Qt.exec(e[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(c=ft.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,c=ft.event.special[p]||{},h=ft.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&ft.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=u[p])||(d=u[p]=[],d.delegateCount=0,c.setup&&!1!==c.setup.call(t,n,f,s)||t.addEventListener&&t.addEventListener(p,s)),c.add&&(c.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),ft.event.global[p]=!0)},remove:function(t,e,i,n,r){var o,s,a,u,l,h,c,d,p,f,g,m=Et.hasData(t)&&Et.get(t);if(m&&(u=m.events)){for(e=(e||"").match(Mt)||[""],l=e.length;l--;)if(a=Qt.exec(e[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(c=ft.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)h=d[o],!r&&g!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(d.splice(o,1),h.selector&&d.delegateCount--,c.remove&&c.remove.call(t,h));s&&!d.length&&(c.teardown&&!1!==c.teardown.call(t,f,m.handle)||ft.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)ft.event.remove(t,p+e[l],i,n,!0);ft.isEmptyObject(u)&&Et.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,o,s,a=ft.event.fix(t),u=new Array(arguments.length),l=(Et.get(this,"events")||{})[a.type]||[],h=ft.event.special[a.type]||{};for(u[0]=a,e=1;e<arguments.length;e++)u[e]=arguments[e];if(a.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,a)){for(s=ft.event.handlers.call(this,a,l),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(n=((ft.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,u))&&!1===(a.result=n)&&(a.preventDefault(),a.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,a),a.result}},handlers:function(t,e){var i,n,r,o,s,a=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],s={},i=0;i<u;i++)n=e[i],r=n.selector+" ",void 0===s[r]&&(s[r]=n.needsContext?ft(r,this).index(l)>-1:ft.find(r,this,null,[l]).length),s[r]&&o.push(n);o.length&&a.push({elem:l,handlers:o})}return l=this,u<e.length&&a.push({elem:l,handlers:e.slice(u)}),a},addProp:function(t,e){Object.defineProperty(ft.Event.prototype,t,{enumerable:!0,configurable:!0,get:ft.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[ft.expando]?t:new ft.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==S()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===S()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r(this,"input"))return this.click(),!1},_default:function(t){return r(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},ft.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},ft.Event=function(t,e){if(!(this instanceof ft.Event))return new ft.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?w:b,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&ft.extend(this,e),this.timeStamp=t&&t.timeStamp||ft.now(),this[ft.expando]=!0},ft.Event.prototype={constructor:ft.Event,isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=w,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=w,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=w,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},ft.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Kt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Zt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},ft.event.addProp),ft.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){ft.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===n||ft.contains(n,r))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),ft.fn.extend({on:function(t,e,i,n){return C(this,t,e,i,n)},one:function(t,e,i,n){return C(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,ft(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=b),this.each(function(){ft.event.remove(this,t,i,e)})}});var Jt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,te=/<script|<style|<link/i,ee=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^true\/(.*)/,ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ft.extend({htmlPrefilter:function(t){return t.replace(Jt,"<$1></$2>")},clone:function(t,e,i){var n,r,o,s,a=t.cloneNode(!0),u=ft.contains(t.ownerDocument,t);if(!(pt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ft.isXMLDoc(t)))for(s=y(a),o=y(t),n=0,r=o.length;n<r;n++)M(o[n],s[n]);if(e)if(i)for(o=o||y(t),s=s||y(a),n=0,r=o.length;n<r;n++)O(o[n],s[n]);else O(t,a);return s=y(a,"script"),s.length>0&&_(s,!u&&y(t,"script")),a},cleanData:function(t){for(var e,i,n,r=ft.event.special,o=0;void 0!==(i=t[o]);o++)if(It(i)){if(e=i[Et.expando]){if(e.events)for(n in e.events)r[n]?ft.event.remove(i,n):ft.removeEvent(i,n,e.handle);i[Et.expando]=void 0}i[At.expando]&&(i[At.expando]=void 0)}}}),ft.fn.extend({detach:function(t){return D(this,t,!0)},remove:function(t){return D(this,t)},text:function(t){return Bt(this,function(t){return void 0===t?ft.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return V(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){F(this,t).appendChild(t)}})},prepend:function(){return V(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=F(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return V(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return V(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(ft.cleanData(y(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return ft.clone(this,t,e)})},html:function(t){return Bt(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!te.test(t)&&!Wt[(qt.exec(t)||["",""])[1].toLowerCase()]){t=ft.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(ft.cleanData(y(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return V(this,arguments,function(e){var i=this.parentNode;ft.inArray(this,t)<0&&(ft.cleanData(y(this)),i&&i.replaceChild(e,this))},t)}}),ft.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ft.fn[t]=function(t){for(var i,n=[],r=ft(t),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),ft(r[s])[e](i),st.apply(n,i.get());return this.pushStack(n)}});var re=/^margin/,oe=new RegExp("^("+Rt+")(?!px)[a-z%]+$","i"),se=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)};!function(){function e(){if(a){a.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",$t.appendChild(s);var e=t.getComputedStyle(a);i="1%"!==e.top,o="2px"===e.marginLeft,n="4px"===e.width,a.style.marginRight="50%",r="4px"===e.marginRight,$t.removeChild(s),a=null}}var i,n,r,o,s=it.createElement("div"),a=it.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",pt.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),ft.extend(pt,{pixelPosition:function(){return e(),i},boxSizingReliable:function(){return e(),n},pixelMarginRight:function(){return e(),r},reliableMarginLeft:function(){return e(),o}}))}();var ae=/^(none|table(?!-c[ea]).+)/,ue=/^--/,le={position:"absolute",visibility:"hidden",display:"block"},he={letterSpacing:"0",fontWeight:"400"},ce=["Webkit","Moz","ms"],de=it.createElement("div").style;ft.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=B(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=ft.camelCase(e),u=ue.test(e),l=t.style;if(u||(e=A(a)),s=ft.cssHooks[e]||ft.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(t,!1,n))?r:l[e];o=typeof i,"string"===o&&(r=kt.exec(i))&&r[1]&&(i=g(t,e,r),o="number"),null!=i&&i===i&&("number"===o&&(i+=r&&r[3]||(ft.cssNumber[a]?"":"px")),pt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(u?l.setProperty(e,i):l[e]=i))}},css:function(t,e,i,n){var r,o,s,a=ft.camelCase(e);return ue.test(e)||(e=A(a)),s=ft.cssHooks[e]||ft.cssHooks[a],s&&"get"in s&&(r=s.get(t,!0,i)),void 0===r&&(r=B(t,e,n)),"normal"===r&&e in he&&(r=he[e]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),ft.each(["height","width"],function(t,e){ft.cssHooks[e]={get:function(t,i,n){if(i)return!ae.test(ft.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?R(t,e,n):jt(t,le,function(){return R(t,e,n)})},set:function(t,i,n){var r,o=n&&se(t),s=n&&L(t,e,n,"border-box"===ft.css(t,"boxSizing",!1,o),o);return s&&(r=kt.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=ft.css(t,e)),P(t,i,s)}}}),ft.cssHooks.marginLeft=I(pt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(B(t,"marginLeft"))||t.getBoundingClientRect().left-jt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),ft.each({margin:"",padding:"",border:"Width"},function(t,e){ft.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+zt[n]+e]=o[n]||o[n-2]||o[0];return r}},re.test(t)||(ft.cssHooks[t+e].set=P)}),ft.fn.extend({css:function(t,e){return Bt(this,function(t,e,i){var n,r,o={},s=0;if(Array.isArray(e)){for(n=se(t),r=e.length;s<r;s++)o[e[s]]=ft.css(t,e[s],!1,n);return o}return void 0!==i?ft.style(t,e,i):ft.css(t,e)},t,e,arguments.length>1)}}),ft.Tween=k,k.prototype={constructor:k,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||ft.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ft.cssNumber[i]?"":"px")},cur:function(){var t=k.propHooks[this.prop];return t&&t.get?t.get(this):k.propHooks._default.get(this)},run:function(t){var e,i=k.propHooks[this.prop];return this.options.duration?this.pos=e=ft.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):k.propHooks._default.set(this),this}},k.prototype.init.prototype=k.prototype,k.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=ft.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){ft.fx.step[t.prop]?ft.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[ft.cssProps[t.prop]]&&!ft.cssHooks[t.prop]?t.elem[t.prop]=t.now:ft.style(t.elem,t.prop,t.now+t.unit)}}},k.propHooks.scrollTop=k.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ft.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},ft.fx=k.prototype.init,ft.fx.step={};var pe,fe,ge=/^(?:toggle|show|hide)$/,me=/queueHooks$/;ft.Animation=ft.extend(H,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return g(i.elem,t,kt.exec(e),i),i}]},tweener:function(t,e){ft.isFunction(t)?(e=t,t=["*"]):t=t.match(Mt);for(var i,n=0,r=t.length;n<r;n++)i=t[n],H.tweeners[i]=H.tweeners[i]||[],H.tweeners[i].unshift(e)},prefilters:[G],prefilter:function(t,e){e?H.prefilters.unshift(t):H.prefilters.push(t)}}),ft.speed=function(t,e,i){var n=t&&"object"==typeof t?ft.extend({},t):{complete:i||!i&&e||ft.isFunction(t)&&t,duration:t,easing:i&&e||e&&!ft.isFunction(e)&&e};return ft.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in ft.fx.speeds?n.duration=ft.fx.speeds[n.duration]:n.duration=ft.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){ft.isFunction(n.old)&&n.old.call(this),n.queue&&ft.dequeue(this,n.queue)},n},ft.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Xt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=ft.isEmptyObject(t),o=ft.speed(e,i,n),s=function(){var e=H(this,ft.extend({},t),o);(r||Et.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=ft.timers,s=Et.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&me.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));!e&&i||ft.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=Et.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=ft.timers,s=n?n.length:0;for(i.finish=!0,ft.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),ft.each(["toggle","show","hide"],function(t,e){var i=ft.fn[e];ft.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(j(e,!0),t,n,r)}}),ft.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ft.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),ft.timers=[],ft.fx.tick=function(){var t,e=0,i=ft.timers;for(pe=ft.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||ft.fx.stop(),pe=void 0},ft.fx.timer=function(t){ft.timers.push(t),ft.fx.start()},ft.fx.interval=13,ft.fx.start=function(){fe||(fe=!0,z())},ft.fx.stop=function(){fe=null},ft.fx.speeds={slow:600,fast:200,_default:400},ft.fn.delay=function(e,i){return e=ft.fx?ft.fx.speeds[e]||e:e,i=i||"fx",this.queue(i,function(i,n){var r=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(r)}})},function(){var t=it.createElement("input"),e=it.createElement("select"),i=e.appendChild(it.createElement("option"));t.type="checkbox",pt.checkOn=""!==t.value,pt.optSelected=i.selected,t=it.createElement("input"),t.value="t",t.type="radio",pt.radioValue="t"===t.value}();var xe,ye=ft.expr.attrHandle;ft.fn.extend({attr:function(t,e){return Bt(this,ft.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ft.removeAttr(this,t)})}}),ft.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?ft.prop(t,e,i):(1===o&&ft.isXMLDoc(t)||(r=ft.attrHooks[e.toLowerCase()]||(ft.expr.match.bool.test(e)?xe:void 0)),void 0!==i?null===i?void ft.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:(n=ft.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set:function(t,e){if(!pt.radioValue&&"radio"===e&&r(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(Mt);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),xe={set:function(t,e,i){return!1===e?ft.removeAttr(t,i):t.setAttribute(i,i),i}},ft.each(ft.expr.match.bool.source.match(/\w+/g),function(t,e){var i=ye[e]||ft.find.attr;ye[e]=function(t,e,n){var r,o,s=e.toLowerCase();return n||(o=ye[s],ye[s]=r,r=null!=i(t,e,n)?s:null,ye[s]=o),r}});var _e=/^(?:input|select|textarea|button)$/i,ve=/^(?:a|area)$/i;ft.fn.extend({prop:function(t,e){return Bt(this,ft.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[ft.propFix[t]||t]})}}),ft.extend({prop:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ft.isXMLDoc(t)||(e=ft.propFix[e]||e,r=ft.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=ft.find.attr(t,"tabindex");return e?parseInt(e,10):_e.test(t.nodeName)||ve.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),pt.optSelected||(ft.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),ft.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ft.propFix[this.toLowerCase()]=this}),ft.fn.extend({addClass:function(t){var e,i,n,r,o,s,a,u=0;if(ft.isFunction(t))return this.each(function(e){ft(this).addClass(t.call(this,e,Y(this)))});if("string"==typeof t&&t)for(e=t.match(Mt)||[];i=this[u++];)if(r=Y(i),n=1===i.nodeType&&" "+W(r)+" "){for(s=0;o=e[s++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=W(n),r!==a&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,r,o,s,a,u=0;if(ft.isFunction(t))return this.each(function(e){ft(this).removeClass(t.call(this,e,Y(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(Mt)||[];i=this[u++];)if(r=Y(i),n=1===i.nodeType&&" "+W(r)+" "){for(s=0;o=e[s++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");a=W(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):ft.isFunction(t)?this.each(function(i){ft(this).toggleClass(t.call(this,i,Y(this),e),e)}):this.each(function(){var e,n,r,o;if("string"===i)for(n=0,r=ft(this),o=t.match(Mt)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==i||(e=Y(this),e&&Et.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Et.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+W(Y(i))+" ").indexOf(e)>-1)return!0;return!1}});var we=/\r/g;ft.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=ft.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,ft(this).val()):t,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=ft.map(r,function(t){return null==t?"":t+""})),(e=ft.valHooks[this.type]||ft.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return(e=ft.valHooks[r.type]||ft.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(we,""):null==i?"":i)}}}),ft.extend({valHooks:{option:{get:function(t){var e=ft.find.attr(t,"value");return null!=e?e:W(ft.text(t))}},select:{get:function(t){var e,i,n,o=t.options,s=t.selectedIndex,a="select-one"===t.type,u=a?null:[],l=a?s+1:o.length;for(n=s<0?l:a?s:0;n<l;n++)if(i=o[n],(i.selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!r(i.parentNode,"optgroup"))){if(e=ft(i).val(),a)return e;u.push(e)}return u},set:function(t,e){for(var i,n,r=t.options,o=ft.makeArray(e),s=r.length;s--;)n=r[s],(n.selected=ft.inArray(ft.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),ft.each(["radio","checkbox"],function(){ft.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=ft.inArray(ft(t).val(),e)>-1}},pt.checkOn||(ft.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var be=/^(?:focusinfocus|focusoutblur)$/;ft.extend(ft.event,{trigger:function(e,i,n,r){var o,s,a,u,l,h,c,d=[n||it],p=ht.call(e,"type")?e.type:e,f=ht.call(e,"namespace")?e.namespace.split("."):[];if(s=a=n=n||it,3!==n.nodeType&&8!==n.nodeType&&!be.test(p+ft.event.triggered)&&(p.indexOf(".")>-1&&(f=p.split("."),p=f.shift(),f.sort()),l=p.indexOf(":")<0&&"on"+p,e=e[ft.expando]?e:new ft.Event(p,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:ft.makeArray(i,[e]),c=ft.event.special[p]||{},r||!c.trigger||!1!==c.trigger.apply(n,i))){if(!r&&!c.noBubble&&!ft.isWindow(n)){for(u=c.delegateType||p,be.test(u+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),a=s;a===(n.ownerDocument||it)&&d.push(a.defaultView||a.parentWindow||t)}for(o=0;(s=d[o++])&&!e.isPropagationStopped();)e.type=o>1?u:c.bindType||p,h=(Et.get(s,"events")||{})[e.type]&&Et.get(s,"handle"),h&&h.apply(s,i),(h=l&&s[l])&&h.apply&&It(s)&&(e.result=h.apply(s,i),!1===e.result&&e.preventDefault());return e.type=p,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(d.pop(),i)||!It(n)||l&&ft.isFunction(n[p])&&!ft.isWindow(n)&&(a=n[l],a&&(n[l]=null),ft.event.triggered=p,n[p](),ft.event.triggered=void 0,a&&(n[l]=a)),e.result}},simulate:function(t,e,i){var n=ft.extend(new ft.Event,i,{type:t,isSimulated:!0});ft.event.trigger(n,null,e)}}),ft.fn.extend({trigger:function(t,e){return this.each(function(){ft.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return ft.event.trigger(t,e,i,!0)}}),ft.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){ft.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),ft.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),pt.focusin="onfocusin"in t,pt.focusin||ft.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){ft.event.simulate(e,t.target,ft.event.fix(t))};ft.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=Et.access(n,e);r||n.addEventListener(t,i,!0),Et.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=Et.access(n,e)-1;r?Et.access(n,e,r):(n.removeEventListener(t,i,!0),Et.remove(n,e))}}});var Se=t.location,Ce=ft.now(),Fe=/\?/;ft.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||ft.error("Invalid XML: "+e),i};var Te=/\[\]$/,Ne=/\r?\n/g,Oe=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;ft.param=function(t,e){var i,n=[],r=function(t,e){var i=ft.isFunction(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!ft.isPlainObject(t))ft.each(t,function(){r(this.name,this.value)});else for(i in t)$(i,t[i],e,r);return n.join("&")},ft.fn.extend({serialize:function(){return ft.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ft.prop(this,"elements");return t?ft.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ft(this).is(":disabled")&&Me.test(this.nodeName)&&!Oe.test(t)&&(this.checked||!Gt.test(t))}).map(function(t,e){var i=ft(this).val();return null==i?null:Array.isArray(i)?ft.map(i,function(t){return{name:e.name,value:t.replace(Ne,"\r\n")}}):{name:e.name,value:i.replace(Ne,"\r\n")}}).get()}});var Ve=/%20/g,De=/#.*$/,Be=/([?&])_=[^&]*/,Ie=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ee=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ae=/^(?:GET|HEAD)$/,Pe=/^\/\//,Le={},Re={},ke="*/".concat("*"),ze=it.createElement("a");ze.href=Se.href,ft.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Se.href,type:"GET",isLocal:Ee.test(Se.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ft.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Q(Q(t,ft.ajaxSettings),e):Q(ft.ajaxSettings,t)},ajaxPrefilter:K(Le),ajaxTransport:K(Re),ajax:function(e,i){function n(e,i,n,a){var l,d,p,v,w,b=i;h||(h=!0,u&&t.clearTimeout(u),r=void 0,s=a||"",S.readyState=e>0?4:0,l=e>=200&&e<300||304===e,n&&(v=J(f,S,n)),v=tt(f,v,S,l),l?(f.ifModified&&(w=S.getResponseHeader("Last-Modified"),w&&(ft.lastModified[o]=w),(w=S.getResponseHeader("etag"))&&(ft.etag[o]=w)),204===e||"HEAD"===f.type?b="nocontent":304===e?b="notmodified":(b=v.state,d=v.data,p=v.error,l=!p)):(p=b,!e&&b||(b="error",e<0&&(e=0))),S.status=e,S.statusText=(i||b)+"",l?x.resolveWith(g,[d,b,S]):x.rejectWith(g,[S,b,p]),S.statusCode(_),_=void 0,c&&m.trigger(l?"ajaxSuccess":"ajaxError",[S,f,l?d:p]),y.fireWith(g,[S,b]),c&&(m.trigger("ajaxComplete",[S,f]),--ft.active||ft.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=void 0),i=i||{};var r,o,s,a,u,l,h,c,d,p,f=ft.ajaxSetup({},i),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?ft(g):ft.event,x=ft.Deferred(),y=ft.Callbacks("once memory"),_=f.statusCode||{},v={},w={},b="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(h){if(!a)for(a={};e=Ie.exec(s);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return h?s:null},setRequestHeader:function(t,e){return null==h&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,v[t]=e),this},overrideMimeType:function(t){return null==h&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(h)S.always(t[S.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort:function(t){var e=t||b;return r&&r.abort(e),n(0,e),this}};if(x.promise(S),f.url=((e||f.url||Se.href)+"").replace(Pe,Se.protocol+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(Mt)||[""],null==f.crossDomain){l=it.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=ze.protocol+"//"+ze.host!=l.protocol+"//"+l.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ft.param(f.data,f.traditional)),Z(Le,f,i,S),h)return S;c=ft.event&&f.global,c&&0==ft.active++&&ft.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ae.test(f.type),o=f.url.replace(De,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ve,"+")):(p=f.url.slice(o.length),f.data&&(o+=(Fe.test(o)?"&":"?")+f.data,delete f.data),!1===f.cache&&(o=o.replace(Be,"$1"),p=(Fe.test(o)?"&":"?")+"_="+Ce+++p),f.url=o+p),f.ifModified&&(ft.lastModified[o]&&S.setRequestHeader("If-Modified-Since",ft.lastModified[o]),ft.etag[o]&&S.setRequestHeader("If-None-Match",ft.etag[o])),(f.data&&f.hasContent&&!1!==f.contentType||i.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+ke+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)S.setRequestHeader(d,f.headers[d])
;if(f.beforeSend&&(!1===f.beforeSend.call(g,S,f)||h))return S.abort();if(b="abort",y.add(f.complete),S.done(f.success),S.fail(f.error),r=Z(Re,f,i,S)){if(S.readyState=1,c&&m.trigger("ajaxSend",[S,f]),h)return S;f.async&&f.timeout>0&&(u=t.setTimeout(function(){S.abort("timeout")},f.timeout));try{h=!1,r.send(v,n)}catch(t){if(h)throw t;n(-1,t)}}else n(-1,"No Transport");return S},getJSON:function(t,e,i){return ft.get(t,e,i,"json")},getScript:function(t,e){return ft.get(t,void 0,e,"script")}}),ft.each(["get","post"],function(t,e){ft[e]=function(t,i,n,r){return ft.isFunction(i)&&(r=r||n,n=i,i=void 0),ft.ajax(ft.extend({url:t,type:e,dataType:r,data:i,success:n},ft.isPlainObject(t)&&t))}}),ft._evalUrl=function(t){return ft.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},ft.fn.extend({wrapAll:function(t){var e;return this[0]&&(ft.isFunction(t)&&(t=t.call(this[0])),e=ft(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return ft.isFunction(t)?this.each(function(e){ft(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ft(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=ft.isFunction(t);return this.each(function(i){ft(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){ft(this).replaceWith(this.childNodes)}),this}}),ft.expr.pseudos.hidden=function(t){return!ft.expr.pseudos.visible(t)},ft.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},ft.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Xe={0:200,1223:204},je=ft.ajaxSettings.xhr();pt.cors=!!je&&"withCredentials"in je,pt.ajax=je=!!je,ft.ajaxTransport(function(e){var i,n;if(pt.cors||je&&!e.crossDomain)return{send:function(r,o){var s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)a[s]=e.xhrFields[s];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(s in r)a.setRequestHeader(s,r[s]);i=function(t){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Xe[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}}),ft.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),ft.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return ft.globalEval(t),t}}}),ft.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),ft.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,r){e=ft("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),it.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ue=[],Ge=/(=)\?(?=&|$)|\?\?/;ft.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ue.pop()||ft.expando+"_"+Ce++;return this[t]=!0,t}}),ft.ajaxPrefilter("json jsonp",function(e,i,n){var r,o,s,a=!1!==e.jsonp&&(Ge.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ge.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=ft.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ge,"$1"+r):!1!==e.jsonp&&(e.url+=(Fe.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||ft.error(r+" was not called"),s[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){s=arguments},n.always(function(){void 0===o?ft(t).removeProp(r):t[r]=o,e[r]&&(e.jsonpCallback=i.jsonpCallback,Ue.push(r)),s&&ft.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),pt.createHTMLDocument=function(){var t=it.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),ft.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var n,r,o;return e||(pt.createHTMLDocument?(e=it.implementation.createHTMLDocument(""),n=e.createElement("base"),n.href=it.location.href,e.head.appendChild(n)):e=it),r=St.exec(t),o=!i&&[],r?[e.createElement(r[1])]:(r=v([t],e,o),o&&o.length&&ft(o).remove(),ft.merge([],r.childNodes))},ft.fn.load=function(t,e,i){var n,r,o,s=this,a=t.indexOf(" ");return a>-1&&(n=W(t.slice(a)),t=t.slice(0,a)),ft.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&ft.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(n?ft("<div>").append(ft.parseHTML(t)).find(n):t)}).always(i&&function(t,e){s.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},ft.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ft.fn[e]=function(t){return this.on(e,t)}}),ft.expr.pseudos.animated=function(t){return ft.grep(ft.timers,function(e){return t===e.elem}).length},ft.offset={setOffset:function(t,e,i){var n,r,o,s,a,u,l,h=ft.css(t,"position"),c=ft(t),d={};"static"===h&&(t.style.position="relative"),a=c.offset(),o=ft.css(t,"top"),u=ft.css(t,"left"),l=("absolute"===h||"fixed"===h)&&(o+u).indexOf("auto")>-1,l?(n=c.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(u)||0),ft.isFunction(e)&&(e=e.call(t,i,ft.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):c.css(d)}},ft.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ft.offset.setOffset(this,t,e)});var e,i,n,r,o=this[0];if(o)return o.getClientRects().length?(n=o.getBoundingClientRect(),e=o.ownerDocument,i=e.documentElement,r=e.defaultView,{top:n.top+r.pageYOffset-i.clientTop,left:n.left+r.pageXOffset-i.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===ft.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),r(t[0],"html")||(n=t.offset()),n={top:n.top+ft.css(t[0],"borderTopWidth",!0),left:n.left+ft.css(t[0],"borderLeftWidth",!0)}),{top:e.top-n.top-ft.css(i,"marginTop",!0),left:e.left-n.left-ft.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===ft.css(t,"position");)t=t.offsetParent;return t||$t})}}),ft.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;ft.fn[t]=function(n){return Bt(this,function(t,n,r){var o;if(ft.isWindow(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):t[n]=r},t,n,arguments.length)}}),ft.each(["top","left"],function(t,e){ft.cssHooks[e]=I(pt.pixelPosition,function(t,i){if(i)return i=B(t,e),oe.test(i)?ft(t).position()[e]+"px":i})}),ft.each({Height:"height",Width:"width"},function(t,e){ft.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){ft.fn[n]=function(r,o){var s=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===o?"margin":"border");return Bt(this,function(e,i,r){var o;return ft.isWindow(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?ft.css(e,i,a):ft.style(e,i,r,a)},e,s?r:void 0,s)}})}),ft.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),ft.holdReady=function(t){t?ft.readyWait++:ft.ready(!0)},ft.isArray=Array.isArray,ft.parseJSON=JSON.parse,ft.nodeName=r,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ft});var qe=t.jQuery,He=t.$;return ft.noConflict=function(e){return t.$===ft&&(t.$=He),e&&t.jQuery===ft&&(t.jQuery=qe),ft},e||(t.jQuery=t.$=ft),ft}),define("jquery/dist/jquery",function(){}),define("x_ite/Error",["jquery"],function(t){"use strict";function e(i,n){t(function(){var r=t("X3DCanvas");r.each(function(){e.fallback(t(this))});for(var o=0;o<n.length;++o){var s=n[o];"function"==typeof s&&s(r,i)}})}function i(t){t.addClass("x_ite-browser-fallback"),t.children(".x_ite-private-browser").hide(),t.children(":not(.x_ite-private-browser)").addClass("x_ite-fallback"),t.children(":not(.x_ite-private-browser)").show()}return e.fallback=i,e}),define("x_ite/Basic/X3DFieldDefinition",[],function(){"use strict";function t(t,e,i){this.accessType=t,this.dataType=i.getType(),this.name=e,this.value=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return t.prototype.constructor=t,t}),define("x_ite/Basic/FieldDefinitionArray",["jquery"],function(t){"use strict";function e(t){this.array=t,this.index={};for(var e=0,n=t.length;e<n;++e)this.index[t[e].name]=t[e];return new Proxy(this,i)}var i={get:function(t,e){return e in t?t[e]:t.array[e]},set:function(t,e,i){return!1}};return t.extend(e.prototype,{constructor:e,add:function(t){this.array.push(t),this.index[t.name]=t},get:function(t){return this.index[t]},getValue:function(){return this.array}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.array.length},enumerable:!1,configurable:!1}),e}),define("x_ite/Base/X3DObject",[],function(){"use strict";function t(){return this._id}function e(){}var i=0;return e.prototype={constructor:e,_id:0,_name:"",_tainted:!1,_interests:{},getId:function(){return this.getId=t,this._id=++i},setName:function(t){this._name=t},getName:function(){return this._name},setTainted:function(t){this._tainted=t},getTainted:function(){return this._tainted},hasInterest:function(t,e){return Boolean(this._interests[e.getId()+t])},addInterest:function(t,e){this.hasOwnProperty("_interests")||(this._interests={});var i=Array.prototype.slice.call(arguments,0);i[0]=arguments[1],i[1]=this,this._interests[e.getId()+t]=Function.prototype.bind.apply(e[t],i)},removeInterest:function(t,e){delete this._interests[e.getId()+t]},getInterests:function(){return this._interests},processInterests:function(){var t=this._interests;for(var e in t)t[e]()},toString:function(){var t={string:""};return this.toStream(t),t.string},toVRMLString:function(){},toXMLString:function(){var t={string:""};return this.toXMLStream(t),t.string},dispose:function(){}},e}),define("x_ite/Base/X3DChildObject",["jquery","x_ite/Base/X3DObject"],function(t,e){"use strict";function i(){e.call(this),this._parents={}}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,addEvent:function(){var t=this._parents;for(var e in t)t[e].addEvent(this)},addEventObject:function(t,e){var i=this._parents;for(var n in i)i[n].addEventObject(this,e)},addParent:function(t){this._parents[t.getId()]=t},removeParent:function(t){delete this._parents[t.getId()]},getParents:function(){return this._parents},addClones:Function.prototype,removeClones:Function.prototype,dispose:function(){e.prototype.dispose.call(this)}}),i}),define("x_ite/Bits/X3DConstants",[],function(){"use strict";var t=0,e=0,i=0,n={NOT_STARTED_STATE:t++,IN_PROGRESS_STATE:t++,COMPLETE_STATE:t++,FAILED_STATE:t++,initializeOnly:parseInt("001",2),inputOnly:parseInt("010",2),outputOnly:parseInt("100",2),inputOutput:parseInt("111",2),SFBool:e++,SFColor:e++,SFColorRGBA:e++,SFDouble:e++,SFFloat:e++,SFImage:e++,SFInt32:e++,SFMatrix3d:e++,SFMatrix3f:e++,SFMatrix4d:e++,SFMatrix4f:e++,SFNode:e++,SFRotation:e++,SFString:e++,SFTime:e++,SFVec2d:e++,SFVec2f:e++,SFVec3d:e++,SFVec3f:e++,SFVec4d:e++,SFVec4f:e++,VrmlMatrix:e++,MFBool:e++,MFColor:e++,MFColorRGBA:e++,MFDouble:e++,MFFloat:e++,MFImage:e++,MFInt32:e++,MFMatrix3d:e++,MFMatrix3f:e++,MFMatrix4d:e++,MFMatrix4f:e++,MFNode:e++,MFRotation:e++,MFString:e++,MFTime:e++,MFVec2d:e++,MFVec2f:e++,MFVec3d:e++,MFVec3f:e++,MFVec4d:e++,MFVec4f:e++,Anchor:i++,Appearance:i++,Arc2D:i++,ArcClose2D:i++,AudioClip:i++,Background:i++,BallJoint:i++,Billboard:i++,BlendedVolumeStyle:i++,BooleanFilter:i++,BooleanSequencer:i++,BooleanToggle:i++,BooleanTrigger:i++,BoundaryEnhancementVolumeStyle:i++,BoundedPhysicsModel:i++,Box:i++,CADAssembly:i++,CADFace:i++,CADLayer:i++,CADPart:i++,CartoonVolumeStyle:i++,Circle2D:i++,ClipPlane:i++,CollidableOffset:i++,CollidableShape:i++,CollisionCollection:i++,Collision:i++,CollisionSensor:i++,CollisionSpace:i++,ColorChaser:i++,ColorDamper:i++,ColorInterpolator:i++,Color:i++,ColorRGBA:i++,ComposedCubeMapTexture:i++,ComposedShader:i++,ComposedTexture3D:i++,ComposedVolumeStyle:i++,ConeEmitter:i++,Cone:i++,Contact:i++,Contour2D:i++,ContourPolyline2D:i++,CoordinateChaser:i++,CoordinateDamper:i++,CoordinateDouble:i++,CoordinateInterpolator2D:i++,CoordinateInterpolator:i++,Coordinate:i++,Cylinder:i++,CylinderSensor:i++,DirectionalLight:i++,DISEntityManager:i++,DISEntityTypeMapping:i++,Disk2D:i++,DoubleAxisHingeJoint:i++,EaseInEaseOut:i++,EdgeEnhancementVolumeStyle:i++,ElevationGrid:i++,EspduTransform:i++,ExplosionEmitter:i++,Extrusion:i++,FillProperties:i++,FloatVertexAttribute:i++,FogCoordinate:i++,Fog:i++,FontStyle:i++,ForcePhysicsModel:i++,GeneratedCubeMapTexture:i++,GeoCoordinate:i++,GeoElevationGrid:i++,GeoLocation:i++,GeoLOD:i++,GeoMetadata:i++,GeoOrigin:i++,GeoPositionInterpolator:i++,GeoProximitySensor:i++,GeoTouchSensor:i++,GeoTransform:i++,GeoViewpoint:i++,Group:i++,HAnimDisplacer:i++,HAnimHumanoid:i++,HAnimJoint:i++,HAnimSegment:i++,HAnimSite:i++,ImageCubeMapTexture:i++,ImageTexture3D:i++,ImageTexture:i++,IndexedFaceSet:i++,IndexedLineSet:i++,IndexedQuadSet:i++,IndexedTriangleFanSet:i++,IndexedTriangleSet:i++,IndexedTriangleStripSet:i++,Inline:i++,IntegerSequencer:i++,IntegerTrigger:i++,IsoSurfaceVolumeData:i++,KeySensor:i++,Layer:i++,LayerSet:i++,LayoutGroup:i++,LayoutLayer:i++,Layout:i++,LinePickSensor:i++,LineProperties:i++,LineSet:i++,LoadSensor:i++,LocalFog:i++,LOD:i++,Material:i++,Matrix3VertexAttribute:i++,Matrix4VertexAttribute:i++,MetadataBoolean:i++,MetadataDouble:i++,MetadataFloat:i++,MetadataInteger:i++,MetadataSet:i++,MetadataString:i++,MotorJoint:i++,MovieTexture:i++,MultiTextureCoordinate:i++,MultiTexture:i++,MultiTextureTransform:i++,NavigationInfo:i++,NormalInterpolator:i++,Normal:i++,NurbsCurve2D:i++,NurbsCurve:i++,NurbsOrientationInterpolator:i++,NurbsPatchSurface:i++,NurbsPositionInterpolator:i++,NurbsSet:i++,NurbsSurfaceInterpolator:i++,NurbsSweptSurface:i++,NurbsSwungSurface:i++,NurbsTextureCoordinate:i++,NurbsTrimmedSurface:i++,OpacityMapVolumeStyle:i++,OrientationChaser:i++,OrientationDamper:i++,OrientationInterpolator:i++,OrthoViewpoint:i++,PackagedShader:i++,ParticleSystem:i++,PickableGroup:i++,PixelTexture3D:i++,PixelTexture:i++,PlaneSensor:i++,PointEmitter:i++,PointLight:i++,PointPickSensor:i++,PointSet:i++,Polyline2D:i++,PolylineEmitter:i++,Polypoint2D:i++,PositionChaser2D:i++,PositionChaser:i++,PositionDamper2D:i++,PositionDamper:i++,PositionInterpolator2D:i++,PositionInterpolator:i++,PrimitivePickSensor:i++,ProgramShader:i++,ProjectionVolumeStyle:i++,ProximitySensor:i++,QuadSet:i++,ReceiverPdu:i++,Rectangle2D:i++,RigidBodyCollection:i++,RigidBody:i++,ScalarChaser:i++,ScalarDamper:i++,ScalarInterpolator:i++,ScreenFontStyle:i++,ScreenGroup:i++,Script:i++,SegmentedVolumeData:i++,ShadedVolumeStyle:i++,ShaderPart:i++,ShaderProgram:i++,Shape:i++,SignalPdu:i++,SilhouetteEnhancementVolumeStyle:i++,SingleAxisHingeJoint:i++,SliderJoint:i++,Sound:i++,Sphere:i++,SphereSensor:i++,SplinePositionInterpolator2D:i++,SplinePositionInterpolator:i++,SplineScalarInterpolator:i++,SpotLight:i++,SquadOrientationInterpolator:i++,StaticGroup:i++,StringSensor:i++,SurfaceEmitter:i++,Switch:i++,TexCoordChaser2D:i++,TexCoordDamper2D:i++,Text:i++,TextureBackground:i++,TextureCoordinate3D:i++,TextureCoordinate4D:i++,TextureCoordinateGenerator:i++,TextureCoordinate:i++,TextureProperties:i++,TextureTransform3D:i++,TextureTransformMatrix3D:i++,TextureTransform:i++,TimeSensor:i++,TimeTrigger:i++,ToneMappedVolumeStyle:i++,TouchGroup:i++,TouchSensor:i++,Transform:i++,TransformSensor:i++,TransmitterPdu:i++,TriangleFanSet:i++,TriangleSet2D:i++,TriangleSet:i++,TriangleStripSet:i++,TwoSidedMaterial:i++,UniversalJoint:i++,ViewpointGroup:i++,Viewpoint:i++,Viewport:i++,VisibilitySensor:i++,VolumeData:i++,VolumeEmitter:i++,VolumePickSensor:i++,WindPhysicsModel:i++,WorldInfo:i++,X3DBaseNode:i++,X3DAppearanceChildNode:i++,X3DAppearanceNode:i++,X3DBackgroundNode:i++,X3DBindableNode:i++,X3DBoundedObject:i++,X3DChaserNode:i++,X3DChildNode:i++,X3DColorNode:i++,X3DComposableVolumeRenderStyleNode:i++,X3DComposedGeometryNode:i++,X3DCoordinateNode:i++,X3DDamperNode:i++,X3DDragSensorNode:i++,X3DEnvironmentalSensorNode:i++,X3DEnvironmentTextureNode:i++,X3DFogObject:i++,X3DFollowerNode:i++,X3DFontStyleNode:i++,X3DGeometricPropertyNode:i++,X3DGeometryNode:i++,X3DGeospatialObject:i++,X3DGroupingNode:i++,X3DInfoNode:i++,X3DInterpolatorNode:i++,X3DKeyDeviceSensorNode:i++,X3DLayerNode:i++,X3DLayoutNode:i++,X3DLightNode:i++,X3DLineGeometryNode:i++,X3DMaterialNode:i++,X3DMetadataObject:i++,X3DNBodyCollidableNode:i++,X3DNBodyCollisionSpaceNode:i++,X3DNetworkSensorNode:i++,X3DNode:i++,X3DNormalNode:i++,X3DNurbsControlCurveNode:i++,X3DNurbsSurfaceGeometryNode:i++,X3DParametricGeometryNode:i++,X3DParticleEmitterNode:i++,X3DParticlePhysicsModelNode:i++,X3DPickableObject:i++,X3DPickSensorNode:i++,X3DPointingDeviceSensorNode:i++,X3DProductStructureChildNode:i++,X3DProgrammableShaderObject:i++,X3DPrototypeInstance:i++,X3DRigidJointNode:i++,X3DScriptNode:i++,X3DSensorNode:i++,X3DSequencerNode:i++,X3DShaderNode:i++,X3DShapeNode:i++,X3DSoundNode:i++,X3DSoundSourceNode:i++,X3DTexture2DNode:i++,X3DTexture3DNode:i++,X3DTextureCoordinateNode:i++,X3DTextureNode:i++,X3DTextureTransformNode:i++,X3DTimeDependentNode:i++,X3DTouchSensorNode:i++,X3DTransformMatrix3DNode:i++,X3DTransformNode:i++,X3DTriggerNode:i++,X3DUrlObject:i++,X3DVertexAttributeNode:i++,X3DViewpointNode:i++,X3DViewportNode:i++,X3DVolumeDataNode:i++,X3DVolumeRenderStyleNode:i++,X3DProtoDeclarationNode:i++,X3DProtoDeclaration:i++,X3DExternProtoDeclaration:i++};return Object.preventExtensions(n),Object.freeze(n),Object.seal(n),n}),define("x_ite/Base/Events",["jquery"],function(t){"use strict";return{stack:[],create:function(t){if(this.stack.length){var e=this.stack.pop();return e.field=t,e}return{field:t,sources:{}}},copy:function(t){if(this.stack.length){var e=this.stack.pop();e.field=t.field}else var e={field:t.field,sources:{}};var i=t.sources,n=e.sources;for(var r in i)n[r]=i[r];return e},push:function(t){var e=t.sources;for(var i in e)delete e[i];this.stack.push(t)},clear:function(){this.stack.length=0}}}),define("x_ite/Basic/X3DField",["jquery","x_ite/Base/X3DChildObject","x_ite/Bits/X3DConstants","x_ite/Base/Events"],function(t,e,i,n){"use strict";function r(t){return e.call(this),this._value=t,this}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,_value:null,_references:{},_fieldInterests:{},_fieldCallbacks:{},_inputRoutes:{},_outputRoutes:{},_accessType:i.initializeOnly,_unit:null,_set:!1,_uniformLocation:null,clone:function(){return this.copy()},equals:function(t){return this._value===t.valueOf()},setValue:function(t){this.set(t instanceof this.constructor?t.getValue():t),this.addEvent()},set:function(t){this._value=t},assign:function(t){this.set(t.getValue()),this.addEvent()},getValue:function(){return this._value},setAccessType:function(t){this._accessType=t},getAccessType:function(){return this._accessType},isInitializable:function(){return this.getAccessType()&i.initializeOnly},isInput:function(){return this.getAccessType()&i.inputOnly},isOutput:function(){return this.getAccessType()&i.outputOnly},isReadable:function(){return this.getAccessType()!==i.inputOnly},isWritable:function(){return this.getAccessType()!==i.initializeOnly},setUnit:function(t){return this._unit=t},getUnit:function(){return this._unit},setSet:function(t){return this._set=t},getSet:function(){return this._set},hasReferences:function(){return!!this.hasOwnProperty("_references")&&!t.isEmptyObject(this._references)},isReference:function(t){return t===this.getAccessType()||t===i.inputOutput},addReference:function(t){var e=this.getReferences();if(!e[t.getId()])switch(e[t.getId()]=t,this.getAccessType()&t.getAccessType()){case i.initializeOnly:return void this.set(t.getValue());case i.inputOnly:return void t.addFieldInterest(this);case i.outputOnly:return void this.addFieldInterest(t);case i.inputOutput:return t.addFieldInterest(this),this.addFieldInterest(t),void this.set(t.getValue())}},getReferences:function(){return this.hasOwnProperty("_references")||(this._references={}),this._references},updateReferences:function(){if(this.hasOwnProperty("_references"))for(var t in this._references){var e=this._references[t];switch(this.getAccessType()&e.getAccessType()){case i.inputOnly:case i.outputOnly:continue;case i.initializeOnly:case i.inputOutput:this.set(e.getValue());continue}}},addFieldInterest:function(t){this.hasOwnProperty("_fieldInterests")||(this._fieldInterests={}),this._fieldInterests[t.getId()]=t},removeFieldInterest:function(t){delete this._fieldInterests[t.getId()]},getFieldInterests:function(){return this._fieldInterests},addFieldCallback:function(t,e){this.hasOwnProperty("_fieldCallbacks")||(this._fieldCallbacks={}),this._fieldCallbacks[t]=e},removeFieldCallback:function(t){delete this._fieldCallbacks[t]},getFieldCallbacks:function(){return this._fieldCallbacks},addOutputRoute:function(t){this.hasOwnProperty("_outputRoutes")||(this._outputRoutes={}),this._outputRoutes[t.getId()]=t},removeOutputRoute:function(t){delete this._outputRoutes[t.getId()]},getOutputRoutes:function(){return this._outputRoutes},addInputRoute:function(t){this.hasOwnProperty("_inputRoutes")||(this._inputRoutes={}),this._inputRoutes[t.getId()]=t},removeInputRoute:function(t){delete this._inputRoutes[t.getId()]},getInputRoutes:function(){return this._inputRoutes},processEvent:function(t){if(!t.sources[this.getId()]){t.sources[this.getId()]=!0,this.setTainted(!1),t.field!==this&&this.set(t.field.getValue()),this.processInterests();var e=this._fieldInterests,i=!0;for(var r in e)i?(i=!1,e[r].addEventObject(this,t)):e[r].addEventObject(this,n.copy(t));i&&n.push(t);var o=this._fieldCallbacks;for(var r in o)o[r](this.valueOf())}},valueOf:function(){return this}}),r}),define("x_ite/InputOutput/Generator",["jquery","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function i(){this.indent="",this.indentChar="  ",this.executionContextStack=[null],this.importedNodesIndex={},this.exportedNodesIndex={},this.nodes={},this.names={},this.namesByNode={},this.importedNames={},this.routeNodes={},this.level=0,this.newName=0,this.containerFields=[],this.units=!0,this.unitCategories=[]}return i.prototype={constructor:i,Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)},PushExecutionContext:function(t){this.executionContextStack.push(t),this.importedNodesIndex[t.getId()]={},this.exportedNodesIndex[t.getId()]={}},PopExecutionContext:function(){this.executionContextStack.pop(),this.ExecutionContext()||(this.importedNodesIndex={},this.exportedNodesIndex={})},ExecutionContext:function(){return this.executionContextStack[this.executionContextStack.length-1]},EnterScope:function(){0===this.level&&(this.newName=0),++this.level},LeaveScope:function(){0===--this.level&&(this.nodes={},this.names={},this.namesByNode={},this.importedNames={},this.importedNodes={})},ExportedNodes:function(t){},ImportedNodes:function(t){var e=this.importedNodesIndex[this.ExecutionContext().getId()];for(var i in t)try{e[t[i].getInlineNode().getId()]=!0}catch(t){}},AddImportedNode:function(t,e){this.importedNames[t.getId()]=e},AddRouteNode:function(t){this.routeNodes[t.getId()]=!0},ExistsRouteNode:function(t){return!!this.routeNodes[t.getId()]},IsSharedNode:function(t){return!1},AddNode:function(t){this.nodes[t.getId()]=!0,this.AddRouteNode(t)},ExistsNode:function(t){return void 0!==this.nodes[t.getId()]},Name:function(t){var e=this.namesByNode[t.getId()];if(void 0!==e)return e;if(0===t.getName().length){if(this.NeedsName(t)){var e=this.UniqueName();return this.names[e]=t,this.namesByNode[t.getId()]=e,e}return t.getName()}var i=/(_\d+$)/,e=t.getName(),n=null!==e.match(i);if(e=e.replace(i,""),0===e.length){if(!this.NeedsName(t))return"";e=this.UniqueName()}else{for(var r=0,o=n?e+"_"+ ++r:e;void 0!==this.names[o];)o=e+"_"+ ++r;e=o}return this.names[e]=t,this.namesByNode[t.getId()]=e,e},NeedsName:function(t){if(t.getCloneCount()>1)return!0;if(t.hasRoutes())return!0;var e=t.getExecutionContext(),i=this.importedNodesIndex[e.getId()];if(i&&i[t.getId()])return!0;var i=this.exportedNodesIndex[e.getId()];return!(!i||!i[t.getId()])},UniqueName:function(){for(;;){var t="_"+ ++this.newName;if(void 0===this.names[t])return t}},LocalName:function(t){var e=this.importedNames[t.getId()];if(void 0!==e)return e;if(this.ExistsNode(t))return this.Name(t);throw new Error("Couldn't get local name for node '"+t.getTypeName()+"'.")},PushContainerField:function(t){this.containerFields.push(t)},PopContainerField:function(){this.containerFields.pop()},ContainerField:function(){return this.containerFields.length?this.containerFields[this.containerFields.length-1]:null},AccessType:function(t){switch(t){case e.initializeOnly:return"initializeOnly";case e.inputOnly:return"inputOnly";case e.outputOnly:return"outputOnly";case e.inputOutput:return"inputOutput"}},SetUnits:function(t){this.units=t},GetUnits:function(){return this.units},PushUnitCategory:function(t){this.unitCategories.push(t)},PopUnitCategory:function(){this.unitCategories.pop()},Unit:function(t){var e=this.unitCategories.length;return 0==e?t:this.unitCategories[e-1]},ToUnit:function(t,e){if(this.units){var i=this.ExecutionContext();if(i)return i.toUnit(t,e)}return e},XMLEncode:function(t){return t.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,'\\"')},escapeCDATA:function(t){return t.replace(/\]\]\>/g,"\\]\\]\\>")}},i.Get=function(t){return t.generator||(t.generator=new i),t.generator},i}),define("x_ite/Basic/X3DArrayField",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t){return e.call(this,[]),t[0]instanceof Array&&(t=t[0]),r.prototype.push.apply(this,t),new Proxy(this,o)}var o={get:function(t,e){try{if(e in t)return t[e];var i=t.getValue(),n=parseInt(e);return n>=i.length&&t.resize(n+1),i[n].valueOf()}catch(i){if("symbol"==typeof e)return;console.log(t,typeof e,e,i)}},set:function(t,e,i){try{if(e in t)return t[e]=i,!0;var n=t.getValue(),r=parseInt(e);return r>=n.length&&t.resize(r+1),n[r].setValue(i),!0}catch(i){return console.log(t,e,i),!1}},has:function(t,e){return e in t.getValue()},enumerate:function(t){return Object.keys(t.getValue())[Symbol.iterator]()}};return r.prototype=t.extend(new e([]),{constructor:r,copy:function(){var t=new this.constructor,e=this.getValue();return r.prototype.push.apply(t,e),t},equals:function(t){var e=this.getValue(),i=t.getValue(),n=e.length;if(e===i)return!0;if(n!==i.length)return!1;for(var r=0;r<n;++r)if(!e[r].equals(i[r]))return!1;return!0},setValue:function(t){this.set(t instanceof r?t.getValue():t),this.addEvent()},isDefaultValue:function(){return 0===this.length},set:function(t){this.resize(t.length,void 0,!0);for(var i=this.getValue(),n=0,r=t.length;n<r;++n)i[n].set(t[n]instanceof e?t[n].getValue():t[n])},unshift:function(t){for(var e=this.getValue(),i=arguments.length-1;i>=0;--i){var n=new this._valueType;n.setValue(arguments[i]),this.addChild(n),e.unshift(n)}return this.addEvent(),e.length},shift:function(){var t=this.getValue();if(t.length){var e=t.shift();return this.removeChild(e),this.addEvent(),e.valueOf()}},push:function(t){for(var e=this.getValue(),i=0,n=arguments.length;i<n;++i){var r=new this._valueType;r.setValue(arguments[i]),this.addChild(r),e.push(r)}return this.addEvent(),e.length},pop:function(){var t=this.getValue();if(t.length){var e=t.pop();return this.removeChild(e),this.addEvent(),e.valueOf()}},splice:function(t,e){var i=this.getValue();t>i.length&&(t=i.length),t+e>i.length&&(e=i.length-t);var n=new this.constructor(this.erase(t,t+e));return arguments.length>2&&this.insert(t,arguments,2,arguments.length),n},insert:function(t,e,i,n){for(var r=[t,0],o=i;o<n;++o){var s=new this._valueType;s.setValue(e[o]),this.addChild(s),r.push(s)}Array.prototype.splice.apply(this.getValue(),r),this.addEvent()},find:function(e,i,n){if(t.isFunction(n)){for(var r=this.getValue(),o=e;o<i;++o)if(n(r[o].valueOf()))return o;return i}for(var r=this.getValue(),o=e;o<i;++o)if(r[o].equals(n))return o;return i},remove:function(e,i,n){if(t.isFunction(n)){var r=this.getValue();if((e=this.find(e,i,n))!==i)for(var o=e;++o<i;){var s=r[o];if(!n(s.valueOf())){var a=r[e];r[e++]=s,r[o]=a}}return e!==i&&this.addEvent(),e}var r=this.getValue();if((e=this.find(e,i,n))!==i)for(var o=e;++o<i;){var s=r[o];if(!s.equals(n)){var a=r[e];r[e++]=s,r[o]=a}}return e!==i&&this.addEvent(),e},erase:function(t,e){for(var i=this.getValue().splice(t,e-t),n=0,r=i.length;n<r;++n)this.removeChild(i[n]);return this.addEvent(),i},resize:function(t,e,i){var n=this.getValue();if(t<n.length){for(var r=t,o=n.length;r<o;++r)this.removeChild(n[r]);n.length=t,i||this.addEvent()}else if(t>n.length){for(var r=n.length;r<t;++r){var s=new this._valueType;void 0!==e&&s.setValue(e),this.addChild(s),n.push(s)}i||this.addEvent()}},addChild:function(t){t.addParent(this)},removeChild:function(t){t.removeParent(this)},toStream:function(t){var e=n.Get(t),i=this.getValue();switch(i.length){case 0:t.string+="[ ]";break;case 1:e.PushUnitCategory(this.getUnit()),i[0].toStream(t),e.PopUnitCategory();break;default:e.PushUnitCategory(this.getUnit()),t.string+="[\n",e.IncIndent();for(var r=0,o=i.length-1;r<o;++r)t.string+=e.Indent(),i[r].toStream(t),t.string+=",\n";t.string+=e.Indent(),i[o].toStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="]",e.PopUnitCategory()}},toXMLStream:function(t){var e=this.length;if(e){var i=n.Get(t),r=this.getValue();i.PushUnitCategory(this.getUnit());for(var o=0,s=e-1;o<s;++o)r[o].toXMLStream(t),t.string+=", ";r[s].toXMLStream(t),i.PopUnitCategory()}},dispose:function(){this.erase(0,this.length),e.prototype.dispose.call(this)}}),Object.defineProperty(r.prototype,"length",{get:function(){return this.getValue().length},set:function(t){this.resize(t)},enumerable:!1,configurable:!1}),r}),define("x_ite/Fields/SFBool",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){return this instanceof n?e.call(this,Boolean(t)):e.call(Object.create(n.prototype),Boolean(t))}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},isDefaultValue:function(){return!1===this.getValue()},set:function(t){e.prototype.set.call(this,Boolean(t))},getTypeName:function(){return"SFBool"},getType:function(){return i.SFBool},valueOf:function(){return this.getValue()},toStream:function(t){
t.string+=this.getValue()?"TRUE":"FALSE"},toXMLStream:function(t){t.string+=this.getValue()?"true":"false"}}),n}),define("standard/Math/Algorithm",[],function(){"use strict";var t={signum:function(t){return(0<t)-(t<0)},radians:function(t){return t*(Math.PI/180)},degrees:function(t){return t*(180/Math.PI)},random:function(t,e){return t+Math.random()*(e-t)},clamp:function(t,e,i){return t<e?e:t>i?i:t},interval:function(t,e,i){return t>=i?(t-e)%(i-e)+e:t<e?(t-i)%(i-e)+i:t},lerp:function(t,e,i){return t+i*(e-t)},slerp:function(t,e,i){var n=t.dot(e);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(n>=1)return t;n<0&&(n=-n,e.negate());var r=Math.acos(n),o=Math.sin(r),s=Math.sin((1-i)*r)/o,a=Math.sin(i*r)/o;return t.x=t.x*s+e.x*a,t.y=t.y*s+e.y*a,t.z=t.z*s+e.z*a,t.w=t.w*s+e.w*a,t},simpleSlerp:function(t,e,i){var n=t.dot(e);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(n>=1)return t;var r=Math.acos(n),o=Math.sin(r),s=Math.sin((1-i)*r)/o,a=Math.sin(i*r)/o;return t.x=t.x*s+e.x*a,t.y=t.y*s+e.y*a,t.z=t.z*s+e.z*a,t.w=t.w*s+e.w*a,t},isPowerOfTwo:function(t){return 0==(t-1&t)},nextPowerOfTwo:function(t){--t;for(var e=1;!(32&e);e<<=1)t|=t>>e;return++t},less:function(t,e){return t<e},greater:function(t,e){return t>e},lowerBound:function(t,e,i,n,r){for(var o=0,s=0,a=i-e;a>0;)s=a>>>1,o=e+s,r(t[o],n)?(e=++o,a-=s+1):a=s;return e},upperBound:function(t,e,i,n,r){for(var o=0,s=0,a=i-e;a>0;)s=a>>>1,o=e+s,r(n,t[o])?a=s:(e=++o,a-=s+1);return e},set_difference:function(t,e,i){for(var n in t)n in e||(i[n]=t[n]);return i}};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("standard/Math/Numbers/Color3",["jquery","standard/Math/Algorithm"],function(t,e){"use strict";function i(t,e,i){arguments.length?(this.r_=n(t,0,1),this.g_=n(e,0,1),this.b_=n(i,0,1)):(this.r_=0,this.g_=0,this.b_=0)}var n=e.clamp;i.prototype={constructor:i,length:3,copy:function(){var t=Object.create(i.prototype);return t.r_=this.r_,t.g_=this.g_,t.b_=this.b_,t},assign:function(t){this.r_=t.r_,this.g_=t.g_,this.b_=t.b_},set:function(t,e,i){this.r_=n(t,0,1),this.g_=n(e,0,1),this.b_=n(i,0,1)},equals:function(t){return this.r_===t.r_&&this.g_===t.g_&&this.b_===t.b_},getHSV:function(t){var e,i,n,r=Math.min(this.r_,this.g_,this.b_),o=Math.max(this.r_,this.g_,this.b_);n=o;var s=o-r;return 0!==o&&0!==s?(i=s/o,e=this.r_===o?(this.g_-this.b_)/s:this.g_===o?2+(this.b_-this.r_)/s:4+(this.r_-this.g_)/s,(e*=Math.PI/3)<0&&(e+=2*Math.PI)):i=e=0,t[0]=e,t[1]=i,t[2]=n,t},setHSV:function(t,i,r){if(i=n(i,0,1),r=n(r,0,1),0===i)this.r_=this.g_=this.b_=r;else{var o=e.degrees(e.interval(t,0,2*Math.PI))/60,s=Math.floor(o),a=o-s,u=r*(1-i),l=r*(1-i*a),h=r*(1-i*(1-a));switch(s%6){case 0:this.r_=r,this.g_=h,this.b_=u;break;case 1:this.r_=l,this.g_=r,this.b_=u;break;case 2:this.r_=u,this.g_=r,this.b_=h;break;case 3:this.r_=u,this.g_=l,this.b_=r;break;case 4:this.r_=h,this.g_=u,this.b_=r;break;default:this.r_=r,this.g_=u,this.b_=l}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_}};var r={get:function(){return this.r_},set:function(t){this.r_=n(t,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.g_},set:function(t){this.g_=n(t,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(t){this.b_=n(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(i.prototype,"r",r),Object.defineProperty(i.prototype,"g",o),Object.defineProperty(i.prototype,"b",s),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,Object.defineProperty(i.prototype,"0",r),Object.defineProperty(i.prototype,"1",o),Object.defineProperty(i.prototype,"2",s),t.extend(i,{HSV:function(t,e,n){var r=new i(0,0,0);return r.setHSV(t,e,n),r},lerp:function(t,i,n,r){var o=Math.abs(i[0]-t[0]);if(o<=Math.PI)return r[0]=e.lerp(t[0],i[0],n),r[1]=e.lerp(t[1],i[1],n),r[2]=e.lerp(t[2],i[2],n),r;var s=2*Math.PI,a=(s-o)*n,u=t[0]<i[0]?t[0]-a:t[0]+a;return u<0?u+=s:u>s&&(u-=s),r[0]=u,r[1]=e.lerp(t[1],i[1],n),r[2]=e.lerp(t[2],i[2],n),r}}),i}),define("x_ite/Fields/SFColor",["jquery","standard/Math/Numbers/Color3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t,n,o){return this instanceof r?arguments.length?arguments[0]instanceof e?i.call(this,arguments[0]):i.call(this,new e(+t,+n,+o)):i.call(this,new e):r.apply(Object.create(r.prototype),arguments)}r.prototype=t.extend(Object.create(i.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return n.SFColor},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b},set:function(t){this.getValue().assign(t)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(t,e,i){this.getValue().setHSV(t,e,i),this.addEvent()},toStream:function(t){t.string+=this.getValue().toString()},toXMLStream:function(t){this.toStream(t)}});var o={get:function(){return this.getValue().r},set:function(t){this.getValue().r=t,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().g},set:function(t){this.getValue().g=t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(t){this.getValue().b=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",o),Object.defineProperty(r.prototype,"g",s),Object.defineProperty(r.prototype,"b",a),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),r}),define("standard/Math/Numbers/Color4",["jquery","standard/Math/Numbers/Color3","standard/Math/Algorithm"],function(t,e,i){"use strict";function n(t,e,i,n){arguments.length?(this.r_=r(t,0,1),this.g_=r(e,0,1),this.b_=r(i,0,1),this.a_=r(n,0,1)):(this.r_=0,this.g_=0,this.b_=0,this.a_=0)}var r=i.clamp;n.prototype={constructor:n,length:4,copy:function(){var t=Object.create(n.prototype);return t.r_=this.r_,t.g_=this.g_,t.b_=this.b_,t.a_=this.a_,t},assign:function(t){this.r_=t.r_,this.g_=t.g_,this.b_=t.b_,this.a_=t.a_},set:function(t,e,i,n){this.r_=r(t,0,1),this.g_=r(e,0,1),this.b_=r(i,0,1),this.a_=r(n,0,1)},equals:function(t){return this.r_===t.r_&&this.g_===t.g_&&this.b_===t.b_&&this.a_===t.a_},getHSVA:function(t){return e.prototype.getHSV.call(this,t),t[3]=this.a_,t},setHSVA:function(t,i,n,o){e.prototype.setHSV.call(this,t,i,n),this.a_=r(o,0,1)},toString:function(){return this.r_+" "+this.g_+" "+this.b_+" "+this.a_}};var o={get:function(){return this.r_},set:function(t){this.r_=r(t,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.g_},set:function(t){this.g_=r(t,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this.b_},set:function(t){this.b_=r(t,0,1)},enumerable:!0,configurable:!1},u={get:function(){return this.a_},set:function(t){this.a_=r(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(n.prototype,"r",o),Object.defineProperty(n.prototype,"g",s),Object.defineProperty(n.prototype,"b",a),Object.defineProperty(n.prototype,"a",u),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(n.prototype,"0",o),Object.defineProperty(n.prototype,"1",s),Object.defineProperty(n.prototype,"2",a),Object.defineProperty(n.prototype,"3",u),n.HSVA=function(t,e,i,r){var o=new n(0,0,0,r);return o.setHSV(t,e,i),o},n}),define("x_ite/Fields/SFColorRGBA",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFColor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color4"],function(t,e,i,n,r){"use strict";function o(t,i,n,s){return this instanceof o?arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i,+n,+s)):e.call(this,new r):o.apply(Object.create(o.prototype),arguments)}o.prototype=t.extend(Object.create(e.prototype),{constructor:o,copy:function(){return new o(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return n.SFColorRGBA},equals:i.prototype.equals,isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b&&0===this.getValue().a},set:i.prototype.set,getHSVA:function(){return this.getValue().getHSVA([])},setHSVA:function(t,e,i,n){this.getValue().setHSVA(t,e,i,n),this.addEvent()},toStream:i.prototype.toStream,toXMLStream:i.prototype.toXMLStream});var s={get:function(){return this.getValue().r},set:function(t){this.getValue().r=t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().g},set:function(t){this.getValue().g=t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().b},set:function(t){this.getValue().b=t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().a},set:function(t){this.getValue().a=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"r",s),Object.defineProperty(o.prototype,"g",a),Object.defineProperty(o.prototype,"b",u),Object.defineProperty(o.prototype,"a",l),s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(o.prototype,"0",s),Object.defineProperty(o.prototype,"1",a),Object.defineProperty(o.prototype,"2",u),Object.defineProperty(o.prototype,"3",l),o}),define("x_ite/Fields/SFDouble",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t){return this instanceof r?e.call(this,arguments.length?+t:0):e.call(Object.create(r.prototype),arguments.length?+t:0)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,copy:function(){return new r(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return i.SFDouble},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(t){var e=n.Get(t),i=e.Unit(this.getUnit());t.string+=String(e.ToUnit(i,this.getValue()))},toXMLStream:function(t){this.toStream(t)}}),r}),define("x_ite/Fields/SFFloat",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t){return this instanceof r?e.call(this,arguments.length?+t:0):e.call(Object.create(r.prototype),arguments.length?+t:0)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,copy:function(){return new r(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return i.SFFloat},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(t){var e=n.Get(t),i=e.Unit(this.getUnit());t.string+=String(e.ToUnit(i,this.getValue()))},toXMLStream:function(t){this.toStream(t)}}),r}),define("x_ite/Fields/SFInt32",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){return this instanceof n?e.call(this,~~t):e.call(Object.create(n.prototype),~~t)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return i.SFInt32},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,~~t)},valueOf:e.prototype.getValue,toStream:function(t,e){t.string+=this.getValue().toString(e)},toXMLStream:function(t){t.string+=this.getValue().toString()}}),n}),define("x_ite/Fields/SFMatrixPrototypeTemplate",["jquery","x_ite/Basic/X3DField"],function(t,e){"use strict";return function(i,n){return t.extend(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(i.Identity)},set:function(t){this.getValue().assign(t)},setTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e?e.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().set(t,e,i,n,r)},getTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e?e.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().get(t,e,i,n,r)},transpose:function(){return new this.constructor(i.transpose(this.getValue()))},inverse:function(){return new this.constructor(i.inverse(this.getValue()))},multLeft:function(t){return new this.constructor(i.multLeft(this.getValue(),t.getValue()))},multRight:function(t){return new this.constructor(i.multRight(this.getValue(),t.getValue()))},multVecMatrix:function(t){return new n(this.getValue().multVecMatrix(t.getValue().copy()))},multMatrixVec:function(t){return new n(this.getValue().multMatrixVec(t.getValue().copy()))},multDirMatrix:function(t){return new n(this.getValue().multDirMatrix(t.getValue().copy()))},multMatrixDir:function(t){return new n(this.getValue().multMatrixDir(t.getValue().copy()))},toStream:function(t){t.string+=this.getValue().toString()},toXMLStream:function(t){this.toStream(t)}})}}),define("x_ite/Fields/SFVecPrototypeTemplate",["jquery","x_ite/Basic/X3DField","x_ite/InputOutput/Generator"],function(t,e,i){"use strict";return function(n){return t.extend(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(t){return this.getValue().equals(n.Zero)},set:function(t){this.getValue().assign(t)},negate:function(){return new this.constructor(n.negate(this.getValue().copy()))},add:function(t){return new this.constructor(n.add(this.getValue(),t.getValue()))},subtract:function(t){return new this.constructor(n.subtract(this.getValue(),t.getValue()))},multiply:function(t){return new this.constructor(n.multiply(this.getValue(),t))},multVec:function(t){return new this.constructor(n.multVec(this.getValue(),t.getValue()))},divide:function(t){return new this.constructor(n.divide(this.getValue(),t))},divVec:function(t){return new this.constructor(n.divVec(this.getValue(),t.getValue()))},dot:function(t){return this.getValue().dot(t.getValue())},normalize:function(t){return new this.constructor(n.normalize(this.getValue()))},length:function(){return this.getValue().abs()},toStream:function(t){for(var e=i.Get(t),n=this.getValue(),r=e.Unit(this.getUnit()),o=0,s=n.length-1;o<s;++o)t.string+=String(e.ToUnit(r,n[o])),t.string+=" ";t.string+=String(e.ToUnit(r,n[o]))},toXMLStream:function(t){this.toStream(t)}})}}),define("standard/Math/Numbers/Vector2",["jquery","standard/Math/Algorithm"],function(t,e){"use strict";function i(t,e){this.x=t,this.y=e}return i.prototype={constructor:i,length:2,copy:function(){var t=Object.create(i.prototype);return t.x=this.x,t.y=this.y,t},assign:function(t){return this.x=t.x,this.y=t.y,this},set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this.x===t.x&&this.y===t.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t,this.y*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this},divide:function(t){return this.x/=t,this.y/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t&&(t=1/t,this.x*=t,this.y*=t),this},dot:function(t){return this.x*t.x+this.y*t.y},norm:function(){return this.x*this.x+this.y*this.y},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},distance:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},lerp:function(t,e){return this.x=this.x+e*(t.x-this.x),this.y=this.y+e*(t.y-this.y),this},min:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y)}return this},max:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y)}return this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(i.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),t.extend(i,{Zero:new i(0,0),One:new i(1,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e},add:function(t,e){var i=Object.create(this.prototype);return i.x=t.x+e.x,i.y=t.y+e.y,i},subtract:function(t,e){var i=Object.create(this.prototype);return i.x=t.x-e.x,i.y=t.y-e.y,i},multiply:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e,i.y=t.y*e,i},multVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e.x,i.y=t.y*e.y,i},divide:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e,i.y=t.y/e,i},divVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e.x,i.y=t.y/e.y,i},normalize:function(t){var e=Object.create(this.prototype),i=t.x,n=t.y,r=Math.sqrt(i*i+n*n);return r?(r=1/r,e.x=i*r,e.y=n*r):(e.x=0,e.y=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,r){return new i(e.lerp(t.x,n.x,r),e.lerp(t.y,n.y,r))},min:function(t,e){for(var n=t.x,r=t.y,o=1,s=arguments.length;o<s;++o){var a=arguments[o];n=Math.min(n,a.x),r=Math.min(r,a.y)}return new i(n,r)},max:function(t,e){for(var n=t.x,r=t.y,o=1,s=arguments.length;o<s;++o){var a=arguments[o];n=Math.max(n,a.x),r=Math.max(r,a.y)}return new i(n,r)}}),i}),define("x_ite/Fields/SFVec2",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r){"use strict";function o(n,o){function s(t,i){return arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i)):e.call(this,new r(0,0))}s.prototype=t.extend(Object.create(e.prototype),i(r),{constructor:s,getTypeName:function(){return n},getType:function(){return o}});var a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),a.enumerable=!1,u.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),s}return{SFVec2d:o("SFVec2d",n.SFVec2d),SFVec2f:o("SFVec2f",n.SFVec2f)}}),define("standard/Math/Numbers/Vector3",["jquery","standard/Math/Algorithm"],function(t,e){"use strict";function i(t,e,i){this.x=t,this.y=e,this.z=i}i.prototype={constructor:i,length:3,copy:function(){var t=Object.create(i.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},cross:function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return t&&(t=1/t,this.x*=t,this.y*=t,this.z*=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},distance:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},lerp:function(t,e){return this.x=this.x+e*(t.x-this.x),this.y=this.y+e*(t.y-this.y),this.z=this.z+e*(t.z-this.z),this},slerp:function(t,i){return e.simpleSlerp(this,n.assign(t),i)},min:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z)}return this},max:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z)}return this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(i.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),t.extend(i,{Zero:new i(0,0,0),One:new i(1,1,1),xAxis:new i(1,0,0),yAxis:new i(0,1,0),zAxis:new i(0,0,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},add:function(t,e){var i=Object.create(this.prototype);return i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i},subtract:function(t,e){var i=Object.create(this.prototype);return i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i},multiply:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e,i.y=t.y*e,i.z=t.z*e,i},multVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i},divide:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e,i.y=t.y/e,i.z=t.z/e,i},divVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i},cross:function(t,e){var i=Object.create(this.prototype);return i.x=t.y*e.z-t.z*e.y,i.y=t.z*e.x-t.x*e.z,i.z=t.x*e.y-t.y*e.x,i},normalize:function(t){var e=Object.create(this.prototype),i=t.x,n=t.y,r=t.z,o=Math.sqrt(i*i+n*n+r*r);return o?(o=1/o,e.x=i*o,e.y=n*o,e.z=r*o):(e.x=0,e.y=0,e.z=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,r){return new i(e.lerp(t.x,n.x,r),e.lerp(t.y,n.y,r),e.lerp(t.z,n.z,r))},slerp:function(t,i,r){return e.simpleSlerp(t.copy(),n.assign(i),r)},min:function(t,e){for(var n=t.x,r=t.y,o=t.z,s=1,a=arguments.length;s<a;++s){var u=arguments[s];n=Math.min(n,u.x),r=Math.min(r,u.y),o=Math.min(o,u.z)}return new i(n,r,o)},max:function(t,e){for(var n=t.x,r=t.y,o=t.z,s=1,a=arguments.length;s<a;++s){var u=arguments[s];n=Math.max(n,u.x),r=Math.max(r,u.y),o=Math.max(o,u.z)}return new i(n,r,o)}});var n=new i(0,0,0);return i}),define("standard/Math/Numbers/Matrix2",["jquery","standard/Math/Algorithm"],function(t,e){"use strict";function i(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return i.prototype={constructor:i,order:2,length:4,copy:function(){var t=Object.create(i.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]},set1:function(t,e,i){this[t*this.order+e]=i},get1:function(t,e){return this[t*this.order+e]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}},determinant1:function(){return this[0]},determinant:function(){return this[0]*this[3]-this[1]*this[2]},transpose:function(){var t=this[1];return this[1]=this[2],this[2]=t,this},inverse:function(){var t=this.determinant();if(0===t)throw new Error("Matrix2 .inverse: determinant is 0.");return this[0]=array[0]/t,this[1]=-array[1]/t,this[2]=-array[2]/t,this[3]=array[3]/t,this},multLeft:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=t[0],s=t[1],a=t[2],u=t[3];return this[0]=e*o+n*s,this[1]=i*o+r*s,this[2]=e*a+n*u,this[3]=i*a+r*u,this},multRight:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=t[0],s=t[1],a=t[2],u=t[3];return this[0]=o*e+a*i,this[1]=s*e+u*i,this[2]=o*n+a*r,this[3]=s*n+u*r,this},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(i.prototype,"x",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"origin",{get:function(){return nthis[2]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"submatrix",{get:function(){return this.value[0]},enumerable:!1,configurable:!1}),t.extend(i,{Identity:new i}),i}),define("standard/Math/Algorithms/eigendecomposition",[],function(){"use strict";return function(t){var e,i,n,r,o,s,a,u,l,h,c,d,p,f=t.order,g=new Array(f),m=new Array(f),x=new Array(f),y=new Array(f),_=new Array(f),v=t.length;for(d=0;d<f;++d)for(m[d]=new Array(f),x[d]=new Array(f),y[d]=g[d]=t.get1(d,d),_[d]=0,p=0;p<f;++p)m[d][p]=d===p?1:0,x[d][p]=t.get1(p,d);for(d=0;d<50;++d){for(e=0,h=0;h<f-1;++h)for(c=h+1;c<f;++c)e+=Math.abs(x[h][c]);if(0===e)break;for(l=d<3?.2*e/v:0,h=0;h<f-1;++h)for(c=h+1;c<f;++c)if(u=100*Math.abs(x[h][c]),d>3&&Math.abs(g[h])+u===Math.abs(g[h])&&Math.abs(g[c])+u===Math.abs(g[c]))x[h][c]=0;else if(Math.abs(x[h][c])>l){for(a=g[c]-g[h],Math.abs(a)+u===Math.abs(a)?o=x[h][c]/a:(i=.5*a/x[h][c],o=1/(Math.abs(i)+Math.sqrt(1+i*i)),i<0&&(o=-o)),n=1/Math.sqrt(1+o*o),r=o*n,s=r/(1+n),a=o*x[h][c],_[h]-=a,_[c]+=a,g[h]-=a,g[c]+=a,x[h][c]=0,p=0;p<h;++p)u=x[p][h],a=x[p][c],x[p][h]=u-r*(a+u*s),x[p][c]=a+r*(u-a*s);for(p=h+1;p<c;++p)u=x[h][p],a=x[p][c],x[h][p]=u-r*(a+u*s),x[p][c]=a+r*(u-a*s);for(p=c+1;p<f;++p)u=x[h][p],a=x[c][p],x[h][p]=u-r*(a+u*s),x[c][p]=a+r*(u-a*s);for(p=0;p<f;++p)u=m[p][h],a=m[p][c],m[p][h]=u-r*(a+u*s),m[p][c]=a+r*(u-a*s)}for(h=0;h<f;++h)g[h]=y[h]+=_[h],_[h]=0}return{values:g,vectors:m}}}),define("standard/Math/Numbers/Matrix3",["jquery","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],function(t,e,i,n,r){"use strict";function o(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}var s=new e(0,0),a=new i(0,0,0),u=new e(0,0),l=new i(0,0,0),h=new e(0,0),c=new n,d=new n,p=new n,f=new n,g=new e(0,0),m=new n;return o.prototype={constructor:o,order:3,length:9,copy:function(){var t=Object.create(o.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(t,e,i){return this[t*this.order+e]=i,this},get1:function(t,e){return this[t*this.order+e]},set:function(t,i,n,r,o){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===i&&(i=0),this.identity(),this.translate(t),0!==i&&this.rotate(i);break;case 3:null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),this.identity(),this.translate(t),0!==i&&this.rotate(i),n.equals(e.One)||this.scale(n);break;case 4:if(null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),this.identity(),this.translate(t),0!==i&&this.rotate(i),!n.equals(e.One)){0!==r?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)}break;case 5:null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),null===o&&(o=e.Zero),this.identity(),this.translate(t);var s=!o.equals(e.Zero);s&&this.translate(o),0!==i&&this.rotate(i),n.equals(e.One)||(0!==r?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)),s&&this.translate(e.negate(o));break;case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this},get:function(t,e,i,n,r){switch(null===t&&(t=s),null===e&&(e=a),null===i&&(i=u),null===n&&(n=l),null===r&&(r=h),arguments.length){case 1:t.set(this[6],this[7]);break;case 2:this.factor(t,p,u,f),e[0]=p[0],e[1]=p[1],e[2]=Math.atan2(p[1],p[0]);break;case 3:this.factor(t,p,i,f),e[0]=p[0],e[1]=p[1],e[2]=Math.atan2(p[1],p[0]);break;case 4:this.factor(t,p,i,f),e[0]=p[0],e[1]=p[1],e[2]=Math.atan2(p[1],p[0]),n[0]=f[0],n[1]=f[1],n[2]=Math.atan2(f[1],f[0]);break;case 5:var c=new o;c.set(g.assign(r).negate()),c.multLeft(this),c.translate(r),c.get(t,e,i,n)}},factor:function(t,e,i,n){t.set(this[6],this[7]);var o=this.submatrix,s=o.determinant(),a=s<0?-1:1;if(0===s)return!1;m.assign(o).transpose().multLeft(o);var u=r(m);return n.set(u.vectors[0][0],u.vectors[0][1],u.vectors[1][0],u.vectors[1][1]),i.x=a*Math.sqrt(u.values[0]),i.y=a*Math.sqrt(u.values[1]),c[0]=1/i.x,c[3]=1/i.y,e.assign(d.assign(n).multRight(c).transpose().multLeft(n).multRight(o)),n.transpose(),!0},determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){var t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8];return t*(r*u-o*a)-e*(n*u-o*s)+i*(n*a-r*s)},transpose:function(){var t;return t=this[1],this[1]=this[3],this[3]=t,t=this[2],this[2]=this[6],this[6]=t,t=this[5],this[5]=this[7],this[7]=t,this},inverse:function(){var t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=t*r,h=t*a,c=n*e,d=n*a,p=s*e,f=s*r,g=l*u-h*o-c*u+d*i+p*o-f*i;if(0===g)throw new Error("Matrix3 .inverse: determinant is 0.");g=1/g;var m=(r*u-a*o)*g,x=-(e*u-a*i)*g,y=(e*o-r*i)*g,_=-(n*u-s*o)*g,v=(t*u-s*i)*g,w=-(t*o-n*i)*g;return this[0]=m,this[1]=x,this[2]=y,this[3]=_,this[4]=v,this[5]=w,this[6]=(d-f)*g,this[7]=-(h-p)*g,this[8]=(l-c)*g,this},multLeft:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],h=t[0],c=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],x=t[7],y=t[8];return this[0]=e*h+r*c+a*d,this[1]=i*h+o*c+u*d,this[2]=n*h+s*c+l*d,this[3]=e*p+r*f+a*g,this[4]=i*p+o*f+u*g,this[5]=n*p+s*f+l*g,this[6]=e*m+r*x+a*y,this[7]=i*m+o*x+u*y,this[8]=n*m+s*x+l*y,this},multRight:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],h=t[0],c=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],x=t[7],y=t[8];return this[0]=e*h+i*p+n*m,this[1]=e*c+i*f+n*x,this[2]=e*d+i*g+n*y,this[3]=r*h+o*p+s*m,this[4]=r*c+o*f+s*x,this[5]=r*d+o*g+s*y,this[6]=a*h+u*p+l*m,this[7]=a*c+u*f+l*x,this[8]=a*d+u*g+l*y,this},multVecMatrix:function(t){if(2===t.length){var e=t.x,i=t.y,n=e*this[2]+i*this[5]+this[8];return t.x=(e*this[0]+i*this[3]+this[6])/n,t.y=(e*this[1]+i*this[4]+this[7])/n,t}var e=t.x,i=t.y,r=t.z;return t.x=e*this[0]+i*this[3]+r*this[6],t.y=e*this[1]+i*this[4]+r*this[7],t.z=e*this[2]+i*this[5]+r*this[8],t},multMatrixVec:function(t){if(2===t.length){var e=t.x,i=t.y,n=e*this[6]+i*this[7]+this[8];return t.x=(e*this[0]+i*this[1]+this[2])/n,t.y=(e*this[3]+i*this[4]+this[5])/n,t}var e=t.x,i=t.y,r=t.z;return t.x=e*this[0]+i*this[1]+r*this[2],t.y=e*this[3]+i*this[4]+r*this[5],t.z=e*this[6]+i*this[7]+r*this[8],t},multDirMatrix:function(t){var e=t.x,i=t.y;return t.x=e*this[0]+i*this[3],t.y=e*this[1]+i*this[4],t},multMatrixDir:function(t){var e=t.x,i=t.y;return t.x=e*this[0]+i*this[1],t.y=e*this[3]+i*this[4],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},
translate:function(t){var e=t.x,i=t.y;return this[6]+=this[0]*e+this[3]*i,this[7]+=this[1]*e+this[4]*i,this},rotate:function(t){return this.multLeft(o.Rotation(t)),this},scale:function(t){var e=t.x,i=t.y;return this[0]*=e,this[3]*=i,this[1]*=e,this[4]*=i,this},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(o.prototype,"x",{get:function(){return new e(this[0],this[1])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){return new e(this[3],this[4])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"origin",{get:function(){return new e(this[6],this[7])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"submatrix",{get:function(){var t=Object.create(n.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[3],t[3]=this[4],t},enumerable:!1,configurable:!1}),t.extend(o,{Identity:new o,Rotation:function(t){var e=Math.sin(t),i=Math.cos(t);return new o(i,e,0,-e,i,0,0,0,1)},Matrix2:function(t){return new o(t[0],t[1],0,t[2],t[3],0,0,0,1)},transpose:function(t){var e=Object.create(this.prototype);return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e},inverse:function(t){var e=Object.create(this.prototype),i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],l=t[7],h=t[8],c=i*s,d=i*l,p=o*n,f=o*l,g=u*n,m=u*s,x=c*h-d*a-p*h+f*r+g*a-m*r;if(0===x)throw new Error("Matrix3 .inverse: determinant is 0.");x=1/x;var y=(s*h-l*a)*x,_=-(n*h-l*r)*x,v=(n*a-s*r)*x,w=-(o*h-u*a)*x,b=(i*h-u*r)*x,S=-(i*a-o*r)*x;return e[0]=y,e[1]=_,e[2]=v,e[3]=w,e[4]=b,e[5]=S,e[6]=(f-m)*x,e[7]=-(d-g)*x,e[8]=(c-p)*x,e},multLeft:function(t,e){var i=Object.create(this.prototype),n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],h=t[7],c=t[8],d=e[0],p=e[1],f=e[2],g=e[3],m=e[4],x=e[5],y=e[6],_=e[7],v=e[8];return i[0]=n*d+s*p+l*f,i[1]=r*d+a*p+h*f,i[2]=o*d+u*p+c*f,i[3]=n*g+s*m+l*x,i[4]=r*g+a*m+h*x,i[5]=o*g+u*m+c*x,i[6]=n*y+s*_+l*v,i[7]=r*y+a*_+h*v,i[8]=o*y+u*_+c*v,i},multRight:function(t,e){var i=Object.create(this.prototype),n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],h=t[7],c=t[8],d=e[0],p=e[1],f=e[2],g=e[3],m=e[4],x=e[5],y=e[6],_=e[7],v=e[8];return i[0]=n*d+r*g+o*y,i[1]=n*p+r*m+o*_,i[2]=n*f+r*x+o*v,i[3]=s*d+a*g+u*y,i[4]=s*p+a*m+u*_,i[5]=s*f+a*x+u*v,i[6]=l*d+h*g+c*y,i[7]=l*p+h*m+c*_,i[8]=l*f+h*x+c*v,i}}),o}),define("x_ite/Fields/SFMatrix3",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec2","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(t,e,i,n,r,o){"use strict";function s(n,r,s){function a(t,i,n,r,s,a,u,l,h){return arguments.length?arguments[0]instanceof o?e.call(this,arguments[0]):e.call(this,new o(+t,+i,+n,+r,+s,+a,+u,+l,+h)):e.call(this,new o)}a.prototype=t.extend(Object.create(e.prototype),i(o,s),{constructor:a,getTypeName:function(){return n},getType:function(){return r},setTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e||0,i=i?i.getValue():null,n=n||0,r=r?r.getValue():null,this.getValue().set(t,e,i,n,r)}});for(var u=0;u<o.prototype.length;++u)!function(t){Object.defineProperty(a.prototype,t,{get:function(){return this.getValue()[t]},set:function(e){this.getValue()[t]=e,this.addEvent()},enumerable:!1,configurable:!1})}(u);return a}return{SFMatrix3d:s("SFMatrix3d",r.SFMatrix3d,n.SFVec2d),SFMatrix3f:s("SFMatrix3f",r.SFMatrix3f,n.SFVec2f)}}),define("x_ite/Fields/SFVec3",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(n,o){function s(t,i,n){return arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i,+n)):e.call(this,new r(0,0,0))}s.prototype=t.extend(Object.create(e.prototype),i(r),{constructor:s,getTypeName:function(){return n},getType:function(){return o},cross:function(t){return new this.constructor(r.cross(this.getValue(),t.getValue()))}});var a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),Object.defineProperty(s.prototype,"z",l),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),Object.defineProperty(s.prototype,"2",l),s}return{SFVec3d:o("SFVec3d",n.SFVec3d),SFVec3f:o("SFVec3f",n.SFVec3f)}}),define("standard/Math/Numbers/Vector4",["jquery","standard/Math/Algorithm"],function(t,e){"use strict";function i(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}return i.prototype={constructor:i,length:4,copy:function(){var t=Object.create(i.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return t&&(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},distance:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z,r=this.w-t.w;return Math.sqrt(e*e+i*i+n*n+r*r)},lerp:function(t,e){return this.x=this.x+e*(t.x-this.x),this.y=this.y+e*(t.y-this.y),this.z=this.z+e*(t.z-this.z),this.w=this.w+e*(t.w-this.w),this},min:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w)}return this},max:function(t){for(var e=0,i=arguments.length;e<i;++e){var t=arguments[e];this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w)}return this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(i.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),t.extend(i,{Zero:new i(0,0,0,0),One:new i(1,1,1,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=-t.w,e},add:function(t,e){var i=Object.create(this.prototype);return i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i},subtract:function(t,e){var i=Object.create(this.prototype);return i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i.w=t.w-e.w,i},multiply:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e,i.y=t.y*e,i.z=t.z*e,i.w=t.w*e,i},multVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i.w=t.w*e.w,i},divide:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e,i.y=t.y/e,i.z=t.z/e,i.w=t.w/e,i},divVec:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i.w=t.w/e.w,i},normalize:function(t){var e=Object.create(this.prototype),i=t.x,n=t.y,r=t.z,o=t.w,s=Math.sqrt(i*i+n*n+r*r+o*o);return s?(s=1/s,e.x=i*s,e.y=n*s,e.z=r*s,e.w=o*s):(e.x=0,e.y=0,e.z=0,e.w=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,r){return new i(e.lerp(t.x,n.x,r),e.lerp(t.y,n.y,r),e.lerp(t.z,n.z,r),e.lerp(t.w,n.w,r))},min:function(t,e){for(var n=t.x,r=t.y,o=t.z,s=t.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];n=Math.min(n,l.x),r=Math.min(r,l.y),o=Math.min(o,l.z),s=Math.min(s,l.w)}return new i(n,r,o,s)},max:function(t,e){for(var n=t.x,r=t.y,o=t.z,s=t.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];n=Math.max(n,l.x),r=Math.max(r,l.y),o=Math.max(o,l.z),s=Math.max(s,l.w)}return new i(n,r,o,s)}}),i}),define("standard/Math/Numbers/Quaternion",["jquery","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,i,n){"use strict";function r(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}var o=new i(0,0,0);r.prototype={constructor:r,length:4,copy:function(){var t=Object.create(r.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setMatrix:function(t){var e;e=t[0]>t[4]?t[0]>t[8]?0:2:t[4]>t[8]?1:2;var i=t[0]+t[4]+t[8];if(i>t[3*e+e]){this[3]=Math.sqrt(i+1)/2;var n=4*this[3];this[0]=(t[5]-t[7])/n,this[1]=(t[6]-t[2])/n,this[2]=(t[1]-t[3])/n}else{var r=(e+1)%3,o=(e+2)%3;this[e]=Math.sqrt(t[3*e+e]-t[3*r+r]-t[3*o+o]+1)/2;var n=4*this[e];this[r]=(t[3*e+r]+t[3*r+e])/n,this[o]=(t[3*e+o]+t[3*o+e])/n,this[3]=(t[3*r+o]-t[3*o+r])/n}return this},getMatrix:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=e*e,s=e*i,a=i*i,u=i*n,l=n*e,h=n*n,c=r*e,d=r*i,p=r*n;return t[0]=1-2*(a+h),t[1]=2*(s+p),t[2]=2*(l-d),t[3]=2*(s-p),t[4]=1-2*(h+o),t[5]=2*(u+c),t[6]=2*(l+d),t[7]=2*(u-c),t[8]=1-2*(a+o),t},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multLeft:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=t.w;return this.x=r*o+e*u+i*a-n*s,this.y=r*s+i*u+n*o-e*a,this.z=r*a+n*u+e*s-i*o,this.w=r*u-e*o-i*s-n*a,this},multRight:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=t.w;return this.x=u*e+o*r+s*n-a*i,this.y=u*i+s*r+a*e-o*n,this.z=u*n+a*r+o*i-s*e,this.w=u*r-o*e-s*i-a*n,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},multVecQuat:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=r*r-e*e-i*i-n*n,l=2*(o*e+s*i+a*n),h=2*r;return t.x=u*o+l*e+h*(i*a-n*s),t.y=u*s+l*i+h*(n*o-e*a),t.z=u*a+l*n+h*(e*s-i*o),t},multQuatVec:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=r*r-e*e-i*i-n*n,l=2*(o*e+s*i+a*n),h=2*r;return t.x=u*o+l*e-h*(i*a-n*s),t.y=u*s+l*i-h*(n*o-e*a),t.z=u*a+l*n-h*(e*s-i*o),t},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return t&&(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},pow:function(t){if(t instanceof r)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));var i=this.abs(),n=Math.acos(this.w/i),o=this.imag.abs(),s=Math.pow(i,t),a=t*n,u=s/o*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=s*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));var t=this.abs(),e=this.imag.normalize().multiply(Math.acos(this.w/t)),i=Math.log(t);return this.x=e.x,this.y=e.y,this.z=e.z,this.w=i,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));var t=this.imag,e=t.abs(),i=Math.exp(this.w),n=i*Math.cos(e),r=t.multiply(i*Math.sin(e)/e);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=n,this},slerp:function(t,e){return n.slerp(this,s.assign(t),e)},squad:function(t,e,i,r){return n.slerp(n.slerp(this,s.assign(i),r),n.slerp(a.assign(t),u.assign(e),r),2*r*(1-r))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(r.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"imag",{get:function(){return o.set(this.x,this.y,this.z)},enumerable:!1,configurable:!1}),t.extend(r,{negate:function(t){var e=Object.create(this.prototype);return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=-this.w,e},inverse:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=t.w,e},add:function(t,e){var i=Object.create(this.prototype);return i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i},subtract:function(t,e){var i=Object.create(this.prototype);return i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i.w=t.w-e.w,i},multiply:function(t,e){var i=Object.create(this.prototype);return i.x=t.x*e,i.y=t.y*e,i.z=t.z*e,i.w=t.w*e,i},multLeft:function(t,e){var i=Object.create(this.prototype),n=t.x,r=t.y,o=t.z,s=t.w,a=e.x,u=e.y,l=e.z,h=e.w;return i.x=s*a+n*h+r*l-o*u,i.y=s*u+r*h+o*a-n*l,i.z=s*l+o*h+n*u-r*a,i.w=s*h-n*a-r*u-o*l,i},multRight:function(t,e){var i=Object.create(this.prototype),n=t.x,r=t.y,o=t.z,s=t.w,a=e.x,u=e.y,l=e.z,h=e.w;return i.x=h*n+a*s+u*o-l*r,i.y=h*r+u*s+l*n-a*o,i.z=h*o+l*s+a*r-u*n,i.w=h*s-a*n-u*r-l*o,i},divide:function(t,e){var i=Object.create(this.prototype);return i.x=t.x/e,i.y=t.y/e,i.z=t.z/e,i.w=t.w/e,i},normalize:function(t){var e=Object.create(this.prototype),i=t.x,n=t.y,r=t.z,o=t.w,s=Math.sqrt(i*i+n*n+r*r+o*o);return s?(s=1/s,e.x=i*s,e.y=n*s,e.z=r*s,e.w=o*s):(e.x=0,e.y=0,e.z=0,e.w=0),e},slerp:function(t,e,i){return n.slerp(t.copy(),a.assign(e),i)},squad:function(t,e,i,r,o){return n.slerp(n.slerp(t.copy(),s.assign(r),o),n.slerp(a.assign(e),u.assign(i),o),2*o*(1-o))},spline:function(t,e,i){return l.assign(t),h.assign(e),c.assign(i),l.dot(h)<0&&l.negate(),c.dot(h)<0&&c.negate(),d.assign(h).inverse(),h.multRight(s.assign(d).multRight(l).log().add(a.assign(d).multRight(c).log()).divide(-4).exp()).normalize().copy()}});var s=new r(0,0,0,1),a=new r(0,0,0,1),u=new r(0,0,0,1),l=new r(0,0,0,1),h=new r(0,0,0,1),c=new r(0,0,0,1),d=new r(0,0,0,1);return r}),define("standard/Math/Numbers/Rotation4",["jquery","standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],function(t,e,i,n,r){"use strict";function o(t,n,r,o){switch(arguments.length){case 0:return void(this.value=new e(0,0,0,1));case 1:return void(this.value=arguments[0]);case 2:var s=arguments[0],a=arguments[1];return this.value=new e(0,0,0,1),a instanceof i?this.setFromToVec(s,a):void this.set(s.x,s.y,s.z,a);case 4:return this.value=new e(0,0,0,1),void this.set(t,n,r,o)}}var s=new i(1,0,0),a=new i(0,1,0),u=new i(0,0,1),l=new i(0,0,0),h=new i(0,0,0),c=new i(0,0,0),d=new i(0,0,0),p=new n(0,0,1,0),f=new n(0,0,0,0);o.prototype={constructor:o,length:4,copy:function(){var t=Object.create(o.prototype);return t.value=this.value.copy(),t},assign:function(t){return this.value.assign(t.value),this},set:function(t,e,i,n){var o=Math.sqrt(t*t+e*e+i*i);if(0===o)return this.value.set(0,0,0,1),this;var s=r.interval(n/2,0,Math.PI),o=Math.sin(s)/o;return this.value.set(t*o,e*o,i*o,Math.cos(s)),this},get:function(){var t=this.value;if(Math.abs(t.w)>=1)return p;var e=t.imag.normalize();return f.set(e.x,e.y,e.z,2*Math.acos(t.w))},setAxisAngle:function(t,e){return this.set(t.x,t.y,t.z,e)},setFromToVec:function(t,e){l.assign(t).normalize(),h.assign(e).normalize();var i=r.clamp(l.dot(h),-1,1),n=c.assign(l).cross(h).normalize();return 0===n.abs()?i>0?this.value.set(0,0,0,1):(d.assign(l).cross(s),0===d.norm()&&d.assign(l).cross(a),d.normalize(),this.value.set(d.x,d.y,d.z,0)):(n.multiply(Math.sqrt(Math.abs(1-i)/2)),this.value.set(n.x,n.y,n.z,Math.sqrt((1+i)/2))),this},setAxis:function(t){this.set(t.x,t.y,t.z,this.angle)},getAxis:function(){return Math.abs(this.value.w)>=1?u:this.value.imag.normalize()},setMatrix:function(t){return this.value.setMatrix(t).normalize(),this},getMatrix:function(t){return this.value.getMatrix(t)},equals:function(t){return this.value.equals(t.value)},inverse:function(){return this.value.inverse(),this},multLeft:function(t){return this.value.multLeft(t.value).normalize(),this},multRight:function(t){return this.value.multRight(t.value).normalize(),this},multVecRot:function(t){return this.value.multVecQuat(t)},multRotVec:function(t){return this.value.multQuatVec(t)},slerp:function(t,e){return this.value.slerp(t.value,e),this},squad:function(t,e,i,n){return this.value.squad(t.value,e.value,i.value,n),this},toString:function(){var t=this.get();return t.x+" "+t.y+" "+t.z+" "+t.w}};var g={get:function(){return this.getAxis().x},set:function(t){var e=this.get();this.set(t,e[1],e[2],e[3])},enumerable:!0,configurable:!1},m={get:function(){return this.getAxis().y},set:function(t){var e=this.get();this.set(e[0],t,e[2],e[3])},enumerable:!0,configurable:!1},x={get:function(){return this.getAxis().z},set:function(t){var e=this.get();this.set(e[0],e[1],t,e[3])},enumerable:!0,configurable:!1},y={get:function(){return Math.abs(this.value.w)>=1?0:2*Math.acos(this.value.w)},set:function(t){var e=this.getAxis();this.set(e.x,e.y,e.z,t)},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",g),Object.defineProperty(o.prototype,"y",m),Object.defineProperty(o.prototype,"z",x),Object.defineProperty(o.prototype,"angle",y),g.enumerable=!1,m.enumerable=!1,x.enumerable=!1,y.enumerable=!1,Object.defineProperty(o.prototype,"0",g),Object.defineProperty(o.prototype,"1",m),Object.defineProperty(o.prototype,"2",x),Object.defineProperty(o.prototype,"3",y),t.extend(o,{Identity:new o,inverse:function(t){var i=Object.create(this.prototype);return i.value=e.inverse(t.value),i},multRight:function(t,i){var n=Object.create(this.prototype);return n.value=e.multRight(t.value,i.value),n},slerp:function(t,i,n){var r=Object.create(this.prototype);return r.value=e.slerp(t.value,i.value,n),r},squad:function(t,i,n,r,o){var s=Object.create(this.prototype);return s.value=e.squad(t.value,i,n,r.value,o),s},bezier:function(t,i,n,r,o){var s=Object.create(this.prototype);return s.value=e.bezier(t.value,i,n,r.value,o),s},spline:function(t,i,n){var r=Object.create(this.prototype);return r.value=e.spline(t.value,i.value,n.value),r}}),o}),define("standard/Math/Numbers/Matrix4",["jquery","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],function(t,e,i,n,r,o){"use strict";function s(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}var a=new e(0,0,0),u=new n,l=new e(0,0,0),h=new n,c=new e(0,0,0),d=new r,p=new r,f=new r,g=new r,m=new e(0,0,0),x=new r;s.prototype={constructor:s,order:4,length:16,copy:function(){var t=Object.create(s.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t[9]=this[9],t[10]=this[10],t[11]=this[11],t[12]=this[12],t[13]=this[13],t[14]=this[14],t[15]=this[15],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]&&this[9]===t[9]&&this[10]===t[10]&&this[11]===t[11]&&this[12]===t[12]&&this[13]===t[13]&&this[14]===t[14]&&this[15]===t[15]},set1:function(t,e,i){return this[t*this.order+e]=i,this},get1:function(t,e){return this[t*this.order+e]},set:function(t,i,r,o,s){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===i&&(i=n.Identity),this.identity(),this.translate(t),i.equals(n.Identity)||this.rotate(i);break;case 3:null===t&&(t=e.Zero),null===i&&(i=n.Identity),null===r&&(r=e.One),this.identity(),this.translate(t),i.equals(n.Identity)||this.rotate(i),r.equals(e.One)||this.scale(r);break;case 4:if(null===t&&(t=e.Zero),null===i&&(i=n.Identity),null===r&&(r=e.One),null===o&&(o=n.Identity),this.identity(),this.translate(t),i.equals(n.Identity)||this.rotate(i),!r.equals(e.One)){!o.equals(n.Identity)?(this.rotate(o),this.scale(r),this.rotate(n.inverse(o))):this.scale(r)}break;case 5:null===t&&(t=e.Zero),null===i&&(i=n.Identity),null===r&&(r=e.One),null===o&&(o=n.Identity),null===s&&(s=e.Zero),this.identity(),this.translate(t);var a=!s.equals(e.Zero);a&&this.translate(s),i.equals(n.Identity)||this.rotate(i),r.equals(e.One)||(o.equals(n.Identity)?this.scale(r):(this.rotate(o),this.scale(r),this.rotate(n.inverse(o)))),a&&this.translate(e.negate(s));break;case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this},get:function(t,e,i,n,r){switch(null===t&&(t=a),null===e&&(e=u),null===i&&(i=l),null===n&&(n=h),null===r&&(r=c),arguments.length){case 1:t.set(this[12],this[13],this[14]);break;case 2:this.factor(t,d,l,p),e.setMatrix(d);break;case 3:this.factor(t,d,i,p),e.setMatrix(d);break;case 4:this.factor(t,d,i,p),e.setMatrix(d),n.setMatrix(p);break;case 5:var o=new s;o.set(m.assign(r).negate()),o.multLeft(this),o.translate(r),o.get(t,e,i,n)}},setRotation:function(t){return this.setQuaternion(t.value)},setQuaternion:function(t){var e=t.x,i=t.y,n=t.z,r=t.w,o=i*i,s=n*n,a=e*i,u=n*r,l=n*e,h=i*r,c=e*e,d=i*n,p=e*r;return this[0]=1-2*(o+s),this[1]=2*(a+u),this[2]=2*(l-h),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(s+c),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+h),this[9]=2*(d-p),this[10]=1-2*(o+c),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(t,e,i,n){t.set(this[12],this[13],this[14]);var r=this.submatrix,s=r.determinant(),a=s<0?-1:1;if(0===s)return!1;x.assign(r).transpose().multLeft(r);var u=o(x);return n.set(u.vectors[0][0],u.vectors[0][1],u.vectors[0][2],u.vectors[1][0],u.vectors[1][1],u.vectors[1][2],u.vectors[2][0],u.vectors[2][1],u.vectors[2][2]),i.x=a*Math.sqrt(u.values[0]),i.y=a*Math.sqrt(u.values[1]),i.z=a*Math.sqrt(u.values[2]),f[0]=1/i.x,f[4]=1/i.y,f[8]=1/i.z,e.assign(g.assign(n).multRight(f).transpose().multLeft(n).multRight(r)),n.transpose(),!0},determinant3:function(){var t=this[0],e=this[1],i=this[2],n=this[4],r=this[5],o=this[6],s=this[8],a=this[9],u=this[10];return t*(r*u-o*a)-e*(n*u-o*s)+i*(n*a-r*s)},determinant:function(){var t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],h=this[10],c=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=h*g,x=f*c,y=s*g,_=f*a,v=s*c,w=h*a,b=i*g,S=f*n,C=i*c,F=h*n,T=i*a,N=s*n;return t*(m*o+_*l+v*p-x*o-y*l-w*p)+r*(x*e+b*l+F*p-m*e-S*l-C*p)+u*(y*e+S*o+T*p-_*e-b*o-N*p)+d*(w*e+C*o+N*l-v*e-F*o-T*l)},transpose:function(){var t;return t=this[1],this[1]=this[4],this[1]=t,t=this[2],this[2]=this[8],this[2]=t,t=this[3],this[3]=this[12],this[3]=t,t=this[6],this[6]=this[9],this[6]=t,t=this[7],this[7]=this[13],this[7]=t,t=this[11],this[11]=this[14],this[11]=t,this},inverse:function(){var t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],h=this[10],c=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=h*g,x=f*c,y=s*g,_=f*a,v=s*c,w=h*a,b=i*g,S=f*n,C=i*c,F=h*n,T=i*a,N=s*n,O=u*p,M=d*l,V=r*p,D=d*o,B=r*l,I=u*o,E=t*p,A=d*e,P=t*l,L=u*e,R=t*o,k=r*e,z=m*o+_*l+v*p-(x*o+y*l+w*p),X=x*e+b*l+F*p-(m*e+S*l+C*p),j=y*e+S*o+T*p-(_*e+b*o+N*p),U=w*e+C*o+N*l-(v*e+F*o+T*l),G=t*z+r*X+u*j+d*U;if(0===G)throw new Error("Matrix4 .inverse: determinant is 0.");return G=1/G,this[0]=G*z,this[1]=G*X,this[2]=G*j,this[3]=G*U,this[4]=G*(x*r+y*u+w*d-m*r-_*u-v*d),this[5]=G*(m*t+S*u+C*d-x*t-b*u-F*d),this[6]=G*(_*t+b*r+N*d-y*t-S*r-T*d),this[7]=G*(v*t+F*r+T*u-w*t-C*r-N*u),this[8]=G*(O*a+D*c+B*g-M*a-V*c-I*g),this[9]=G*(M*n+E*c+L*g-O*n-A*c-P*g),this[10]=G*(V*n+A*a+R*g-D*n-E*a-k*g),this[11]=G*(I*n+P*a+k*c-B*n-L*a-R*c),this[12]=G*(V*h+I*f+M*s-B*f-O*s-D*h),this[13]=G*(P*f+O*i+A*h-E*h-L*f-M*i),this[14]=G*(E*s+k*f+D*i-R*f-V*i-A*s),this[15]=G*(R*h+B*i+L*s-P*s-k*h-I*i),this},multLeft:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],h=this[9],c=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],x=t[0],y=t[1],_=t[2],v=t[3],w=t[4],b=t[5],S=t[6],C=t[7],F=t[8],T=t[9],N=t[10],O=t[11],M=t[12],V=t[13],D=t[14],B=t[15];return this[0]=e*x+o*y+l*_+p*v,this[1]=i*x+s*y+h*_+f*v,this[2]=n*x+a*y+c*_+g*v,this[3]=r*x+u*y+d*_+m*v,this[4]=e*w+o*b+l*S+p*C,this[5]=i*w+s*b+h*S+f*C,this[6]=n*w+a*b+c*S+g*C,this[7]=r*w+u*b+d*S+m*C,this[8]=e*F+o*T+l*N+p*O,this[9]=i*F+s*T+h*N+f*O,this[10]=n*F+a*T+c*N+g*O,this[11]=r*F+u*T+d*N+m*O,this[12]=e*M+o*V+l*D+p*B,this[13]=i*M+s*V+h*D+f*B,this[14]=n*M+a*V+c*D+g*B,this[15]=r*M+u*V+d*D+m*B,this},multRight:function(t){var e=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],h=this[9],c=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],x=t[0],y=t[1],_=t[2],v=t[3],w=t[4],b=t[5],S=t[6],C=t[7],F=t[8],T=t[9],N=t[10],O=t[11],M=t[12],V=t[13],D=t[14],B=t[15];return this[0]=e*x+i*w+n*F+r*M,this[1]=e*y+i*b+n*T+r*V,this[2]=e*_+i*S+n*N+r*D,this[3]=e*v+i*C+n*O+r*B,this[4]=o*x+s*w+a*F+u*M,this[5]=o*y+s*b+a*T+u*V,this[6]=o*_+s*S+a*N+u*D,this[7]=o*v+s*C+a*O+u*B,this[8]=l*x+h*w+c*F+d*M,this[9]=l*y+h*b+c*T+d*V,this[10]=l*_+h*S+c*N+d*D,this[11]=l*v+h*C+c*O+d*B,this[12]=p*x+f*w+g*F+m*M,this[13]=p*y+f*b+g*T+m*V,this[14]=p*_+f*S+g*N+m*D,this[15]=p*v+f*C+g*O+m*B,this},multVecMatrix:function(t){if(3===t.length){var e=t.x,i=t.y,n=t.z,r=1/(e*this[3]+i*this[7]+n*this[11]+this[15]);return t.x=(e*this[0]+i*this[4]+n*this[8]+this[12])*r,t.y=(e*this[1]+i*this[5]+n*this[9]+this[13])*r,t.z=(e*this[2]+i*this[6]+n*this[10]+this[14])*r,t}var e=t.x,i=t.y,n=t.z,r=t.w;return t.x=e*this[0]+i*this[4]+n*this[8]+r*this[12],t.y=e*this[1]+i*this[5]+n*this[9]+r*this[13],t.z=e*this[2]+i*this[6]+n*this[10]+r*this[14],t.w=e*this[3]+i*this[7]+n*this[11]+r*this[15],t},multMatrixVec:function(t){if(3===t.length){var e=t.x,i=t.y,n=t.z,r=1/(e*this[12]+i*this[13]+n*this[14]+this[15]);return t.x=(e*this[0]+i*this[1]+n*this[2]+this[3])*r,t.y=(e*this[4]+i*this[5]+n*this[6]+this[7])*r,t.z=(e*this[8]+i*this[9]+n*this[10]+this[11])*r,t}var e=t.x,i=t.y,n=t.z,r=t.w;return t.x=e*this[0]+i*this[1]+n*this[2]+r*this[3],t.y=e*this[4]+i*this[5]+n*this[6]+r*this[7],t.z=e*this[8]+i*this[9]+n*this[10]+r*this[11],t.w=e*this[12]+i*this[13]+n*this[14]+r*this[15],t},multDirMatrix:function(t){var e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[4]+n*this[8],t.y=e*this[1]+i*this[5]+n*this[9],t.z=e*this[2]+i*this[6]+n*this[10],t},multMatrixDir:function(t){var e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[1]+n*this[2],t.y=e*this[4]+i*this[5]+n*this[6],t.z=e*this[8]+i*this[9]+n*this[10],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(t){var e=t.x,i=t.y,n=t.z;return this[12]+=this[0]*e+this[4]*i+this[8]*n,this[13]+=this[1]*e+this[5]*i+this[9]*n,this[14]+=this[2]*e+this[6]*i+this[10]*n,this},rotate:function(t){return this.multLeft(y.setQuaternion(t.value)),this},scale:function(t){var e=t.x,i=t.y,n=t.z;return this[0]*=e,this[4]*=i,this[8]*=n,this[1]*=e,this[5]*=i,this[9]*=n,this[2]*=e,this[6]*=i,this[10]*=n,this},getDepth:function(t){var e=t.x,i=t.y,n=t.z,r=1/(e*this[3]+i*this[7]+n*this[11]+this[15]);return(e*this[2]+i*this[6]+n*this[10]+this[14])*r},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(s.prototype,"x",{get:function(){return new e(this[0],this[1],this[2])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"y",{get:function(){return new e(this[4],this[5],this[6])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"z",{get:function(){return new e(this[8],this[9],this[10])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"origin",{get:function(){return new e(this[12],this[13],this[14])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"submatrix",{get:function(){var t=Object.create(r.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[4],t[4]=this[5],t[5]=this[6],t[6]=this[8],t[7]=this[9],t[8]=this[10],t},enumerable:!1,configurable:!1}),t.extend(s,{Identity:new s,Rotation:function(t){return Object.create(this.prototype).setQuaternion(t.value)},Quaternion:function(t){return Object.create(this.prototype).setQuaternion(t)},Matrix3:function(t){return new s(t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,0,0,0,1)},transpose:function(t){var e=Object.create(this.prototype);return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},inverse:function(t){var e=Object.create(this.prototype),i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],l=t[7],h=t[8],c=t[9],d=t[10],p=t[11],f=t[12],g=t[13],m=t[14],x=t[15],y=d*x,_=m*p,v=u*x,w=m*l,b=u*p,S=d*l,C=r*x,F=m*o,T=r*p,N=d*o,O=r*l,M=u*o,V=h*g,D=f*c,B=s*g,I=f*a,E=s*c,A=h*a,P=i*g,L=f*n,R=i*c,k=h*n,z=i*a,X=s*n,j=y*a+w*c+b*g-(_*a+v*c+S*g),U=_*n+C*c+N*g-(y*n+F*c+T*g),G=v*n+F*a+O*g-(w*n+C*a+M*g),q=S*n+T*a+M*c-(b*n+N*a+O*c),H=i*j+s*U+h*G+f*q;if(0==H)throw new Error("Matrix4 .inverse: determinant is 0.");return H=1/H,e[0]=H*j,e[1]=H*U,e[2]=H*G,e[3]=H*q,e[4]=H*(_*s+v*h+S*f-y*s-w*h-b*f),e[5]=H*(y*i+F*h+T*f-_*i-C*h-N*f),e[6]=H*(w*i+C*s+M*f-v*i-F*s-O*f),e[7]=H*(b*i+N*s+O*h-S*i-T*s-M*h),e[8]=H*(V*l+I*p+E*x-D*l-B*p-A*x),e[9]=H*(D*o+P*p+k*x-V*o-L*p-R*x),
e[10]=H*(B*o+L*l+z*x-I*o-P*l-X*x),e[11]=H*(A*o+R*l+X*p-E*o-k*l-z*p),e[12]=H*(B*d+A*m+D*u-E*m-V*u-I*d),e[13]=H*(R*m+V*r+L*d-P*d-k*m-D*r),e[14]=H*(P*u+X*m+I*r-z*m-B*r-L*u),e[15]=H*(z*d+E*r+k*u-R*u-X*d-A*r),e},multLeft:function(t,e){var i=Object.create(this.prototype),n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],h=t[7],c=t[8],d=t[9],p=t[10],f=t[11],g=t[12],m=t[13],x=t[14],y=t[15],_=e[0],v=e[1],w=e[2],b=e[3],S=e[4],C=e[5],F=e[6],T=e[7],N=e[8],O=e[9],M=e[10],V=e[11],D=e[12],B=e[13],I=e[14],E=e[15];return i[0]=n*_+a*v+c*w+g*b,i[1]=r*_+u*v+d*w+m*b,i[2]=o*_+l*v+p*w+x*b,i[3]=s*_+h*v+f*w+y*b,i[4]=n*S+a*C+c*F+g*T,i[5]=r*S+u*C+d*F+m*T,i[6]=o*S+l*C+p*F+x*T,i[7]=s*S+h*C+f*F+y*T,i[8]=n*N+a*O+c*M+g*V,i[9]=r*N+u*O+d*M+m*V,i[10]=o*N+l*O+p*M+x*V,i[11]=s*N+h*O+f*M+y*V,i[12]=n*D+a*B+c*I+g*E,i[13]=r*D+u*B+d*I+m*E,i[14]=o*D+l*B+p*I+x*E,i[15]=s*D+h*B+f*I+y*E,i},multRight:function(t,e){var i=Object.create(this.prototype),n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],h=t[7],c=t[8],d=t[9],p=t[10],f=t[11],g=t[12],m=t[13],x=t[14],y=t[15],_=e[0],v=e[1],w=e[2],b=e[3],S=e[4],C=e[5],F=e[6],T=e[7],N=e[8],O=e[9],M=e[10],V=e[11],D=e[12],B=e[13],I=e[14],E=e[15];return i[0]=n*_+r*S+o*N+s*D,i[1]=n*v+r*C+o*O+s*B,i[2]=n*w+r*F+o*M+s*I,i[3]=n*b+r*T+o*V+s*E,i[4]=a*_+u*S+l*N+h*D,i[5]=a*v+u*C+l*O+h*B,i[6]=a*w+u*F+l*M+h*I,i[7]=a*b+u*T+l*V+h*E,i[8]=c*_+d*S+p*N+f*D,i[9]=c*v+d*C+p*O+f*B,i[10]=c*w+d*F+p*M+f*I,i[11]=c*b+d*T+p*V+f*E,i[12]=g*_+m*S+x*N+y*D,i[13]=g*v+m*C+x*O+y*B,i[14]=g*w+m*F+x*M+y*I,i[15]=g*b+m*T+x*V+y*E,i}});var y=new s;return s}),define("x_ite/Fields/SFMatrix4",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec3","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o){"use strict";function s(n,r,s){function a(t,i,n,r,s,a,u,l,h,c,d,p,f,g,m,x){return arguments.length?arguments[0]instanceof o?e.call(this,arguments[0]):e.call(this,new o(+t,+i,+n,+r,+s,+a,+u,+l,+h,+c,+d,+p,+f,+g,+m,+x)):e.call(this,new o)}a.prototype=t.extend(Object.create(e.prototype),i(o,s),{constructor:a,getTypeName:function(){return n},getType:function(){return r}});for(var u=0;u<o.prototype.length;++u)!function(t){Object.defineProperty(a.prototype,t,{get:function(){return this.getValue()[t]},set:function(e){this.getValue()[t]=e,this.addEvent()},enumerable:!1,configurable:!1})}(u);return a}return{SFMatrix4d:s("SFMatrix4d",r.SFMatrix4d,n.SFVec3d),SFMatrix4f:s("SFMatrix4f",r.SFMatrix4f,n.SFVec3f),VrmlMatrix:s("VrmlMatrix",r.VrmlMatrix,n.SFVec3f)}}),define("x_ite/Fields/SFNode",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t){return this instanceof r?(t?(t.addParent(this),e.call(this,t)):e.call(this,null),new Proxy(this,o)):r.call(Object.create(r.prototype),t)}var o={get:function(t,e){if(e in t)return t[e];try{var n=t.getValue().getField(e);if(n.getAccessType()===i.inputOnly)return;return n.valueOf()}catch(t){return}},set:function(t,e,n){if(e in t)return t[e]=n,!0;try{var r=t.getValue().getField(e);return r.getAccessType()!==i.outputOnly&&r.setValue(n),!0}catch(i){return console.error(t,e,i),!1}}};return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,_cloneCount:0,clone:function(){return new r(this.getValue())},copy:function(t){var e=this.getValue();return e?new r(e.copy(t)):new r},getTypeName:function(){return"SFNode"},getType:function(){return i.SFNode},equals:function(t){return t?this.getValue()===t.getValue():null===this.getValue()},isDefaultValue:function(){return null===this.getValue()},set:function(t){var i=this.getValue();i&&(i.removeClones(this._cloneCount),i.removeParent(this)),t?(t.addParent(this),t.addClones(this._cloneCount),e.prototype.set.call(this,t)):e.prototype.set.call(this,null)},getNodeTypeName:function(){var t=this.getValue();if(t)return t.getTypeName();throw new Error("SFNode.getNodeTypeName: node is null.")},getNodeName:function(){var t=this.getValue();if(t)return t.getName();throw new Error("SFNode.getNodeName: node is null.")},getNodeType:function(){var t=this.getValue();if(t)return t.getType().slice();throw new Error("SFNode.getNodeType: node is null.")},getFieldDefinitions:function(){var t=this.getValue();if(t)return t.getFieldDefinitions();throw new Error("SFNode.getFieldDefinitions: node is null.")},addClones:function(t){var e=this.getValue();this._cloneCount+=t,e&&e.addClones(t)},removeClones:function(t){var e=this.getValue();this._cloneCount-=t,e&&e.removeClones(t)},valueOf:function(){return this.getValue()?this:null},toStream:function(t){var e=this.getValue();e?e.toStream(t):t.string+="NULL"},toVRMLString:function(){},toVRMLStream:function(t){var e=this.getValue();e?e.toVRMLStream(t):t.string+="NULL"},toXMLString:function(){var t={string:""},e=n.Get(t),i=this.getValue();return e.PushExecutionContext(i.getExecutionContext()),this.toXMLStream(t),e.PopExecutionContext(),t.string},toXMLStream:function(t){var e=this.getValue();e?e.toXMLStream(t):t.string+="NULL"},dispose:function(){this.set(null),e.prototype.dispose.call(this)}}),r}),define("x_ite/Fields/SFRotation",["jquery","x_ite/Fields/SFVec3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o){"use strict";function s(t,e,n,r){if(this instanceof s)switch(arguments.length){case 1:return i.call(this,arguments[0]);case 2:return arguments[1]instanceof a?i.call(this,new o(arguments[0].getValue(),arguments[1].getValue())):i.call(this,new o(arguments[0].getValue(),+arguments[1]));case 4:return i.call(this,new o(+t,+e,+n,+r));default:return i.call(this,new o)}return s.apply(Object.create(s.prototype),arguments)}var a=e.SFVec3f;s.prototype=t.extend(Object.create(i.prototype),{constructor:s,copy:function(){return new s(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(o.Identity)},getTypeName:function(){return"SFRotation"},getType:function(){return n.SFRotation},set:function(t){this.getValue().assign(t)},setAxis:function(t){this.getValue().setAxis(t.getValue()),this.addEvent()},getAxis:function(){return new a(this.getValue().getAxis().copy())},inverse:function(){return new s(o.inverse(this.getValue()))},multiply:function(t){return new s(o.multRight(this.getValue(),t.getValue()))},multVec:function(t){return new a(this.getValue().multVecRot(t.getValue().copy()))},slerp:function(t,e){return new s(o.slerp(this.getValue(),t.getValue(),e))},toStream:function(t){var e=r.Get(t),i=this.getValue().get();t.string+=i.x+" "+i.y+" "+i.z+" "+e.ToUnit("angle",i.w)},toXMLStream:function(t){this.toStream(t)}});var u={get:function(){return this.getValue().x},set:function(t){this.getValue().x=t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().y},set:function(t){this.getValue().y=t,this.addEvent()},enumerable:!0,configurable:!1},h={get:function(){return this.getValue().z},set:function(t){this.getValue().z=t,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().angle},set:function(t){this.getValue().angle=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",u),Object.defineProperty(s.prototype,"y",l),Object.defineProperty(s.prototype,"z",h),Object.defineProperty(s.prototype,"angle",c),u.enumerable=!1,l.enumerable=!1,h.enumerable=!1,c.enumerable=!1,Object.defineProperty(s.prototype,"0",u),Object.defineProperty(s.prototype,"1",l),Object.defineProperty(s.prototype,"2",h),Object.defineProperty(s.prototype,"3",c),s}),define("x_ite/Fields/SFString",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t){return this instanceof r?e.call(this,arguments.length?String(t):""):e.call(Object.create(r.prototype),arguments.length?String(t):"")}var o=/\\([\\"])/g,s=/([\\"])/g;return t.extend(r,{unescape:function(t){return t.replace(o,"$1")},escape:function(t){return t.replace(s,"\\$1")}}),r.prototype=t.extend(Object.create(e.prototype),{constructor:r,copy:function(){return new r(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return i.SFString},isDefaultValue:function(){return""===this.getValue()},set:function(t){e.prototype.set.call(this,String(t))},valueOf:e.prototype.getValue,toStream:function(t){t.string+='"'+r.escape(this.getValue())+'"'},toXMLStream:function(t){t.string+=n.Get(t).XMLEncode(this.getValue())}}),Object.defineProperty(r.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),r}),define("x_ite/Fields/SFTime",["jquery","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){return this instanceof n?e.call(this,arguments.length?+t:0):e.call(Object.create(n.prototype),arguments.length?+t:0)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return i.SFTime},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(t){t.string+=String(this.getValue())},toXMLStream:function(t){this.toStream(t)}}),n}),define("x_ite/Fields/SFVec4",["jquery","x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,i,n,r){"use strict";function o(n,o){function s(t,i,n,o){return arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i,+n,+o)):e.call(this,new r(0,0,0,0))}s.prototype=t.extend(Object.create(e.prototype),i(r),{constructor:s,getTypeName:function(){return n},getType:function(){return o}});var a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=t,this.addEvent()},enumerable:!0,configurable:!1},h={get:function(){return this.getValue().w},set:function(t){this.getValue().w=t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),Object.defineProperty(s.prototype,"z",l),Object.defineProperty(s.prototype,"w",h),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,h.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),Object.defineProperty(s.prototype,"2",l),Object.defineProperty(s.prototype,"3",h),s}return{SFVec4d:o("SFVec4d",n.SFVec4d),SFVec4f:o("SFVec4f",n.SFVec4f)}}),define("x_ite/Fields/ArrayFields",["jquery","x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Basic/X3DArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_){"use strict";function v(t){return this instanceof v?x.call(this,arguments):x.call(Object.create(v.prototype),arguments)}function w(e,i,n){function r(t){return this instanceof r?x.call(this,arguments):x.call(Object.create(r.prototype),arguments)}return r.prototype=t.extend(Object.create(x.prototype),{constructor:r,_valueType:n,getTypeName:function(){return e},getType:function(){return i}}),r}function b(t){return this instanceof b?x.call(this,arguments):x.call(Object.create(b.prototype),arguments)}var S=u.SFMatrix3d,C=u.SFMatrix3f,F=l.SFMatrix4d,T=l.SFMatrix4f,N=f.SFVec2d,O=f.SFVec2f,M=g.SFVec3d,V=g.SFVec3f,D=m.SFVec4d,B=m.SFVec4f;v.prototype=t.extend(Object.create(x.prototype),{constructor:v,_valueType:h,_cloneCount:0,getTypeName:function(){return"MFNode"},getType:function(){return y.MFNode},clone:function(){var t=new v;return t.setValue(this),t},copy:function(t){for(var e=new v,i=this.getValue(),n=e.getValue(),r=0,o=i.length;r<o;++r){var s=i[r].copy(t);s.addParent(e),n.push(s)}return e},addClones:function(t){var e=this.getValue();this._cloneCount+=t;for(var i=0,n=e.length;i<n;++i)e[i].addClones(t)},removeClones:function(t){var e=this.getValue();this._cloneCount+=t;for(var i=0,n=e.length;i<n;++i)e[i].removeClones(t)},addChildObject:function(t){x.prototype.addChildObject.call(this,t),t.addClones(this._cloneCount)},removeChild:function(t){x.prototype.removeChild.call(this,t),t.removeClones(this._cloneCount)},toXMLStream:function(t){var e=_.Get(t),i=this.length;if(i){e.EnterScope();for(var n=this.getValue(),r=0,o=i-1;r<o;++r){var s=n[r].getValue();s?(s.toXMLStream(t),t.string+="\n"):(t.string+=e.Indent(),t.string+="\x3c!-- NULL --\x3e\n")}var s=n[o].getValue();s?s.toXMLStream(t):(t.string+=e.Indent(),t.string+="\x3c!-- NULL --\x3e"),e.LeaveScope()}}}),b.prototype=t.extend(Object.create(x.prototype),{constructor:b,_valueType:d,getTypeName:function(){return"MFString"},getType:function(){return y.MFString},toXMLStream:function(t){var e=this.length;if(e){for(var i=this.getValue(),n=0,r=e-1;n<r;++n)t.string+='"',i[n].toXMLStream(t),t.string+='"',t.string+=", ";t.string+='"',i[r].toXMLStream(t),t.string+='"'}}});var I={MFBool:w("MFBool",y.MFBool,e),MFColor:w("MFColor",y.MFColor,i),MFColorRGBA:w("MFColorRGBA",y.MFColorRGBA,n),MFDouble:w("MFDouble",y.MFDouble,r),MFFloat:w("MFFloat",y.MFFloat,o),MFImage:w("MFImage",y.MFImage,s),MFInt32:w("MFInt32",y.MFInt32,a),MFMatrix3d:w("MFMatrix3d",y.MFMatrix3d,S),MFMatrix3f:w("MFMatrix3f",y.MFMatrix3f,C),MFMatrix4d:w("MFMatrix4d",y.MFMatrix4d,F),MFMatrix4f:w("MFMatrix4f",y.MFMatrix4f,T),MFNode:v,MFRotation:w("MFRotation",y.MFRotation,c),MFString:b,MFTime:w("MFTime",y.MFTime,p),MFVec2d:w("MFVec2d",y.MFVec2d,N),MFVec2f:w("MFVec2f",y.MFVec2f,O),MFVec3d:w("MFVec3d",y.MFVec3d,M),MFVec3f:w("MFVec3f",y.MFVec3f,V),MFVec4d:w("MFVec4d",y.MFVec4d,D),MFVec4f:w("MFVec4f",y.MFVec4f,B)};return Object.preventExtensions(I),Object.freeze(I),Object.seal(I),I}),define("x_ite/Fields/SFImage",["jquery","x_ite/Basic/X3DField","x_ite/Fields/ArrayFields","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t,e,i,n){this.width=t,this.height=e,this.comp=i,this.array=new s,this.array.setValue(n),this.array.length=t*e}function o(t,i,n,a){return this instanceof o?(4===arguments.length?e.call(this,new r(+t,+i,+n,a)):e.call(this,new r(0,0,0,new s)),this.getValue().getArray().addParent(this),this.addInterest("set_size__",this),this):o.apply(Object.create(o.prototype),arguments)}var s=i.MFInt32;r.prototype={constructor:r,copy:function(){return new r(this.width,this.height,this.comp,this.array)},equals:function(t){return this.width===t.width&&this.height===t.height&&this.comp===t.comp&&this.array.equals(t.array)},assign:function(t){this.width=t.width,this.height=t.height,this.comp=t.comp,this.array.set(t.array.getValue())},set:function(t,e,i,n){this.width=t,this.height=e,this.comp=i,this.array.set(n)},setWidth:function(t){this.width=t,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(t){this.height=t,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(t){this.comp=t},getComp:function(){return this.comp},setArray:function(t){this.array.setValue(t),this.array.length=this.width*this.height},getArray:function(){return this.array}},o.prototype=t.extend(Object.create(e.prototype),{constructor:o,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new o(this.getValue())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.width&&0===this.height&&0===this.comp},set:function(t){this.getValue().assign(t)},getTypeName:function(){return"SFImage"},getType:function(){return n.SFImage},toStream:function(t){var e=this.array.getValue();t.string+=this.width+" "+this.height+" "+this.comp;for(var i=0,n=this.width*this.height;i<n;++i)t.string+=" 0x",e[i].toStream(t,16)},toXMLStream:function(t){this.toStream(t)}});var a={get:function(){return this.getValue().getWidth()},set:function(t){this.getValue().setWidth(t),this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().getHeight()},set:function(t){this.getValue().setHeight(t),this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().getComp()},set:function(t){this.getValue().setComp(t),this.addEvent()},enumerable:!0,configurable:!1},h={get:function(){return this.getValue().getArray()},set:function(t){this.getValue().setArray(t),this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"width",a),Object.defineProperty(o.prototype,"height",u),Object.defineProperty(o.prototype,"comp",l),Object.defineProperty(o.prototype,"array",h),a.enumerable=!1,u.enumerable=!1,Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),o}),define("x_ite/Fields",["jquery","x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Fields/ArrayFields"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x){"use strict";var y=t.extend({SFBool:e,SFColor:i,SFColorRGBA:n,SFDouble:r,SFFloat:o,SFImage:s,SFInt32:a,SFMatrix3d:u.SFMatrix3d,SFMatrix3f:u.SFMatrix3f,SFMatrix4d:l.SFMatrix4d,SFMatrix4f:l.SFMatrix4f,SFNode:h,SFRotation:c,SFString:d,SFTime:p,SFVec2d:f.SFVec2d,SFVec2f:f.SFVec2f,SFVec3d:g.SFVec3d,SFVec3f:g.SFVec3f,SFVec4d:m.SFVec4d,SFVec4f:m.SFVec4f,VrmlMatrix:l.VrmlMatrix},x);return Object.preventExtensions(y),Object.freeze(y),Object.seal(y),y}),define("x_ite/Browser/VERSION",[],function(){return"4.0.8a"}),define("x_ite/Base/X3DEventObject",["jquery","x_ite/Base/X3DChildObject","x_ite/Base/Events"],function(t,e,i){"use strict";function n(t){e.call(this),this._browser=t}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getBrowser:function(){return this._browser},getExtendedEventHandling:function(){return!0},addEvent:function(t){t.setSet(!0),t.getTainted()||(t.setTainted(!0),this.addEventObject(t,i.create(t)))},addEventObject:function(t,e){this.getBrowser().addBrowserEvent(),this.getBrowser().addTaintedField(t,e),this.getTainted()||(t.isInput()||this.getExtendedEventHandling()&&!t.isOutput())&&(this.setTainted(!0),this.getBrowser().addTaintedNode(this))},addNodeEvent:function(){this.getTainted()||(this.setTainted(!0),this.getBrowser().addTaintedNode(this),this.getBrowser().addBrowserEvent())},processEvents:function(){this.setTainted(!1),this.processInterests()}}),n}),define("x_ite/Basic/X3DBaseNode",["jquery","x_ite/Base/X3DEventObject","x_ite/Base/Events","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a){"use strict";function u(){return this.isLive_}function l(t){if(!this.hasOwnProperty("_executionContext")){e.call(this,t.getBrowser()),this._executionContext=t,this._type=[s.X3DBaseNode],this._fields={},this._predefinedFields={},this._userDefinedFields={},this._cloneCount=0,this.hasUserDefinedFields()&&(this.fieldDefinitions=new r(this.fieldDefinitions.getValue().slice()));for(var i=this.fieldDefinitions.getValue(),n=0,o=i.length;n<o;++n)this.addField(i[n])}}return l.prototype=t.extend(Object.create(e.prototype),{constructor:l,fieldDefinitions:new r([]),_private:!1,_live:!0,_initialized:!1,setExecutionContext:function(t){this._executionContext=t},getScene:function(){for(var t=this._executionContext;!t.isRootContext();)t=t.getExecutionContext();return t},getExecutionContext:function(){return this._executionContext},addType:function(t){this._type.push(t)},getType:function(){return this._type},getInnerNode:function(){return this},isLive:function(){return this.isLive=u,this.addChildObjects("isLive",new o.SFBool(this.getLiveState())),this.isLive_.removeParent(this),this._executionContext!==this&&this._executionContext.isLive().addInterest("_set_live__",this),this.isLive()},setLive:function(t){this._live=t.valueOf(),this._set_live__()},getLive:function(){return this._live},getLiveState:function(){return this!==this._executionContext?this.getLive()&&this._executionContext.isLive().getValue():this.getLive()},_set_live__:function(){var t=this.getLiveState(),e=this.isLive();if(t){if(e.getValue())return;e.setValue(!0),e.processEvent(i.create(e))}else e.getValue()&&(e.setValue(!1),e.processEvent(i.create(e)))},isInitialized:function(){return this._initialized},setup:function(){if(!this._initialized){this._initialized=!0;for(var t=this.fieldDefinitions.getValue(),e=0,i=t.length;e<i;++e){var n=this._fields[t[e].name];n.updateReferences(),n.setTainted(!1)}this.initialize()}},initialize:function(){},eventsProcessed:function(){},create:function(t){return new this.constructor(t)},copy:function(t){var e=this.getName();if(e.length)try{return t.getNamedNode(e).getValue()}catch(t){}var i=this.create(t);e.length&&t.updateNamedNode(e,i);var n=this.getPredefinedFields();for(var e in n)try{var r=n[e],o=i.getField(e);if(o.setSet(r.getSet()),r.hasReferences()){var a=r.getReferences();for(var u in a)try{var l=a[u];o.addReference(t.getField(l.getName()))}catch(t){console.error(t.message)}}else if(r.getAccessType()&s.initializeOnly)switch(r.getType()){case s.SFNode:case s.MFNode:o.set(r.copy(t).getValue());break;default:o.set(r.getValue())}}catch(t){console.log(t.message)}var h=this.getUserDefinedFields();for(var e in h){var r=h[e],o=r.copy(t);if(i.addUserDefinedField(r.getAccessType(),r.getName(),o),o.setSet(r.getSet()),r.hasReferences()){var a=r.getReferences();for(var u in a)try{var l=a[u];o.addReference(t.getField(l.getName()))}catch(e){console.error("No reference '"+l.getName()+"' inside execution context "+t.getTypeName()+" '"+t.getName()+"'.")}}}return t.addUninitializedNode(i),i},addChildObjects:function(t,e){for(var i=0,n=arguments.length;i<n;i+=2)this.addChildObject(arguments[i],arguments[i+1])},addChildObject:function(t,e){e.addParent(this),e.setName(t),Object.defineProperty(this,t+"_",{get:function(){return e},set:function(t){return e.setValue(t)},enumerable:!0,configurable:!1})},addField:function(t){var e=t.accessType,i=t.name,n=t.value.clone();n.setTainted(!0),n.addParent(this),n.setName(i),n.setAccessType(e),this.setField(i,n)},setField:function(t,e,i){if(e.getAccessType()===s.inputOutput&&(this._fields["set_"+t]=e,this._fields[t+"_changed"]=e),this._fields[t]=e,this.getPrivate()||e.addClones(1),i)return void(this._userDefinedFields[t]=e);this._predefinedFields[t]=e,Object.defineProperty(this,t+"_",{get:function(){return e},set:function(t){return e.setValue(t)},enumerable:!0,configurable:!0})},removeField:function(t){var e=this._fields[t];if(e){e.getAccessType()===s.inputOutput&&(delete this._fields["set_"+e.getName()],delete this._fields[e.getName()+"_changed"]),delete this._fields[t],delete this._userDefinedFields[t];for(var i=this.fieldDefinitions.getValue(),n=0,r=i.length;n<r;++n)if(i[n].name===t){i.splice(n,1);break}this.getPrivate()||e.removeClones(1)}},getField:function(t){var e=this._fields[t];if(e)return e;throw new Error("Unkown field '"+t+"' in node class "+this.getTypeName()+".")},getFieldDefinitions:function(){return this.fieldDefinitions},hasUserDefinedFields:function(){return!1},addUserDefinedField:function(t,e,i){this._fields[e]&&this.removeField(e),i.setTainted(!0),i.addParent(this),i.setName(e),i.setAccessType(t),this.fieldDefinitions.add(new n(t,e,i)),this.setField(e,i,!0)},getUserDefinedFields:function(){return this._userDefinedFields},getPredefinedFields:function(){return this._predefinedFields},getChangedFields:function(){var e=[],i=this.getPredefinedFields();for(var n in i){var r=i[n];if(t.isEmptyObject(r.getReferences())){if(!r.isInitializable())continue;if(this.isDefaultValue(r))continue}e.push(r)}return e},isDefaultValue:function(t){var e=this.getFieldDefinitions().get(t.getName());return e?e.value.equals(t):!t.getSet()},getFields:function(){return this._fields},getSourceText:function(){return null},hasRoutes:function(){for(var e=this.getFieldDefinitions(),i=0,n=e.length;i<n;++i){var r=this.getField(e[i].name);if(!t.isEmptyObject(r.getInputRoutes())||!t.isEmptyObject(r.getOutputRoutes()))return!0}return!1},getPrivate:function(){return this._private},setPrivate:function(t){if(this._private=t,t)for(var e=this.getFieldDefinitions(),i=0,n=e.length;i<n;++i)this.getField(e[i].name).removeClones(1);else for(var e=this.getFieldDefinitions(),i=0,n=e.length;i<n;++i)this.getField(e[i].name).addClones(1)},getCloneCount:function(){return this._cloneCount},addClones:function(t){0!==t&&(this._cloneCount+=t)},removeClones:function(t){0!==t&&(this._cloneCount-=t)},traverse:function(){},toStream:function(t){t.string+=this.getTypeName()+" { }"},toXMLStream:function(e){var i=a.Get(e);if(i.IsSharedNode(this))return e.string+=i.Indent(),void(e.string+="\x3c!-- NULL --\x3e");i.EnterScope();var n=i.Name(this);if(n.length&&i.ExistsNode(this)){e.string+=i.Indent(),e.string+="<",e.string+=this.getTypeName(),e.string+=" ",e.string+="USE='",e.string+=i.XMLEncode(n),e.string+="'";var r=i.ContainerField();return r&&r.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=i.XMLEncode(r.getName()),e.string+="'"),e.string+="/>",void i.LeaveScope()}e.string+=i.Indent(),e.string+="<",e.string+=this.getTypeName(),n.length&&(i.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=i.XMLEncode(n),e.string+="'");var r=i.ContainerField();r&&r.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=i.XMLEncode(r.getName()),e.string+="'");var o=this.getChangedFields(),u=this.getUserDefinedFields(),l=[],h=[],c=this.getSourceText();c&&0===c.length&&(c=null),i.IncIndent(),i.IncIndent();for(var d=0,p=o.length;d<p;++d){var f=o[d],g=!1;if(i.ExecutionContext()&&f.getAccessType()===s.inputOutput&&!t.isEmptyObject(f.getReferences())){var m=!1,x=f.getReferences();for(var y in x)m|=x[y].isInitializable();m||(g=!0)}if(t.isEmptyObject(f.getReferences())||!i.ExecutionContext()||g){if(g&&l.push(f),f.isInitializable())switch(f.getType()){case s.SFNode:case s.MFNode:h.push(f);break;default:if(f===c)break;e.string+="\n",e.string+=i.Indent(),e.string+=f.getName(),e.string+="='",f.toXMLStream(e),e.string+="'"}}else l.push(f)}if(i.DecIndent(),i.DecIndent(),this.hasUserDefinedFields()&&0!==u.length||0!==l.length||0!==h.length||c){if(e.string+=">\n",i.IncIndent(),this.hasUserDefinedFields())for(var n in u){var f=u[n];e.string+=i.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=i.AccessType(f.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=f.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(f.getName()),e.string+="'";var g=!1;if(f.getAccessType()===s.inputOutput&&!t.isEmptyObject(f.getReferences())){var m=!1,x=f.getReferences();for(var y in x)m|=x[y].isInitializable();m||(g=!0)}if(t.isEmptyObject(f.getReferences())||!i.ExecutionContext()||g)if(g&&i.ExecutionContext()&&l.push(f),!f.isInitializable()||f.isDefaultValue())e.string+="/>\n";else switch(f.getType()){case s.SFNode:case s.MFNode:i.PushContainerField(null),e.string+=">\n",i.IncIndent(),f.toXMLStream(e),e.string+="\n",i.DecIndent(),e.string+=i.Indent(),e.string+="</field>\n",i.PopContainerField();break;default:e.string+=" ",e.string+="value='",f.toXMLStream(e),e.string+="'",e.string+="/>\n"}else i.ExecutionContext()&&l.push(f),e.string+="/>\n"}if(l.length){e.string+=i.Indent(),e.string+="<IS>",e.string+="\n",i.IncIndent();for(var d=0,p=l.length;d<p;++d){var f=l[d],_=f.getReferences();for(var y in _){var v=_[y];e.string+=i.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=i.XMLEncode(f.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=i.XMLEncode(v.getName()),e.string+="'",e.string+="/>\n"}}i.DecIndent(),e.string+=i.Indent(),e.string+="</IS>\n"}for(var d=0,p=h.length;d<p;++d){var f=h[d];i.PushContainerField(f),f.toXMLStream(e),e.string+="\n",i.PopContainerField()}if(c)for(var d=0,p=c.length;d<p;++d){var w=c[d];e.string+="<![CDATA[",e.string+=i.escapeCDATA(w),e.string+="]]>\n"}i.DecIndent(),e.string+=i.Indent(),e.string+="</",e.string+=this.getTypeName(),e.string+=">"}else e.string+="/>";i.LeaveScope()},dispose:function(){var t=this.getPredefinedFields(),e=this.getUserDefinedFields();for(var i in t)t[i].dispose();for(var i in e)e[i].dispose();var n=this.getParents();for(var r in n){var s=n[r];if(s instanceof o.SFNode){var a=s.getParents();for(var u in a){var l=a[u];if(l instanceof o.MFNode){var h=l.length;l.erase(l.remove(0,h,s),h)}}s.setValue(null)}}}}),l.prototype.addAlias=l.prototype.setField,l}),define("x_ite/Browser/Core/PrimitiveQuality",[],function(){"use strict";var t=0,e={LOW:t++,MEDIUM:t++,HIGH:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Browser/Core/TextureQuality",[],function(){"use strict";var t=0,e={LOW:t++,MEDIUM:t++,HIGH:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Browser/Core/BrowserOptions",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Core/TextureQuality"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addAlias("AntiAliased",this.Antialiased_),this.setAttributeSplashScreen(),this.primitiveQuality=s.MEDIUM,this.textureQuality=a.MEDIUM}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"SplashScreen",new e.SFBool(!0)),new i(o.inputOutput,"Dashboard",new e.SFBool(!0)),new i(o.inputOutput,"Rubberband",new e.SFBool(!0)),new i(o.inputOutput,"EnableInlineViewpoints",new e.SFBool(!0)),new i(o.inputOutput,"Antialiased",new e.SFBool(!0)),new i(o.inputOutput,"TextureQuality",new e.SFString("MEDIUM")),new i(o.inputOutput,"PrimitiveQuality",new e.SFString("MEDIUM")),new i(o.inputOutput,"QualityWhenMoving",new e.SFString("MEDIUM")),new i(o.inputOutput,"Shading",new e.SFString("GOURAUD")),new i(o.inputOutput,"MotionBlur",new e.SFBool),new i(o.inputOutput,"Gravity",new e.SFFloat(9.80665))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserOptions"},initialize:function(){r.prototype.initialize.call(this),this.SplashScreen_.addInterest("set_splashScreen__",this),this.Rubberband_.addInterest("set_rubberband__",this),this.PrimitiveQuality_.addInterest("set_primitiveQuality__",this),this.TextureQuality_.addInterest("set_textureQuality__",this),this.Shading_.addInterest("set_shading__",this),this.getBrowser().shutdown().addInterest("configure",this),this.configure()},configure:function(){for(var t=this.getFieldDefinitions(),e=0;e<t.length;++e){var i=t[e],n=this.getField(i.name);void 0===this.getBrowser().getDataStorage()["BrowserOptions."+i.name]&&(n.equals(i.value)||n.setValue(i.value))}var r=this.getBrowser().getDataStorage()["BrowserOptions.Rubberband"],o=this.getBrowser().getDataStorage()["BrowserOptions.PrimitiveQuality"],s=this.getBrowser().getDataStorage()["BrowserOptions.TextureQuality"];this.setAttributeSplashScreen(),void 0!==r&&r!==this.Rubberband_.getValue()&&(this.Rubberband_=r),void 0!==o&&o!==this.PrimitiveQuality_.getValue()&&(this.PrimitiveQuality_=o),
void 0!==s&&s!==this.TextureQuality_.getValue()&&(this.TextureQuality_=s)},setAttributeSplashScreen:function(){this.SplashScreen_.set(this.getSplashScreen())},getSplashScreen:function(){return"false"!==this.getBrowser().getElement().attr("splashScreen")},getNotifications:function(){return"false"!==this.getBrowser().getElement().attr("notifications")},getTimings:function(){return"false"!==this.getBrowser().getElement().attr("timings")},getContextMenu:function(){return"false"!==this.getBrowser().getElement().attr("contextMenu")},getCache:function(){return"false"!==this.getBrowser().getElement().attr("cache")},getPrimitiveQuality:function(){return this.primitiveQuality},getTextureQuality:function(){return this.textureQuality},getShading:function(){return this.Shading_.getValue()},set_splashScreen__:function(t){this.getBrowser().getElement().attr("splashScreen",t.getValue()?"true":"false")},set_rubberband__:function(t){this.getBrowser().getDataStorage()["BrowserOptions.Rubberband"]=t.getValue()},set_primitiveQuality__:function(t){this.getBrowser().getDataStorage()["BrowserOptions.PrimitiveQuality"]=t.getValue();var e=this.getBrowser().getArc2DOptions(),i=this.getBrowser().getArcClose2DOptions(),n=this.getBrowser().getCircle2DOptions(),r=this.getBrowser().getDisk2DOptions(),o=this.getBrowser().getConeOptions(),a=this.getBrowser().getCylinderOptions(),u=this.getBrowser().getSphereOptions();switch(t.getValue()){case"LOW":this.primitiveQuality=s.LOW,e.dimension_=20,i.dimension_=20,n.dimension_=20,r.dimension_=20,o.xDimension_=16,a.xDimension_=16,u.xDimension_=20,u.yDimension_=9;break;case"HIGH":this.primitiveQuality=s.HIGH,e.dimension_=80,i.dimension_=80,n.dimension_=80,r.dimension_=80,o.xDimension_=32,a.xDimension_=32,u.xDimension_=64,u.yDimension_=31;break;default:this.primitiveQuality=s.MEDIUM,e.dimension_=40,i.dimension_=40,n.dimension_=40,r.dimension_=40,o.xDimension_=20,a.xDimension_=20,u.xDimension_=32,u.yDimension_=15}},set_textureQuality__:function(t){this.getBrowser().getDataStorage()["BrowserOptions.TextureQuality"]=t.getValue();var e=this.getBrowser().getDefaultTextureProperties();switch(t.getValue()){case"LOW":this.textureQuality=a.LOW,e.magnificationFilter_="AVG_PIXEL",e.minificationFilter_="AVG_PIXEL",e.textureCompression_="FASTEST",e.generateMipMaps_=!0;break;case"HIGH":this.textureQuality=a.HIGH,e.magnificationFilter_="NICEST",e.minificationFilter_="NICEST",e.textureCompression_="NICEST",e.generateMipMaps_=!0;break;default:this.textureQuality=a.MEDIUM,e.magnificationFilter_="NICEST",e.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",e.textureCompression_="NICEST",e.generateMipMaps_=!0}},set_shading__:function(t){this.getBrowser().setShading(t.getValue())}}),u}),define("x_ite/Browser/Core/BrowserProperties",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.initializeOnly,"ABSTRACT_NODES",new e.SFBool(!0)),new i(o.initializeOnly,"CONCRETE_NODES",new e.SFBool(!0)),new i(o.initializeOnly,"EXTERNAL_INTERACTIONS",new e.SFBool(!0)),new i(o.initializeOnly,"PROTOTYPE_CREATE",new e.SFBool(!0)),new i(o.initializeOnly,"DOM_IMPORT",new e.SFBool(!0)),new i(o.initializeOnly,"XML_ENCODING",new e.SFBool(!0)),new i(o.initializeOnly,"CLASSIC_VRML_ENCODING",new e.SFBool(!0)),new i(o.initializeOnly,"BINARY_ENCODING",new e.SFBool)]),getTypeName:function(){return"BrowserProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserProperties"}}),s}),define("x_ite/Browser/Core/RenderingProperties",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addAlias("AntiAliased",this.Antialiased_)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.initializeOnly,"Shading",new e.SFString),new i(o.initializeOnly,"MaxTextureSize",new e.SFInt32),new i(o.initializeOnly,"TextureUnits",new e.SFInt32),new i(o.initializeOnly,"MaxLights",new e.SFInt32),new i(o.initializeOnly,"Antialiased",new e.SFBool(!0)),new i(o.initializeOnly,"ColorDepth",new e.SFInt32),new i(o.initializeOnly,"TextureMemory",new e.SFDouble)]),getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"renderingProperties"},initialize:function(){r.prototype.initialize.call(this);var t=this.getBrowser();this.MaxTextureSize_=t.getMaxTextureSize(),this.TextureUnits_=t.getCombinedTextureUnits(),this.MaxLights_=t.getMaxLights(),this.ColorDepth_=t.getColorDepth(),this.TextureMemory_=t.getTextureMemory(),t.getBrowserOptions().Shading_.addInterest("set_shading__",this),this.set_shading__(t.getBrowserOptions().Shading_)},set_shading__:function(t){this.Shading_=t}}),s}),define("x_ite/Browser/Core/Notification",["jquery","x_ite/Fields/SFString","x_ite/Basic/X3DBaseNode"],function(t,e,i){"use strict";function n(t){i.call(this,t)}return t.fn.textWidth=function(e){var i=t(this).children(),n=t(this).html(),r="<span>"+n+"</span>";t(this).html(r);var o=t(this).find("span:first").width();return t(this).empty(),t(this).append(i),o},n.prototype=t.extend(Object.create(i.prototype),{constructor:n,initialize:function(){i.prototype.initialize.call(this),this.addChildObjects("string",new e),this.element=t("<div></div>").addClass("x_ite-private-notification").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")).animate({width:0}),t("<span></span>").appendTo(this.element),this.string_.addInterest("set_string__",this)},set_string__:function(){this.getBrowser().getBrowserOptions().getNotifications()&&0!==this.string_.length&&(this.element.children().text(this.string_.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth()}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),n}),define("text/text",["module"],function(t){"use strict";function e(t,e){return void 0===t||""===t?e:t}function i(t,i,n,r){if(i===r)return!0;if(t===n){if("http"===t)return e(i,"80")===e(r,"80");if("https"===t)return e(i,"443")===e(r,"443")}return!1}var n,r,o,s,a,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),p=c&&location.hostname,f=c&&(location.port||void 0),g={},m=t.config&&t.config()||{};return n={version:"2.0.15",strip:function(t){if(t){t=t.replace(l,"");var e=t.match(h);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=u[e];try{t=new ActiveXObject(i)}catch(t){}if(t){u=[i];break}}return t},parseName:function(t){var e,i,n,r=!1,o=t.lastIndexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!s||o>1)?(e=t.substring(0,o),i=t.substring(o+1)):e=t,n=i||e,o=n.indexOf("!"),-1!==o&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:e=n),{moduleName:e,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,r,o){var s,a,u,l=n.xdRegExp.exec(t);return!l||(s=l[2],a=l[3],a=a.split(":"),u=a[1],a=a[0],(!s||s===e)&&(!a||a.toLowerCase()===r.toLowerCase())&&(!u&&!a||i(s,u,e,o)))},finishLoad:function(t,e,i,r){i=e?n.strip(i):i,m.isBuild&&(g[t]=i),r(i)},load:function(t,e,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();m.isBuild=r&&r.isBuild;var o=n.parseName(t),s=o.moduleName+(o.ext?"."+o.ext:""),a=e.toUrl(s),u=m.useXhr||n.useXhr;if(0===a.indexOf("empty:"))return void i();!c||u(a,d,p,f)?n.get(a,function(e){n.finishLoad(t,o.strip,e,i)},function(t){i.error&&i.error(t)}):e([s],function(t){n.finishLoad(o.moduleName+"."+o.ext,o.strip,t,i)})},write:function(t,e,i,r){if(g.hasOwnProperty(e)){var o=n.jsEscape(g[e]);i.asModule(t+"!"+e,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,e,i,r,o){var s=n.parseName(e),a=s.ext?"."+s.ext:"",u=s.moduleName+a,l=i.toUrl(s.moduleName+a)+".js";n.load(u,i,function(e){var i=function(t){return r(l,t)};i.asModule=function(t,e){return r.asModule(t,l,e)},n.write(t,u,i,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),n.get=function(t,e,i){try{var n=r.readFileSync(t,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),e(n)}catch(t){i&&i(t)}}):"xhr"===m.env||!m.env&&n.createXhr()?n.get=function(t,e,i,r){var o,s=n.createXhr();if(s.open("GET",t,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);m.onXhr&&m.onXhr(s,t),s.onreadystatechange=function(n){var r,o;4===s.readyState&&(r=s.status||0,r>399&&r<600?(o=new Error(t+" HTTP status: "+r),o.xhr=s,i&&i(o)):e(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,t))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(t,e){var i,n,r=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),a="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(o),i.append(n);a=String(i.toString())}finally{s.close()}e(a)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in o,n.get=function(t,e){var i,n,r,u={};a&&(t=t.replace(/\//g,"\\")),r=new FileUtils.File(t);try{i=o["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(r,1,0,!1),n=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),n.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),u),n.close(),i.close(),e(u.value)}catch(t){throw new Error((r&&r.path||"")+": "+t)}}),n}),define("text",["text/text"],function(t){return t}),define("text!locale/de.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "BpS"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\nmsgid "Browser"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routen"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "ZeigegerÃ¤t"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Kamera"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Kollision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Anzeige"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formen"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Sensoren"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr ""\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "VerfÃ¼gbare Betrachter"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "QualitÃ¤t der Grundobjekte"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Hoch"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "hoch"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Mittel"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "mittel"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Niedrig"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "niedrig"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Textur QualitÃ¤t"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "an"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "aus"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "Ãber X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Lade %d Datei"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Lade %d Dateien"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\n#~ msgid "Look At"\n#~ msgstr "Auf Objekte zielen"\n'}),define("text!locale/fr.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Moins de propriÃ©tÃ©s"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Plus de propriÃ©tÃ©s"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "FrÃ©quence"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "fps"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "VÃ©locitÃ©"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\n#, fuzzy\nmsgid "Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routes"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "Pointeur"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "CamÃ©ra"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Collision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Visualisation"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formes"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Senseurs"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "QualitÃ© des objets simples"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Haut"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "haut"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Moyenne"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "moyenne"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Faible"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "faible"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "QualitÃ© des textures"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "PrÃ©senter le bande Ã©lastique"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Bande Ã©lastique"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "marche"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "arrÃªt"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur rÃ©activÃ©"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein Ã©cran"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Plein Ã©cran"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "Ã propos de X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de prÃ¨s"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "TÃ©lÃ©charger %d fichier"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "TÃ©lÃ©charger %d fichiers"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "TÃ©lÃ©chargement fini"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers ayant Ã©chouÃ©."\n\n#~ msgid "Look At"\n#~ msgstr "Regarder un objet de prÃ¨s"\n'}),define("locale/gettext",["text!locale/de.po","text!locale/fr.po"],function(t,e){"use strict";function i(t,e){for(var i=null,n=[];i=t.exec(e);)n.push(i);return n}function n(t){var e=r[s];if(void 0===e)return t;var i=e[t];return void 0===i?t:i}var r={en:"C",de:t,fr:e},o=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,s=function(){for(var t=0;t<navigator.languages;++t){var e=navigator.languages[t].split("-")[0];if(r[e])return e}return(navigator.language||navigator.userLanguage).split("-")[0]}();return function(t){if(r[t])for(var e=i(o,r[t]),n=r[t]={},s=0,a=e.length;s<a;++s)e[s][2].length&&(n[e[s][1]]=e[s][2])}(s),n}),define("x_ite/Browser/Core/BrowserTimings",["jquery","x_ite/Fields/SFBool","x_ite/Basic/X3DBaseNode","locale/gettext"],function(t,e,i,n){"use strict";function r(t){return Math.floor(100*t)/100}function o(t){i.call(this,t),this.addChildObjects("enabled",new e)}return o.prototype=t.extend(Object.create(i.prototype),{constructor:o,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserTimings"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.type=this.getBrowser().getDataStorage()["BrowserTimings.type"]||"LESS",this.startTime=0,this.frames=0,this.element=t("<div></div>").addClass("x_ite-private-browser-timings").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")),this.table=t("<table></table>").appendTo(this.element),this.header=t("<thead></thead>").append(t("<tr></tr>").append(t("<th colspan='2'></th>"))).appendTo(this.table),this.body=t("<tbody></tbody>").appendTo(this.table),this.footer=t("<tfoot></tfoot>").append(t("<tr></tr>").append(t("<td colspan='2'></td>"))).appendTo(this.table),this.button=t("<button></button>").click(this.set_type__.bind(this)).appendTo(this.footer.find("td")),this.rows=[],this.set_button__(),this.getBrowser().getDataStorage()["BrowserTimings.enabled"]&&(this.enabled_=!0)},setEnabled:function(t){this.enabled_=t},getEnabled:function(){return this.enabled_.getValue()},set_enabled__:function(t){this.getBrowser().getBrowserOptions().getTimings()&&(this.getBrowser().getDataStorage()["BrowserTimings.enabled"]=t.getValue(),t.getValue()?(this.element.fadeIn(),this.getBrowser().prepareEvents().addInterest("update",this),this.update()):(this.element.fadeOut(),this.getBrowser().prepareEvents().removeInterest("update",this)))},set_type__:function(){"MORE"===this.type?this.type="LESS":this.type="MORE",this.getBrowser().getDataStorage()["BrowserTimings.type"]=this.type,this.set_button__(),this.build()},set_button__:function(){"MORE"===this.type?this.button.text(n("Less Properties")):this.button.text(n("More Properties"))},update:function(){var t=this.getBrowser().getCurrentTime();t-this.startTime>1?(this.build(),this.frames=0,this.startTime=t):++this.frames},build:function(){var e=this.getBrowser(),i=e.getCurrentTime(),o=navigator.language||navigator.userLanguage,s=this.localeOptions,a=this.rows,u=0;if(a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Frame rate")+":")).append(t("<td></td>").text(r(this.frames/(i-this.startTime)).toLocaleString(o,s)+" "+n("fps"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Speed")+":")).append(t("<td></td>").text(r(this.getSpeed(e.currentSpeed)).toLocaleString(o,s)+" "+this.getSpeedUnit(e.currentSpeed))),"MORE"===this.type){for(var l=e.getWorld().getLayerSet().getLayers(),h=e.getActiveLayer(),c=e.systemTime,d=h&&e.getCollisionCount()?h.collisionTime:0,p=e.collisionTime+d,f=e.browserTime-(e.cameraTime+e.collisionTime+e.displayTime+d),g=Object.keys(e.prepareEvents().getInterests()).length-1,m=Object.keys(e.sensorEvents().getInterests()).length,x=0,y=0,_=0;_<l.length;++_){var v=l[_];x+=v.numOpaqueShapes,y+=v.numTransparentShapes}a[1].addClass("x_ite-private-more"),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Browser")+":")).append(t("<td></td>").text(r(c).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("X3D")+":")).append(t("<td></td>").text(r(e.browserTime).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Routing")+":")).append(t("<td></td>").text(r(f).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Picking")+":")).append(t("<td></td>").text(r(e.pickingTime).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Camera")+":")).append(t("<td></td>").text(r(e.cameraTime).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Collision")+":")).append(t("<td></td>").text(r(p).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Display")+":")).append(t("<td></td>").text(r(e.displayTime).toLocaleString(o,s)+" "+n("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Shapes")+":")).append(t("<td></td>").text(x+" + "+y)),a[u++]=t("<tr></tr>").append(t("<td></td>").text(n("Sensors")+":")).append(t("<td></td>").text(g+m))}a.length=u,this.header.find("th").text(n("Browser Timings")),this.body.empty(),this.body.append(a)},getSpeed:function(t){return t<15?t:3.6*t},getSpeedUnit:function(t){return n(t<15?"m/s":"km/h")}}),o}),function(t){"function"==typeof define&&define.amd?define("lib/jquery-contextMenu/dist/jquery.contextMenu",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){for(var e,i=t.split(/\s+/),n=[],r=0;e=i[r];r++)e=e.charAt(0).toUpperCase(),n.push(e);return n}function i(e){return e.id&&t('label[for="'+e.id+'"]').val()||e.name}function n(e,r,o){return o||(o=0),r.each(function(){var r,s,a=t(this),u=this,l=this.nodeName.toLowerCase();switch("label"===l&&a.find("input, textarea, select").length&&(r=a.text(),a=a.children().first(),u=a.get(0),l=u.nodeName.toLowerCase()),l){case"menu":s={name:a.attr("label"),items:{}},o=n(s.items,a.children(),o);break;case"a":case"button":s={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){return function(){a.click()}}()};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":s={name:a.attr("label"),disabled:!!a.attr("disabled"),icon:a.attr("icon"),callback:function(){return function(){a.click()}}()};break;case"checkbox":s={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:s=void 0}break;case"hr":s="-------";break;case"input":switch(a.attr("type")){case"text":s={type:"text",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":s={type:"checkbox",name:r||i(u),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",name:r||i(u),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:s=void 0}break;case"select":s={type:"select",name:r||i(u),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each(function(){s.options[this.value]=t(this).text()});break;case"textarea":s={type:"textarea",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:s={type:"html",html:a.clone(!0)}}s&&(o++,e["key"+o]=s)}),o}t.support.htmlMenuitem="HTMLMenuItemElement"in window,t.support.htmlCommand="HTMLCommandElement"in window,t.support.eventSelectstart="onselectstart"in document.documentElement,t.ui&&t.widget||(t.cleanData=function(e){return function(i){var n,r,o;for(o=0;null!=(r=i[o]);o++)try{n=t._data(r,"events"),n&&n.remove&&t(r).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData));var r=null,o=!1,s=t(window),a=0,u={},l={},h={},c={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,classNames:{hover:"hover",disabled:"disabled",visible:"visible",notSelectable:"not-selectable",icon:"icon",iconEdit:"icon-edit",iconCut:"icon-cut",iconCopy:"icon-copy",iconPaste:"icon-paste",iconDelete:"icon-delete",iconAdd:"icon-add",iconQuit:"icon-quit"},determinePosition:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight(),i.left+=this.outerWidth()/2-e.outerWidth()/2,e.css(i)}},position:function(t,e,i){var n;if(!e&&!i)return void t.determinePosition.call(this,t.$menu);n="maintain"===e&&"maintain"===i?t.$menu.position():{top:i,left:e};var r=s.scrollTop()+s.height(),o=s.scrollLeft()+s.width(),a=t.$menu.outerHeight(),u=t.$menu.outerWidth();n.top+a>r&&(n.top-=a),n.top<0&&(n.top=0),n.left+u>o&&(n.left-=u),t.$menu.css(n)},positionSubmenu:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:0,left:this.outerWidth()};e.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:t.noop,hide:t.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},p=function(t){for(var e=0,i=t;;)if(e=Math.max(e,parseInt(i.css("z-index"),10)||0),!(i=i.parent())||!i.length||"html body".indexOf(i.prop("nodeName").toLowerCase())>-1)break;return e},f={abortevent:function(t){t.preventDefault(),t.stopImmediatePropagation()},contextmenu:function(e){var i=t(this);if("right"===e.data.trigger&&(e.preventDefault(),e.stopImmediatePropagation()),!("right"!==e.data.trigger&&"demand"!==e.data.trigger&&e.originalEvent||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled"))){if(r=i,e.data.build){var n=e.data.build(r,e);if(!1===n)return;if(e.data=t.extend(!0,{},c,e.data,n||{}),!e.data.items||t.isEmptyObject(e.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");e.data.$trigger=r,g.create(e.data)}var o=!1;for(var s in e.data.items)if(e.data.items.hasOwnProperty(s)){var a;a=t.isFunction(e.data.items[s].visible)?e.data.items[s].visible.call(t(e.currentTarget),s,e.data):void 0===s.visible||!0===e.data.items[s].visible,a&&(o=!0)}o&&g.show.call(i,e.data,e.pageX,e.pageY)}},click:function(e){e.preventDefault(),e.stopImmediatePropagation(),
t(this).trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function(e){var i=t(this);r&&r.length&&!r.is(i)&&r.data("contextMenu").$menu.trigger("contextmenu:hide"),2===e.button&&(r=i.data("contextMenuActive",!0))},mouseup:function(e){var i=t(this);i.data("contextMenuActive")&&r&&r.length&&r.is(i)&&!i.hasClass("context-menu-disabled")&&(e.preventDefault(),e.stopImmediatePropagation(),r=i,i.trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))),i.removeData("contextMenuActive")},mouseenter:function(e){var i=t(this),n=t(e.relatedTarget),o=t(document);n.is(".context-menu-list")||n.closest(".context-menu-list").length||r&&r.length||(d.pageX=e.pageX,d.pageY=e.pageY,d.data=e.data,o.on("mousemove.contextMenuShow",f.mousemove),d.timer=setTimeout(function(){d.timer=null,o.off("mousemove.contextMenuShow"),r=i,i.trigger(t.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},e.data.delay))},mousemove:function(t){d.pageX=t.pageX,d.pageY=t.pageY},mouseleave:function(e){var i=t(e.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(e){}d.timer=null}},layerClick:function(e){var i,n,r=t(this),o=r.data("contextMenuRoot"),a=e.button,u=e.pageX,l=e.pageY;e.preventDefault(),e.stopImmediatePropagation(),setTimeout(function(){var r,h="left"===o.trigger&&0===a||"right"===o.trigger&&2===a;if(document.elementFromPoint&&(o.$layer.hide(),i=document.elementFromPoint(u-s.scrollLeft(),l-s.scrollTop()),o.$layer.show()),o.reposition&&h)if(document.elementFromPoint){if(o.$trigger.is(i)||o.$trigger.has(i).length)return void o.position.call(o.$trigger,o,u,l)}else if(n=o.$trigger.offset(),r=t(window),n.top+=r.scrollTop(),n.top<=e.pageY&&(n.left+=r.scrollLeft(),n.left<=e.pageX&&(n.bottom=n.top+o.$trigger.outerHeight(),n.bottom>=e.pageY&&(n.right=n.left+o.$trigger.outerWidth(),n.right>=e.pageX))))return void o.position.call(o.$trigger,o,u,l);i&&h&&o.$trigger.one("contextmenu:hidden",function(){t(i).contextMenu({x:u,y:l})}),o.$menu.trigger("contextmenu:hide")},50)},keyStop:function(t,e){e.isInput||t.preventDefault(),t.stopPropagation()},key:function(t){var e={};switch(r&&(e=r.data("contextMenu")||{}),t.keyCode){case 9:case 38:if(f.keyStop(t,e),e.isInput){if(9===t.keyCode&&t.shiftKey)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("prevcommand");if(38===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault()}else if(9!==t.keyCode||t.shiftKey)return void e.$menu.trigger("prevcommand");case 40:if(f.keyStop(t,e),!e.isInput)return void e.$menu.trigger("nextcommand");if(9===t.keyCode)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("nextcommand");if(40===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault();break;case 37:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;if(!e.$selected.parent().hasClass("context-menu-root")){var i=e.$selected.parent().parent();return e.$selected.trigger("contextmenu:blur"),void(e.$selected=i)}break;case 39:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;var n=e.$selected.data("contextMenu")||{};if(n.$menu&&e.$selected.hasClass("context-menu-submenu"))return e.$selected=null,n.$selected=null,void n.$menu.trigger("nextcommand");break;case 35:case 36:return e.$selected&&e.$selected.find("input, textarea, select").length?void 0:((e.$selected&&e.$selected.parent()||e.$menu).children(":not(."+e.classNames.disabled+", ."+e.classNames.notSelectable+")")[36===t.keyCode?"first":"last"]().trigger("contextmenu:focus"),void t.preventDefault());case 13:if(f.keyStop(t,e),e.isInput){if(e.$selected&&!e.$selected.is("textarea, select"))return void t.preventDefault();break}return void(void 0!==e.$selected&&e.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(t,e);case 27:return f.keyStop(t,e),void e.$menu.trigger("contextmenu:hide");default:var o=String.fromCharCode(t.keyCode).toUpperCase();if(e.accesskeys&&e.accesskeys[o])return void e.accesskeys[o].$node.trigger(e.accesskeys[o].$menu?"contextmenu:focus":"mouseup")}t.stopPropagation(),void 0!==e.$selected&&e.$selected.trigger(t)},prevItem:function(e){e.stopPropagation();var i=t(this).data("contextMenu")||{},n=t(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var o=i.$menu.children(),s=i.$selected&&i.$selected.prev().length?i.$selected.prev():o.last(),a=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable);)if(s=s.prev().length?s.prev():o.last(),s.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),e),f.itemMouseenter.call(s.get(0),e);var u=s.find("input, textarea, select");u.length&&u.focus()},nextItem:function(e){e.stopPropagation();var i=t(this).data("contextMenu")||{},n=t(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var o=i.$menu.children(),s=i.$selected&&i.$selected.next().length?i.$selected.next():o.first(),a=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable);)if(s=s.next().length?s.next():o.first(),s.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),e),f.itemMouseenter.call(s.get(0),e);var u=s.find("input, textarea, select");u.length&&u.focus()},focusInput:function(){var e=t(this).closest(".context-menu-item"),i=e.data(),n=i.contextMenu,r=i.contextMenuRoot;r.$selected=n.$selected=e,r.isInput=n.isInput=!0},blurInput:function(){var e=t(this).closest(".context-menu-item"),i=e.data(),n=i.contextMenu;i.contextMenuRoot.isInput=n.isInput=!1},menuMouseenter:function(){t(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(e){var i=t(this).data().contextMenuRoot;i.$layer&&i.$layer.is(e.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(e){var i=t(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;if(o.hovering=!0,e&&o.$layer&&o.$layer.is(e.relatedTarget)&&(e.preventDefault(),e.stopImmediatePropagation()),(r.$menu?r:o).$menu.children(".hover").trigger("contextmenu:blur"),i.hasClass(o.classNames.disabled)||i.hasClass(o.classNames.notSelectable))return void(r.$selected=null);i.trigger("contextmenu:focus")},itemMouseleave:function(e){var i=t(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;if(o!==r&&o.$layer&&o.$layer.is(e.relatedTarget))return void 0!==o.$selected&&o.$selected.trigger("contextmenu:blur"),e.preventDefault(),e.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node);i.trigger("contextmenu:blur")},itemClick:function(e){var i,n=t(this),r=n.data(),o=r.contextMenu,s=r.contextMenuRoot,a=r.contextMenuKey;if(o.items[a]&&!n.is("."+s.classNames.disabled+", .context-menu-submenu, .context-menu-separator, ."+s.classNames.notSelectable)){if(e.preventDefault(),e.stopImmediatePropagation(),t.isFunction(s.callbacks[a])&&Object.prototype.hasOwnProperty.call(s.callbacks,a))i=s.callbacks[a];else{if(!t.isFunction(s.callback))return;i=s.callback}!1!==i.call(s.$trigger,a,s)?s.$menu.trigger("contextmenu:hide"):s.$menu.parent().length&&g.update.call(s.$trigger,s)}},inputClick:function(t){t.stopImmediatePropagation()},hideMenu:function(e,i){var n=t(this).data("contextMenuRoot");g.hide.call(n.$trigger,n,i&&i.force)},focusItem:function(e){e.stopPropagation();var i=t(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;i.addClass([o.classNames.hover,o.classNames.visible].join(" ")).siblings().removeClass(o.classNames.visible).filter(o.classNames.hover).trigger("contextmenu:blur"),r.$selected=o.$selected=i,r.$node&&o.positionSubmenu.call(r.$node,r.$menu)},blurItem:function(e){e.stopPropagation();var i=t(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;r.autoHide&&i.removeClass(o.classNames.visible),i.removeClass(o.classNames.hover),r.$selected=null}},g={show:function(e,i,n){var o=t(this),s={};if(t("#context-menu-layer").trigger("mousedown"),e.$trigger=o,!1===e.events.show.call(o,e))return void(r=null);g.update.call(o,e),e.position.call(o,e,i,n),e.zIndex&&(s.zIndex=p(o)+e.zIndex),g.layer.call(e.$menu,e,s.zIndex),e.$menu.find("ul").css("zIndex",s.zIndex+1),e.$menu.css(s)[e.animation.show](e.animation.duration,function(){o.trigger("contextmenu:visible")}),o.data("contextMenu",e).addClass("context-menu-active"),t(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),e.autoHide&&t(document).on("mousemove.contextMenuAutoHide",function(t){var i=o.offset();i.right=i.left+o.outerWidth(),i.bottom=i.top+o.outerHeight(),!e.$layer||e.hovering||t.pageX>=i.left&&t.pageX<=i.right&&t.pageY>=i.top&&t.pageY<=i.bottom||e.$menu.trigger("contextmenu:hide")})},hide:function(e,i){var n=t(this);if(e||(e=n.data("contextMenu")||{}),i||!e.events||!1!==e.events.hide.call(n,e)){if(n.removeData("contextMenu").removeClass("context-menu-active"),e.$layer){setTimeout(function(t){return function(){t.remove()}}(e.$layer),10);try{delete e.$layer}catch(t){e.$layer=null}}r=null,e.$menu.find("."+e.classNames.hover).trigger("contextmenu:blur"),e.$selected=null,t(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),e.$menu&&e.$menu[e.animation.hide](e.animation.duration,function(){e.build&&(e.$menu.remove(),t.each(e,function(t){switch(t){case"ns":case"selector":case"build":case"trigger":return!0;default:e[t]=void 0;try{delete e[t]}catch(t){}return!0}})),setTimeout(function(){n.trigger("contextmenu:hidden")},10)})}},create:function(i,n){void 0===n&&(n=i),i.$menu=t('<ul class="context-menu-list"></ul>').addClass(i.className||"").data({contextMenu:i,contextMenuRoot:n}),t.each(["callbacks","commands","inputs"],function(t,e){i[e]={},n[e]||(n[e]={})}),n.accesskeys||(n.accesskeys={}),t.each(i.items,function(r,o){var s=t('<li class="context-menu-item"></li>').addClass(o.className||""),a=null,u=null;if(s.on("click",t.noop),"string"==typeof o&&(o={type:"cm_seperator"}),o.$node=s.data({contextMenu:i,contextMenuRoot:n,contextMenuKey:r}),void 0!==o.accesskey)for(var l,c=e(o.accesskey),d=0;l=c[d];d++)if(!n.accesskeys[l]){n.accesskeys[l]=o,o._name=o.name.replace(new RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if(o.type&&h[o.type])h[o.type].call(s,o,i,n),t.each([i,n],function(e,i){i.commands[r]=o,t.isFunction(o.callback)&&(i.callbacks[r]=o.callback)});else{switch("cm_seperator"===o.type?s.addClass("context-menu-separator "+i.classNames.notSelectable):"html"===o.type?s.addClass("context-menu-html "+i.classNames.notSelectable):o.type?(a=t("<label></label>").appendTo(s),t("<span></span>").html(o._name||o.name).appendTo(a),s.addClass("context-menu-input"),i.hasTypes=!0,t.each([i,n],function(t,e){e.commands[r]=o,e.inputs[r]=o})):o.items&&(o.type="sub"),o.type){case"seperator":break;case"text":u=t('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+r).val(o.value||"").appendTo(a);break;case"textarea":u=t('<textarea name=""></textarea>').attr("name","context-menu-input-"+r).val(o.value||"").appendTo(a),o.height&&u.height(o.height);break;case"checkbox":u=t('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+r).val(o.value||"").prop("checked",!!o.selected).prependTo(a);break;case"radio":u=t('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+o.radio).val(o.value||"").prop("checked",!!o.selected).prependTo(a);break;case"select":u=t('<select name=""></select>').attr("name","context-menu-input-"+r).appendTo(a),o.options&&(t.each(o.options,function(e,i){t("<option></option>").val(e).text(i).appendTo(u)}),u.val(o.selected));break;case"sub":t("<span></span>").html(o._name||o.name).appendTo(s),o.appendTo=o.$node,g.create(o,n),s.data("contextMenu",o).addClass("context-menu-submenu"),o.callback=null;break;case"html":t(o.html).appendTo(s);break;default:t.each([i,n],function(e,i){i.commands[r]=o,t.isFunction(o.callback)&&(i.callbacks[r]=o.callback)}),t("<span></span>").html(o._name||o.name||"").appendTo(s)}o.type&&"sub"!==o.type&&"html"!==o.type&&"cm_seperator"!==o.type&&(u.on("focus",f.focusInput).on("blur",f.blurInput),o.events&&u.on(o.events,i)),o.icon&&(t.isFunction(o.icon)?o._icon=o.icon.call(this,s,r,o):o._icon=i.classNames.icon+" "+i.classNames.icon+"-"+o.icon,s.addClass(o._icon))}o.$input=u,o.$label=a,s.appendTo(i.$menu),!i.hasTypes&&t.support.eventSelectstart&&s.on("selectstart.disableTextSelect",f.abortevent)}),i.$node||i.$menu.css("display","none").addClass("context-menu-root"),i.$menu.appendTo(i.appendTo||document.body)},resize:function(e,i){e.css({position:"absolute",display:"block"}),e.data("width",Math.ceil(e.width())),e.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),e.find("> li > ul").each(function(){g.resize(t(this),!0)}),i||e.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return t(this).data("width")})},update:function(e,i){var n=this;void 0===i&&(i=e,g.resize(e.$menu)),e.$menu.children().each(function(){var r,o=t(this),s=o.data("contextMenuKey"),a=e.items[s],u=t.isFunction(a.disabled)&&a.disabled.call(n,s,i)||!0===a.disabled;if(r=t.isFunction(a.visible)?a.visible.call(n,s,i):void 0===a.visible||!0===a.visible,o[r?"show":"hide"](),o[u?"addClass":"removeClass"](i.classNames.disabled),t.isFunction(a.icon)&&(o.removeClass(a._icon),a._icon=a.icon.call(this,n,s,a),o.addClass(a._icon)),a.type)switch(o.find("input, select, textarea").prop("disabled",u),a.type){case"text":case"textarea":a.$input.val(a.value||"");break;case"checkbox":case"radio":a.$input.val(a.value||"").prop("checked",!!a.selected);break;case"select":a.$input.val(a.selected||"")}a.$menu&&g.update.call(n,a,i)})},layer:function(e,i){var n=e.$layer=t('<div id="context-menu-layer" style="position:fixed; z-index:'+i+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:s.height(),width:s.width(),display:"block"}).data("contextMenuRoot",e).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&n.css({position:"absolute",height:t(document).height()}),n}};t.fn.contextMenu=function(e){var i=this,n=e;if(this.length>0)if(void 0===e)this.first().trigger("contextmenu");else if(void 0!==e.x&&void 0!==e.y)this.first().trigger(t.Event("contextmenu",{pageX:e.x,pageY:e.y}));else if("hide"===e){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===e?t.contextMenu("destroy",{context:this}):t.isPlainObject(e)?(e.context=this,t.contextMenu("create",e)):e?this.removeClass("context-menu-disabled"):e||this.addClass("context-menu-disabled");else t.each(l,function(){this.selector===i.selector&&(n.data=this,t.extend(n.data,{trigger:"demand"}))}),f.contextmenu.call(n.target,n);return this},t.contextMenu=function(e,i){"string"!=typeof e&&(i=e,e="create"),"string"==typeof i?i={selector:i}:void 0===i&&(i={});var n=t.extend(!0,{},c,i||{}),r=t(document),s=r,h=!1;switch(n.context&&n.context.length?(s=t(n.context).first(),n.context=s.get(0),h=n.context!==document):n.context=document,e){case"create":if(!n.selector)throw new Error("No selector specified");if(n.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+n.selector+'" as it contains a reserved className');if(!n.build&&(!n.items||t.isEmptyObject(n.items)))throw new Error("No Items specified");switch(a++,n.ns=".contextMenu"+a,h||(u[n.selector]=n.ns),l[n.ns]=n,n.trigger||(n.trigger="right"),o||(r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on({"mouseup.contextMenu":f.itemClick,"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave},".context-menu-item"),o=!0),s.on("contextmenu"+n.ns,n.selector,n,f.contextmenu),h&&s.on("remove"+n.ns,function(){t(this).contextMenu("destroy")}),n.trigger){case"hover":s.on("mouseenter"+n.ns,n.selector,n,f.mouseenter).on("mouseleave"+n.ns,n.selector,n,f.mouseleave);break;case"left":s.on("click"+n.ns,n.selector,n,f.click)}n.build||g.create(n);break;case"destroy":var d;if(h){var p=n.context;t.each(l,function(e,i){if(i.context!==p)return!0;d=t(".context-menu-list").filter(":visible"),d.length&&d.data().contextMenuRoot.$trigger.is(t(i.context).find(i.selector))&&d.trigger("contextmenu:hide",{force:!0});try{l[i.ns].$menu&&l[i.ns].$menu.remove(),delete l[i.ns]}catch(t){l[i.ns]=null}return t(i.context).off(i.ns),!0})}else if(n.selector){if(u[n.selector]){d=t(".context-menu-list").filter(":visible"),d.length&&d.data().contextMenuRoot.$trigger.is(n.selector)&&d.trigger("contextmenu:hide",{force:!0});try{l[u[n.selector]].$menu&&l[u[n.selector]].$menu.remove(),delete l[u[n.selector]]}catch(t){l[u[n.selector]]=null}r.off(u[n.selector])}}else r.off(".contextMenu .contextMenuAutoHide"),t.each(l,function(e,i){t(i.context).off(i.ns)}),u={},l={},a=0,o=!1,t("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!t.support.htmlCommand&&!t.support.htmlMenuitem||"boolean"==typeof i&&i)&&t('menu[type="context"]').each(function(){this.id&&t.contextMenu({selector:"[contextmenu="+this.id+"]",items:t.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+e+'"')}return this},t.contextMenu.setInputValues=function(e,i){void 0===i&&(i={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":e.value=i[t]||"";break;case"checkbox":e.selected=!!i[t];break;case"radio":e.selected=(i[e.radio]||"")===e.value;break;case"select":e.selected=i[t]||""}})},t.contextMenu.getInputValues=function(e,i){return void 0===i&&(i={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":case"select":i[t]=e.$input.val();break;case"checkbox":i[t]=e.$input.prop("checked");break;case"radio":e.$input.prop("checked")&&(i[e.radio]=e.value)}}),i},t.contextMenu.fromMenu=function(e){var i=t(e),r={};return n(r,i.children()),r},t.contextMenu.defaults=c,t.contextMenu.types=h,t.contextMenu.handle=f,t.contextMenu.op=g,t.contextMenu.menus=l}),define("lib/jquery.fullscreen-min",["jquery"],function(t){function e(t){var e,i;return this.length?(e=this[0],e.ownerDocument?i=e.ownerDocument:(i=e,e=i.documentElement),null==t?i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen?(t=!!(i.fullscreenElement||i.msFullscreenElement||i.webkitIsFullScreen||i.mozFullScreen),t?i.fullscreenElement||i.webkitFullscreenElement||i.webkitCurrentFullScreenElement||i.msFullscreenElement||i.mozFullScreenElement||t:t):null:(t?(t=e.requestFullscreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen||e.mozRequestFullScreen)&&t.call(e):(t=i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen)&&t.call(i),this)):this}t.fn.fullScreen=e,t.fn.toggleFullScreen=function(){return e.call(this,!e.call(this))};var i,n,r;i=document,i.webkitCancelFullScreen?(n="webkitfullscreenchange",r="webkitfullscreenerror"):i.msExitFullscreen?(n="MSFullscreenChange",r="MSFullscreenError"):i.mozCancelFullScreen?(n="mozfullscreenchange",r="mozfullscreenerror"):(n="fullscreenchange",r="fullscreenerror"),t(document).bind(n,function(){t(document).trigger(new t.Event("fullscreenchange"))}),t(document).bind(r,function(){t(document).trigger(new t.Event("fullscreenerror"))})}),define("x_ite/Browser/Core/ContextMenu",["jquery","x_ite/Basic/X3DBaseNode","locale/gettext","lib/jquery-contextMenu/dist/jquery.contextMenu","lib/jquery.fullscreen-min"],function(t,e,i){"use strict";function n(t){e.call(this,t)}return t("head").append('<style>.x_ite-private-menu-title:before { content: "'+i("X_ITE Browser")+'" }</style>'),n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"contextMenu"},initialize:function(){e.prototype.initialize.call(this),this.getBrowser().getBrowserOptions().getContextMenu()&&t.contextMenu({selector:".x_ite-private-surface-"+this.getBrowser().getId(),build:this.build.bind(this)})},build:function(e,n){var r=this.getBrowser().getActiveLayer(),o=r?r.getViewpoint():null,s=this.getBrowser().viewer_.getValue(),a=this.getBrowser().getElement().fullScreen(),u={className:"x_ite-private-menu x_ite-private-menu-title",items:{separator0:"--------",viewpoints:{name:i("Viewpoints"),className:"context-menu-icon x_ite-private-icon-viewpoint",items:this.getViewpoints(),callback:function(e){e&&(t(".context-menu-list").fadeOut(500),this.getBrowser().bindViewpoint(e),this.getBrowser().getCanvas().focus())}.bind(this,o)},separator1:"--------",viewer:{name:i(this.getViewerName(s)),className:"context-menu-icon x_ite-private-icon-"+s.toLowerCase()+"-viewer",callback:function(e){t(".context-menu-list").fadeOut(500),this.getBrowser().viewer_=e,this.getBrowser().getNotification().string_=i(this.getViewerName(e)),this.getBrowser().getCanvas().focus()}.bind(this,s)},"available-viewers":{name:i("Available Viewers"),items:this.getAvailableViewers()},separator2:"--------","primitive-quality":{name:i("Primitive Quality"),className:"context-menu-icon x_ite-private-icon-primitive-quality",items:{high:{name:i("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","HIGH"),this.getBrowser().getNotification().string_=i("Primitive Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","MEDIUM"),this.getBrowser().getNotification().string_=i("Primitive Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","LOW"),this.getBrowser().getNotification().string_=i("Primitive Quality")+": "+i("low")}.bind(this)}}}},"texture-quality":{name:i("Texture Quality"),className:"context-menu-icon x_ite-private-icon-texture-quality",items:{high:{name:i("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","HIGH"),this.getBrowser().getNotification().string_=i("Texture Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","MEDIUM"),this.getBrowser().getNotification().string_=i("Texture Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","LOW"),this.getBrowser().getNotification().string_=i("Texture Quality")+": "+i("low")}.bind(this)}}}},"display-rubberband":{name:i("Display Rubberband"),type:"checkbox",selected:this.getBrowser().getBrowserOption("Rubberband"),events:{click:function(){var t=!this.getBrowser().getBrowserOption("Rubberband");this.getBrowser().setBrowserOption("Rubberband",t),this.getBrowser().getNotification().string_=t?i("Rubberband")+": "+i("on"):i("Rubberband")+": "+i("off")}.bind(this)}},"browser-timings":this.getBrowser().getBrowserOptions().getTimings()?{name:i("Browser Timings"),type:"checkbox",selected:this.getBrowser().getBrowserTimings().getEnabled(),events:{click:function(){this.getBrowser().getBrowserTimings().setEnabled(!this.getBrowser().getBrowserTimings().getEnabled()),this.getBrowser().getCanvas().focus()}.bind(this)}}:void 0,"mute-browser":{name:i("Mute Browser"),type:"checkbox",selected:this.getBrowser().mute_.getValue(),events:{click:function(){var t=!this.getBrowser().mute_.getValue();this.getBrowser().mute_=t,this.getBrowser().getNotification().string_=i(t?"Browser muted":"Browser unmuted")}.bind(this)}},fullscreen:{name:i(a?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(a?"x_ite-private-icon-leave-fullscreen":"x_ite-private-icon-fullscreen"),callback:function(){this.getBrowser().getElement().toggleFullScreen()}.bind(this)},separator3:"--------",about:{name:i("About X_ITE"),className:"context-menu-icon x_ite-private-icon-help-about",callback:function(){window.open("http://create3000.de/x_ite/")}}}};return t.isEmptyObject(u.items.viewpoints.items)&&(delete u.items.separator0,delete u.items.viewpoints),Object.keys(u.items["available-viewers"].items).length<2&&delete u.items["available-viewers"],u},getViewpoints:function(){var e=this.getBrowser().getActiveLayer();if(!e)return{};for(var i=e.getViewpoints().get(),n=e.getViewpoint(),r={},o=0;o<i.length;++o){var s=i[o],a=s.description_.getValue();if(""!==a){var u={name:a,callback:function(e){t(".context-menu-list").fadeOut(500),this.getBrowser().bindViewpoint(e),this.getBrowser().getCanvas().focus()}.bind(this,s)};s===n&&(u.className="context-menu-selected"),r["Viewpoint"+s.getId()]=u}}return r},getAvailableViewers:function(){for(var e=this.getBrowser().viewer_.getValue(),n=this.getBrowser().availableViewers_,r={},o=0;o<n.length;++o){var s=n[o];r[s]={name:i(this.getViewerName(s)),className:"context-menu-icon x_ite-private-icon-"+s.toLowerCase()+"-viewer",callback:function(e){t(".context-menu-list").fadeOut(500),this.getBrowser().viewer_=e,this.getBrowser().getNotification().string_=i(this.getViewerName(e)),this.getBrowser().getCanvas().focus()}.bind(this,s)},s===e&&(r[s].className+=" context-menu-selected")}return r},getViewerName:function(t){switch(t){case"EXAMINE":return i("Examine Viewer");case"WALK":return i("Walk Viewer");case"FLY":return i("Fly Viewer");case"PLANE":return i("Plane Viewer");case"LOOKAT":return i("Look At Viewer");case"NONE":return i("None Viewer")}}}),n}),define("x_ite/Configuration/X3DInfoArray",["jquery"],function(t){"use strict";function e(){return this.array=[],this.index={},new Proxy(this,i)}var i={get:function(t,e){return e in t?t[e]:e in t.array?t.array[e]:t.index[e]},set:function(t,e,i){return!1},has:function(t,e){return e in t.array||e in t.index},enumerate:function(t){return Object.keys(t.array)[Symbol.iterator]()}};return t.extend(e.prototype,{constructor:e,add:function(t,e){this.array.push(e),this.index[t]=e},get:function(t){return this.index[t]},getValue:function(){return this.array},toXMLStream:function(t){for(var e=this.array,i=0,n=e.length;i<n;++i)try{e[i].toXMLStream(t),t.string+="\n"}catch(t){}}}),e}),define("x_ite/Configuration/ComponentInfo",["jquery","x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t,e){this.name=e.name,this.level=e.level,this.title=e.title,this.providerUrl=e.providerUrl,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return t.extend(r.prototype,{constructor:r,toXMLStream:function(t){var e=n.Get(t);t.string+=e.Indent(),t.string+="<component",t.string+=" ",t.string+="name='",t.string+=this.name,t.string+="'",t.string+=" ",t.string+="level='",t.string+=this.level,t.string+="'",t.string+="/>"}}),r}),define("x_ite/Configuration/ComponentInfoArray",["jquery","x_ite/Configuration/X3DInfoArray","x_ite/Configuration/ComponentInfo"],function(t,e,i){"use strict";function n(t,i){this.browser=t;var n=e.call(this);if(i)for(var r=0,o=i.length;r<o;++r)this.add(i[r].name,i[r]);return n}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,addComponentInfo:function(t){this.add(t.name,new i(this.browser,t))}}),n}),define("x_ite/Execution/ImportedNode",["jquery","x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r){"use strict";function o(t,e,n,r){i.call(this,t),this.inlineNode=e,this.exportedName=n,this.importedName=r,this.routes={},this.inlineNode.loadState_.addInterest("set_loadState__",this)}return o.prototype=t.extend(Object.create(i.prototype),{constructor:o,getTypeName:function(){return"ImportedNode"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"importedNodes"},getInlineNode:function(){return this.inlineNode},getExportedName:function(){return this.exportedName},getExportedNode:function(){return this.inlineNode.getInternalScene().getExportedNode(this.exportedName)},setImportedName:function(t){this.importedName=t},getImportedName:function(){return this.importedName},addRoute:function(t,e,i,r){var o=t.getId()+"."+e+" "+i.getId()+"."+r;this.routes[o]={sourceNode:t,sourceField:e,destinationNode:i,destinationField:r},this.inlineNode.checkLoadState()===n.COMPLETE_STATE&&this.resolveRoute(o)},resolveRoute:function(t){try{var e=this.routes[t],i=e.sourceNode,n=e.sourceField,r=e.destinationNode,s=e.destinationField;e._route&&e._route.dispose(),i instanceof o&&(i=i.getExportedNode().getValue()),r instanceof o&&(r=r.getExportedNode().getValue()),e._route=this.getExecutionContext().addSimpleRoute(i,n,r,s)}catch(t){console.error(t.message)}},deleteRoutes:function(){var t=this.routes;for(var e in t){var i=t[e];i._route&&(this.getExecutionContext().deleteRoute(i._route),delete i._route)}},set_loadState__:function(){switch(this.inlineNode.checkLoadState()){case n.NOT_STARTED_STATE:case n.FAILED_STATE:this.deleteRoutes();break;case n.COMPLETE_STATE:var t=this.routes;this.deleteRoutes();for(var e in t)this.resolveRoute(e)}},toXMLStream:function(t){var e=r.Get(t);if(!e.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");t.string+=e.Indent(),t.string+="<IMPORT",t.string+=" ",t.string+="inlineDEF='",t.string+=e.XMLEncode(e.Name(this.getInlineNode())),t.string+="'",t.string+=" ",t.string+="exportedDEF='",t.string+=e.XMLEncode(this.getExportedName()),t.string+="'",this.getImportedName()!==this.getExportedName()&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this.getImportedName()),t.string+="'"),t.string+="/>";try{e.AddRouteNode(this),e.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(r){var i=this.routes;for(var n in i){var s=i[n],a=s.sourceNode,u=s.sourceField,l=s.destinationNode,h=s.destinationField;if(e.ExistsRouteNode(a)&&e.ExistsRouteNode(l)){if(a instanceof o)var c=a.getImportedName();else var c=e.Name(a);if(l instanceof o)var d=l.getImportedName();else var d=e.Name(l);t.string+="\n",t.string+="\n",t.string+=e.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=e.XMLEncode(c),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=e.XMLEncode(u),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=e.XMLEncode(d),t.string+="'",t.string+=" ",t.string+="toField='",t.string+=e.XMLEncode(h),t.string+="'",t.string+="/>"}}}},dispose:function(){this.inlineNode.loadState_.removeInterest("set_loadState__",this),this.deleteRoutes(),i.prototype.dispose.call(this)}}),o}),define("x_ite/Prototype/ExternProtoDeclarationArray",["jquery","x_ite/Configuration/X3DInfoArray"],function(t,e){"use strict";function i(t){return e.call(this)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i}),i}),
define("x_ite/Prototype/ProtoDeclarationArray",["jquery","x_ite/Configuration/X3DInfoArray"],function(t,e){"use strict";function i(t){return e.call(this)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Routing/RouteArray",["jquery"],function(t){"use strict";function e(){return this.array=[],new Proxy(this,i)}var i={get:function(t,e){return e in t?t[e]:t.array[e]},set:function(t,e,i){return!1}};return t.extend(e.prototype,{constructor:e,getValue:function(){return this.array},toXMLStream:function(t){for(var e=this.array,i=0,n=e.length;i<n;++i)try{e[i].toXMLStream(t),t.string+="\n"}catch(t){}}}),e}),define("x_ite/Routing/X3DRoute",["jquery","x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r){"use strict";function o(t,n,r,o,s){i.call(this,t),this.addChildObjects("sourceNode",new e.SFNode(n),"destinationNode",new e.SFNode(o)),this._sourceField=r,this._destinationField=s,r.addFieldInterest(s),r.addOutputRoute(this),s.addInputRoute(this)}return o.prototype=t.extend(Object.create(i.prototype),{getTypeName:function(){return"X3DRoute"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"routes"},initialize:function(){i.prototype.initialize.call(this),this.sourceNode_.addInterest("set_node",this),this.destinationNode_.addInterest("set_node",this)},set_node:function(){this.sourceNode_.getValue()&&this.destinationNode_.getValue()||this.dispose()},disconnect:function(){this._sourceField.removeFieldInterest(this._destinationField),this._sourceField.removeOutputRoute(this),this._destinationField.removeInputRoute(this),this.sourceNode_.getValue()&&this.sourceNode_.removeInterest("set_node",this),this.destinationNode_.getValue()&&this.destinationNode_.removeInterest("set_node",this)},getSourceNode:function(){return this.sourceNode_.getValue()},getSourceField:function(){return this._sourceField.getName()},getDestinationNode:function(){return this.destinationNode_.getValue()},getDestinationField:function(){return this._destinationField.getName()},toString:function(){return Object.prototype.toString(this)},toXMLStream:function(t){var e=r.Get(t),i=e.LocalName(this.getSourceNode()),o=e.LocalName(this.getDestinationNode());t.string+=e.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=e.XMLEncode(i),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=e.XMLEncode(this._sourceField.getName()),this._sourceField.getAccessType()===n.inputOutput&&(t.string+="_changed"),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=e.XMLEncode(o),t.string+="'",t.string+=" ",t.string+="toField='",this._destinationField.getAccessType()===n.inputOutput&&(t.string+="set_"),t.string+=e.XMLEncode(this._destinationField.getName()),t.string+="'",t.string+="/>"},dispose:function(){this.disconnect(),this.getExecutionContext().deleteRoute(this),i.prototype.dispose.call(this)}}),Object.defineProperty(o.prototype,"sourceNode",{get:function(){return this.sourceNode_.clone()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"sourceField",{get:function(){return this._sourceField.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"destinationNode",{get:function(){return this.destinationNode_.clone()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"destinationField",{get:function(){return this._destinationField.getName()},enumerable:!0,configurable:!1}),o}),define("x_ite/Bits/X3DCast",["x_ite/Fields"],function(t){"use strict";return function(e,i){try{if(i&&(i instanceof t.SFNode&&(i=i.getValue()),i&&(i=i.getInnerNode(),-1!==i.getType().indexOf(e))))return i}catch(t){}return null}}),define("standard/Networking/URI",["jquery"],function(t){"use strict";function e(t,e){switch(arguments.length){case 2:this.value=t.split(e),this.value.separator=e,this.value.leadingSeparator=!1,this.value.trailingSeparator=!1,this.value.length&&""===this.value[0]&&(this.value.shift(),this.value.leadingSeparator=!0),this.value.length&&""===this.value[this.value.length-1]&&(this.value.pop(),this.value.trailingSeparator=!0);break;case 4:this.value=arguments[0],this.value.separator=arguments[1],this.value.leadingSeparator=arguments[2],this.value.trailingSeparator=arguments[3]}}function i(t,e){var i=s.exec(e);if(i){t.scheme=i[1]||"",t.slashs=i[2]||"",t.authority=i[3]||"",t.path=i[4]||"",t.query=i[5]||"",t.fragment=i[6]||"";var i=a.exec(t.authority);i&&(t.host=i[1]||"",t.port=i[2]?parseInt(i[2]):0,t.authority=t.host,t.port&&(t.authority+=":"+t.port)),t.absolute=Boolean(t.slashs.length)||"/"===t.path[0],t.local=/^(?:file|data)$/.test(t.scheme)||!t.scheme&&!t.authority}t.string=e}function n(t){return new e(t,"/").removeDotSegments().toString()}function r(t){switch(this.value={local:!0,absolute:!0,scheme:"",slashs:"",authority:"",host:"",port:0,path:"",query:"",fragment:"",string:""},arguments.length){case 0:break;case 1:i(this.value,t);break;case 10:this.value.local=arguments[0],this.value.absolute=arguments[1],this.value.scheme=arguments[2],this.value.slashs=arguments[3],this.value.authority=arguments[4],this.value.host=arguments[5],this.value.port=arguments[6],this.value.path=arguments[7],this.value.query=arguments[8],this.value.fragment=arguments[9],this.value.string=this.toString()}}e.prototype={copy:function(){return new e(this.value.slice(0,this.value.length),this.value.separator,this.value.leadingSeparator,this.value.trailingSeparator)},get origin(){return new e([],this.value.separator,!0,!1)},get base(){return this.value.trailingSeparator?this.copy():this.parent},get parent(){switch(this.value.length){case 0:case 1:return this.value.leadingSeparator?this.origin:new e([".."],this.value.separator,!1,!1);default:return new e(this.value.slice(0,this.value.length-1),this.value.separator,this.value.leadingSeparator,!0)}},isRelative:function(){return!this.value.length||".."==this.value[0]},getRelativePath:function(t){if(this.isRelative())return t;var i,n,r=new e([],"/",!1,!1),o=this.removeDotSegments().base,s=t.removeDotSegments();for(i=0;i<o.value.length&&i<s.value.length&&o.value[i]===s.value[i];++i);for(n=i;n<o.value.length;++n)r.value.push("..");for(n=i;n<s.value.length;++n)r.value.push(s.value[n]);return r},removeDotSegments:function(){var t=new e([],this.value.separator,this.value.leadingSeparator,this.value.trailingSeparator);if(this.value.length){for(var i=0;i<this.value.length;++i){var n=this.value[i];"."===n?t.value.trailingSeparator=!0:".."===n?(t.value.trailingSeparator=!0,t.value.length&&t.value.pop()):(t.value.trailingSeparator=!1,t.value.push(n))}t.value.trailingSeparator|=this.value.trailingSeparator}return t},toString:function(){var t="";return this.value.leadingSeparator&&(t+=this.value.separator),t+=this.value.join(this.value.separator),this.value.trailingSeparator&&(t+=this.value.separator),t}};var o={ftp:21,http:80,https:443,ftps:990},s=/^(?:([^:\/?#]*?):)?(?:(\/\/)([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,a=/^(.*?)(?:\:([^:]*))?$/;return r.prototype={copy:function(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,this.value.query,this.value.fragment)},get length(){return this.value.string.length},isRelative:function(){return!this.value.absolute()},isAbsolute:function(){return!this.value.absolute},isLocal:function(){return this.value.local},isNetwork:function(){return!this.value.local},isDirectory:function(){return 0==this.value.path.length?this.isNetwork():"/"===this.value.path[this.value.path.length-1]},isFile:function(){return!this.isDirectory()},get hierarchy(){var t="";return t+=this.value.slashs,t+=this.value.authority,t+=this.value.path},get authority(){return this.value.authority},get scheme(){return this.value.scheme},get host(){return this.value.host},get port(){return this.value.port},get wellKnownPort(){var t=o[this.value.scheme];return void 0!==t?t:0},get path(){return this.value.path},set query(t){this.value.query=t},get query(){return this.value.query},set fragment(t){this.value.fragment=t},get fragment(){return this.value.fragment},get location(){return this.toString()},get origin(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.local?"/":"","","")},get base(){return this.isDirectory()?new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,"",""):this.parent},get parent(){var t;if(this.isDirectory()){if(1==this.value.path.length)return"/";t=this.value.path.substr(0,this.value.path.length-1)}else t=this.path;return t=-1==t.lastIndexOf("/")?"":t.substring(0,t.lastIndexOf("/")+1),new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,t,"","")},get filename(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,"","")},get basename(){return this.value.path?this.value.path.substr(this.value.path.lastIndexOf("/")+1):""},get prefix(){if(this.value.path.length&&this.isFile()){var t=this.basename,e=this.suffix;return t.substr(0,t.length-e.length)}return this.basename},get suffix(){var t=this.value.path.lastIndexOf(".");return this.value.path.lastIndexOf("/")<t?this.value.path.substr(t):""},transform:function(t){var e=!1,i=!1,o="",s="",a="",u="",l=0,h="",c="",d="";if(t.scheme.length)e=t.isLocal(),i=t.isAbsolute(),o=t.scheme,s=t.value.slashs,a=t.authority,u=t.host,l=t.port,h=t.path,c=t.query;else{if(t.authority.length)e=t.isLocal(),i=t.isAbsolute(),a=t.authority,u=t.host,l=t.port,h=t.path,c=t.query;else{if(0===t.path.length){var h=this.value.path;c=t.query.length?t.query:this.value.query}else{if("/"===t.path[0])h=t.path;else{var p=this.base;0===p.path.length?h="/":h+=p.path,h+=t.path}c=t.query}e=this.isLocal(),i=this.isAbsolute()||t.isAbsolute(),a=this.value.authority,u=this.value.host,l=this.value.port}o=this.value.scheme,s=this.value.slashs}return d=t.fragment,new r(e,i,o,s,a,u,l,n(h),c,d)},removeDotSegments:function(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,n(this.value.path),this.value.query,this.value.fragment)},getRelativePath:function(t){if(this.value.scheme!==t.scheme)return t;if(this.value.authority!==t.authority)return t;var i=new e(this.value.path,"/"),n=new e(t.path,"/");return new r(!0,!1,"","","","",0,i.getRelativePath(n).toString(),t.query,t.fragment)},escape:function(){return new r(escape(this.location))},unescape:function(){return new r(unescape(this.location))},toString:function(){var t=this.value.scheme;return this.value.scheme.length&&(t+=":"),t+=this.hierarchy,this.value.query.length&&(t+="?"+this.value.query),this.value.fragment.length&&(t+="#"+this.value.fragment),t}},r}),define("x_ite/Execution/X3DExecutionContext",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Configuration/ComponentInfoArray","x_ite/Execution/ImportedNode","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Networking/URI","standard/Math/Algorithm","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g){"use strict";function m(t){r.call(this,t),this.addChildObjects("rootNodes",new e.MFNode),this.specificationVersion="3.3",this.encoding="SCRIPTED",this.profile=null,this.components=new o(this.getBrowser()),this.url=new p(window.location),this.uninitializedNodes=[],this.uninitializedNodes2=[],this.namedNodes={},this.importedNodes={},this.protos=new u,this.externprotos=new a,this.routes=new l,this.routeIndex={}}return m.prototype=t.extend(Object.create(r.prototype),{constructor:m,setup:function(){for(r.prototype.setup.call(this);this.uninitializedNodes.length;){var t=this.uninitializedNodes;this.uninitializedNodes=this.uninitializedNodes2,this.uninitializedNodes2=t;for(var e=0,i=t.length;e<i;++e)t[e].setup();t.length=0}},isMasterContext:function(){return!1},isRootContext:function(){return!1},getSpecificationVersion:function(){return this.specificationVersion},setEncoding:function(t){this.encoding=t},getEncoding:function(){return this.encoding},getWorldURL:function(){return this.getURL().location},setURL:function(t){this.url=t},getURL:function(){return this.url},setProfile:function(t){this.profile=t},getProfile:function(t){return this.profile},addComponent:function(t){this.components.add(t.name,t)},getComponents:function(){return this.components},getUnits:function(){return this.getExecutionContext().getUnits()},createNode:function(t,i){var n=this.getBrowser().supportedNodes[t];if(!n)throw new Error("Unknown node type '"+t+"'.");var r=n.createInstance(this);return!1===i?r:(r.setup(),new e.SFNode(r))},createProto:function(t,e){for(var i=this;;){var n=i.protos[t];if(n)return n.createInstance(this,e);var r=i.externprotos[t];if(r)return r.createInstance(this,e);if(i.isRootContext())break;i=i.getExecutionContext()}throw new Error("Unknown proto or externproto type '"+t+"'.")},addUninitializedNode:function(t){this.uninitializedNodes.push(t)},addNamedNode:function(t,e){if(void 0!==this.namedNodes[t])throw new Error("Couldn't add named node: node named '"+t+"' is already in use.");this.updateNamedNode(t,e)},updateNamedNode:function(t,i){if(!(i instanceof e.SFNode||i instanceof r))throw new Error("Couldn't update named node: node must be of type SFNode.");if(t=String(t),i=new e.SFNode(i instanceof e.SFNode?i.getValue():i),!i.getValue())throw new Error("Couldn't update named node: node IS NULL.");if(i.getValue().getExecutionContext()!==this)throw new Error("Couldn't update named node: node does not belong to this execution context.");if(0===t.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(i.getValue().getName()),this.removeNamedNode(t),i.getValue().setName(t),this.namedNodes[t]=i},removeNamedNode:function(t){delete this.namedNodes[t]},getNamedNode:function(t){var e=this.namedNodes[t];if(!e)throw new Error("Named node '"+t+"' not found.");return e},getUniqueName:function(t){var e=/(_\d+$)/;t=t.replace(e,"");for(var i=t,n=64;n&&(this.namedNodes[i]||0===i.length);){var r=n,o=n<<=1;i=t,i+="_",i+=Math.round(f.random(r,o))}return i},addImportedNode:function(t,e,i){if(void 0===i&&(i=e),this.importedNodes[i])throw new Error("Couldn't add imported node: imported name '"+i+"' already in use.");this.updateImportedNode(t,e,i)},updateImportedNode:function(t,e,i){if(t=c(d.Inline,t),e=String(e),i=void 0===i?e:String(i),!t)throw new Error("Node named is not an Inline node.");if(t.getExecutionContext()!==this)throw new Error("Couldn't update imported node: Inline node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update imported node: exported name is empty.");if(0===i.length)throw new Error("Couldn't update imported node: imported name is empty.");for(var n in this.importedNodes){var r=this.importedNodes[n];if(r.getInlineNode()===t&&r.getExportedName()===e)return delete this.importedNodes[n],this.importedNodes[i]=r,void r.setImportedName(i)}this.removeImportedNode(i),this.importedNodes[i]=new s(this,t,e,i),this.importedNodes[i].setup()},removeImportedNode:function(t){var e=this.importedNodes[t];e&&e.dispose(),delete this.importedNodes[t]},getImportedNode:function(t){var e=this.importedNodes[t];if(e)return e.getExportedNode();throw new Error("Imported node '"+t+"' not found.")},getImportedNodes:function(){return this.importedNodes},getLocalNode:function(t){try{return this.getNamedNode(t)}catch(n){var i=this.importedNodes[t];if(i)return new e.SFNode(i);throw new Error("Unknown named or imported node '"+t+"'.")}},getLocalName:function(t){if(!(t instanceof e.SFNode))throw new Error("Couldn't get local name: node is NULL.");if(t.getValue().getExecutionContext()===this)return t.getValue().getName();for(var i in this.importedNodes)try{if(this.importedNodes[i].getExportedNode()===t)return i}catch(t){}throw new Error("Couldn't get local name: node is shared.")},setRootNodes:function(){},getRootNodes:function(){return this.rootNodes_},getProtoDeclaration:function(t){return this.protos.get(t)},getProtoDeclarations:function(){return this.protos},getExternProtoDeclaration:function(t){return this.externprotos.get(t)},getExternProtoDeclarations:function(){return this.externprotos},addRoute:function(t,i,n,r){if(i=String(i),r=String(r),!(t instanceof e.SFNode))throw new Error("Bad ROUTE specification: source node must be of type SFNode.");if(!(n instanceof e.SFNode))throw new Error("Bad ROUTE specification: destination node must be of type SFNode.");if(t=t.getValue(),n=n.getValue(),!t)throw new Error("Bad ROUTE specification: source node is NULL.");if(!n)throw new Error("Bad ROUTE specification: destination node is NULL.");var o=t instanceof s?t:null,a=n instanceof s?n:null;try{t.getExecutionContext()!==this&&(o=this.getLocalNode(this.getLocalName(t)))}catch(t){}try{n.getExecutionContext()!==this&&(a=this.getLocalNode(this.getLocalName(n)))}catch(t){}if(o instanceof s&&o.addRoute(o,i,n,r),a instanceof s&&a.addRoute(t,i,a,r),o!==t&&a!==n)return this.addSimpleRoute(t,i,n,r)},addSimpleRoute:function(t,e,i,n){try{if(e=t.getField(e),n=i.getField(n),!e.isOutput())throw new Error("Field named '"+e.getName()+"' in node named '"+t.getName()+"' of type "+t.getTypeName()+" is not an output field.");if(!n.isInput())throw new Error("Field named '"+n.getName()+"' in node named '"+i.getName()+"' of type "+i.getTypeName()+" is not an input field.");if(e.getType()!==n.getType())throw new Error("ROUTE types "+e.getTypeName()+" and "+n.getTypeName()+" do not match.");var r=e.getId()+"."+n.getId();if(this.routeIndex[r])return this.routeIndex[r];var o=new h(this,t,e,i,n);return o.setup(),this.routes.getValue().push(o),this.routeIndex[r]=o,o}catch(t){throw new Error("Bad ROUTE specification: "+t.message)}},deleteRoute:function(t){try{var e=t._sourceField,i=t._destinationField,n=e.getId()+"."+i.getId(),r=this.routes.getValue().indexOf(t);t.disconnect(),-1!==r&&this.routes.getValue().splice(r,1),delete this.routeIndex[n]}catch(t){console.log(t)}},getRoute:function(t,e,i,n){if(!t.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!i.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");var e=t.getValue().getField(e),n=i.getValue().getField(n),r=e.getId()+"."+n.getId();return this.routeIndex[r]},getRoutes:function(){return this.routes},changeViewpoint:function(t){try{var e=this.getNamedNode(t),i=c(d.X3DViewpointNode,e);if(!i)throw 1;i.isBound_.getValue()?i.transitionStart(i):i.set_bind_=!0}catch(e){if(this.isRootContext())throw new Error("Viewpoint named '"+t+"' not found.");this.getExecutionContext().changeViewpoint(t)}},toXMLStream:function(t){var e=g.Get(t);e.PushExecutionContext(this),e.EnterScope(),e.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toXMLStream(t),this.getProtoDeclarations().toXMLStream(t);var i=this.getRootNodes();i.length&&(i.toXMLStream(t),t.string+="\n");var n=this.getImportedNodes();for(var r in n)try{n[r].toXMLStream(t),t.string+="\n"}catch(t){}this.getRoutes().toXMLStream(t),e.LeaveScope(),e.PopExecutionContext()}}),Object.defineProperty(m.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(m.prototype,"units",{get:function(){return this.getUnits()},enumerable:!0,configurable:!1}),Object.defineProperty(m.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(t){this.setRootNodes(t)},enumerable:!0,configurable:!1}),m}),define("x_ite/Configuration/UnitInfo",["jquery","x_ite/InputOutput/Generator"],function(t,e){"use strict";function i(t,e,i){Object.defineProperty(this,"category",{value:t,writable:!1}),this.name=e,this.conversionFactor=i}return t.extend(i.prototype,{constructor:i,toXMLStream:function(t){var i=e.Get(t);t.string+=i.Indent(),t.string+="<unit",t.string+=" ",t.string+="category='",t.string+=this.category,t.string+="'",t.string+=" ",t.string+="name='",t.string+=i.XMLEncode(this.name),t.string+="'",t.string+=" ",t.string+="conversionFactor='",t.string+=this.conversionFactor,t.string+="'",t.string+="/>"}}),Object.defineProperty(i.prototype,"conversion_factor",{get:function(){return this.conversionFactor},enumerable:!0,configurable:!1}),i}),define("x_ite/Configuration/UnitInfoArray",["jquery","x_ite/Configuration/X3DInfoArray"],function(t,e){"use strict";function i(){return e.call(this)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Execution/ExportedNode",["jquery","x_ite/Fields","x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],function(t,e,i,n){"use strict";function r(t,e){i.call(this),this.exportedName=t,this.localNode=e}return r.prototype=t.extend(Object.create(i.prototype),{constructor:r,getExportedName:function(){return this.exportedName},getLocalNode:function(){return new e.SFNode(this.localNode)},toXMLStream:function(t){var e=n.Get(t),i=e.LocalName(this.localNode);t.string+=e.Indent(),t.string+="<EXPORT",t.string+=" ",t.string+="localDEF='",t.string+=e.XMLEncode(i),t.string+="'",this.exportedName!==i&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this.exportedName),t.string+="'"),t.string+="/>"}}),r}),define("x_ite/Execution/X3DScene",["jquery","x_ite/Fields","x_ite/Execution/X3DExecutionContext","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/ExportedNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){i.call(this,t),this.getRootNodes().setAccessType(s.inputOutput),this.unitArray=new r,this.unitArray.add("angle",new n("angle","radian",1)),this.unitArray.add("force",new n("force","newton",1)),this.unitArray.add("length",new n("length","metre",1)),this.unitArray.add("mass",new n("mass","kilogram",1)),this.metadata={},this.exportedNodes={},this.setLive(!1)}return u.prototype=t.extend(Object.create(i.prototype),{constructor:u,isMasterContext:function(){return this===this.getExecutionContext()},isRootContext:function(){return!0},getScene:function(){return this.isMasterContext()?this:this.getExecutionContext().getScene()},updateUnit:function(t,e,i){var n=this.unitArray.get(t);n&&(n.name=e,n.conversionFactor=i)},getUnits:function(){return this.unitArray},fromUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e*this.getUnits().get(t).conversionFactor;case"acceleration:":return e*this.getUnits().get("length").conversionFactor;case"angularRate":return e*this.getUnits().get("angle").conversionFactor;case"area":return e*Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return e*this.getUnits().get("length").conversionFactor;case"volume":return e*Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},toUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e/this.getUnits().get(t).conversionFactor;case"acceleration:":return e/this.getUnits().get("length").conversionFactor;case"angularRate":return e/this.getUnits().get("angle").conversionFactor;case"area":return e/Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return e/this.getUnits().get("length").conversionFactor;case"volume":return e/Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},setMetaData:function(t,e){t.length&&(this.metadata[t]=String(e))},removeMetaData:function(t){delete this.metadata[t]},getMetaData:function(t){return this.metadata[t]},getMetadata:function(){return t.extend({},this.metadata)},addExportedNode:function(t,e){if(this.exportedNodes[t])throw new Error("Couldn't add exported node: exported name '"+t+"' already in use.");this.updateExportedNode(t,e)},updateExportedNode:function(t,i){if(t=String(t),0===t.length)throw new Error("Couldn't update exported node: node exported name is empty.");if(!(i instanceof e.SFNode))throw new Error("Couldn't update exported node: node must be of type SFNode.");if(!i.getValue())throw new Error("Couldn't update exported node: node IS NULL.");this.exportedNodes[t]=new o(t,i.getValue())},removeExportedNode:function(t){delete this.exportedNodes[t]},getExportedNode:function(t){var e=this.exportedNodes[t];if(e)return e.getLocalNode();throw new Error("Exported node '"+t+"' not found.")},getExportedNodes:function(){return this.exportedNodes},addRootNode:function(t){if(!(t instanceof e.SFNode||null===t))throw new Error("Couldn't add root node: node must be of type SFNode.");this.getRootNodes().push(t)},removeRootNode:function(t){if(!(t instanceof e.SFNode||null===t))throw new Error("Couldn't remove root node: node must be of type SFNode.");var i=this.getRootNodes(),n=i.length;i.erase(i.remove(0,n,t),n)},setRootNodes:function(t){this.getRootNodes().setValue(t)},toXMLStream:function(t){var e=a.Get(t),n=this.getSpecificationVersion();"2.0"===n&&(n="3.3"),t.string+='<?xml version="1.0" encoding="UTF-8"?>\n',t.string+='<!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D ',t.string+=n,t.string+='//EN" "http://www.web3d.org/specifications/x3d-',t.string+=n,t.string+='.dtd">\n',t.string+="<X3D",t.string+=" ",t.string+="profile='",t.string+=this.getProfile()?this.getProfile().name:"Full",t.string+="'",t.string+=" ",t.string+="version='",t.string+=n,t.string+="'",t.string+=" ",t.string+="xmlns:xsd='http://www.w3.org/2001/XMLSchema-instance'",t.string+=" ",t.string+="xsd:noNamespaceSchemaLocation='http://www.web3d.org/specifications/x3d-",t.string+=n,t.string+=".xsd'>\n",e.IncIndent(),t.string+=e.Indent(),t.string+="<head>\n",e.IncIndent(),this.getComponents().toXMLStream(t);for(var r=this.getUnits(),o=0,s=r.length;o<s;++o){var u=r[o];1!==u.conversionFactor&&(u.toXMLStream(t),t.string+="\n")}var l=this.metadata;for(var h in l)t.string+=e.Indent(),t.string+="<meta",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(h),t.string+="'",t.string+=" ",t.string+="content='",t.string+=e.XMLEncode(l[h]),t.string+="'",t.string+="/>\n";e.DecIndent(),t.string+=e.Indent(),t.string+="</head>\n",t.string+=e.Indent(),t.string+="<Scene>\n",e.IncIndent();var c=this.getExportedNodes();e.PushExecutionContext(this),e.EnterScope(),e.ExportedNodes(c),i.prototype.toXMLStream.call(this,t);for(var d in c)c[d].toXMLStream(t),t.string+="\n";e.LeaveScope(),e.PopExecutionContext(),e.DecIndent(),t.string+=e.Indent(),t.string+="</Scene>\n",e.DecIndent(),t.string+="</X3D>\n"}}),u}),define("x_ite/Execution/Scene",["jquery","x_ite/Fields","x_ite/Execution/X3DScene"],function(t,e,i){"use strict";function n(t){this._browser=t,i.call(this,this),this.addChildObjects("initLoadCount",new e.SFInt32,"loadCount",new e.SFInt32),this.loadingObjects={}}return n.prototype=t.extend(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"Scene"},setExecutionContext:function(t){if(!this.isMasterContext()){var e=this.getScene(),n=this.loadingObjects;for(var r in n)e.removeLoadCount(n[r])}if(i.prototype.setExecutionContext.call(this,t),!this.isMasterContext()){var e=this.getScene(),n=this.loadingObjects;for(var r in n)e.addLoadCount(n[r])}},addInitLoadCount:function(t){this.initLoadCount_=this.initLoadCount_.getValue()+1},removeInitLoadCount:function(t){this.initLoadCount_=this.initLoadCount_.getValue()-1},addLoadCount:function(t){var e=t.getId();this.loadingObjects.hasOwnProperty(e)||(this.loadingObjects[e]=t,this.loadCount_=this.loadCount_.getValue()+1,this===this.getBrowser().getExecutionContext()&&this.getBrowser().addLoadCount(t),this.isMasterContext()||this.getScene().addLoadCount(t))},removeLoadCount:function(t){var e=t.getId();this.loadingObjects.hasOwnProperty(e)&&(delete this.loadingObjects[e],this.loadCount_=this.loadCount_.getValue()-1,this===this.getBrowser().getExecutionContext()&&this.getBrowser().removeLoadCount(t),this.isMasterContext()||this.getScene().removeLoadCount(t))},getLoadingObjects:function(){return this.loadingObjects}}),n}),define("x_ite/Parser/X3DParser",[],function(){"use strict";function t(t){this.scene=t,this.executionContexts=[t],this.units=!0}return t.prototype={constructor:t,getScene:function(){return this.scene},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts[this.executionContexts.length-1]},pushExecutionContext:function(t){return this.executionContexts.push(t)},popExecutionContext:function(){this.executionContexts.pop()},isInsideProtoDefinition:function(){return this.executionContexts.length>1},addRootNode:function(t){this.getExecutionContext().rootNodes.push(t)},setUnits:function(t){if("boolean"==typeof arguments[0])return void(this.units=arguments[0]);var e=/Titania\s+V(\d+).*/,i=t.match(e);if(i){if(parseInt(i[1])<4)return void(this.units=!1)}this.units=!0},getUnits:function(){return this.units},fromUnit:function(t,e){return this.units?this.getExecutionContext().fromUnit(t,e):e}},t}),define("x_ite/Components/Networking/X3DUrlObject",["jquery","x_ite/Fields","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){this.addType(i.X3DUrlObject),this.addChildObjects("loadState",new e.SFInt32(i.NOT_STARTED_STATE))}return n.prototype={constructor:n,initialize:function(){},setLoadState:function(t,e){this.loadState_=t,this.getScene().removeLoadCount(this),!1!==e&&t===i.IN_PROGRESS_STATE&&this.getScene().addLoadCount(this)},checkLoadState:function(){return this.loadState_.getValue()}},n}),define("x_ite/Components/Core/X3DNode",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getLayers:function(){return this.findParents(i.X3DLayerNode,this)},findParents:function(t,e){var i=e.getParents(),n=[],r={};for(var o in i)this.findParentsImpl(t,i[o],n,r);return n},findParentsImpl:function(t,n,r,o){if(!o.hasOwnProperty(n.getId())){if(o[n.getId()]=!0,n instanceof e){for(var s=n.getType(),a=s.length-1;a>=0;--a){switch(s[a]){case i.X3DProtoDeclarationNode:case i.X3DNode:break;case i.LayerSet:case i.X3DBaseNode:case i.X3DMetadataObject:case i.X3DProgrammableShaderObject:case i.X3DScriptNode:return;default:continue}break}if(-1!==n.getType().indexOf(t))return void r.push(n)}var u=n.getParents();for(var l in u)this.findParentsImpl(t,u[l],r,o)}}}),n}),define("x_ite/Components/Core/X3DPrototypeInstance",["jquery","x_ite/Basic/FieldDefinitionArray","x_ite/Fields","x_ite/Base/X3DChildObject","x_ite/Components/Core/X3DNode","x_ite/Execution/X3DExecutionContext","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a){"use strict";function u(t,i){this.protoNode=i,this.fieldDefinitions=new e(i.getFieldDefinitions().getValue().slice()),r.call(this,t),o.call(this,t),this.addType(s.X3DPrototypeInstance),this.getRootNodes().setAccessType(s.initializeOnly),this.getScene().addInitLoadCount(this),i.isExternProto?i.requestAsyncLoad(this.construct.bind(this)):this.construct()}return u.prototype=t.extend(Object.create(o.prototype),r.prototype,{constructor:u,create:function(t){return new u(t,this.protoNode)},getTypeName:function(){return this.protoNode.getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},construct:function(){this.getScene().removeInitLoadCount(this);var t=this.protoNode.getProtoDeclaration();if(t){if(this.metadata_.getSet()||(this.metadata_=t.metadata_),this.protoNode.isExternProto)for(var e=t.getFieldDefinitions(),i=0,r=e.length;i<r;++i)try{var o=e[i],a=this.getField(o.name),u=t.getField(o.name);if(a.getAccessType()!==u.getAccessType())continue
;if(a.getType()!==u.getType())continue;if(!(a.getAccessType()&s.initializeOnly))continue;if(a.getSet())continue;if(a.hasReferences())continue;a.setValue(u.getValue())}catch(t){this.addField(o)}this.setURL(t.getURL()),this.importExternProtos(t.externprotos),this.importProtos(t.protos),this.copyRootNodes(t.rootNodes),this.isInitialized()&&(this.setup(),n.prototype.addEvent.call(this))}},setup:function(){r.prototype.setup.call(this),o.prototype.setup.call(this)},initialize:function(){try{var t=this.protoNode.getProtoDeclaration();t&&(this.copyImportedNodes(t,t.importedNodes),this.copyRoutes(t,t.routes)),r.prototype.initialize.call(this),o.prototype.initialize.call(this)}catch(t){console.error(t.message)}},getInnerNode:function(){var t=this.getRootNodes().getValue();if(t.length){var e=t[0];if(e)return e.getValue().getInnerNode()}throw new Error("Root node not available.")},fromUnit:function(t,e){return this.protoNode.getProtoDeclaration().fromUnit(t,e)},toUnit:function(t,e){return this.protoNode.getProtoDeclaration().toUnit(t,e)},getExtendedEventHandling:function(){return!1},importExternProtos:function(t){for(var e=0,i=t.length;e<i;++e)this.externprotos.add(t[e].getName(),t[e])},importProtos:function(t){for(var e=0,i=t.length;e<i;++e)this.protos.add(t[e].getName(),t[e])},copyRootNodes:function(t){for(var e=t.getValue(),i=this.getRootNodes().getValue(),n=0,r=e.length;n<r;++n){var o=e[n].copy(this);o.addParent(this.getRootNodes()),i.push(o)}},copyImportedNodes:function(t,e){for(var i in e)try{var n=e[i],r=this.getNamedNode(n.getInlineNode().getName()),o=n.getExportedName(),i=n.getImportedName();this.addImportedNode(r,o,i)}catch(t){console.error("Bad IMPORT specification in copy: ",t)}},copyRoutes:function(t,e){for(var i=0,n=e.length;i<n;++i)try{var r=e[i],o=this.getLocalNode(t.getLocalName(r.sourceNode)),s=this.getLocalNode(t.getLocalName(r.destinationNode));this.addRoute(o,r.sourceField,s,r.destinationField)}catch(t){console.log(t)}},toXMLStream:function(e){var i=a.Get(e);if(i.IsSharedNode(this))return e.string+=i.Indent(),void(e.string+="\x3c!-- NULL --\x3e");i.EnterScope();var n=i.Name(this);if(n.length&&i.ExistsNode(this)){e.string+=i.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(this.getTypeName()),e.string+="'",e.string+=" ",e.string+="USE='",e.string+=i.XMLEncode(n),e.string+="'";var r=i.ContainerField();return r&&r.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=i.XMLEncode(r.getName()),e.string+="'"),e.string+="/>",void i.LeaveScope()}e.string+=i.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(this.getTypeName()),e.string+="'",n.length&&(i.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=i.XMLEncode(n),e.string+="'");var r=i.ContainerField();r&&r.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=i.XMLEncode(r.getName()),e.string+="'");var o=this.getChangedFields(),u=this.metadata_;try{u=this.getField("metadata")}catch(t){}if(u===this.metadata_&&(o=o.filter(function(t){return t!==this.metadata_}.bind(this))),0!==o.length||(this.metadata_,0)){e.string+=">\n",i.IncIndent();for(var l=[],h=0,c=o.length;h<c;++h){var d=o[h],p=!1;if(i.ExecutionContext()&&d.getAccessType()===s.inputOutput&&!t.isEmptyObject(d.getReferences())){var f=!1,g=d.getReferences();for(var m in g)f|=g[m].isInitializable();f||(p=!0)}if(t.isEmptyObject(d.getReferences())||!i.ExecutionContext()||p)switch(p&&l.push(d),d.getType()){case s.MFNode:e.string+=i.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(d.getName()),e.string+="'",0===d.length?e.string+="/>\n":(e.string+=">\n",i.IncIndent(),d.toXMLStream(e),e.string+="\n",i.DecIndent(),e.string+=i.Indent(),e.string+="</fieldValue>\n");break;case s.SFNode:if(null!==d.getValue()){e.string+=i.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(d.getName()),e.string+="'",e.string+=">\n",i.IncIndent(),d.toXMLStream(e),e.string+="\n",i.DecIndent(),e.string+=i.Indent(),e.string+="</fieldValue>\n";break}default:e.string+=i.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(d.getName()),e.string+="'",e.string+=" ",e.string+="value='",d.toXMLStream(e),e.string+="'",e.string+="/>\n"}else l.push(d)}if(l.length){e.string+=i.Indent(),e.string+="<IS>",e.string+="\n",i.IncIndent();for(var h=0,c=l.length;h<c;++h){var d=l[h],x=d.getReferences();for(var m in x){var y=x[m];e.string+=i.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=i.XMLEncode(d.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=i.XMLEncode(y.getName()),e.string+="'",e.string+="/>\n"}}i.DecIndent(),e.string+=i.Indent(),e.string+="</IS>\n"}u===this.metadata_&&u.getValue()&&(u.toXMLStream(e),e.string+="\n"),i.DecIndent(),e.string+=i.Indent(),e.string+="</ProtoInstance>"}else e.string+="/>";i.LeaveScope()}}),u}),define("x_ite/Prototype/X3DProtoDeclarationNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Bits/X3DConstants"],function(t,e,i,n,r){"use strict";function o(t){i.call(this,t),this.addType(r.X3DProtoDeclarationNode)}return o.prototype=t.extend(Object.create(i.prototype),{constructor:o,hasUserDefinedFields:function(){return!0},createInstance:function(t,i){var r=new n(t,this);return!1===i?r:(r.setup(),new e.SFNode(r))},newInstance:function(){return this.createInstance(this.getExecutionContext())}}),o}),define("x_ite/Prototype/X3DExternProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DUrlObject","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a){"use strict";function u(){}function l(i){o.call(this,i),r.call(this,i),this.addType(s.X3DExternProtoDeclaration),this.addChildObjects("url",new e.MFString),this.deferred=t.Deferred()}return l.prototype=t.extend(Object.create(o.prototype),r.prototype,{constructor:l,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode)]),getTypeName:function(){return"EXTERNPROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"externprotos"},initialize:function(){o.prototype.initialize.call(this),r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},set_live__:function(){this.checkLoadState()===s.COMPLETE_STATE&&this.scene.setLive(this.isLive().getValue())},hasUserDefinedFields:function(){return!0},setProtoDeclaration:function(t){if(this.proto=t,this.proto)for(var e=this.getFieldDefinitions(),i=t.getFieldDefinitions(),n=0,r=i.length;n<r;++n){var o=i[n],s=e.get(o.name);s&&s.value.setValue(o.value)}},getProtoDeclaration:function(){return this.proto},loadNow:function(t){this.requestAsyncLoad(t||u)},requestAsyncLoad:function(t){if(this.deferred.done(t),this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE){this.setLoadState(s.IN_PROGRESS_STATE),this.getScene().addInitLoadCount(this);new(require("x_ite/InputOutput/FileLoader"))(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this))}},setInternalSceneAsync:function(t){this.getScene().removeInitLoadCount(this),t?this.setInternalScene(t):this.setError()},setInternalScene:function(t){this.scene=t,this.setLoadState(s.COMPLETE_STATE),this.scene.setLive(this.isLive().getValue()),this.scene.setPrivate(this.getScene().getPrivate()),this.scene.setup();var e=this.scene.getURL().fragment||0;this.setProtoDeclaration(this.scene.protos[e]),this.deferred.resolve()},getInternalScene:function(){return this.scene},setError:function(e){console.error("Error loading extern prototype:",e),this.setLoadState(s.FAILED_STATE),this.scene=this.getBrowser().getPrivateScene(),this.setProtoDeclaration(null),this.deferred.resolve(),this.deferred=t.Deferred()},toXMLStream:function(t){var e=a.Get(t);t.string+=e.Indent(),t.string+="<ExternProtoDeclare",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getName()),t.string+="'",t.string+=" ",t.string+="url='",this.url_.toXMLStream(t),t.string+="'",t.string+=">\n",e.IncIndent();var i=this.getUserDefinedFields();for(var n in i){var r=i[n];t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(r.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=r.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(r.getName()),t.string+="'",t.string+="/>\n"}e.DecIndent(),t.string+=e.Indent(),t.string+="</ExternProtoDeclare>"}}),Object.defineProperty(l.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"isExternProto",{get:function(){return!0},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"urls",{get:function(){return this.url_.copy()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"loadState",{get:function(){return this.checkLoadState()},enumerable:!0,configurable:!1}),l}),define("x_ite/Prototype/X3DProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Execution/X3DExecutionContext","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){o.call(this,t),r.call(this,t),this.addType(s.X3DProtoDeclaration),this.addChildObjects("loadState",new e.SFInt32(s.NOT_STARTED_STATE))}return u.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode)]),getTypeName:function(){return"PROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"protos"},initialize:function(){o.prototype.initialize.call(this),this.loadState_=s.COMPLETE_STATE},getURL:function(){return this.getExecutionContext().getURL()},getProtoDeclaration:function(){return this},checkLoadState:function(){return this.loadState_.getValue()},fromUnit:function(t,e){return this.getExecutionContext().fromUnit(t,e)},toUnit:function(t,e){return this.getExecutionContext().toUnit(t,e)},hasUserDefinedFields:function(){return!0},toXMLStream:function(e){var i=a.Get(e);e.string+=i.Indent(),e.string+="<ProtoDeclare",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(this.getName()),e.string+="'",e.string+=">",e.string+="\n",i.EnterScope();var n=this.getUserDefinedFields();if(!t.isEmptyObject(n)){i.IncIndent(),e.string+=i.Indent(),e.string+="<ProtoInterface>\n",i.IncIndent();for(var o in n){var u=n[o];if(e.string+=i.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=i.AccessType(u.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=u.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(u.getName()),e.string+="'",u.isDefaultValue())e.string+="/>\n";else switch(u.getType()){case s.SFNode:case s.MFNode:i.PushContainerField(null),e.string+=">\n",i.IncIndent(),u.toXMLStream(e),e.string+="\n",i.DecIndent(),e.string+=i.Indent(),e.string+="</field>\n",i.PopContainerField();break;default:e.string+=" ",e.string+="value='",u.toXMLStream(e),e.string+="'",e.string+="/>\n"}}i.DecIndent(),e.string+=i.Indent(),e.string+="</ProtoInterface>\n",i.DecIndent()}i.LeaveScope(),i.IncIndent(),e.string+=i.Indent(),e.string+="<ProtoBody>\n",i.IncIndent(),r.prototype.toXMLStream.call(this,e),i.DecIndent(),e.string+=i.Indent(),e.string+="</ProtoBody>\n",i.DecIndent(),e.string+=i.Indent(),e.string+="</ProtoDeclare>"}}),Object.defineProperty(u.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"isExternProto",{get:function(){return!1},enumerable:!0,configurable:!1}),u}),define("x_ite/Parser/Parser",["jquery","x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){switch(t){case o.inializeOnly:return"initializeOnly";case o.inputOnly:return"inputOnly";case o.outputOnly:return"outputOnly";case o.inputOutput:return"inputOutput"}}function a(t){return this.lastIndex=0,t.result=this.exec(t.input),!!t.result&&(t.input=t.input.slice(t.result[0].length),!0)}function u(t,e){i.call(this,t),this.isXML=e}var l={Whitespaces:/^([\x20\n,\t\r]+)/,Comment:/^#(.*?)(?=[\n\r])/,Header:/^#(VRML|X3D) V(.*?) (utf8)(?: (.*?))?[\n\r]/,AS:/^AS/,COMPONENT:/^COMPONENT/,DEF:/^DEF/,EXPORT:/^EXPORT/,EXTERNPROTO:/^EXTERNPROTO/,FALSE:/^FALSE/,false:/^false/,IMPORT:/^IMPORT/,IS:/^IS/,META:/^META/,NULL:/^NULL/,TRUE:/^TRUE/,true:/^true/,PROFILE:/^PROFILE/,PROTO:/^PROTO/,ROUTE:/^ROUTE/,TO:/^TO/,UNIT:/^UNIT/,USE:/^USE/,OpenBrace:/^\{/,CloseBrace:/^\}/,OpenBracket:/^\[/,CloseBracket:/^\]/,Period:/^\./,Colon:/^\:/,Id:/^([^\x30-\x39\x00-\x20\x22\x23\x27\x2b\x2c\x2d\x2e\x5b\x5c\x5d\x7b\x7d\x7f]{1}[^\x00-\x20\x22\x23\x27\x2c\x2e\x5b\x5c\x5d\x7b\x7d\x7f]*)/,ComponentNameId:/^([^\x30-\x39\x00-\x20\x22\x23\x27\x2b\x2c\x2d\x2e\x5b\x5c\x5d\x7b\x7d\x7f\x3a]{1}[^\x00-\x20\x22\x23\x27\x2c\x2e\x5b\x5c\x5d\x7b\x7d\x7f\x3a]*)/,initializeOnly:/^initializeOnly/,inputOnly:/^inputOnly/,outputOnly:/^outputOnly/,inputOutput:/^inputOutput/,field:/^field/,eventIn:/^eventIn/,eventOut:/^eventOut/,exposedField:/^exposedField/,FieldType:/^(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)/,int32:/^((?:0[xX][\da-fA-F]+)|(?:[+-]?\d+))/,double:/^([+-]?(?:(?:(?:\d*\.\d+)|(?:\d+(?:\.)?))(?:[eE][+-]?\d+)?))/,string:/^"((?:[^"\\]|\\\\|\\")*)"/,Inf:/^[+]?inf/i,NegativeInf:/^-inf/i,NaN:/^[+-]?nan/i,Break:/\r?\n/g};for(var h in l)l[h].parse=a;return Object.preventExtensions(l),Object.freeze(l),Object.seal(l),u.prototype=t.extend(Object.create(i.prototype),{accessTypes:{field:o.initializeOnly,eventIn:o.inputOnly,eventOut:o.outputOnly,exposedField:o.inputOutput,initializeOnly:o.initializeOnly,inputOnly:o.inputOnly,outputOnly:o.outputOnly,inputOutput:o.inputOutput},SFBool:new e.SFBool,SFColor:new e.SFColor,SFColorRGBA:new e.SFColorRGBA,SFDouble:new e.SFDouble,SFFloat:new e.SFFloat,SFImage:new e.SFImage,SFInt32:new e.SFInt32,SFMatrix3f:new e.SFMatrix3f,SFMatrix3d:new e.SFMatrix3d,SFMatrix4f:new e.SFMatrix4f,SFMatrix4d:new e.SFMatrix4d,SFNode:new e.SFNode,SFRotation:new e.SFRotation,SFString:new e.SFString,SFTime:new e.SFTime,SFVec2d:new e.SFVec2d,SFVec2f:new e.SFVec2f,SFVec3d:new e.SFVec3d,SFVec3f:new e.SFVec3f,SFVec4d:new e.SFVec4d,SFVec4f:new e.SFVec4f,MFBool:new e.MFBool,MFColor:new e.MFColor,MFColorRGBA:new e.MFColorRGBA,MFDouble:new e.MFDouble,MFFloat:new e.MFFloat,MFImage:new e.MFImage,MFInt32:new e.MFInt32,MFMatrix3d:new e.MFMatrix3d,MFMatrix3f:new e.MFMatrix3f,MFMatrix4d:new e.MFMatrix4d,MFMatrix4f:new e.MFMatrix4f,MFNode:new e.MFNode,MFRotation:new e.MFRotation,MFString:new e.MFString,MFTime:new e.MFTime,MFVec2d:new e.MFVec2d,MFVec2f:new e.MFVec2f,MFVec3d:new e.MFVec3d,MFVec3f:new e.MFVec3f,MFVec4d:new e.MFVec4d,MFVec4f:new e.MFVec4f,setInput:function(t){this.input=t,this.lineNumber=1,this.lastIndex=0},exception:function(t){if(this.getBrowser().isStrict())throw new Error(t);this.getBrowser().println(t)},parseIntoScene:function(t){try{return this.getScene().setEncoding("VRML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.setInput(t),void this.x3dScene()}catch(t){throw new Error(this.getError(t))}},getError:function(t){var e=t.message,i=this.getLine(),n=this.getLastLine(),r=this.getLastLine(),o=n.length-i.length+1;return n.length>80&&(n=n.substr(o-40,80),r="",o=40),"\n********************************************************************************\nParser error at line "+this.lineNumber+":"+o+"\nin '"+this.getScene().getURL()+"'\n\n"+r+"\n"+n+"\n"+Array(o).join(" ")+"^\n"+e+"\n********************************************************************************\n"},getLine:function(){for(var t=this.input,e=this.lastIndex,i="";e<t.length&&"\n"!==t[e]&&"\r"!==t[e];)i+=t[e++];return this.lastIndex=e,i},getLastLine:function(){var t=this.input,e=this.lastIndex,i="";for(e<t.length&&("\n"!==t[e]||"\r"!==t[e])&&--e;e>=0&&"\n"!==t[e]&&"\r"!==t[e];)i=t[e--]+i;return this.lastIndex=e,i},comments:function(){for(;this.comment(););},comment:function(){return!!this.whitespaces()||l.Comment.parse(this)},whitespaces:function(){return!!l.Whitespaces.parse(this)&&(this.xml||this.lines(this.result[1]),!0)},lines:function(t){var e=t.match(l.Break);e&&(this.lineNumber+=e.length)},x3dScene:function(){this.pushExecutionContext(this.getScene()),this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements();try{this.setUnits(this.getScene().getMetaData("generator"))}catch(t){}if(this.statements(),this.popExecutionContext(this.getScene()),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){var t=l.Header.exec(this.input);return!!t&&(this.getScene().specificationVersion=t[2],this.getScene().encoding="VRML",!0)},profileStatement:function(){if(this.comments(),l.PROFILE.parse(this)){if(this.profileNameId()){var t=this.getBrowser().getProfile(this.result[1]);return void this.getScene().setProfile(t)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var t=this.componentStatement();t;)this.getScene().addComponent(t),t=this.componentStatement()},componentStatement:function(){if(this.comments(),l.COMPONENT.parse(this)){if(this.componentNameId()){var t=this.result[1];if(this.comments(),l.Colon.parse(this)){if(this.componentSupportLevel()){var e=this.value;return this.getBrowser().getComponent(t,e)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),l.UNIT.parse(this)){if(this.categoryNameId()){var t=this.result[1];if(this.unitNameId()){var e=this.result[1];if(this.unitConversionFactor()){var i=this.value;try{return this.getScene().updateUnit(t,e,i),!0}catch(t){return console.log(t.message),!0}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identificator.")}throw new Error("Expected category name identificator after UNIT statement.")}return!1},unitConversionFactor:function(){return this.double()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),l.META.parse(this)){if(this.metakey()){var t=this.value;if(this.metavalue()){var e=this.value;return this.getScene().setMetaData(t,e),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){if(this.comments(),l.EXPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e="";this.comments();var i=this.getScene().getLocalNode(t);if(l.AS.parse(this)){if(!this.exportedNodeNameId())throw new Error("No name given after AS.");e=this.result[1]}else e=t;return this.getScene().updateExportedNode(e,i),!0}throw new Error("No name given after EXPORT.")}return!1},importStatement:function(){if(this.comments(),l.IMPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getNamedNode(t);if(this.comments(),l.Period.parse(this)){if(this.exportedNodeNameId()){var i=this.result[1],n=i;if(this.comments(),l.AS.parse(this)){if(!this.nodeNameId())throw new Error("No name given after AS.");n=this.result[1]}return this.getExecutionContext().updateImportedNode(e,i,n),!0}throw new Error("Expected exported node name.")}throw new Error("Expected a '.' after exported node name.")}throw new Error("No name given after IMPORT statement.")}return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var t=this.nodeStatement();return!1!==t&&(this.addRootNode(t),!0)},nodeStatement:function(){if(this.comments(),l.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(l.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]).getValue();throw new Error("No name given after USE.")}return l.NULL.parse(this)?null:this.node("")},protoStatement:function(){return!!this.proto()||!!this.externproto()},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),l.PROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),l.OpenBracket.parse(this)){var e=this.interfaceDeclarations();if(this.comments(),l.CloseBracket.parse(this)){if(this.comments(),l.OpenBrace.parse(this)){for(var i=new r(this.getExecutionContext()),n=0,o=e.length;n<o;++n){var s=e[n];i.addUserDefinedField(s.getAccessType(),s.getName(),s)}if(this.pushExecutionContext(i),this.protoBody(),this.popExecutionContext(),this.comments(),l.CloseBrace.parse(this))return i.setName(t),i.setup(),this.getExecutionContext().protos.add(t,i),!0;throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var t=this.rootNodeStatement();!1!==t&&this.addRootNode(t),this.statements()},rootNodeStatement:function(){if(this.comments(),l.DEF.parse(this)){if(this.nodeNameId()){var t=this.result[0],e=this.node(t);if(!1!==e)return e;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var e=this.node("");return!1!==e&&e},interfaceDeclarations:function(){for(var t=[],e=this.interfaceDeclaration();e;)t.push(e),e=this.interfaceDeclaration();return t},restrictedInterfaceDeclaration:function(){if(this.comments(),l.inputOnly.parse(this)||l.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.inputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(l.outputOnly.parse(this)||l.eventOut.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.outputOnlyId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.outputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(l.initializeOnly.parse(this)||l.field.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.initializeOnlyId()){var e=this.result[1],i=new this[t].constructor;if(this.fieldValue(i))return i.setAccessType(o.initializeOnly),i.setName(e),i;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){var t=this.restrictedInterfaceDeclaration();if(t)return t;if(this.comments(),l.inputOutput.parse(this)||l.exposedField.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOutputId()){var i=this.result[1],t=new this[e].constructor;if(this.fieldValue(t))return t.setAccessType(o.inputOutput),t.setName(i),t;throw new Error("Couldn't read value for field '"+i+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),l.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),l.OpenBracket.parse(this)){var e=this.externInterfaceDeclarations();if(this.comments(),l.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var i=new n(this.getExecutionContext()),r=0,o=e.length;r<o;++r){var s=e[r];i.addUserDefinedField(s.getAccessType(),s.getName(),s)}return i.setName(t),i.url_=this.MFString,i.setup(),this.getExecutionContext().externprotos.add(t,i),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+t+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var t=[],e=this.externInterfaceDeclaration();e;)t.push(e),e=this.externInterfaceDeclaration();return t},externInterfaceDeclaration:function(){if(this.comments(),l.inputOnly.parse(this)||l.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.inputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(l.outputOnly.parse(this)||l.eventOut.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.outputOnlyId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.outputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(l.initializeOnly.parse(this)||l.field.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.initializeOnlyId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.initializeOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(l.inputOutput.parse(this)||l.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var e=this.result[1],i=new this[t].constructor;return i.setAccessType(o.inputOutput),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(t){return this.mfstringValue(t)},routeStatement:function(){if(this.comments(),l.ROUTE.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getLocalNode(t);if(this.comments(),l.Period.parse(this)){if(this.outputOnlyId()){var i=this.result[1];if(this.comments(),l.TO.parse(this)){if(this.nodeNameId()){var n=this.result[1],r=this.getExecutionContext().getLocalNode(n);if(this.comments(),l.Period.parse(this)){if(this.inputOnlyId())try{var o=this.result[1];return this.getExecutionContext().addRoute(e,i,r,o),!0}catch(t){return this.exception(t.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(t){if(this.nodeTypeId()){var e=this.result[1];try{var i=this.getExecutionContext().createNode(e,!1)}catch(t){try{var i=this.getExecutionContext().createProto(e,!1)}catch(e){throw new Error(t.message+"\n"+e.message)}}if(t.length){try{var n=this.getExecutionContext().getNamedNode(t);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(t),n)}catch(t){}this.getExecutionContext().updateNamedNode(t,i)}if(this.comments(),l.OpenBrace.parse(this)){if(i.hasUserDefinedFields()?this.scriptBody(i):this.nodeBody(i),this.comments(),l.CloseBrace.parse(this))return this.getExecutionContext().addUninitializedNode(i),i;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(t){for(;this.scriptBodyElement(t););},scriptBodyElement:function(t){var e=this.input,i=this.lineNumber;if(this.Id()){var n=this.accessTypes[this.result[1]];if(n&&this.fieldType()){var r=this.result[1];if(this.Id()){var a=this.result[1];if(this.comments(),l.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var u=this.result[1];try{var h=this.getExecutionContext().getField(u)}catch(t){return this.exception("No such event or field '"+u+"' inside PROTO "+this.getExecutionContext().getName()+" interface declaration."),!0}var c=this[r];if(c.getType()===h.getType()){if(h.isReference(n)){try{var d=t.getField(a);if(h.getType()===d.getType())if(n===d.getAccessType());else{if(d.getAccessType()!==o.inputOutput)return this.exception("Field '"+a+"' must have access type "+s(d.getAccessType())+"."),!0;n!==d.getAccessType()&&(d=this.createUserDefinedField(t,n,a,c))}else d=this.createUserDefinedField(t,n,a,c)}catch(e){var d=this.createUserDefinedField(t,n,a,c)}return d.addReference(h),!0}throw new Error("Field '"+a+"' and '"+h.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+a+"' and '"+h.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}this.input=e,this.lineNumber=i;var d=this.interfaceDeclaration();if(d){try{if(d.getAccessType()===o.inputOutput){var p=t.getField(d.getName());if(p.getAccessType()===o.inputOutput&&d.getType()===p.getType())return p.set(d.getValue()),p.setSet(!0),!0}}catch(t){}return t.addUserDefinedField(d.getAccessType(),d.getName(),d),!0}return this.nodeBodyElement(t)},createUserDefinedField:function(t,e,i,n){var r=new n.constructor;return t.addUserDefinedField(e,i,r),r},nodeBody:function(t){for(;this.nodeBodyElement(t););},nodeBodyElement:function(t){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var e=this.result[1];try{var i=t.getField(e)}catch(i){throw new Error("Unknown field '"+e+"' in class '"+t.getTypeName()+"'.")}if(this.comments(),l.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var n=this.result[1];try{var r=this.getExecutionContext().getField(n)}catch(t){return this.exception("No such event or field '"+n+"' inside PROTO "+this.getExecutionContext().getName()),!0}if(i.getType()===r.getType()){if(r.isReference(i.getAccessType()))return i.addReference(r),!0;throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(i.isInitializable()){if(this.fieldValue(i))return!0;throw new Error("Couldn't read value for field '"+e+"'.")}
throw new Error("Couldn't assign value to "+s(i.getAccessType())+" field '"+e+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),l.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},exportedNodeNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),l.Id.parse(this)},fieldType:function(){return this.comments(),l.FieldType.parse(this)},fieldValue:function(t){return t.setSet(!0),this.fieldTypes[t.getType()].call(this,t)},double:function(){return this.comments(),l.double.parse(this)?(this.value=parseFloat(this.result[1]),!0):l.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):l.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):!!l.NaN.parse(this)&&(this.value=Number.NaN,!0)},int32:function(){return this.comments(),!!l.int32.parse(this)&&(this.value=parseInt(this.result[1]),!0)},string:function(){return this.comments(),!!l.string.parse(this)&&(this.value=e.SFString.unescape(this.result[1]),this.isXML||this.lines(this.value),!0)},sfboolValue:function(t){if(this.comments(),this.isXML){if(l.true.parse(this))return t.set(!0),!0;if(l.false.parse(this))return t.set(!1),!0}return l.TRUE.parse(this)?(t.set(!0),!0):!!l.FALSE.parse(this)&&(t.set(!1),!0)},mfboolValue:function(t){if(t.length=0,this.sfboolValue(this.SFBool))return t.push(this.SFBool),!0;if(l.OpenBracket.parse(this)){if(this.sfboolValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(t){t.length=0;for(var i=t.getValue(),n=new e.SFBool;this.sfboolValue(n);)n.addParent(t),i.push(n),n=new e.SFBool},sfcolorValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;return t.getValue().set(e,i,n),!0}}}return!1},mfcolorValue:function(t){if(t.length=0,this.sfcolorValue(this.SFColor))return t.push(this.SFColor),!0;if(l.OpenBracket.parse(this)){if(this.sfcolorValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(t){for(t.length=0;this.sfcolorValue(this.SFColor);)t.push(this.SFColor)},sfcolorrgbaValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return t.getValue().set(e,i,n,r),!0}}}}return!1},mfcolorrgbaValue:function(t){if(t.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return t.push(this.SFColorRGBA),!0;if(l.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(t){for(t.length=0;this.sfcolorrgbaValue(this.SFColorRGBA);)t.push(this.SFColorRGBA)},sfdoubleValue:function(t){return!!this.double()&&(t.set(this.fromUnit(t.getUnit(),this.value)),!0)},mfdoubleValue:function(t){if(t.length=0,this.SFDouble.setUnit(t.getUnit()),this.sfdoubleValue(this.SFDouble))return t.push(this.SFDouble),!0;if(l.OpenBracket.parse(this)){if(this.sfdoubleValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(t){for(t.length=0,this.SFDouble.setUnit(t.getUnit());this.sfdoubleValue(this.SFDouble);)t.push(this.SFDouble)},sffloatValue:function(t){return this.sfdoubleValue(t)},mffloatValue:function(t){if(t.length=0,this.SFFloat.setUnit(t.getUnit()),this.sffloatValue(this.SFFloat))return t.push(this.SFFloat),!0;if(l.OpenBracket.parse(this)){if(this.sffloatValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(t){for(t.length=0,this.SFFloat.setUnit(t.getUnit());this.sffloatValue(this.SFFloat);)t.push(this.SFFloat)},sfimageValue:function(t){if(this.int32()){var e=this.value;if(this.int32()){var i=this.value;if(this.int32()){for(var n=this.value,r=[],o=e*i,s=0;s<o;++s){if(!this.int32())return!1;r.push(this.value)}return t.getValue().set(e,i,n,r),!0}}}return!1},mfimageValue:function(t){if(t.length=0,this.sfimageValue(this.SFImage))return t.push(this.SFImage),!0;if(l.OpenBracket.parse(this)){if(this.sfimageValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(t){for(t.length=0;this.sfimageValue(this.SFImage);)t.push(this.SFImage)},sfint32Value:function(t){return!!this.int32()&&(t.set(this.value),!0)},mfint32Value:function(t){if(t.length=0,this.sfint32Value(this.SFInt32))return t.push(this.SFInt32),!0;if(l.OpenBracket.parse(this)){if(this.sfint32Values(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(t){for(t.length=0;this.sfint32Value(this.SFInt32);)t.push(this.SFInt32)},sfmatrix3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;return t.getValue().set(e,i,n,r,o,s,a,u,l),!0}}}}}}}}}return!1},mfmatrix3dValue:function(t){if(t.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return t.push(this.SFMatrix3d),!0;if(l.OpenBracket.parse(this)){if(this.sfmatrix3dValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(t){for(t.length=0;this.sfmatrix3dValue(this.SFMatrix3d);)t.push(this.SFMatrix3d)},sfmatrix3fValue:function(t){return this.sfmatrix3dValue(t)},mfmatrix3fValue:function(t){if(t.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return t.push(this.SFMatrix3f),!0;if(l.OpenBracket.parse(this)){if(this.sfmatrix3fValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(t){for(t.length=0;this.sfmatrix3fValue(this.SFMatrix3f);)t.push(this.SFMatrix3f)},sfmatrix4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;if(this.double()){var h=this.value;if(this.double()){var c=this.value;if(this.double()){var d=this.value;if(this.double()){var p=this.value;if(this.double()){var f=this.value;if(this.double()){var g=this.value;if(this.double()){var m=this.value;return t.getValue().set(e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m),!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(t){if(t.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return t.push(this.SFMatrix4d),!0;if(l.OpenBracket.parse(this)){if(this.sfmatrix4dValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(t){for(t.length=0;this.sfmatrix4dValue(this.SFMatrix4d);)t.push(this.SFMatrix4d)},sfmatrix4fValue:function(t){return this.sfmatrix4dValue(t)},mfmatrix4fValue:function(t){if(t.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return t.push(this.SFMatrix4f),!0;if(l.OpenBracket.parse(this)){if(this.sfmatrix4fValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(t){for(t.length=0;this.sfmatrix4fValue(this.SFMatrix4f);)t.push(this.SFMatrix4f)},sfnodeValue:function(t){var e=this.nodeStatement();return!1!==e&&(t.setValue(e),!0)},mfnodeValue:function(t){t.length=0;var e=this.nodeStatement();if(!1!==e)return t.push(e),!0;if(l.OpenBracket.parse(this)){if(this.nodeStatements(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(t){for(var e=this.nodeStatement();!1!==e;)t.push(e),e=this.nodeStatement()},sfrotationValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return t.getValue().set(e,i,n,this.fromUnit("angle",r)),!0}}}}return!1},mfrotationValue:function(t){if(t.length=0,this.sfrotationValue(this.SFRotation))return t.push(this.SFRotation),!0;if(l.OpenBracket.parse(this)){if(this.sfrotationValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(t){for(t.length=0;this.sfrotationValue(this.SFRotation);)t.push(this.SFRotation)},sfstringValue:function(t){return!!this.string()&&(t.set(this.value),!0)},mfstringValue:function(t){if(t.length=0,this.sfstringValue(this.SFString))return t.push(this.SFString),!0;if(l.OpenBracket.parse(this)){if(this.sfstringValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(t){for(t.length=0;this.sfstringValue(this.SFString);)t.push(this.SFString)},sftimeValue:function(t){return this.sfdoubleValue(t)},mftimeValue:function(t){if(t.length=0,this.sftimeValue(this.SFTime))return t.push(this.SFTime),!0;if(l.OpenBracket.parse(this)){if(this.sftimeValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(t){for(t.length=0;this.sftimeValue(this.SFTime);)t.push(this.SFTime)},sfvec2dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value,n=t.getUnit();return t.getValue().set(this.fromUnit(n,e),this.fromUnit(n,i)),!0}}return!1},mfvec2dValue:function(t){if(t.length=0,this.SFVec2d.setUnit(t.getUnit()),this.sfvec2dValue(this.SFVec2d))return t.push(this.SFVec2d),!0;if(l.OpenBracket.parse(this)){if(this.sfvec2dValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(t){for(t.length=0,this.SFVec2d.setUnit(t.getUnit());this.sfvec2dValue(this.SFVec2d);)t.push(this.SFVec2d)},sfvec2fValue:function(t){return this.sfvec2dValue(t)},mfvec2fValue:function(t){if(t.length=0,this.SFVec2f.setUnit(t.getUnit()),this.sfvec2fValue(this.SFVec2f))return t.push(this.SFVec2f),!0;if(l.OpenBracket.parse(this)){if(this.sfvec2fValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(t){for(t.length=0,this.SFVec2f.setUnit(t.getUnit());this.sfvec2fValue(this.SFVec2f);)t.push(this.SFVec2f)},sfvec3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value,r=t.getUnit();return t.getValue().set(this.fromUnit(r,e),this.fromUnit(r,i),this.fromUnit(r,n)),!0}}}return!1},mfvec3dValue:function(t){if(t.length=0,this.SFVec3d.setUnit(t.getUnit()),this.sfvec3dValue(this.SFVec3d))return t.push(this.SFVec3d),!0;if(l.OpenBracket.parse(this)){if(this.sfvec3dValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(t){for(t.length=0,this.SFVec3d.setUnit(t.getUnit());this.sfvec3dValue(this.SFVec3d);)t.push(this.SFVec3d)},sfvec3fValue:function(t){return this.sfvec3dValue(t)},mfvec3fValue:function(t){if(t.length=0,this.SFVec3f.setUnit(t.getUnit()),this.sfvec3fValue(this.SFVec3f))return t.push(this.SFVec3f),!0;if(l.OpenBracket.parse(this)){if(this.sfvec3fValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(t){for(t.length=0,this.SFVec3f.setUnit(t.getUnit());this.sfvec3fValue(this.SFVec3f);)t.push(this.SFVec3f)},sfvec4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value,o=t.getUnit();return t.getValue().set(this.fromUnit(o,e),this.fromUnit(o,i),this.fromUnit(o,n),this.fromUnit(o,r)),!0}}}}return!1},mfvec4dValue:function(t){if(t.length=0,this.SFVec4d.setUnit(t.getUnit()),this.sfvec4dValue(this.SFVec4d))return t.push(this.SFVec4d),!0;if(l.OpenBracket.parse(this)){if(this.sfvec4dValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(t){for(t.length=0,this.SFVec4d.setUnit(t.getUnit());this.sfvec4dValue(this.SFVec4d);)t.push(this.SFVec4d)},sfvec4fValue:function(t){return this.sfvec4dValue(t)},mfvec4fValue:function(t){if(t.length=0,this.SFVec4f.setUnit(t.getUnit()),this.sfvec4fValue(this.SFVec4f))return t.push(this.SFVec4f),!0;if(l.OpenBracket.parse(this)){if(this.sfvec4fValues(t),this.comments(),l.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(t){for(t.length=0,this.SFVec4f.setUnit(t.getUnit());this.sfvec4fValue(this.SFVec4f);)t.push(this.SFVec4f)}}),u.prototype.fieldTypes=[],u.prototype.fieldTypes[o.SFBool]=u.prototype.sfboolValue,u.prototype.fieldTypes[o.SFColor]=u.prototype.sfcolorValue,u.prototype.fieldTypes[o.SFColorRGBA]=u.prototype.sfcolorrgbaValue,u.prototype.fieldTypes[o.SFDouble]=u.prototype.sfdoubleValue,u.prototype.fieldTypes[o.SFFloat]=u.prototype.sffloatValue,u.prototype.fieldTypes[o.SFImage]=u.prototype.sfimageValue,u.prototype.fieldTypes[o.SFInt32]=u.prototype.sfint32Value,u.prototype.fieldTypes[o.SFMatrix3f]=u.prototype.sfmatrix4dValue,u.prototype.fieldTypes[o.SFMatrix3d]=u.prototype.sfmatrix4fValue,u.prototype.fieldTypes[o.SFMatrix4f]=u.prototype.sfmatrix4dValue,u.prototype.fieldTypes[o.SFMatrix4d]=u.prototype.sfmatrix4fValue,u.prototype.fieldTypes[o.SFNode]=u.prototype.sfnodeValue,u.prototype.fieldTypes[o.SFRotation]=u.prototype.sfrotationValue,u.prototype.fieldTypes[o.SFString]=u.prototype.sfstringValue,u.prototype.fieldTypes[o.SFTime]=u.prototype.sftimeValue,u.prototype.fieldTypes[o.SFVec2d]=u.prototype.sfvec2dValue,u.prototype.fieldTypes[o.SFVec2f]=u.prototype.sfvec2fValue,u.prototype.fieldTypes[o.SFVec3d]=u.prototype.sfvec3dValue,u.prototype.fieldTypes[o.SFVec3f]=u.prototype.sfvec3fValue,u.prototype.fieldTypes[o.SFVec4d]=u.prototype.sfvec4dValue,u.prototype.fieldTypes[o.SFVec4f]=u.prototype.sfvec4fValue,u.prototype.fieldTypes[o.MFBool]=u.prototype.mfboolValue,u.prototype.fieldTypes[o.MFColor]=u.prototype.mfcolorValue,u.prototype.fieldTypes[o.MFColorRGBA]=u.prototype.mfcolorrgbaValue,u.prototype.fieldTypes[o.MFDouble]=u.prototype.mfdoubleValue,u.prototype.fieldTypes[o.MFFloat]=u.prototype.mffloatValue,u.prototype.fieldTypes[o.MFImage]=u.prototype.mfimageValue,u.prototype.fieldTypes[o.MFInt32]=u.prototype.mfint32Value,u.prototype.fieldTypes[o.MFMatrix3d]=u.prototype.mfmatrix3dValue,u.prototype.fieldTypes[o.MFMatrix3f]=u.prototype.mfmatrix3fValue,u.prototype.fieldTypes[o.MFMatrix4d]=u.prototype.mfmatrix4dValue,u.prototype.fieldTypes[o.MFMatrix4f]=u.prototype.mfmatrix4fValue,u.prototype.fieldTypes[o.MFNode]=u.prototype.mfnodeValue,u.prototype.fieldTypes[o.MFRotation]=u.prototype.mfrotationValue,u.prototype.fieldTypes[o.MFString]=u.prototype.mfstringValue,u.prototype.fieldTypes[o.MFTime]=u.prototype.mftimeValue,u.prototype.fieldTypes[o.MFVec2d]=u.prototype.mfvec2dValue,u.prototype.fieldTypes[o.MFVec2f]=u.prototype.mfvec2fValue,u.prototype.fieldTypes[o.MFVec3d]=u.prototype.mfvec3dValue,u.prototype.fieldTypes[o.MFVec3f]=u.prototype.mfvec3fValue,u.prototype.fieldTypes[o.MFVec4d]=u.prototype.mfvec4dValue,u.prototype.fieldTypes[o.MFVec4f]=u.prototype.mfvec4fValue,u}),define("standard/Utility/DataStorage",[],function(){"use strict";function t(t){return e.set(this,t),new Proxy(this,i)}var e=new WeakMap,i={get:function(t,e){if(e in t)return t[e];var i=localStorage[t.getNameSpace()+e];if(void 0!==i)return JSON.parse(i)},set:function(t,e,i){return localStorage[t.getNameSpace()+e]=JSON.stringify(i),!0}};return t.prototype={constructor:t,getNameSpace:function(){return e.get(this)},removeItem:function(t){return localStorage.removeItem(this.getNameSpace()+t)},clear:function(){return localStorage.clear()}},t}),define("x_ite/Browser/Core/X3DCoreContext",["jquery","x_ite/Fields","x_ite/Browser/Core/BrowserOptions","x_ite/Browser/Core/BrowserProperties","x_ite/Browser/Core/RenderingProperties","x_ite/Browser/Core/Notification","x_ite/Browser/Core/BrowserTimings","x_ite/Browser/Core/ContextMenu","x_ite/Execution/Scene","x_ite/Parser/Parser","standard/Utility/DataStorage"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){var e=t.getContext("webgl")||t.getContext("experimental-webgl");if(!e)throw new Error("Couldn't create WebGL context.");var i=e.getParameter(e.ALIASED_LINE_WIDTH_RANGE);return 1===i[0]&&1===i[1]&&(e.lineWidth=Function.prototype),e}function d(e){this.number=++p,this.element=e;var l=t("<div></div>").addClass("x_ite-private-browser").prependTo(this.element),d=t("<div></div>").addClass("x_ite-private-splash-screen").appendTo(l),f=(t("<div></div>").addClass("x_ite-private-spinner").appendTo(d),t("<div></div>").addClass("x_ite-private-progress").appendTo(d)),g=t("<div></div>").addClass("x_ite-private-surface x_ite-private-surface-"+this.getId()).appendTo(l);t("<div></div>").addClass("x_ite-private-spinner-text").appendTo(f).text("Lade 0 Dateien"),t("<div></div>").addClass("x_ite-private-progressbar").appendTo(f).append(t("<div></div>")),this.splashScreen=d,this.canvas=t("<canvas></canvas>").addClass("x_ite-private-canvas").prependTo(g),this.context=c(this.canvas[0]),this.privateScene=new u(this),this.browserOptions=new i(this.getPrivateScene()),this.browserProperties=new n(this.getPrivateScene()),this.renderingProperties=new r(this.getPrivateScene()),this.notification=new o(this.getPrivateScene()),this.browserTimings=new s(this.getPrivateScene()),this.contextMenu=new a(this.getPrivateScene()),this.dataStorage=new h("X3DBrowser("+this.number+")."),this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t(".x_ite-console").empty()}var p=0;return d.prototype={initialize:function(){this.privateScene.setPrivate(!0),this.privateScene.setLive(!0),this.privateScene.setup(),this.browserOptions.setup(),this.browserProperties.setup(),this.renderingProperties.setup(),this.notification.setup(),this.browserTimings.setup(),this.contextMenu.setup(),this.debug="true"==this.getElement().attr("debug"),this.observer=new MutationObserver(this.processMutations.bind(this)),this.observer.observe(this.element[0],{attributes:!0,childList:!1,characterData:!1,subtree:!1})},getDebug:function(){return this.debug},getNumber:function(){return this.number},isStrict:function(){return!1},getElement:function(){return this.element},getSplashScreen:function(){return this.splashScreen},getCanvas:function(){return this.canvas},getContext:function(){return this.context},getBrowserOptions:function(){return this.browserOptions},getBrowserProperties:function(){return this.browserProperties},getRenderingProperties:function(){return this.renderingProperties},getNotification:function(){return this.notification},getBrowserTimings:function(){return this.browserTimings},getDataStorage:function(){return this.dataStorage},getMobile:function(){return this.mobile},processMutations:function(t){t.forEach(function(t){this.processMutation(t)},this)},processMutation:function(t){var e=t.target;switch(t.type){case"attributes":this.processAttribute(t,e)}},processAttribute:function(t,e){switch(t.attributeName.toLowerCase()){case"src":var i=this.getElement().attr("src");i&&this.load('"'+i+'"');break;case"url":this.load(this.getElement().attr("url"));break;case"splashscreen":this.getBrowserOptions().setAttributeSplashScreen()}},load:function(t){if(t){var i=new l(this.getExecutionContext(),!0),n=new e.MFString,r=new e.MFString;i.setInput(t),i.sfstringValues(n),n.length&&this.loadURL(n,r)}else this.getLoading()||this.getCanvas().fadeIn(0)},getPrivateScene:function(){return this.privateScene}},d}),define("x_ite/Routing/X3DRoutingContext",[],function(){"use strict";function t(){this.taintedFields=[],this.taintedFieldsTemp=[],this.taintedNodes=[],this.taintedNodesTemp=[]}return t.prototype={constructor:t,initialize:function(){},addTaintedField:function(t,e){this.taintedFields.push(t,e)},addTaintedNode:function(t){this.taintedNodes.push(t)},processEvents:function(){do{do{var t=this.taintedFields;this.taintedFields=this.taintedFieldsTemp,this.taintedFields.length=0;for(var e=0,i=t.length;e<i;e+=2)t[e].processEvent(t[e+1]);this.taintedFieldsTemp=t}while(this.taintedFields.length);do{var n=this.taintedNodes;this.taintedNodes=this.taintedNodesTemp,this.taintedNodes.length=0;for(var e=0,i=n.length;e<i;++e)n[e].processEvents();this.taintedNodesTemp=n}while(!this.taintedFields.length&&this.taintedNodes.length)}while(this.taintedFields.length)}},t}),define("x_ite/Browser/Scripting/X3DScriptingContext",[],function(){"use strict";function t(){this.scripts=[this]}return t.prototype={initialize:function(){},isExternal:function(){return 1===this.scripts.length},getScriptStack:function(){return this.scripts}},t}),define("x_ite/Components/Core/X3DChildNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){this.getExecutionContext()||(i.call(this,t),this.addType(n.X3DChildNode),this.addChildObjects("isCameraObject",new e.SFBool))}return r.prototype=t.extend(Object.create(i.prototype),{constructor:r,setCameraObject:function(t){t!==this.isCameraObject_.getValue()&&(this.isCameraObject_=t)},getCameraObject:function(){return this.isCameraObject_.getValue()}}),r}),define("x_ite/Components/Core/X3DSensorNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DSensorNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Networking/X3DNetworkSensorNode",["jquery","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DNetworkSensorNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Networking/LoadSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"timeOut",new e.SFTime),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"isLoaded",new e.SFBool),new i(s.outputOnly,"progress",new e.SFFloat),new i(s.outputOnly,"loadTime",new e.SFTime),new i(s.inputOutput,"watchList",new e.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.timeOut_.addInterest("set_timeOut__",this),this.watchList_.addInterest("set_watchList__",this),this.watchList_.addEvent()},set_enabled__:function(){this.enabled_.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this.isActive_.getValue()&&(this.clearTimeout(),this.aborted=!1,this.timeOut_.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this.timeOut_.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(t,e){switch(e.checkLoadState()){case s.NOT_STARTED_STATE:break;case s.IN_PROGRESS_STATE:case s.COMPLETE_STATE:case s.FAILED_STATE:this.count()}},count:function(){for(var t=0,e=0,i=this.urlObjects,n=0,r=i.length;n<r;++n){var o=i[n];t+=o.checkLoadState()==s.COMPLETE_STATE,e+=o.checkLoadState()==s.FAILED_STATE}var a=t==i.length,u=t/i.length;this.aborted||e||a?(this.clearTimeout(),this.isActive_=!1,this.isLoaded_=a,this.progress_=u,a&&(this.loadTime_=this.getBrowser().getCurrentTime())):this.isActive_.getValue()?this.progress_=u:(this.isActive_=!0,this.progress_=u,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this.enabled_.getValue()&&this.count()},reset:function(){if(this.remove(),this.enabled_.getValue()){for(var t=this.watchList_.getValue(),e=this.urlObjects,i=0,n=t.length;i<n;++i){var r=o(s.X3DUrlObject,t[i]);r&&(e.push(r),r.loadState_.addInterest("set_loadState__",this,r))}this.count()}},remove:function(){this.clearTimeout();for(var t=this.urlObjects,e=0,i=t.length;e<i;++e)t[e].loadState_.removeInterest("set_loadState__",this);t.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),a}),define("x_ite/Browser/Networking/urls",[],function(){"use strict";return{providerUrl:"http://create3000.de/x_ite",fallbackUrl:"http://cors.create3000.de/",fallbackExpression:new RegExp("^http://cors.create3000.de/")}}),function(){"use strict";function t(t){return i(n(t),arguments)}function e(e,i){return t.apply(null,[e].concat(i||[]))}function i(e,i){var n,o,s,a,u,l,h,c,d,p=1,f=e.length,g="";for(o=0;o<f;o++)if("string"==typeof e[o])g+=e[o];else if(Array.isArray(e[o])){if((a=e[o])[2])for(n=i[p],s=0;s<a[2].length;s++){if(!n.hasOwnProperty(a[2][s]))throw new Error(t('[sprintf] property "%s" does not exist',a[2][s]));n=n[a[2][s]]}else n=a[1]?i[a[1]]:i[p++];if(r.not_type.test(a[8])&&r.not_primitive.test(a[8])&&n instanceof Function&&(n=n()),r.numeric_arg.test(a[8])&&"number"!=typeof n&&isNaN(n))throw new TypeError(t("[sprintf] expecting number but found %T",n));switch(r.number.test(a[8])&&(c=n>=0),a[8]){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,a[6]?parseInt(a[6]):0);break;case"e":n=a[7]?parseFloat(n).toExponential(a[7]):parseFloat(n).toExponential();break;case"f":n=a[7]?parseFloat(n).toFixed(a[7]):parseFloat(n);break;case"g":n=a[7]?String(Number(n.toPrecision(a[7]))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a[7]?n.substring(0,a[7]):n;break;case"t":n=String(!!n),n=a[7]?n.substring(0,a[7]):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a[7]?n.substring(0,a[7]):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a[7]?n.substring(0,a[7]):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}r.json.test(a[8])?g+=n:(!r.number.test(a[8])||c&&!a[3]?d="":(d=c?"+":"-",n=n.toString().replace(r.sign,"")),l=a[4]?"0"===a[4]?"0":a[4].charAt(1):" ",h=a[6]-(d+n).length,u=a[6]&&h>0?l.repeat(h):"",g+=a[5]?d+n+u:"0"===l?d+u+n:u+d+n)}return g}function n(t){if(o[t])return o[t];for(var e,i=t,n=[],s=0;i;){if(null!==(e=r.text.exec(i)))n.push(e[0]);else if(null!==(e=r.modulo.exec(i)))n.push("%");else{if(null===(e=r.placeholder.exec(i)))throw new SyntaxError("[sprintf] unexpected placeholder");if(e[2]){s|=1;var a=[],u=e[2],l=[];if(null===(l=r.key.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(u=u.substring(l[0].length));)if(null!==(l=r.key_access.exec(u)))a.push(l[1]);else{if(null===(l=r.index_access.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}e[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push(e)}i=i.substring(e[0].length)}return o[t]=n}var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/},o=Object.create(null);"undefined"!=typeof exports&&(exports.sprintf=t,exports.vsprintf=e),"undefined"!=typeof window&&(window.sprintf=t,window.vsprintf=e,"function"==typeof define&&define.amd&&define("sprintf/dist/sprintf.min",[],function(){return{sprintf:t,vsprintf:e}}))}(),define("sprintf",["sprintf/dist/sprintf.min"],function(t){return t}),define("x_ite/Browser/Networking/X3DNetworkingContext",["x_ite/Fields","x_ite/Components/Networking/LoadSensor","x_ite/Browser/Networking/urls","standard/Networking/URI","sprintf","locale/gettext"],function(t,e,i,n,r,o){"use strict";function s(t){var e=t.baseURI;return e.startsWith("about:")&&(e=document.baseURI),new n(e)}function a(){this.addChildObjects("loadCount",new t.SFInt32),this.loadSensor=new e(this.getPrivateScene()),this.loadingTotal=0,this.loadingObjects={},this.loading=!1,this.location=s(this.getElement()[0]),this.defaultScene=this.createScene(),this.getCanvas().fadeOut(0),this.getBrowserOptions().getSplashScreen()&&this.getSplashScreen().fadeIn(0)}return a.prototype={initialize:function(){this.loadSensor.setup(),this.defaultScene.setPrivate(!0),this.defaultScene.setLive(!0),this.defaultScene.setup()},getProviderUrl:function(){return i.providerUrl},getLocation:function(){return this.location},getDefaultScene:function(){return this.defaultScene},getLoadSensor:function(){return this.loadSensor},setBrowserLoading:function(t){this.loading=t,t?(this.resetLoadCount(),this.getBrowserOptions().getSplashScreen()&&(this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getSplashScreen().stop(!0,!0).animate({delay:1},1).fadeIn(0))):this.getBrowserOptions().getSplashScreen()?(this.getSplashScreen().stop(!0,!0).fadeIn(0).fadeOut(2e3),this.getCanvas().stop(!0,!0).fadeOut(0).fadeIn(2e3)):this.getCanvas().fadeIn(0)},getLoading:function(){return this.loading},addLoadCount:function(t){var e=t.getId();this.loadingObjects.hasOwnProperty(e)||(++this.loadingTotal,this.loadingObjects[e]=t,this.setLoadCount(this.loadCount_=this.loadCount_.getValue()+1),this.setCursor("DEFAULT"))},removeLoadCount:function(t){var e=t.getId();this.loadingObjects.hasOwnProperty(e)&&(delete this.loadingObjects[e],this.setLoadCount(this.loadCount_=this.loadCount_.getValue()-1))},setLoadCount:function(t){if(t)var e=r.sprintf(o(1==t?"Loading %d file":"Loading %d files"),t);else{var e=o("Loading done");this.setCursor("DEFAULT")}this.loading||(this.getNotification().string_=e),this.getSplashScreen().find(".x_ite-private-spinner-text").text(e),this.getSplashScreen().find(".x_ite-private-progressbar div").css("width",100*(this.loadingTotal-t)/this.loadingTotal+"%")},resetLoadCount:function(){this.loadCount_=0,this.loadingTotal=0,this.loadingObjects={}}},a}),define("x_ite/Browser/Shaders/X3DShadersContext",[],function(){"use strict";function t(){this.shaders={}}return t.prototype={initialize:function(){},getShadingLanguageVersion:function(){return this.getContext().getParameter(this.getContext().SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_ATTRIBS)},addShader:function(t){this.shaders[t.getId()]=t,t.setShading(this.getBrowserOptions().getShading())},removeShader:function(t){delete this.shaders[t.getId()]},getShaders:function(){return this.shaders}},t}),define("x_ite/Components/Shape/X3DAppearanceNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){i.call(this,t),this.addType(n.X3DAppearanceNode)}
return r.prototype=t.extend(Object.create(i.prototype),{constructor:r,initialize:function(){i.prototype.initialize.call(this),this.addChildObjects("transparent",new e.SFBool)}}),r}),define("x_ite/Components/Shape/Appearance",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.Appearance),this.linePropertiesNode=null,this.materialNode=null,this.textureNode=null,this.textureTransformNode=null,this.shaderNodes=[],this.shaderNode=null}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"fillProperties",new e.SFNode),new i(s.inputOutput,"lineProperties",new e.SFNode),new i(s.inputOutput,"material",new e.SFNode),new i(s.inputOutput,"texture",new e.SFNode),new i(s.inputOutput,"textureTransform",new e.SFNode),new i(s.inputOutput,"shaders",new e.MFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.lineProperties_.addInterest("set_lineProperties__",this),this.material_.addInterest("set_material__",this),this.texture_.addInterest("set_texture__",this),this.textureTransform_.addInterest("set_textureTransform__",this),this.shaders_.addInterest("set_shaders__",this),this.set_lineProperties__(),this.set_material__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__()},getLineProperties:function(){return this.linePropertiesNode},getMaterial:function(){return this.materialNode},getTexture:function(){return this.textureNode},getTextureTransform:function(){return this.textureTransformNode},set_lineProperties__:function(){this.linePropertiesNode=o(s.LineProperties,this.lineProperties_)},set_live__:function(){this.isLive().getValue()?this.shaderNode&&this.getBrowser().addShader(this.shaderNode):this.shaderNode&&this.getBrowser().removeShader(this.shaderNode)},set_material__:function(){this.materialNode&&this.materialNode.transparent_.removeInterest("set_transparent__",this),this.materialNode=o(s.X3DMaterialNode,this.material_),this.materialNode&&this.materialNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()},set_texture__:function(){this.textureNode&&this.textureNode.transparent_.removeInterest("set_transparent__",this),this.textureNode=o(s.X3DTextureNode,this.texture_),this.textureNode&&this.textureNode.transparent_.addInterest("set_transparent__",this),this.generatedCubeMapTexture=o(s.GeneratedCubeMapTexture,this.texture_),this.set_transparent__()},set_textureTransform__:function(){this.textureTransformNode=o(s.X3DTextureTransformNode,this.textureTransform_),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform())},set_shaders__:function(){for(var t=this.shaders_.getValue(),e=this.shaderNodes,i=0,n=e.length;i<n;++i)e[i].isValid_.removeInterest("set_shader__",this);e.length=0;for(var i=0,n=t.length;i<n;++i){var r=o(s.X3DShaderNode,t[i]);r&&(e.push(r),r.isValid_.addInterest("set_shader__",this))}this.set_shader__()},set_shader__:function(){var t=this.shaderNodes;this.shaderNode&&this.getBrowser().removeShader(this.shaderNode),this.shaderNode=null;for(var e=0,i=t.length;e<i;++e)if(t[e].isValid_.getValue()){this.shaderNode=t[e];break}this.isLive().getValue()&&this.shaderNode&&this.getBrowser().addShader(this.shaderNode),this.set_transparent__()},set_transparent__:function(){this.transparent_=this.materialNode&&this.materialNode.transparent_.getValue()||this.textureNode&&this.textureNode.transparent_.getValue()},traverse:function(t,e){this.generatedCubeMapTexture&&this.generatedCubeMapTexture.traverse(t,e),this.shaderNode&&this.shaderNode.traverse(t,e)},display:function(t){t.linePropertiesNode=this.linePropertiesNode,t.materialNode=this.materialNode,t.textureNode=this.textureNode,t.textureTransformNode=this.textureTransformNode,t.shaderNode=this.shaderNode||t.renderer.getBrowser().getDefaultShader()}}),a}),define("x_ite/Browser/Shape/X3DShapeContext",["x_ite/Components/Shape/Appearance"],function(t){"use strict";function e(){this.defaultAppearance=new t(this.getPrivateScene())}return e.prototype={initialize:function(){this.defaultAppearance.setup()},getDefaultAppearance:function(){return this.defaultAppearance}},e}),define("x_ite/Components/Shape/X3DAppearanceChildNode",["jquery","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DAppearanceChildNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Bits/TraverseType",[],function(){"use strict";var t=0,e={POINTER:t++,CAMERA:t++,COLLISION:t++,DEPTH:t++,DISPLAY:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Components/Shaders/X3DShaderNode",["jquery","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DShaderNode)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,custom:!0,setCustom:function(t){this.custom=t},getCustom:function(){return this.custom},setGeometryType:function(t){this.setShading(t,this.getBrowser().getBrowserOptions().Shading_.getValue())},setShading:function(t,e){var i=this.getBrowser().getContext();switch(t){case 0:switch(e){case"POINT":case"POINTSET":case"WIREFRAME":default:this.primitiveMode=i.POINTS,this.wireframe=!0}break;case 1:switch(e){case"POINT":case"POINTSET":this.primitiveMode=i.POINTS,this.wireframe=!0;break;case"WIREFRAME":default:this.primitiveMode=i.LINES,this.wireframe=!0}break;case 2:case 3:switch(e){case"POINT":case"POINTSET":this.primitiveMode=i.POINTS,this.wireframe=!0;break;case"WIREFRAME":this.primitiveMode=i.LINE_LOOP,this.wireframe=!0;break;default:this.primitiveMode=i.TRIANGLES,this.wireframe=!1}}},traverse:function(t,e){switch(t){case n.DISPLAY:e.getShaders()[this.getId()]=this}}}),r}),define("x_ite/Components/Shaders/X3DProgrammableShaderObject",["jquery","x_ite/Fields","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(t,e,i,n,r){"use strict";function o(t){this.addType(n.X3DProgrammableShaderObject),this.x3d_ClipPlane=[],this.x3d_LightType=[],this.x3d_LightOn=[],this.x3d_LightColor=[],this.x3d_LightIntensity=[],this.x3d_LightAmbientIntensity=[],this.x3d_LightAttenuation=[],this.x3d_LightLocation=[],this.x3d_LightDirection=[],this.x3d_LightBeamWidth=[],this.x3d_LightCutOffAngle=[],this.x3d_LightRadius=[],this.x3d_ShadowIntensity=[],this.x3d_ShadowDiffusion=[],this.x3d_ShadowColor=[],this.x3d_ShadowMatrix=[],this.x3d_ShadowMap=[]}var s=new r,a=new e.SFNode;return o.prototype={constructor:o,x3d_NoneClipPlane:new Float32Array([88,51,68,33]),numGlobalLights:0,normalMatrixArray:new Float32Array(9),initialize:function(){var t=this.getBrowser();this.x3d_MaxClipPlanes=t.getMaxClipPlanes(),this.x3d_MaxLights=t.getMaxLights(),this.x3d_MaxTextures=t.getMaxTextures(),this.textureTypeArray=new Int32Array(this.x3d_MaxTextures)},hasUserDefinedFields:function(){return!0},bindAttributeLocations:function(t,e){t.bindAttribLocation(e,3,"x3d_Color"),t.bindAttribLocation(e,2,"x3d_TexCoord"),t.bindAttribLocation(e,1,"x3d_Normal"),t.bindAttribLocation(e,0,"x3d_Vertex")},getDefaultUniforms:function(){var t=this.getBrowser().getContext(),e=this.getProgram();this.x3d_GeometryType=t.getUniformLocation(e,"x3d_GeometryType");for(var i=0;i<this.x3d_MaxClipPlanes;++i)this.x3d_ClipPlane[i]=t.getUniformLocation(e,"x3d_ClipPlane["+i+"]");this.x3d_FogType=t.getUniformLocation(e,"x3d_FogType"),this.x3d_FogColor=t.getUniformLocation(e,"x3d_FogColor"),this.x3d_FogVisibilityRange=t.getUniformLocation(e,"x3d_FogVisibilityRange"),this.x3d_LinewidthScaleFactor=t.getUniformLocation(e,"x3d_LinewidthScaleFactor"),this.x3d_Lighting=t.getUniformLocation(e,"x3d_Lighting"),this.x3d_ColorMaterial=t.getUniformLocation(e,"x3d_ColorMaterial");for(var i=0;i<this.x3d_MaxLights;++i)this.x3d_LightType[i]=t.getUniformLocation(e,"x3d_LightType["+i+"]"),this.x3d_LightColor[i]=t.getUniformLocation(e,"x3d_LightColor["+i+"]"),this.x3d_LightAmbientIntensity[i]=t.getUniformLocation(e,"x3d_LightAmbientIntensity["+i+"]"),this.x3d_LightIntensity[i]=t.getUniformLocation(e,"x3d_LightIntensity["+i+"]"),this.x3d_LightAttenuation[i]=t.getUniformLocation(e,"x3d_LightAttenuation["+i+"]"),this.x3d_LightLocation[i]=t.getUniformLocation(e,"x3d_LightLocation["+i+"]"),this.x3d_LightDirection[i]=t.getUniformLocation(e,"x3d_LightDirection["+i+"]"),this.x3d_LightBeamWidth[i]=t.getUniformLocation(e,"x3d_LightBeamWidth["+i+"]"),this.x3d_LightCutOffAngle[i]=t.getUniformLocation(e,"x3d_LightCutOffAngle["+i+"]"),this.x3d_LightRadius[i]=t.getUniformLocation(e,"x3d_LightRadius["+i+"]"),this.x3d_ShadowIntensity[i]=t.getUniformLocation(e,"x3d_ShadowIntensity["+i+"]"),this.x3d_ShadowDiffusion[i]=t.getUniformLocation(e,"x3d_ShadowDiffusion["+i+"]"),this.x3d_ShadowColor[i]=t.getUniformLocation(e,"x3d_ShadowColor["+i+"]"),this.x3d_ShadowMatrix[i]=t.getUniformLocation(e,"x3d_ShadowMatrix["+i+"]"),this.x3d_ShadowMap[i]=t.getUniformLocation(e,"x3d_ShadowMap["+i+"]");return this.x3d_SeparateBackColor=t.getUniformLocation(e,"x3d_SeparateBackColor"),this.x3d_AmbientIntensity=t.getUniformLocation(e,"x3d_AmbientIntensity"),this.x3d_DiffuseColor=t.getUniformLocation(e,"x3d_DiffuseColor"),this.x3d_SpecularColor=t.getUniformLocation(e,"x3d_SpecularColor"),this.x3d_EmissiveColor=t.getUniformLocation(e,"x3d_EmissiveColor"),this.x3d_Shininess=t.getUniformLocation(e,"x3d_Shininess"),this.x3d_Transparency=t.getUniformLocation(e,"x3d_Transparency"),this.x3d_BackAmbientIntensity=t.getUniformLocation(e,"x3d_BackAmbientIntensity"),this.x3d_BackDiffuseColor=t.getUniformLocation(e,"x3d_BackDiffuseColor"),this.x3d_BackSpecularColor=t.getUniformLocation(e,"x3d_BackSpecularColor"),this.x3d_BackEmissiveColor=t.getUniformLocation(e,"x3d_BackEmissiveColor"),this.x3d_BackShininess=t.getUniformLocation(e,"x3d_BackShininess"),this.x3d_BackTransparency=t.getUniformLocation(e,"x3d_BackTransparency"),this.x3d_TextureType=t.getUniformLocation(e,"x3d_TextureType"),this.x3d_Texture2D=t.getUniformLocation(e,"x3d_Texture2D"),this.x3d_CubeMapTexture=t.getUniformLocation(e,"x3d_CubeMapTexture"),this.x3d_Texture=t.getUniformLocation(e,"x3d_Texture"),this.x3d_Viewport=t.getUniformLocation(e,"x3d_Viewport"),this.x3d_ProjectionMatrix=t.getUniformLocation(e,"x3d_ProjectionMatrix"),this.x3d_ModelViewMatrix=t.getUniformLocation(e,"x3d_ModelViewMatrix"),this.x3d_NormalMatrix=t.getUniformLocation(e,"x3d_NormalMatrix"),this.x3d_TextureMatrix=t.getUniformLocation(e,"x3d_TextureMatrix"),this.x3d_Color=t.getAttribLocation(e,"x3d_Color"),this.x3d_TexCoord=t.getAttribLocation(e,"x3d_TexCoord"),this.x3d_Normal=t.getAttribLocation(e,"x3d_Normal"),this.x3d_Vertex=t.getAttribLocation(e,"x3d_Vertex"),t.uniform1f(this.x3d_LinewidthScaleFactor,1),t.uniform1iv(this.x3d_TextureType,new Int32Array([0])),t.uniform1iv(this.x3d_Texture,new Int32Array([2])),t.uniform1iv(this.x3d_Texture2D,new Int32Array([2])),t.uniform1iv(this.x3d_CubeMapTexture,new Int32Array([4])),this.x3d_Color<0?(this.enableColorAttribute=Function.prototype,this.disableColorAttribute=Function.prototype):(delete this.enableColorAttribute,delete this.disableColorAttribute),this.x3d_TexCoord<0?(this.enableTexCoordAttribute=Function.prototype,this.disableTexCoordAttribute=Function.prototype):(delete this.enableTexCoordAttribute,delete this.disableTexCoordAttribute),this.x3d_Normal<0?(this.enableNormalAttribute=Function.prototype,this.disableNormalAttribute=Function.prototype):(delete this.enableNormalAttribute,delete this.disableNormalAttribute),!(this.x3d_Vertex<0)},addShaderFields:function(){var t=this.getBrowser().getContext(),e=this.getProgram(),i=this.getUserDefinedFields();for(var r in i){var o=i[r],s=t.getUniformLocation(e,r);if(s){switch(o._uniformLocation=s,o.addInterest("set_field__",this),o.getType()){case n.SFImage:s.array=new Int32Array(3+o.array.length);break;case n.SFMatrix3d:case n.SFMatrix3f:case n.SFRotation:s.array=new Float32Array(9);break;case n.SFMatrix4d:case n.SFMatrix4f:s.array=new Float32Array(16);break;case n.MFBool:case n.MFInt32:s.array=new Int32Array(this.getLocationLength(t,e,o));break;case n.MFFloat:case n.MFDouble:case n.MFTime:s.array=new Float32Array(this.getLocationLength(t,e,o));break;case n.MFImage:s.array=new Int32Array(this.getImagesLength(o));break;case n.MFMatrix3d:case n.MFMatrix3f:case n.MFRotation:s.array=new Float32Array(9*this.getLocationLength(t,e,o));break;case n.MFMatrix4d:case n.MFMatrix4f:s.array=new Float32Array(16*this.getLocationLength(t,e,o));break;case n.MFNode:for(var a=o._uniformLocation=[],u=0;;++u){var s=t.getUniformLocation(e,r+"["+u+"]");if(!s)break;a[u]=s}break;case n.MFVec2d:case n.MFVec2f:s.array=new Float32Array(2*this.getLocationLength(t,e,o));break;case n.MFVec3d:case n.MFVec3f:case n.MFColor:s.array=new Float32Array(3*this.getLocationLength(t,e,o));break;case n.MFVec4d:case n.MFVec4f:case n.MFColorRGBA:s.array=new Float32Array(4*this.getLocationLength(t,e,o))}this.set_field__(o)}}},removeShaderFields:function(){var t=this.getBrowser().getContext(),e=this.getProgram(),i=this.getUserDefinedFields();for(var r in i){var o=i[r];switch(o.removeInterest("set_field__",this),o.getType()){case n.SFNode:this.removeNode(t,e,o._uniformLocation);break;case n.MFNode:for(var r=o.getName(),s=0;;++s){var a=t.getUniformLocation(e,r+"["+s+"]");if(!a)break;this.removeNode(t,e,a)}break;default:continue}break}},set_field__:function(t){var e=this.getBrowser().getContext(),i=this.getProgram(),r=t._uniformLocation;if(r)switch(this.useProgram(e),t.getType()){case n.SFBool:case n.SFInt32:return void e.uniform1i(r,t.getValue());case n.SFColor:var o=t.getValue();return void e.uniform3f(r,o.r,o.g,o.b);case n.SFColorRGBA:var o=t.getValue();return void e.uniform4f(r,o.r,o.g,o.b,o.a);case n.SFDouble:case n.SFFloat:case n.SFTime:return void e.uniform1f(r,t.getValue());case n.SFImage:var u=r.array,l=t.array.getValue(),h=3+l.length;h!==u.length&&(u=r.array=new Int32Array(h)),u[0]=t.width,u[1]=t.height,u[2]=t.comp;for(var c=3,d=0,h=l.length;d<h;++d)u[c++]=l[d].getValue();return void e.uniform1iv(r,u);case n.SFMatrix3d:case n.SFMatrix3f:return r.array.set(t.getValue()),void e.uniformMatrix3fv(r,!1,r.array);case n.SFMatrix4d:case n.SFMatrix4f:return r.array.set(t.getValue()),void e.uniformMatrix4fv(r,!1,r.array);case n.SFNode:return void this.setNode(e,i,r,t);case n.SFRotation:return t.getValue().getMatrix(r.array),void e.uniformMatrix3fv(r,!1,r.array);case n.SFString:return;case n.SFVec2d:case n.SFVec2f:var o=t.getValue();return void e.uniform2f(r,o.x,o.y);case n.SFVec3d:case n.SFVec3f:var o=t.getValue();return void e.uniform3f(r,o.x,o.y,o.z);case n.SFVec4d:case n.SFVec4f:var o=t.getValue();return void e.uniform4f(r,o.x,o.y,o.z,o.w);case n.MFBool:case n.MFInt32:for(var o=t.getValue(),u=r.array,p=0,h=o.length;p<h;++p)u[p]=o[p].getValue();for(var h=u.length;p<h;++p)u[p]=0;return void e.uniform1iv(r,u);case n.MFColor:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var g=o[p].getValue();u[f++]=g.r,u[f++]=g.g,u[f++]=g.b}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniform3fv(r,u);case n.MFColorRGBA:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var g=o[p].getValue();u[f++]=g.r,u[f++]=g.g,u[f++]=g.b,u[f++]=g.a}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniform4fv(r,u);case n.MFDouble:case n.MFFloat:case n.MFTime:for(var o=t.getValue(),u=r.array,p=0,h=o.length;p<h;++p)u[p]=o[p].getValue();for(var h=u.length;p<h;++p)u[p]=0;return void e.uniform1fv(r,u);case n.MFImage:var m=t.getValue(),u=r.array,h=this.getImagesLength(t);h!==u.length&&(u=r.array=new Int32Array(h));for(var p=0,c=0,h=m.length;p<h;++p){var o=m[p],l=o.array.getValue();u[c++]=o.width,u[c++]=o.height,u[c++]=o.comp;for(var d=0,x=l.length;d<x;++d)u[c++]=l[d].getValue()}return void e.uniform1iv(r,u);case n.MFMatrix3d:case n.MFMatrix3f:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var y=o[p].getValue();u[f++]=y[0],u[f++]=y[1],u[f++]=y[2],u[f++]=y[3],u[f++]=y[4],u[f++]=y[5],u[f++]=y[6],u[f++]=y[7],u[f++]=y[8]}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniformMatrix3fv(r,!1,u);case n.MFMatrix4d:case n.MFMatrix4f:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var y=o[p].getValue();u[f++]=y[0],u[f++]=y[1],u[f++]=y[2],u[f++]=y[3],u[f++]=y[4],u[f++]=y[5],u[f++]=y[6],u[f++]=y[7],u[f++]=y[8],u[f++]=y[9],u[f++]=y[10],u[f++]=y[11],u[f++]=y[12],u[f++]=y[13],u[f++]=y[14],u[f++]=y[15]}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniformMatrix4fv(r,!1,u);case n.MFNode:for(var o=t.getValue(),p=0,h=o.length;p<h;++p)this.setNode(e,i,r[p],o[p]);for(var h=r.length;p<h;++p)this.setNode(e,i,r[p],a);return;case n.MFRotation:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var y=o[p].getValue().getMatrix(s);u[f++]=y[0],u[f++]=y[1],u[f++]=y[2],u[f++]=y[3],u[f++]=y[4],u[f++]=y[5],u[f++]=y[6],u[f++]=y[7],u[f++]=y[8]}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniformMatrix3fv(r,!1,u);case n.MFString:return;case n.MFVec2d:case n.MFVec2f:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var _=o[p].getValue();u[f++]=_.x,u[f++]=_.y}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniform2fv(r,u);case n.MFVec3d:case n.MFVec3f:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var _=o[p].getValue();u[f++]=_.x,u[f++]=_.y,u[f++]=_.z}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniform3fv(r,u);case n.MFVec4d:case n.MFVec4f:for(var o=t.getValue(),u=r.array,p=0,f=0,h=o.length;p<h;++p){var _=o[p].getValue();u[f++]=_.x,u[f++]=_.y,u[f++]=_.z,u[f++]=_.w}for(var h=u.length;f<h;++f)u[f]=0;return void e.uniform4fv(r,u)}},setNode:function(t,e,r,o){if(r){var s=t.getUniform(e,r);if(!s){if(!this.getBrowser().getCombinedTextureUnits().length)return void console.warn("Not enough combined texture units for uniform variable '",o.getName(),"' available.");s=this.getBrowser().getCombinedTextureUnits().pop(),t.uniform1i(r,s)}t.activeTexture(t.TEXTURE0+s);var a=i(n.X3DTextureNode,o);a&&t.bindTexture(a.getTarget(),a.getTexture()),t.activeTexture(t.TEXTURE0)}},removeNode:function(t,e,i){if(i){var n=t.getUniform(e,i);n&&this.getBrowser().getCombinedTextureUnits().push(n),t.uniform1i(i,0)}},getImagesLength:function(t){for(var e=t.getValue(),i=3*e.length,n=0,r=e.length;n<r;++n)i+=e[n].array.length;return i},getLocationLength:function(t,e,i){for(var n=i.getName(),r=0;;++r){if(!t.getUniformLocation(e,n+"["+r+"]"))break}return r},setClipPlanes:function(t,e){if(e.length){for(var i=0,n=Math.min(this.x3d_MaxClipPlanes,e.length);i<n;++i)e[i].setShaderUniforms(t,this,i);i<this.x3d_MaxClipPlanes&&t.uniform4fv(this.x3d_ClipPlane[i],this.x3d_NoneClipPlane)}else t.uniform4fv(this.x3d_ClipPlane[0],this.x3d_NoneClipPlane)},setGlobalUniforms:function(t,e,i,n){var r=t.getGlobalLights();e.uniform4iv(this.x3d_Viewport,n),e.uniformMatrix4fv(this.x3d_ProjectionMatrix,!1,i),this.numGlobalLights=Math.min(this.x3d_MaxLights,r.length);for(var o=0,s=this.numGlobalLights;o<s;++o)r[o].setShaderUniforms(e,this,o)},setLocalUniforms:function(t,e){var i=e.linePropertiesNode,n=e.materialNode,o=e.textureNode,s=e.textureTransformNode,a=e.modelViewMatrix,u=e.clipPlanes;if(t.uniform1i(this.x3d_GeometryType,e.geometryType),u.length){for(var l=0,h=Math.min(this.x3d_MaxClipPlanes,u.length);l<h;++l)u[l].setShaderUniforms(t,this,l);l<this.x3d_MaxClipPlanes&&t.uniform4fv(this.x3d_ClipPlane[l],this.x3d_NoneClipPlane)}else t.uniform4fv(this.x3d_ClipPlane[0],this.x3d_NoneClipPlane);if(e.fogNode.setShaderUniforms(t,this,e.renderer),i&&i.applied_.getValue()){var c=i.getLinewidthScaleFactor();t.lineWidth(c),t.uniform1f(this.x3d_LinewidthScaleFactor,c)}else t.lineWidth(1),t.uniform1f(this.x3d_LinewidthScaleFactor,1);if(t.uniform1i(this.x3d_ColorMaterial,e.colorMaterial),n){t.uniform1i(this.x3d_Lighting,!0);for(var d=e.localLights,p=Math.min(this.x3d_MaxLights,this.numGlobalLights+d.length),l=this.numGlobalLights,f=0;l<p;++l,++f)d[f].setShaderUniforms(t,this,l);p<this.x3d_MaxLights&&t.uniform1i(this.x3d_LightType[p],0),n.setShaderUniforms(t,this);try{var g=this.normalMatrixArray;g[0]=a[0],g[1]=a[4],g[2]=a[8],g[3]=a[1],g[4]=a[5],g[5]=a[9],g[6]=a[2],g[7]=a[6],g[8]=a[10],r.prototype.inverse.call(g),t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,g)}catch(e){t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,new Float32Array(r.Identity))}}else if(t.uniform1i(this.x3d_Lighting,!1),this.getCustom())try{var g=this.normalMatrixArray;g[0]=a[0],g[1]=a[4],g[2]=a[8],g[3]=a[1],g[4]=a[5],g[5]=a[9],g[6]=a[2],g[7]=a[6],g[8]=a[10],r.prototype.inverse.call(g),t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,g)}catch(e){t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,new Float32Array(r.Identity))}o?(o.setShaderUniforms(t,this,0),s.setShaderUniforms(t,this)):(this.textureTypeArray[0]=0,t.uniform1iv(this.x3d_TextureType,this.textureTypeArray),this.getCustom()&&s.setShaderUniforms(t,this)),t.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,a)},enableFloatAttrib:function(t,e,i,n){var r=t.getAttribLocation(this.getProgram(),e);-1!==r&&(t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(r,n,t.FLOAT,!1,0,0))},disableFloatAttrib:function(t,e){var i=t.getAttribLocation(this.getProgram(),e);-1!==i&&t.disableVertexAttribArray(i)},enableMatrix3Attrib:function(t,e,i){var n=t.getAttribLocation(this.getProgram(),e);-1!==n&&(t.enableVertexAttribArray(n+0),t.enableVertexAttribArray(n+1),t.enableVertexAttribArray(n+2),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(n+0,3,t.FLOAT,!1,36,0),t.vertexAttribPointer(n+1,3,t.FLOAT,!1,36,12),t.vertexAttribPointer(n+2,3,t.FLOAT,!1,36,24))},disableMatrix3Attrib:function(t,e){var i=t.getAttribLocation(this.getProgram(),e);-1!==i&&(t.disableVertexAttribArray(i+0),t.disableVertexAttribArray(i+1),t.disableVertexAttribArray(i+2))},enableMatrix4Attrib:function(t,e,i){var n=t.getAttribLocation(this.getProgram(),e);-1!==n&&(t.enableVertexAttribArray(n+0),t.enableVertexAttribArray(n+1),t.enableVertexAttribArray(n+2),t.enableVertexAttribArray(n+3),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(n+0,4,t.FLOAT,!1,64,0),t.vertexAttribPointer(n+1,4,t.FLOAT,!1,64,16),t.vertexAttribPointer(n+2,4,t.FLOAT,!1,64,32),t.vertexAttribPointer(n+3,4,t.FLOAT,!1,64,48))},disableMatrix4Attrib:function(t,e){var i=t.getAttribLocation(this.getProgram(),e);-1!==i&&(t.disableVertexAttribArray(i+0),t.disableVertexAttribArray(i+1),t.disableVertexAttribArray(i+2),t.disableVertexAttribArray(i+3))},enableColorAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Color),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Color,4,t.FLOAT,!1,0,0)},disableColorAttribute:function(t){t.disableVertexAttribArray(this.x3d_Color)},enableTexCoordAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_TexCoord),t.bindBuffer(t.ARRAY_BUFFER,e[0]),t.vertexAttribPointer(this.x3d_TexCoord,4,t.FLOAT,!1,0,0)},disableTexCoordAttribute:function(t){t.disableVertexAttribArray(this.x3d_TexCoord)},enableNormalAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Normal),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Normal,3,t.FLOAT,!1,0,0)},disableNormalAttribute:function(t){t.disableVertexAttribArray(this.x3d_Normal)},enableVertexAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Vertex),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Vertex,4,t.FLOAT,!1,0,0)},disableVertexAttribute:function(t){t.disableVertexAttribArray(this.x3d_Vertex)},getProgramInfo:function(){for(var e=this.getBrowser().getContext(),i=this.getProgram(),n={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},r=e.getProgramParameter(i,e.ACTIVE_UNIFORMS),o=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES),s={35664:"vec2",35665:"vec3",35666:"vec4",35667:"ivec2",35668:"ivec3",35669:"ivec4",35670:"bool",35671:"bvec2",35672:"bvec3",35673:"bvec4",35674:"mat2",35675:"mat3",35676:"mat4",35678:"sampler2D",35680:"samplerCube",5120:"byte",5121:"ubyte",5122:"short",5123:"ushort",5124:"int",5125:"uint",5126:"float"},a=0;a<r;++a){var u=e.getActiveUniform(i,a);u.typeName=s[u.type],n.uniforms.push(t.extend({},u)),n.uniformCount+=u.size}for(var a=0;a<o;++a){var l=e.getActiveAttrib(i,a);l.typeName=s[l.type],n.attributes.push(t.extend({},l)),n.attributeCount+=l.size}return n.uniforms.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}),n.attributes.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}),n},printProgramInfo:function(){var t=this.getProgramInfo();console.log(this.getName()),console.table(t.attributes),console.log(this.getName(),"attributeCount",t.attributeCount),console.log(this.getName()),console.table(t.uniforms),console.log(this.getName(),"uniformCount",t.uniformCount)}},o}),define("x_ite/Components/Shaders/ComposedShader",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Networking/LoadSensor","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(u.ComposedShader),this.loadSensor=new s(t)}var h=null;return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.inputOnly,"activate",new e.SFBool),new i(u.outputOnly,"isSelected",new e.SFBool),new i(u.outputOnly,"isValid",new e.SFBool),new i(u.initializeOnly,"language",new e.SFString),new i(u.inputOutput,"parts",new e.MFNode)]),wireframe:!1,getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.primitiveMode=t.TRIANGLES,this.isLive().addInterest("set_live__",this),this.activate_.addInterest("set_activate__",this),this.parts_.addFieldInterest(this.loadSensor.watchList_),this.loadSensor.isLoaded_.addInterest("set_loaded__",this),this.loadSensor.watchList_=this.parts_,this.loadSensor.setPrivate(!0),this.loadSensor.setup()},getProgram:function(){return this.program},set_live__:function(){this.isLive().getValue()?this.isValid_.getValue()&&(this.useProgram(this.getBrowser().getContext()),this.addShaderFields()):this.isValid_.getValue()&&(this.useProgram(this.getBrowser().getContext()),this.removeShaderFields())},set_activate__:function(){this.activate_.getValue()&&this.set_loaded__()},set_loaded__:function(){if(this.loadSensor.isLoaded_.getValue()){var t=this.getBrowser().getContext(),e=t.createProgram(),i=this.parts_.getValue(),n=0;this.isValid_.getValue()&&this.removeShaderFields(),this.program=e;for(var r=0,o=i.length;r<o;++r){var s=a(u.ShaderPart,i[r]);s&&(n+=s.isValid(),t.attachShader(e,s.getShader()))}n&&(this.bindAttributeLocations(t,e),t.linkProgram(e),n=n&&t.getProgramParameter(e,t.LINK_STATUS)),n?(this.useProgram(t),this.getDefaultUniforms()?this.addShaderFields():n=!1):console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"': "+t.getProgramInfoLog(e)),n!=this.isValid_.getValue()&&(this.isValid_=n)}else this.isValid_.getValue()&&(this.isValid_=!1)},setGlobalUniforms:function(t,e,i,n){h!==this&&(h=this,e.useProgram(this.program)),o.prototype.setGlobalUniforms.call(this,t,e,i,n)},setLocalUniforms:function(t,e){h!==this&&(h=this,t.useProgram(this.program)),o.prototype.setLocalUniforms.call(this,t,e)},useProgram:function(t){h!==this&&(h=this,t.useProgram(this.program))}}),l}),define("text!x_ite/Browser/Shaders/Bits/Line3.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n/* Line */\n\nstruct Line3 {\n\tvec3 point;\n\tvec3 direction;\n};\n\nLine3\nline3 (in vec3 point1, in vec3 point2)\n{\n\treturn Line3 (point1, normalize (point2 - point1));\n}\n"}),define("text!x_ite/Browser/Shaders/Bits/Plane3.h",[],function(){return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Line3.h"\n\n/* Plane */\n\nstruct Plane3\n{\n\tvec3  normal;\n\tfloat distanceFromOrigin;\n};\n\nPlane3\nplane3 (in vec3 point, in vec3 normal)\n{\n\treturn Plane3 (normal, dot (normal, point));\n}\n\n/* Plane intersect line */\nbool\nintersects (in Plane3 plane, in Line3 line, out vec3 point)\n{\n\tpoint = vec3 (0.0);\n\n\t// Check if the line is parallel to the plane.\n\tfloat theta = dot (line .direction, plane .normal);\n\n\t// Plane and line are parallel.\n\tif (theta == 0.0)\n\t\treturn false;\n\n\t// Plane and line are not parallel. The intersection point can be calculated now.\n\tfloat t = (plane .distanceFromOrigin - dot (plane .normal, line .point)) / theta;\n\n\tpoint = line .point + line .direction * t;\n\n\treturn true;\n}\n\n///  Returns the closest point on the plane to a given point @a point.\nvec3\nclosest_point (in Plane3 plane, in vec3 point)\n{\n\tvec3 closest_point;\n\tintersects (plane, Line3 (point, plane .normal), closest_point);\n\treturn closest_point;\n}\n'}),define("text!x_ite/Browser/Shaders/Bits/Random.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nconst int RAND_MAX = int (0x7fffffff);\nconst int RAND_MIN = int (0x80000000);\n\nint seedValue = 0;\n\nvoid\nseed (in int value)\n{\n\tseedValue = value;\n}\n\n// Return a uniform distributed random floating point number in the interval [-1, 1].\nfloat\nrandom1 ()\n{\n\treturn float (seedValue = seedValue * 1103515245 + 12345) / float (RAND_MAX);\n}\n\nvec2\nrandom2 ()\n{\n\treturn vec2 (random1 (), random1 ());\n}\n\nvec3\nrandom3 ()\n{\n\treturn vec3 (random1 (), random1 (), random1 ());\n}\n"}),define("x_ite/Browser/Shaders/Shader",["text!x_ite/Browser/Shaders/Bits/Line3.h","text!x_ite/Browser/Shaders/Bits/Plane3.h","text!x_ite/Browser/Shaders/Bits/Random.h"],function(t,e,i){"use strict";var n={Line3:t,Plane3:e,Random:i},r=/#pragma\s+X3D\s+include\s+".*?([^\/]+).h"/;return{getShaderSource:function(t,e){for(var i=null;i=e.match(r);)e=e.replace(i[0],n[i[1]]);var o="";return o+="#define x3d_GeometryPoints  0\n",o+="#define x3d_GeometryLines   1\n",o+="#define x3d_Geometry2D      2\n",o+="#define x3d_Geometry3D      3\n",o+="#define x3d_MaxClipPlanes  "+t.getMaxClipPlanes()+"\n",o+="#define x3d_NoneClipPlane  vec4 (88.0, 51.0, 68.0, 33.0)\n",o+="#define x3d_NoneFog          0\n",o+="#define x3d_LinearFog        1\n",o+="#define x3d_ExponentialFog   2\n",o+="#define x3d_Exponential2Fog  3\n",o+="#define x3d_MaxLights         "+t.getMaxLights()+"\n",o+="#define x3d_NoneLight         0\n",o+="#define x3d_DirectionalLight  1\n",o+="#define x3d_PointLight        2\n",o+="#define x3d_SpotLight         3\n",o+="#define x3d_MaxTextures                "+t.getMaxTextures()+"\n",o+="#define x3d_NoneTexture                0\n",o+="#define x3d_TextureType2D              2\n",o+="#define x3d_TextureType3D              3\n",o+="#define x3d_TextureTypeCubeMapTexture  4\n",o+="#define X3D_SHADOWS\n",o+="#define x3d_MaxShadows     4\n",o+="#define x3d_ShadowSamples  8\n",(o+="#line 1\n")+e}}}),define("x_ite/Parser/HTMLSupport",[],function(){"use strict";var t={attributeLowerCaseToCamelCase:{accesstype:"accessType",actionkeypress:"actionKeyPress",actionkeyrelease:"actionKeyRelease",activate:"activate",activelayer:"activeLayer",additionalinterface:"additionalInterface",address:"address",align:"align",alpha:"alpha",altkey:"altKey",ambientintensity:"ambientIntensity",anchorpoint:"anchorPoint",angle:"angle",
anglerate:"angleRate",angulardampingfactor:"angularDampingFactor",angularvelocity:"angularVelocity",anisotropicdegree:"anisotropicDegree",antennalocation:"antennaLocation",antennapatternlength:"antennaPatternLength",antennapatterntype:"antennaPatternType",appinfo:"appinfo",applicationid:"applicationID",applied:"applied",appliedparameters:"appliedParameters",articulationparameterarray:"articulationParameterArray",articulationparameterchangeindicatorarray:"articulationParameterChangeIndicatorArray",articulationparametercount:"articulationParameterCount",articulationparameterdesignatorarray:"articulationParameterDesignatorArray",articulationparameteridpartattachedtoarray:"articulationParameterIdPartAttachedToArray",articulationparametertypearray:"articulationParameterTypeArray",articulationparametervalue0_changed:"articulationParameterValue0_changed",articulationparametervalue1_changed:"articulationParameterValue1_changed",articulationparametervalue2_changed:"articulationParameterValue2_changed",articulationparametervalue3_changed:"articulationParameterValue3_changed",articulationparametervalue4_changed:"articulationParameterValue4_changed",articulationparametervalue5_changed:"articulationParameterValue5_changed",articulationparametervalue6_changed:"articulationParameterValue6_changed",articulationparametervalue7_changed:"articulationParameterValue7_changed",as:"AS",attenuation:"attenuation",autocalc:"autoCalc",autodamp:"autoDamp",autodisable:"autoDisable",autooffset:"autoOffset",avatarsize:"avatarSize",axis:"axis",axis1:"axis1",axis1angle:"axis1Angle",axis1torque:"axis1Torque",axis2:"axis2",axis2angle:"axis2Angle",axis2torque:"axis2Torque",axis3angle:"axis3Angle",axis3torque:"axis3Torque",axisofrotation:"axisOfRotation",axisrotation:"axisRotation",backambientintensity:"backAmbientIntensity",backdiffusecolor:"backDiffuseColor",backemissivecolor:"backEmissiveColor",backshininess:"backShininess",backspecularcolor:"backSpecularColor",backtransparency:"backTransparency",backurl:"backUrl",bboxcenter:"bboxCenter",bboxsize:"bboxSize",beamwidth:"beamWidth",begincap:"beginCap",bindtime:"bindTime",body1anchorpoint:"body1AnchorPoint",body1axis:"body1Axis",body2anchorpoint:"body2AnchorPoint",body2axis:"body2Axis",bordercolor:"borderColor",borderwidth:"borderWidth",bottom:"bottom",bottomradius:"bottomRadius",bottomurl:"bottomUrl",bounce:"bounce",boundarymoder:"boundaryModeR",boundarymodes:"boundaryModeS",boundarymodet:"boundaryModeT",boundaryopacity:"boundaryOpacity",category:"category",ccw:"ccw",center:"center",centerofmass:"centerOfMass",centerofrotation:"centerOfRotation",centerofrotation_changed:"centerOfRotation_changed",child1url:"child1Url",child2url:"child2Url",child3url:"child3Url",child4url:"child4Url",class:"class",clipboundary:"clipBoundary",closed:"closed",closuretype:"closureType",collidetime:"collideTime",collisiontype:"collisionType",color:"color",colorindex:"colorIndex",colorkey:"colorKey",colorpervertex:"colorPerVertex",colorsteps:"colorSteps",constantforcemix:"constantForceMix",contactnormal:"contactNormal",contactsurfacethickness:"contactSurfaceThickness",containerfield:"containerField",content:"content",contourstepsize:"contourStepSize",controlkey:"controlKey",controlpoint:"controlPoint",conversionfactor:"conversionFactor",convex:"convex",coolcolor:"coolColor",coordindex:"coordIndex",country:"country",creaseangle:"creaseAngle",createparticles:"createParticles",crosssection:"crossSection",cryptokeyid:"cryptoKeyID",cryptosystem:"cryptoSystem",cutoffangle:"cutOffAngle",cycleinterval:"cycleInterval",cycletime:"cycleTime",data:"data",datalength:"dataLength",deadreckoning:"deadReckoning",def:"DEF",deletionallowed:"deletionAllowed",depth:"depth",description:"description",desiredangularvelocity1:"desiredAngularVelocity1",desiredangularvelocity2:"desiredAngularVelocity2",detonatetime:"detonateTime",detonationlocation:"detonationLocation",detonationrelativelocation:"detonationRelativeLocation",detonationresult:"detonationResult",diffusecolor:"diffuseColor",dimensions:"dimensions",dir:"dir",direction:"direction",directoutput:"directOutput",disableangularspeed:"disableAngularSpeed",disablelinearspeed:"disableLinearSpeed",disabletime:"disableTime",diskangle:"diskAngle",displacements:"displacements",displayed:"displayed",documentation:"documentation",domain:"domain",duration:"duration",duration_changed:"duration_changed",easeineaseout:"easeInEaseOut",edgecolor:"edgeColor",elapsedtime:"elapsedTime",emissivecolor:"emissiveColor",enabled:"enabled",enabledaxes:"enabledAxes",encodingscheme:"encodingScheme",endangle:"endAngle",endcap:"endCap",enteredtext:"enteredText",entertime:"enterTime",entitycategory:"entityCategory",entitycountry:"entityCountry",entitydomain:"entityDomain",entityextra:"entityExtra",entityid:"entityID",entitykind:"entityKind",entityspecific:"entitySpecific",entitysubcategory:"entitySubcategory",errorcorrection:"errorCorrection",eventapplicationid:"eventApplicationID",evententityid:"eventEntityID",eventnumber:"eventNumber",eventsiteid:"eventSiteID",exittime:"exitTime",extra:"extra",family:"family",fancount:"fanCount",fieldofview:"fieldOfView",filled:"filled",finaltext:"finalText",finiterotationaxis:"finiteRotationAxis",fired1:"fired1",fired2:"fired2",firedtime:"firedTime",firemissionindex:"fireMissionIndex",firingrange:"firingRange",firingrate:"firingRate",fixed:"fixed",fogtype:"fogType",force:"force",forceid:"forceID",forceoutput:"forceOutput",forces:"forces",forcetransitions:"forceTransitions",fraction_changed:"fraction_changed",frequency:"frequency",frictioncoefficients:"frictionCoefficients",frictiondirection:"frictionDirection",fromfield:"fromField",fromnode:"fromNode",fronturl:"frontUrl",function:"function",fuse:"fuse",generatemipmaps:"generateMipMaps",geocenter:"geoCenter",geocoord_changed:"geoCoord_changed",geocoords:"geoCoords",geogridorigin:"geoGridOrigin",geometrytype:"geometryType",geosystem:"geoSystem",geovalue_changed:"geovalue_changed",global:"global",gradientthreshold:"gradientThreshold",gravity:"gravity",groundangle:"groundAngle",groundcolor:"groundColor",gustiness:"gustiness",hatchcolor:"hatchColor",hatched:"hatched",hatchstyle:"hatchStyle",headlight:"headlight",height:"height",hinge1angle:"hinge1Angle",hinge1anglerate:"hinge1AngleRate",hinge2angle:"hinge2Angle",hinge2anglerate:"hinge2AngleRate",hitgeocoord_changed:"hitGeoCoord_changed",hitnormal_changed:"hitNormal_changed",hitpoint_changed:"hitPoint_changed",hittexcoord_changed:"hitTexCoord_changed",horizontal:"horizontal","http-equiv":"http-equiv",image:"image",importeddef:"importedDEF",index:"index",inertia:"inertia",info:"info",initialdestination:"initialDestination",initialvalue:"initialValue",inlinedef:"inlineDEF",innerradius:"innerRadius",inputfalse:"inputFalse",inputnegate:"inputNegate",inputsource:"inputSource",inputtrue:"inputTrue",integerkey:"integerKey",intensity:"intensity",intensitythreshold:"intensityThreshold",internal:"internal",intersectiontype:"intersectionType",isactive:"isActive",isbound:"isBound",iscollided:"isCollided",isdetonated:"isDetonated",isloaded:"isLoaded",isnetworkreader:"isNetworkReader",isnetworkwriter:"isNetworkWriter",isover:"isOver",ispaused:"isPaused",ispickable:"isPickable",isrtpheaderheard:"isRtpHeaderHeard",isselected:"isSelected",isstandalone:"isStandAlone",isvalid:"isValid",iterations:"iterations",jump:"jump",justify:"justify",key:"key",keypress:"keyPress",keyrelease:"keyRelease",keyvalue:"keyValue",keyvelocity:"keyVelocity",kind:"kind",knot:"knot",lang:"lang",language:"language",lefttoright:"leftToRight",lefturl:"leftUrl",length:"length",lengthofmodulationparameters:"lengthOfModulationParameters",level:"level",level_changed:"level_changed",lifetimevariation:"lifetimeVariation",lighting:"lighting",limitorientation:"limitOrientation",linearacceleration:"linearAcceleration",lineardampingfactor:"linearDampingFactor",linearvelocity:"linearVelocity",linebounds:"lineBounds",linesegments:"lineSegments",linetype:"linetype",linewidthscalefactor:"linewidthScaleFactor",llimit:"llimit",load:"load",loadtime:"loadTime",localdef:"localDEF",location:"location",loop:"loop",magnificationfilter:"magnificationFilter",marking:"marking",mass:"mass",matrix:"matrix",maxangle:"maxAngle",maxangle1:"maxAngle1",maxback:"maxBack",maxcorrectionspeed:"maxCorrectionSpeed",maxextent:"maxExtent",maxfront:"maxFront",maxparticles:"maxParticles",maxposition:"maxPosition",maxseparation:"maxSeparation",maxtorque1:"maxTorque1",maxtorque2:"maxTorque2",minangle:"minAngle",minangle1:"minAngle1",minback:"minBack",minbouncespeed:"minBounceSpeed",minfront:"minFront",minificationfilter:"minificationFilter",minposition:"minPosition",minseparation:"minSeparation",mode:"mode",modifiedfraction_changed:"modifiedFraction_changed",modulationtypedetail:"modulationTypeDetail",modulationtypemajor:"modulationTypeMajor",modulationtypespreadspectrum:"modulationTypeSpreadSpectrum",modulationtypesystem:"modulationTypeSystem",momentsofinertia:"momentsOfInertia",motor1angle:"motor1Angle",motor1anglerate:"motor1AngleRate",motor1axis:"motor1Axis",motor2angle:"motor2Angle",motor2anglerate:"motor2AngleRate",motor2axis:"motor2Axis",motor3angle:"motor3Angle",motor3anglerate:"motor3AngleRate",motor3axis:"motor3Axis",multicastrelayhost:"multicastRelayHost",multicastrelayport:"multicastRelayPort",munitionapplicationid:"munitionApplicationID",munitionendpoint:"munitionEndPoint",munitionentityid:"munitionEntityID",munitionquantity:"munitionQuantity",munitionsiteid:"munitionSiteID",munitionstartpoint:"munitionStartPoint",mustevaluate:"mustEvaluate",name:"name",networkmode:"networkMode",next:"next",nodefield:"nodeField",normal_changed:"normal_changed",normalindex:"normalIndex",normalizevelocity:"normalizeVelocity",normalpervertex:"normalPerVertex",numcomponents:"numComponents",objecttype:"objectType",offset:"offset",offsetunits:"offsetUnits",on:"on",opacityfactor:"opacityFactor",order:"order",orientation:"orientation",orientation_changed:"orientation_changed",origin:"origin",orthogonalcolor:"orthogonalColor",outerradius:"outerRadius",parallelcolor:"parallelColor",parameter:"parameter",particlelifetime:"particleLifetime",particlesize:"particleSize",pausetime:"pauseTime",phasefunction:"phaseFunction",pickable:"pickable",pickednormal:"pickedNormal",pickedpoint:"pickedPoint",pickedtexturecoordinate:"pickedTextureCoordinate",pitch:"pitch",plane:"plane",point:"point",pointsize:"pointSize",port:"port",position:"position",position_changed:"position_changed",power:"power",preferaccuracy:"preferAccuracy",previous:"previous",priority:"priority",profile:"profile",progress:"progress",protofield:"protoField",radioentitytypecategory:"radioEntityTypeCategory",radioentitytypecountry:"radioEntityTypeCountry",radioentitytypedomain:"radioEntityTypeDomain",radioentitytypekind:"radioEntityTypeKind",radioentitytypenomenclature:"radioEntityTypeNomenclature",radioentitytypenomenclatureversion:"radioEntityTypeNomenclatureVersion",radioid:"radioID",radius:"radius",range:"range",readinterval:"readInterval",receivedpower:"receivedPower",receiverstate:"receiverState",reference:"reference",relativeantennalocation:"relativeAntennaLocation",repeatr:"repeatR",repeats:"repeatS",repeatt:"repeatT",resumetime:"resumeTime",retainedopacity:"retainedOpacity",retainuseroffsets:"retainUserOffsets",righturl:"rightUrl",rooturl:"rootUrl",rotateyup:"rotateYUp",rotation:"rotation",rotation_changed:"rotation_changed",rtpheaderexpected:"rtpHeaderExpected",samplerate:"sampleRate",samples:"samples",scale:"scale",scalemode:"scaleMode",scaleorientation:"scaleOrientation",scheme:"scheme",segmentenabled:"segmentEnabled",separatebackcolor:"separateBackColor",separation:"separation",separationrate:"separationRate",set_articulationparametervalue0:"set_articulationParameterValue0",set_articulationparametervalue1:"set_articulationParameterValue1",set_articulationparametervalue2:"set_articulationParameterValue2",set_articulationparametervalue3:"set_articulationParameterValue3",set_articulationparametervalue4:"set_articulationParameterValue4",set_articulationparametervalue5:"set_articulationParameterValue5",set_articulationparametervalue6:"set_articulationParameterValue6",set_articulationparametervalue7:"set_articulationParameterValue7",set_bind:"set_bind",set_boolean:"set_boolean",set_colorindex:"set_colorIndex",set_coordindex:"set_coordIndex",set_crosssection:"set_crossSection",set_destination:"set_destination",set_fraction:"set_fraction",set_height:"set_height",set_index:"set_index",set_normalindex:"set_normalIndex",set_orientation:"set_orientation",set_scale:"set_scale",set_spine:"set_spine",set_texcoordindex:"set_texCoordIndex",set_triggertime:"set_triggerTime",set_value:"set_value",shadows:"shadows",shiftkey:"shiftKey",shininess:"shininess",side:"side",silhouetteboundaryopacity:"silhouetteBoundaryOpacity",silhouetteretainedopacity:"silhouetteRetainedOpacity",silhouettesharpness:"silhouetteSharpness",siteid:"siteID",size:"size",sizeunits:"sizeUnits",skincoordindex:"skinCoordIndex",skincoordweight:"skinCoordWeight",skyangle:"skyAngle",skycolor:"skyColor",sliderforce:"sliderForce",slipcoefficients:"slipCoefficients",slipfactors:"slipFactors",softnessconstantforcemix:"softnessConstantForceMix",softnesserrorcorrection:"softnessErrorCorrection",solid:"solid",sortorder:"sortOrder",source:"source",spacing:"spacing",spatialize:"spatialize",specific:"specific",specularcolor:"specularColor",speed:"speed",speedfactor:"speedFactor",spine:"spine",startangle:"startAngle",starttime:"startTime",stiffness:"stiffness",stop1bounce:"stop1Bounce",stop1constantforcemix:"stop1ConstantForceMix",stop1errorcorrection:"stop1ErrorCorrection",stop2bounce:"stop2Bounce",stop2errorcorrection:"stop2ErrorCorrection",stop3bounce:"stop3Bounce",stop3errorcorrection:"stop3ErrorCorrection",stopbounce:"stopBounce",stoperrorcorrection:"stopErrorCorrection",stoptime:"stopTime",string:"string",stripcount:"stripCount",style:"style",subcategory:"subcategory",summary:"summary",surfacearea:"surfaceArea",surfacespeed:"surfaceSpeed",surfacetolerance:"surfaceTolerance",surfacevalues:"surfaceValues",suspensionerrorcorrection:"suspensionErrorCorrection",suspensionforce:"suspensionForce",tau:"tau",tdltype:"tdlType",tessellation:"tessellation",tessellationscale:"tessellationScale",texcoordindex:"texCoordIndex",texcoordkey:"texCoordKey",textbounds:"textBounds",texturecompression:"textureCompression",texturepriority:"texturePriority",time:"time",timeout:"timeOut",timestamp:"timestamp",title:"title",tofield:"toField",toggle:"toggle",tolerance:"tolerance",tonode:"toNode",top:"top",toptobottom:"topToBottom",topurl:"topUrl",torques:"torques",touchtime:"touchTime",trackpoint_changed:"trackPoint_changed",transitioncomplete:"transitionComplete",transitiontime:"transitionTime",transitiontype:"transitionType",translation:"translation",translation_changed:"translation_changed",transmitfrequencybandwidth:"transmitFrequencyBandwidth",transmitstate:"transmitState",transmitterapplicationid:"transmitterApplicationID",transmitterentityid:"transmitterEntityID",transmitterradioid:"transmitterRadioID",transmittersiteid:"transmitterSiteID",transparency:"transparency",triggertime:"triggerTime",triggertrue:"triggerTrue",triggervalue:"triggerValue",turbulence:"turbulence",type:"type",uclosed:"uClosed",udimension:"uDimension",uknot:"uKnot",ulimit:"ulimit",uorder:"uOrder",update:"update",url:"url",use:"USE",usefiniterotation:"useFiniteRotation",usegeometry:"useGeometry",useglobalgravity:"useGlobalGravity",utessellation:"uTessellation",value:"value",value_changed:"value_changed",variation:"variation",vclosed:"vClosed",vdimension:"vDimension",vector:"vector",version:"version",vertexcount:"vertexCount",vertices:"vertices",visibilitylimit:"visibilityLimit",visibilityrange:"visibilityRange",visible:"visible",vknot:"vKnot",vorder:"vOrder",vtessellation:"vTessellation",warhead:"warhead",warmcolor:"warmColor",weight:"weight",weightconstant1:"weightConstant1",weightconstant2:"weightConstant2",weightfunction1:"weightFunction1",weightfunction2:"weightFunction2",whichchoice:"whichChoice",whichgeometry:"whichGeometry",writeinterval:"writeInterval",xdimension:"xDimension",xspacing:"xSpacing",yscale:"yScale",zdimension:"zDimension",zspacing:"zSpacing"}};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Parser/XMLParser",["jquery","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Basic/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/X3DParser","x_ite/Parser/HTMLSupport","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){a.call(this,t),this.protoDeclarations=[],this.parents=[],this.parser=new s(t,!0),this.url=new o.MFString;try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}}var p={initializeOnly:c.initializeOnly,inputOnly:c.inputOnly,outputOnly:c.outputOnly,inputOutput:c.inputOutput};return d.prototype=t.extend(Object.create(a.prototype),{constructor:d,parseIntoScene:function(t){this.getScene().setEncoding("XML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.xmlElement(t)},parseIntoNode:function(t,e){this.pushExecutionContext(t.getExecutionContext()),this.pushParent(t),this.childElement(e),this.popParent(),this.popExecutionContext()},xmlElement:function(e){switch(e.nodeName){case"#document":var i=t(e).children("X3D");if(i.length)for(var n=0;n<i.length;++n)this.x3dElement(i[n]);else this.childrenElements(e);break;case"X3D":this.x3dElement(e);break;case"Scene":case"SCENE":this.sceneElement(e);break;default:this.childElement(e)}},x3dElement:function(t){try{var e=t.getAttribute("profile"),i=this.getBrowser().getProfile(e||"Full");this.getScene().setProfile(i)}catch(t){console.log(t)}var n=t.getAttribute("version");n&&(this.getScene().specificationVersion=n);for(var r=t.childNodes,o=0;o<r.length;++o)this.x3dElementChild(r[o])},x3dElementChild:function(t){switch(t.nodeName){case"head":case"HEAD":return void this.headElement(t);case"Scene":case"SCENE":return void this.sceneElement(t)}},headElement:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.headElementChild(e[i]);try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}},headElementChild:function(t){switch(t.nodeName){case"component":case"COMPONENT":return void this.componentElement(t);case"unit":case"UNIT":return void this.unitElement(t);case"meta":case"META":return void this.metaElement(t)}},componentElement:function(t){try{var e=t.getAttribute("name"),i=parseInt(t.getAttribute("level"));if(null===e)return console.warn("XML Parser Error: Bad component statement: Expected name attribute.");if(null===i)return console.warn("XML Parser Error: Bad component statement: Expected level attribute.");var n=this.getBrowser().getComponent(e,i);this.getScene().addComponent(n)}catch(t){console.log(t.message)}},unitElement:function(t){var e=t.getAttribute("category"),i=t.getAttribute("name"),n=t.getAttribute("conversionFactor");return null===e?console.warn("XML Parser Error: Bad unit statement: Expected category attribute."):null===i?console.warn("XML Parser Error: Bad unit statement: Expected name attribute."):null===n?console.warn("XML Parser Error: Bad unit statement: Expected conversionFactor attribute."):void this.getScene().updateUnit(e,i,parseFloat(n))},metaElement:function(t){var e=t.getAttribute("name"),i=t.getAttribute("content");return null===e?console.warn("XML Parser Error: Bad meta statement: Expected name attribute."):null===i?console.warn("XML Parser Error: Bad meta statement: Expected content attribute."):void this.getScene().setMetaData(e,i)},sceneElement:function(t){this.childrenElements(t)},childrenElements:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.childElement(e[i])},childElement:function(t){switch(t.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdataNode(t);case"ExternProtoDeclare":case"EXTERNPROTODECLARE":return void this.externProtoDeclareElement(t);case"ProtoDeclare":case"PROTODECLARE":return void this.protoDeclareElement(t);case"IS":return void this.isElement(t);case"ProtoInstance":case"PROTOINSTANCE":return void this.protoInstanceElement(t);case"fieldValue":case"FIELDVALUE":return void this.fieldValueElement(t);case"field":case"FIELD":return void this.fieldElement(t);case"ROUTE":return void this.routeElement(t);case"IMPORT":return void this.importElement(t);case"EXPORT":return void this.exportElement(t);default:return void this.nodeElement(t)}},externProtoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){var i=t.getAttribute("url");if(null===i)return console.warn("XML Parser Error: Bad ExternProtoDeclare statement: Expected url attribute.");this.parser.setInput(i),s.prototype.sfstringValues.call(this.parser,this.url);var n=new l(this.getExecutionContext());this.pushParent(n),this.protoInterfaceElement(t),this.popParent(),n.setName(e),n.url_=this.url,n.setup(),this.getExecutionContext().externprotos.add(e,n)}},protoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){for(var i=new h(this.getExecutionContext()),n=t.childNodes,r=0;r<n.length;++r){var o=n[r];switch(o.nodeName){case"ProtoInterface":case"PROTOINTERFACE":this.pushParent(i),this.protoInterfaceElement(o),this.popParent();break;default:continue}break}for(var r=0;r<n.length;++r){var o=n[r];switch(o.nodeName){case"ProtoBody":case"PROTOBODY":this.pushExecutionContext(i),this.pushParent(i),this.protoBodyElement(o),this.popParent(),this.popExecutionContext();break;default:continue}break}i.setName(e),i.setup(),this.getExecutionContext().protos.add(e,i)}},protoInterfaceElement:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.protoInterfaceElementChild(e[i])},protoInterfaceElementChild:function(t){switch(t.nodeName){case"field":case"FIELD":return void this.fieldElement(t)}},fieldElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent();if(!(e instanceof n))return;if(!e.hasUserDefinedFields())return;var i=p[t.getAttribute("accessType")];void 0===i&&(i=c.initializeOnly);var r=o[t.getAttribute("type")];if(void 0===r)return;var s=t.getAttribute("name");if(!this.id(s))return;var a=new r;i&c.initializeOnly&&(this.fieldValue(a,t.getAttribute("value")),this.pushParent(a),this.childrenElements(t),this.popParent()),e.addUserDefinedField(i,s,a)}catch(t){}},protoBodyElement:function(t){this.childrenElements(t)},isElement:function(t){if(this.getExecutionContext()instanceof h)for(var e=t.childNodes,i=0;i<e.length;++i)this.isElementChild(e[i])},isElementChild:function(t){switch(t.nodeName){case"connect":case"CONNECT":return void this.connectElement(t)}},connectElement:function(t){var e=t.getAttribute("nodeField"),i=t.getAttribute("protoField");if(null===e)return console.warn("XML Parser Error: Bad connect statement: Expected nodeField attribute.");if(null===i)return console.warn("XML Parser Error: Bad connect statement: Expected protoField attribute.");try{if(0===this.getParents().length)return;var r=this.getParent(),o=this.getExecutionContext();if(!(r instanceof n))return;var s=r.getField(e),a=o.getField(i);if(s.getType()!==a.getType())throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.");if(!a.isReference(s.getAccessType()))throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.");s.addReference(a)}catch(t){console.warn("XML Parser Error: Couldn't create IS reference: "+t.message)}},protoInstanceElement:function(t){try{if(this.useAttribute(t))return;var e=t.getAttribute("name");if(this.id(e)){var i=this.getExecutionContext().createProto(e,!1);t.x3d=i,this.defAttribute(t,i),this.addNode(t,i),this.pushParent(i),this.childrenElements(t),this.getExecutionContext().addUninitializedNode(i),this.popParent()}}catch(t){console.warn("XML Parser Error: ",t.message)}},fieldValueElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent(),i=t.getAttribute("name");if(!(e instanceof r))return;if(!this.id(i))return;var n=e.getField(i);n.getAccessType()&c.initializeOnly&&(this.fieldValue(n,t.getAttribute("value")),this.pushParent(n),this.childrenElements(t),this.popParent())}catch(t){console.warn("XML Parser Error: Couldn't assign field value: "+t.message)}},nodeElement:function(t){try{if(this.useAttribute(t))return;var e=this.getExecutionContext().createNode(t.nodeName,!1);t.x3d=e,this.defAttribute(t,e),this.addNode(t,e),this.pushParent(e),this.nodeAttributes(t,e),this.childrenElements(t),this.getExecutionContext().addUninitializedNode(e),this.popParent()}catch(t){console.error("XML Parser Error: "+t.message)}},routeElement:function(t){try{var e=t.getAttribute("fromNode"),i=t.getAttribute("fromField"),n=t.getAttribute("toNode"),r=t.getAttribute("toField");if(null===e)throw new Error("Bad ROUTE statement: Expected fromNode attribute.");if(null===i)throw new Error("Bad ROUTE statement: Expected fromField attribute.");if(null===n)throw new Error("Bad ROUTE statement: Expected toNode attribute.");if(null===r)throw new Error("Bad ROUTE statement: Expected toField attribute.");var o=this.getExecutionContext(),s=o.getLocalNode(e),a=o.getLocalNode(n),u=o.addRoute(s,i,a,r);t.x3d=u}catch(t){console.warn("XML Parser Error: "+t.message)}},importElement:function(t){try{var e=t.getAttribute("inlineDEF"),i=t.getAttribute("exportedDEF"),n=t.getAttribute("AS");if(null===e)throw new Error("Bad IMPORT statement: Expected exportedDEF attribute.");if(null===i)throw new Error("Bad IMPORT statement: Expected exportedDEF attribute.");n||(n=i);var r=this.getExecutionContext().getNamedNode(e);this.getExecutionContext().updateImportedNode(r,i,n)}catch(t){console.warn("XML Parser Error: "+t.message)}},exportElement:function(t){try{if(this.getScene()!==this.getExecutionContext())return;var e=t.getAttribute("localDEF"),i=t.getAttribute("AS");if(null===e)throw new Error("Bad EXPORT statement: Expected localDEF attribute.");i||(i=e);var n=this.getExecutionContext().getLocalNode(e);this.getScene().updateExportedNode(i,n)}catch(t){console.warn("XML Parser Error: "+t.message)}},cdataNode:function(t){if(0!==this.getParents().length){var e=this.getParent();if(e instanceof n){var i=e.getSourceText();i&&(i.push(t.data),i.setSet(!0))}}},useAttribute:function(t){try{var e=t.getAttribute("USE");if(this.id(e)){var i=this.getExecutionContext().getNamedNode(e);return this.addNode(t,i.getValue()),!0}}catch(t){console.warn("Invalid USE name: "+t.message)}return!1},defAttribute:function(t,e){try{var i=t.getAttribute("DEF");if(i){try{var n=this.getExecutionContext().getNamedNode(i);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(i),n)}catch(t){}this.getExecutionContext().updateNamedNode(i,e)}}catch(t){console.warn("Invalid DEF name: "+t.message)}},nodeAttributes:function(t,e){for(var i=t.attributes,n=0;n<i.length;++n)this.nodeAttribute(i[n],e)},nodeAttribute:function(t,e){try{var i=e.getField(this.attributeToCamelCase(t.name));this.fieldValue(i,t.value)}catch(t){}},fieldValue:function(t,e){null!==e&&(t.setSet(!0),this.parser.pushExecutionContext(this.getExecutionContext()),this.parser.setInput(e),this.fieldTypes[t.getType()].call(this.parser,t),this.parser.popExecutionContext())},addNode:function(t,i){if(0===this.parents.length||this.getParent()instanceof h)return void this.getExecutionContext().rootNodes.push(i);var n=this.getParent();if(n instanceof e)switch(n.getType()){case c.SFNode:return n.setValue(i),void n.setSet(!0);case c.MFNode:return n.push(i),void n.setSet(!0)}else try{var r=t.getAttribute("containerField");r||(r=i.getContainerField());var o=n.getField(r);switch(o.getType()){case c.SFNode:return o.setValue(i),void o.setSet(!0);case c.MFNode:return o.push(i),void o.setSet(!0)}}catch(t){}},getParents:function(){return this.parents},getParent:function(){return this.parents[this.parents.length-1]},pushParent:function(t){return this.parents.push(t)},popParent:function(){this.parents.pop()},id:function(t){return null!==t&&0!==t.length},attributeToCamelCase:function(t){return t!==t.toLowerCase()?t:u.attributeLowerCaseToCamelCase[t]}}),d.prototype.fieldTypes=[],d.prototype.fieldTypes[c.SFBool]=s.prototype.sfboolValue,d.prototype.fieldTypes[c.SFColor]=s.prototype.sfcolorValue,d.prototype.fieldTypes[c.SFColorRGBA]=s.prototype.sfcolorrgbaValue,d.prototype.fieldTypes[c.SFDouble]=s.prototype.sfdoubleValue,d.prototype.fieldTypes[c.SFFloat]=s.prototype.sffloatValue,d.prototype.fieldTypes[c.SFImage]=s.prototype.sfimageValue,d.prototype.fieldTypes[c.SFInt32]=s.prototype.sfint32Value,d.prototype.fieldTypes[c.SFMatrix3f]=s.prototype.sfmatrix3dValue,d.prototype.fieldTypes[c.SFMatrix3d]=s.prototype.sfmatrix3fValue,d.prototype.fieldTypes[c.SFMatrix4f]=s.prototype.sfmatrix4dValue,d.prototype.fieldTypes[c.SFMatrix4d]=s.prototype.sfmatrix4fValue,d.prototype.fieldTypes[c.SFNode]=function(t){t.set(null)},d.prototype.fieldTypes[c.SFRotation]=s.prototype.sfrotationValue,d.prototype.fieldTypes[c.SFString]=function(t){t.set(this.input)},d.prototype.fieldTypes[c.SFTime]=s.prototype.sftimeValue,d.prototype.fieldTypes[c.SFVec2d]=s.prototype.sfvec2dValue,d.prototype.fieldTypes[c.SFVec2f]=s.prototype.sfvec2fValue,d.prototype.fieldTypes[c.SFVec3d]=s.prototype.sfvec3dValue,d.prototype.fieldTypes[c.SFVec3f]=s.prototype.sfvec3fValue,d.prototype.fieldTypes[c.SFVec4d]=s.prototype.sfvec4dValue,d.prototype.fieldTypes[c.SFVec4f]=s.prototype.sfvec4fValue,d.prototype.fieldTypes[c.MFBool]=s.prototype.sfboolValues,d.prototype.fieldTypes[c.MFColor]=s.prototype.sfcolorValues,d.prototype.fieldTypes[c.MFColorRGBA]=s.prototype.sfcolorrgbaValues,d.prototype.fieldTypes[c.MFDouble]=s.prototype.sfdoubleValues,d.prototype.fieldTypes[c.MFFloat]=s.prototype.sffloatValues,d.prototype.fieldTypes[c.MFImage]=s.prototype.sfimageValues,d.prototype.fieldTypes[c.MFInt32]=s.prototype.sfint32Values,d.prototype.fieldTypes[c.MFMatrix3d]=s.prototype.sfmatrix3dValues,d.prototype.fieldTypes[c.MFMatrix3f]=s.prototype.sfmatrix3fValues,d.prototype.fieldTypes[c.MFMatrix4d]=s.prototype.sfmatrix4dValues,d.prototype.fieldTypes[c.MFMatrix4f]=s.prototype.sfmatrix4fValues,d.prototype.fieldTypes[c.MFNode]=function(){},d.prototype.fieldTypes[c.MFRotation]=s.prototype.sfrotationValues,d.prototype.fieldTypes[c.MFString]=s.prototype.sfstringValues,d.prototype.fieldTypes[c.MFTime]=s.prototype.sftimeValues,d.prototype.fieldTypes[c.MFVec2d]=s.prototype.sfvec2dValues,d.prototype.fieldTypes[c.MFVec2f]=s.prototype.sfvec2fValues,d.prototype.fieldTypes[c.MFVec3d]=s.prototype.sfvec3dValues,d.prototype.fieldTypes[c.MFVec3f]=s.prototype.sfvec3fValues,d.prototype.fieldTypes[c.MFVec4d]=s.prototype.sfvec4dValues,d.prototype.fieldTypes[c.MFVec4f]=s.prototype.sfvec4fValues,d}),define("standard/Networking/BinaryTransport",[],function(){"use strict";return function(t){t.ajaxTransport("+binary",function(t,e,i){if(t.dataType&&"binary"==t.dataType)return{send:function(e,i){var n=t.xhr();if(n.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(var r in t.xhrFields)n[r]=t.xhrFields[r];t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType);for(var r in e)n.setRequestHeader(r,e[r]);n.onload=function(){n.onload=n.onerror=null;var e={};e[t.dataType]=n.response,i(n.status,n.statusText,e,n.getAllResponseHeaders())},n.onerror=function(){n.onload=n.onerror=null,i(n.status||404,n.statusText)},n.responseType=t.responseType||"blob",n.send(t.hasContent&&t.data||null)},abort:function(){var e=t.xhr();e.onload=e.onerror=null,e.abort()}}})}}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("pako_inflate/dist/pako_inflate",[],t);else{var e
;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.pako=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return r(i||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}}return t},i.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)return void t.set(e.subarray(i,i+n),r);for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){var e,i,n,r,o,s;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(s=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)o=t[e],s.set(o,r),r+=o.length;return s}},o={arraySet:function(t,e,i,n,r){for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(n)},{}],2:[function(t,e,i){function n(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var i="",n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i}var r=t("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var a=new r.Buf8(256),u=0;u<256;u++)a[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;a[254]=a[254]=1,i.string2buf=function(t){var e,i,n,o,s,a=t.length,u=0;for(o=0;o<a;o++)i=t.charCodeAt(o),55296==(64512&i)&&o+1<a&&56320==(64512&(n=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),u+=i<128?1:i<2048?2:i<65536?3:4;for(e=new r.Buf8(u),s=0,o=0;s<u;o++)i=t.charCodeAt(o),55296==(64512&i)&&o+1<a&&56320==(64512&(n=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},i.buf2binstring=function(t){return n(t,t.length)},i.binstring2buf=function(t){for(var e=new r.Buf8(t.length),i=0,n=e.length;i<n;i++)e[i]=t.charCodeAt(i);return e},i.buf2string=function(t,e){var i,r,o,s,u=e||t.length,l=new Array(2*u);for(r=0,i=0;i<u;)if((o=t[i++])<128)l[r++]=o;else if((s=a[o])>4)l[r++]=65533,i+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&i<u;)o=o<<6|63&t[i++],s--;s>1?l[r++]=65533:o<65536?l[r++]=o:(o-=65536,l[r++]=55296|o>>10&1023,l[r++]=56320|1023&o)}return n(l,r)},i.utf8border=function(t,e){var i;for(e=e||t.length,e>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+a[t[i]]>e?i:e}},{"./common":1}],3:[function(t,e,i){"use strict";function n(t,e,i,n){for(var r=65535&t|0,o=t>>>16&65535|0,s=0;0!==i;){s=i>2e3?2e3:i,i-=s;do{r=r+e[n++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0}e.exports=n},{}],4:[function(t,e,i){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(t,e,i){"use strict";function n(t,e,i,n){var o=r,s=n+i;t^=-1;for(var a=n;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}var r=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=n},{}],6:[function(t,e,i){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=n},{}],7:[function(t,e,i){"use strict";e.exports=function(t,e){var i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_,v,w,b,S,C,F,T;i=t.state,n=t.next_in,F=t.input,r=n+(t.avail_in-5),o=t.next_out,T=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),u=i.dmax,l=i.wsize,h=i.whave,c=i.wnext,d=i.window,p=i.hold,f=i.bits,g=i.lencode,m=i.distcode,x=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;t:do{f<15&&(p+=F[n++]<<f,f+=8,p+=F[n++]<<f,f+=8),_=g[p&x];e:for(;;){if(v=_>>>24,p>>>=v,f-=v,0===(v=_>>>16&255))T[o++]=65535&_;else{if(!(16&v)){if(0==(64&v)){_=g[(65535&_)+(p&(1<<v)-1)];continue e}if(32&v){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&_,v&=15,v&&(f<v&&(p+=F[n++]<<f,f+=8),w+=p&(1<<v)-1,p>>>=v,f-=v),f<15&&(p+=F[n++]<<f,f+=8,p+=F[n++]<<f,f+=8),_=m[p&y];i:for(;;){if(v=_>>>24,p>>>=v,f-=v,!(16&(v=_>>>16&255))){if(0==(64&v)){_=m[(65535&_)+(p&(1<<v)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(b=65535&_,v&=15,f<v&&(p+=F[n++]<<f,(f+=8)<v&&(p+=F[n++]<<f,f+=8)),(b+=p&(1<<v)-1)>u){t.msg="invalid distance too far back",i.mode=30;break t}if(p>>>=v,f-=v,v=o-s,b>v){if((v=b-v)>h&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(S=0,C=d,0===c){if(S+=l-v,v<w){w-=v;do{T[o++]=d[S++]}while(--v);S=o-b,C=T}}else if(c<v){if(S+=l+c-v,(v-=c)<w){w-=v;do{T[o++]=d[S++]}while(--v);if(S=0,c<w){v=c,w-=v;do{T[o++]=d[S++]}while(--v);S=o-b,C=T}}}else if(S+=c-v,v<w){w-=v;do{T[o++]=d[S++]}while(--v);S=o-b,C=T}for(;w>2;)T[o++]=C[S++],T[o++]=C[S++],T[o++]=C[S++],w-=3;w&&(T[o++]=C[S++],w>1&&(T[o++]=C[S++]))}else{S=o-b;do{T[o++]=T[S++],T[o++]=T[S++],T[o++]=T[S++],w-=3}while(w>2);w&&(T[o++]=T[S++],w>1&&(T[o++]=T[S++]))}break}}break}}while(n<r&&o<a);w=f>>3,n-=w,f-=w<<3,p&=(1<<f)-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<a?a-o+257:257-(o-a),i.hold=p,i.bits=f}},{}],8:[function(t,e,i){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=L,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new y.Buf32(gt),e.distcode=e.distdyn=new y.Buf32(mt),e.sane=1,e.back=-1,M):B}function s(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,o(t)):B}function a(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?B:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,s(t))):B}function u(t,e){var i,n;return t?(n=new r,t.state=n,n.window=null,i=a(t,e),i!==M&&(t.state=null),i):B}function l(t){return u(t,xt)}function h(t){if(yt){var e;for(m=new y.Buf32(512),x=new y.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(b(C,t.lens,0,288,m,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;b(F,t.lens,0,32,x,0,t.work,{bits:5}),yt=!1}t.lencode=m,t.lenbits=9,t.distcode=x,t.distbits=5}function c(t,e,i,n){var r,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),n>=o.wsize?(y.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>n&&(r=n),y.arraySet(o.window,e,i-n,r,o.wnext),n-=r,n?(y.arraySet(o.window,e,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}function d(t,e){var i,r,o,s,a,u,l,d,p,f,g,m,x,gt,mt,xt,yt,_t,vt,wt,bt,St,Ct,Ft,Tt=0,Nt=new y.Buf8(4),Ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return B;i=t.state,i.mode===Y&&(i.mode=$),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,r=t.input,u=t.avail_in,d=i.hold,p=i.bits,f=u,g=l,St=M;t:for(;;)switch(i.mode){case L:if(0===i.wrap){i.mode=$;break}for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(2&i.wrap&&35615===d){i.check=0,Nt[0]=255&d,Nt[1]=d>>>8&255,i.check=v(i.check,Nt,2,0),d=0,p=0,i.mode=R;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){t.msg="incorrect header check",i.mode=dt;break}if((15&d)!==P){t.msg="unknown compression method",i.mode=dt;break}if(d>>>=4,p-=4,bt=8+(15&d),0===i.wbits)i.wbits=bt;else if(bt>i.wbits){t.msg="invalid window size",i.mode=dt;break}i.dmax=1<<bt,t.adler=i.check=1,i.mode=512&d?H:Y,d=0,p=0;break;case R:for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(i.flags=d,(255&i.flags)!==P){t.msg="unknown compression method",i.mode=dt;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=dt;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(Nt[0]=255&d,Nt[1]=d>>>8&255,i.check=v(i.check,Nt,2,0)),d=0,p=0,i.mode=k;case k:for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.head&&(i.head.time=d),512&i.flags&&(Nt[0]=255&d,Nt[1]=d>>>8&255,Nt[2]=d>>>16&255,Nt[3]=d>>>24&255,i.check=v(i.check,Nt,4,0)),d=0,p=0,i.mode=z;case z:for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(Nt[0]=255&d,Nt[1]=d>>>8&255,i.check=v(i.check,Nt,2,0)),d=0,p=0,i.mode=X;case X:if(1024&i.flags){for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(Nt[0]=255&d,Nt[1]=d>>>8&255,i.check=v(i.check,Nt,2,0)),d=0,p=0}else i.head&&(i.head.extra=null);i.mode=j;case j:if(1024&i.flags&&(m=i.length,m>u&&(m=u),m&&(i.head&&(bt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),y.arraySet(i.head.extra,r,s,m,bt)),512&i.flags&&(i.check=v(i.check,r,m,s)),u-=m,s+=m,i.length-=m),i.length))break t;i.length=0,i.mode=U;case U:if(2048&i.flags){if(0===u)break t;m=0;do{bt=r[s+m++],i.head&&bt&&i.length<65536&&(i.head.name+=String.fromCharCode(bt))}while(bt&&m<u);if(512&i.flags&&(i.check=v(i.check,r,m,s)),u-=m,s+=m,bt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=G;case G:if(4096&i.flags){if(0===u)break t;m=0;do{bt=r[s+m++],i.head&&bt&&i.length<65536&&(i.head.comment+=String.fromCharCode(bt))}while(bt&&m<u);if(512&i.flags&&(i.check=v(i.check,r,m,s)),u-=m,s+=m,bt)break t}else i.head&&(i.head.comment=null);i.mode=q;case q:if(512&i.flags){for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d!==(65535&i.check)){t.msg="header crc mismatch",i.mode=dt;break}d=0,p=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Y;break;case H:for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}t.adler=i.check=n(d),d=0,p=0,i.mode=W;case W:if(0===i.havedict)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,i.hold=d,i.bits=p,D;t.adler=i.check=1,i.mode=Y;case Y:if(e===N||e===O)break t;case $:if(i.last){d>>>=7&p,p-=7&p,i.mode=lt;break}for(;p<3;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}switch(i.last=1&d,d>>>=1,p-=1,3&d){case 0:i.mode=K;break;case 1:if(h(i),i.mode=it,e===O){d>>>=2,p-=2;break t}break;case 2:i.mode=J;break;case 3:t.msg="invalid block type",i.mode=dt}d>>>=2,p-=2;break;case K:for(d>>>=7&p,p-=7&p;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if((65535&d)!=(d>>>16^65535)){t.msg="invalid stored block lengths",i.mode=dt;break}if(i.length=65535&d,d=0,p=0,i.mode=Z,e===O)break t;case Z:i.mode=Q;case Q:if(m=i.length){if(m>u&&(m=u),m>l&&(m=l),0===m)break t;y.arraySet(o,r,s,m,a),u-=m,s+=m,l-=m,a+=m,i.length-=m;break}i.mode=Y;break;case J:for(;p<14;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(i.nlen=257+(31&d),d>>>=5,p-=5,i.ndist=1+(31&d),d>>>=5,p-=5,i.ncode=4+(15&d),d>>>=4,p-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=dt;break}i.have=0,i.mode=tt;case tt:for(;i.have<i.ncode;){for(;p<3;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.lens[Ot[i.have++]]=7&d,d>>>=3,p-=3}for(;i.have<19;)i.lens[Ot[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Ct={bits:i.lenbits},St=b(S,i.lens,0,19,i.lencode,0,i.work,Ct),i.lenbits=Ct.bits,St){t.msg="invalid code lengths set",i.mode=dt;break}i.have=0,i.mode=et;case et:for(;i.have<i.nlen+i.ndist;){for(;Tt=i.lencode[d&(1<<i.lenbits)-1],mt=Tt>>>24,xt=Tt>>>16&255,yt=65535&Tt,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(yt<16)d>>>=mt,p-=mt,i.lens[i.have++]=yt;else{if(16===yt){for(Ft=mt+2;p<Ft;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d>>>=mt,p-=mt,0===i.have){t.msg="invalid bit length repeat",i.mode=dt;break}bt=i.lens[i.have-1],m=3+(3&d),d>>>=2,p-=2}else if(17===yt){for(Ft=mt+3;p<Ft;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=mt,p-=mt,bt=0,m=3+(7&d),d>>>=3,p-=3}else{for(Ft=mt+7;p<Ft;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=mt,p-=mt,bt=0,m=11+(127&d),d>>>=7,p-=7}if(i.have+m>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=dt;break}for(;m--;)i.lens[i.have++]=bt}}if(i.mode===dt)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=dt;break}if(i.lenbits=9,Ct={bits:i.lenbits},St=b(C,i.lens,0,i.nlen,i.lencode,0,i.work,Ct),i.lenbits=Ct.bits,St){t.msg="invalid literal/lengths set",i.mode=dt;break}if(i.distbits=6,i.distcode=i.distdyn,Ct={bits:i.distbits},St=b(F,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ct),i.distbits=Ct.bits,St){t.msg="invalid distances set",i.mode=dt;break}if(i.mode=it,e===O)break t;case it:i.mode=nt;case nt:if(u>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,i.hold=d,i.bits=p,w(t,g),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,r=t.input,u=t.avail_in,d=i.hold,p=i.bits,i.mode===Y&&(i.back=-1);break}for(i.back=0;Tt=i.lencode[d&(1<<i.lenbits)-1],mt=Tt>>>24,xt=Tt>>>16&255,yt=65535&Tt,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(xt&&0==(240&xt)){for(_t=mt,vt=xt,wt=yt;Tt=i.lencode[wt+((d&(1<<_t+vt)-1)>>_t)],mt=Tt>>>24,xt=Tt>>>16&255,yt=65535&Tt,!(_t+mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=_t,p-=_t,i.back+=_t}if(d>>>=mt,p-=mt,i.back+=mt,i.length=yt,0===xt){i.mode=ut;break}if(32&xt){i.back=-1,i.mode=Y;break}if(64&xt){t.msg="invalid literal/length code",i.mode=dt;break}i.extra=15&xt,i.mode=rt;case rt:if(i.extra){for(Ft=i.extra;p<Ft;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,p-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=ot;case ot:for(;Tt=i.distcode[d&(1<<i.distbits)-1],mt=Tt>>>24,xt=Tt>>>16&255,yt=65535&Tt,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(0==(240&xt)){for(_t=mt,vt=xt,wt=yt;Tt=i.distcode[wt+((d&(1<<_t+vt)-1)>>_t)],mt=Tt>>>24,xt=Tt>>>16&255,yt=65535&Tt,!(_t+mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=_t,p-=_t,i.back+=_t}if(d>>>=mt,p-=mt,i.back+=mt,64&xt){t.msg="invalid distance code",i.mode=dt;break}i.offset=yt,i.extra=15&xt,i.mode=st;case st:if(i.extra){for(Ft=i.extra;p<Ft;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,p-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=dt;break}i.mode=at;case at:if(0===l)break t;if(m=g-l,i.offset>m){if((m=i.offset-m)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=dt;break}m>i.wnext?(m-=i.wnext,x=i.wsize-m):x=i.wnext-m,m>i.length&&(m=i.length),gt=i.window}else gt=o,x=a-i.offset,m=i.length;m>l&&(m=l),l-=m,i.length-=m;do{o[a++]=gt[x++]}while(--m);0===i.length&&(i.mode=nt);break;case ut:if(0===l)break t;o[a++]=i.length,l--,i.mode=nt;break;case lt:if(i.wrap){for(;p<32;){if(0===u)break t;u--,d|=r[s++]<<p,p+=8}if(g-=l,t.total_out+=g,i.total+=g,g&&(t.adler=i.check=i.flags?v(i.check,o,g,a-g):_(i.check,o,g,a-g)),g=l,(i.flags?d:n(d))!==i.check){t.msg="incorrect data check",i.mode=dt;break}d=0,p=0}i.mode=ht;case ht:if(i.wrap&&i.flags){for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=dt;break}d=0,p=0}i.mode=ct;case ct:St=V;break t;case dt:St=I;break t;case pt:return E;case ft:default:return B}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,i.hold=d,i.bits=p,(i.wsize||g!==t.avail_out&&i.mode<dt&&(i.mode<lt||e!==T))&&c(t,t.output,t.next_out,g-t.avail_out)?(i.mode=pt,E):(f-=t.avail_in,g-=t.avail_out,t.total_in+=f,t.total_out+=g,i.total+=g,i.wrap&&g&&(t.adler=i.check=i.flags?v(i.check,o,g,t.next_out-g):_(i.check,o,g,t.next_out-g)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Y?128:0)+(i.mode===it||i.mode===Z?256:0),(0===f&&0===g||e===T)&&St===M&&(St=A),St)}function p(t){if(!t||!t.state)return B;var e=t.state;return e.window&&(e.window=null),t.state=null,M}function f(t,e){var i;return t&&t.state?(i=t.state,0==(2&i.wrap)?B:(i.head=e,e.done=!1,M)):B}function g(t,e){var i,n,r=e.length;return t&&t.state?(i=t.state,0!==i.wrap&&i.mode!==W?B:i.mode===W&&(n=1,(n=_(n,e,r,0))!==i.check)?I:c(t,e,r,r)?(i.mode=pt,E):(i.havedict=1,M)):B}var m,x,y=t("../utils/common"),_=t("./adler32"),v=t("./crc32"),w=t("./inffast"),b=t("./inftrees"),S=0,C=1,F=2,T=4,N=5,O=6,M=0,V=1,D=2,B=-2,I=-3,E=-4,A=-5,P=8,L=1,R=2,k=3,z=4,X=5,j=6,U=7,G=8,q=9,H=10,W=11,Y=12,$=13,K=14,Z=15,Q=16,J=17,tt=18,et=19,it=20,nt=21,rt=22,ot=23,st=24,at=25,ut=26,lt=27,ht=28,ct=29,dt=30,pt=31,ft=32,gt=852,mt=592,xt=15,yt=!0;i.inflateReset=s,i.inflateReset2=a,i.inflateResetKeep=o,i.inflateInit=l,i.inflateInit2=u,i.inflate=d,i.inflateEnd=p,i.inflateGetHeader=f,i.inflateSetDictionary=g,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(t,e,i){"use strict";var n=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,i,u,l,h,c,d){var p,f,g,m,x,y,_,v,w,b=d.bits,S=0,C=0,F=0,T=0,N=0,O=0,M=0,V=0,D=0,B=0,I=null,E=0,A=new n.Buf16(16),P=new n.Buf16(16),L=null,R=0;for(S=0;S<=15;S++)A[S]=0;for(C=0;C<u;C++)A[e[i+C]]++;for(N=b,T=15;T>=1&&0===A[T];T--);if(N>T&&(N=T),0===T)return l[h++]=20971520,l[h++]=20971520,d.bits=1,0;for(F=1;F<T&&0===A[F];F++);for(N<F&&(N=F),V=1,S=1;S<=15;S++)if(V<<=1,(V-=A[S])<0)return-1;if(V>0&&(0===t||1!==T))return-1;for(P[1]=0,S=1;S<15;S++)P[S+1]=P[S]+A[S];for(C=0;C<u;C++)0!==e[i+C]&&(c[P[e[i+C]]++]=C);if(0===t?(I=L=c,y=19):1===t?(I=r,E-=257,L=o,R-=257,y=256):(I=s,L=a,y=-1),B=0,C=0,S=F,x=h,O=N,M=0,g=-1,D=1<<N,m=D-1,1===t&&D>852||2===t&&D>592)return 1;for(;;){_=S-M,c[C]<y?(v=0,w=c[C]):c[C]>y?(v=L[R+c[C]],w=I[E+c[C]]):(v=96,w=0),p=1<<S-M,f=1<<O,F=f;do{f-=p,l[x+(B>>M)+f]=_<<24|v<<16|w|0}while(0!==f);for(p=1<<S-1;B&p;)p>>=1;if(0!==p?(B&=p-1,B+=p):B=0,C++,0==--A[S]){if(S===T)break;S=e[i+c[C]]}if(S>N&&(B&m)!==g){for(0===M&&(M=N),x+=F,O=S-M,V=1<<O;O+M<T&&!((V-=A[O+M])<=0);)O++,V<<=1;if(D+=1<<O,1===t&&D>852||2===t&&D>592)return 1;g=B&m,l[g]=N<<24|O<<16|x-h|0}}return 0!==B&&(l[x+B]=S-M<<24|64<<16|0),d.bits=N,0}},{"../utils/common":1}],10:[function(t,e,i){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(t,e,i){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},{}],"/lib/inflate.js":[function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,e.windowBits);if(i!==l.Z_OK)throw new Error(h[i]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function r(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg||h[i.err];return i.result}function o(t,e){return e=e||{},e.raw=!0,r(t,e)}var s=t("./zlib/inflate"),a=t("./utils/common"),u=t("./utils/strings"),l=t("./zlib/constants"),h=t("./zlib/messages"),c=t("./zlib/zstream"),d=t("./zlib/gzheader"),p=Object.prototype.toString;n.prototype.push=function(t,e){var i,n,r,o,h,c,d=this.strm,f=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;n=e===~~e?e:!0===e?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?d.input=u.binstring2buf(t):"[object ArrayBuffer]"===p.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(f),d.next_out=0,d.avail_out=f),i=s.inflate(d,l.Z_NO_FLUSH),i===l.Z_NEED_DICT&&g&&(c="string"==typeof g?u.string2buf(g):"[object ArrayBuffer]"===p.call(g)?new Uint8Array(g):g,i=s.inflateSetDictionary(this.strm,c)),i===l.Z_BUF_ERROR&&!0===m&&(i=l.Z_OK,m=!1),i!==l.Z_STREAM_END&&i!==l.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==l.Z_STREAM_END&&(0!==d.avail_in||n!==l.Z_FINISH&&n!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=u.utf8border(d.output,d.next_out),o=d.next_out-r,h=u.buf2string(d.output,r),d.next_out=o,d.avail_out=f-o,o&&a.arraySet(d.output,d.output,r,o,0),this.onData(h)):this.onData(a.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==l.Z_STREAM_END);return i===l.Z_STREAM_END&&(n=l.Z_FINISH),n===l.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===l.Z_OK):n!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Inflate=n,i.inflate=r,i.inflateRaw=o,i.ungzip=r},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),define("pako_inflate",["pako_inflate/dist/pako_inflate"],function(t){return t}),define("x_ite/DEBUG",["x_ite/Browser/VERSION"],function(t){"use strict";return t.match(/^\d+\.\d+\.\d+a$/)}),define("x_ite/InputOutput/FileLoader",["jquery","x_ite/Base/X3DObject","x_ite/Fields","x_ite/Browser/Networking/urls","x_ite/Parser/Parser","x_ite/Parser/XMLParser","standard/Networking/URI","standard/Networking/BinaryTransport","pako_inflate","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t,i){e.call(this),this.node=t,this.browser=t.getBrowser(),this.external=void 0===i?this.browser.isExternal():i,this.executionContext=this.external?t.getExecutionContext():this.browser.currentScene,this.userAgent=this.browser.getName()+"/"+this.browser.getVersion()+" (X3D Browser; +"+this.browser.getProviderUrl()+")",this.url=[],this.URL=new s,this.fileReader=new FileReader}a(t);var c=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,d=/^data\:([^]*?)(?:;([^]*?))?(;base64)?,([^]*)$/,p=/^(?:(.*?);(.*?)$)/,f=new RegExp(".(?:html|xhtml)$"),g={"text/html":!0,"application/xhtml+xml":!0},m=new i.MFString;return h.prototype=t.extend(Object.create(e.prototype),{constructor:h,abort:function(){this.callback=Function.prototype,this.bindViewpoint=Function.prototype,this.foreign=Function.prototype},getWorldURL:function(){return this.URL},createX3DFromString:function(e,i,n,o){var s=this.browser.createScene();if(s.setURL(this.browser.getLocation().transform(e)),n)try{setTimeout(this.importDocument.bind(this,s,t.parseXML(i),n,o),17)}catch(t){new r(s).parseIntoScene(i),this.setScene(s,n)}else try{return this.importDocument(s,t.parseXML(i)),s}catch(t){return new r(s).parseIntoScene(i),s}},importDocument:function(t,e,i,n){try{new o(t).parseIntoScene(e),this.node.dom=e,i&&this.setScene(t,i)}catch(t){if(!n)throw t;n(t)}},setScene:function(t,e){t.initLoadCount_.addInterest("set_initLoadCount__",this,t,e),t.initLoadCount_.addEvent()},set_initLoadCount__:function(t,e,i){t.getValue()||(e.initLoadCount_.removeInterest("set_initLoadCount__",this),i(e),l&&this.URL.length&&"data"!==this.URL.scheme&&console.info("Done loading scene "+this.URL))},createX3DFromURL:function(t,e,i,n,r){return this.bindViewpoint=n,this.foreign=r,i?this.loadDocument(t,e,this.createX3DFromURLAsync.bind(this,i)):this.createX3DFromURLSync(t)},createX3DFromURLAsync:function(t,e){null===e?t(null):this.createX3DFromString(this.URL,e,t,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(e){if(0===e.length)throw new Error("No URL given.");for(var i=null,n=!1,r=0;r<e.length&&(this.URL=this.transform(e[r]),t.ajax({url:this.URL,dataType:"text",async:!1,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(t){try{i=this.createX3DFromString(this.URL,t),n=!0}catch(t){this.error(t)}},error:function(t,e,i){}}),!n);++r);if(n)return i;throw new Error("Couldn't load any url of '"+e.getValue().join(", ")+"'.")},loadScript:function(t,e){this.script=!0,this.loadDocument(t,null,e)},loadDocument:function(t,e,i){if(this.url=t.copy(),this.callback=i,0===t.length)return this.loadDocumentError(new Error("No URL given."));this.target=this.getTarget(e||m),this.loadDocumentAsync(this.url.shift())},getTarget:function(t){for(var e=0,i=t.length;e<i;++e){var n=t[e].split("=");if(2===n.length&&"target"===n[0])return n[1]}return""},loadDocumentAsync:function(e){var i=new s(e);if(0==e.length)return void this.loadDocumentError(new Error("URL is empty."));try{if(this.bindViewpoint&&0===i.filename.toString().length&&0===i.query.length)return void this.bindViewpoint(i.fragment)}catch(t){return void this.loadDocumentError(t)}if(this.script)try{var r=c.exec(e);if(r)return void this.callback(r[1])}catch(t){return void this.loadDocumentError(t)}this.URL=this.transform(e);try{var r=d.exec(e);if(r){var o=r[4];return o=";base64"===r[3]?atob(o):unescape(o),this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):void this.callback(o)}}catch(t){return void this.loadDocumentError(t)}return this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):(this.URL.isDirectory()||this.URL.suffix.match(f))&&this.foreign?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):void t.ajax({url:this.URL,dataType:"binary",async:!0,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(t,e,i){if(this.foreign&&g[this.getContentType(i)])return this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target);this.fileReader.onload=this.readAsText.bind(this,t),this.fileReader.readAsText(t)},error:function(t,e,i){this.loadDocumentError(new Error(i))}})},readAsText:function(t){try{this.callback(this.fileReader.result)}catch(e){this.fileReader.onload=this.readAsArrayBuffer.bind(this,e),this.fileReader.readAsArrayBuffer(t)}},readAsArrayBuffer:function(t){try{this.callback(u.ungzip(this.fileReader.result,{to:"string"}))}catch(e){this.loadDocumentError(t)}},loadDocumentError:function(t){this.error(t),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(t){"data"!==this.URL.scheme&&(console.warn("Couldn't load URL '"+this.URL+"':",t.message),l&&console.log(t))},transform:function(t){var e=this.getReferer().transform(new s(t));return e.isLocal()||"localhost"===e.host?e=this.browser.getLocation().getRelativePath(e):l&&(t.match(n.fallbackExpression)||this.url.unshift(n.fallbackUrl+e)),e},getReferer:function(){return"World"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getURL()},getContentType:function(t){var e=t.getResponseHeader("Content-Type"),i=p.exec(e);return i?i[1]:""}}),h}),define("x_ite/Components/Shaders/ShaderPart",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Browser/Shaders/Shader","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){o.call(this,t),s.call(this,t),this.addType(u.ShaderPart),this.addChildObjects("buffer",new e.SFTime),this.valid=!1}var h={VERTEX:"VERTEX_SHADER",TESS_CONTROL:"TESS_CONTROL_SHADER",TESS_EVALUATION:"TESS_EVALUATION_SHADER",GEOMETRY:"GEOMETRY_SHADER",FRAGMENT:"FRAGMENT_SHADER",COMPUTE:"COMPUTE_SHADER"};return l.prototype=t.extend(Object.create(o.prototype),s.prototype,{constructor:l,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.initializeOnly,"type",new e.SFString("VERTEX")),new i(u.inputOutput,"url",new e.MFString)]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){o.prototype.initialize.call(this),s.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.shader=t.createShader(t[this.getShaderType()]),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.setLoadState(u.NOT_STARTED_STATE),this.requestAsyncLoad()},isValid:function(){return this.valid},getShader:function(){return this.shader},getShaderType:function(){var t=h[this.type_.getValue()];return t||"VERTEX_SHADER"},getSourceText:function(){return this.url_},requestAsyncLoad:function(){this.checkLoadState()!=u.COMPLETE_STATE&&this.checkLoadState()!=u.IN_PROGRESS_STATE&&(this.setLoadState(u.IN_PROGRESS_STATE),this.valid=!1,new a(this).loadDocument(this.url_,null,function(t,e){if(null===t)this.setLoadState(u.FAILED_STATE);else{var i=this.getBrowser().getContext();if(i.shaderSource(this.shader,r.getShaderSource(this.getBrowser(),t)),i.compileShader(this.shader),this.valid=i.getShaderParameter(this.shader,i.COMPILE_STATUS),!this.valid)throw new Error(this.getTypeName()+" '"+this.getName()+"': "+i.getShaderInfoLog(this.shader));this.setLoadState(u.COMPLETE_STATE)}}.bind(this)))}}),l}),define("text!x_ite/Browser/Shaders/PointSet.fs",[],function(){
return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform float x3d_LinewidthScaleFactor;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_FogType == x3d_NoneFog)\n\t\treturn 1.0;\n\n\tif (x3d_FogVisibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v);\n\n\tif (dV >= x3d_FogVisibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_FogType == x3d_LinearFog)\n\t\treturn (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n\tif (x3d_FogType == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_FogVisibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tfloat lw = (x3d_LinewidthScaleFactor + 1.0) / 2.0;\n\tfloat t  = distance (vec2 (0.5, 0.5), gl_PointCoord) * 2.0 * lw - lw + 1.0;\n\n\tgl_FragColor .rgb = mix (x3d_FogColor, C .rgb, getFogInterpolant ());\n\tgl_FragColor .a   = mix (C .a, 0.0, clamp (t, 0.0, 1.0));\n}\n"}),define("text!x_ite/Browser/Shaders/Wireframe.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform int x3d_GeometryType;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Transparency;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n\t// If we are points, make the gl_PointSize one pixel larger.\n\tgl_PointSize = x3d_GeometryType == x3d_GeometryLines ? x3d_LinewidthScaleFactor : x3d_LinewidthScaleFactor + 1.0;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv           = vec3 (p);\n\tgl_Position = x3d_ProjectionMatrix * p;\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_Transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tC .rgb = x3d_Color .rgb;\n\t\t\tC .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tC .rgb = x3d_EmissiveColor;\n\t\t\tC .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tC = x3d_Color;\n\t\telse\n\t\t\tC = vec4 (1.0, 1.0, 1.0, 1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/Wireframe.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform float x3d_LinewidthScaleFactor;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_FogType == x3d_NoneFog)\n\t\treturn 1.0;\n\n\tif (x3d_FogVisibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v);\n\n\tif (dV >= x3d_FogVisibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_FogType == x3d_LinearFog)\n\t\treturn (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n\tif (x3d_FogType == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_FogVisibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\t\n\tgl_FragColor .rgb = mix (x3d_FogColor, C .rgb, getFogInterpolant ());\n\tgl_FragColor .a   = C .a;\n}\n"}),define("text!x_ite/Browser/Shaders/Gouraud.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_TextureMatrix [1];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int   x3d_LightType [x3d_MaxLights];\nuniform bool  x3d_LightOn [x3d_MaxLights];\nuniform vec3  x3d_LightColor [x3d_MaxLights];\nuniform float x3d_LightIntensity [x3d_MaxLights];\nuniform float x3d_LightAmbientIntensity [x3d_MaxLights];\nuniform vec3  x3d_LightAttenuation [x3d_MaxLights];\nuniform vec3  x3d_LightLocation [x3d_MaxLights];\nuniform vec3  x3d_LightDirection [x3d_MaxLights];\nuniform float x3d_LightRadius [x3d_MaxLights];\nuniform float x3d_LightBeamWidth [x3d_MaxLights];\nuniform float x3d_LightCutOffAngle [x3d_MaxLights];\n\nuniform bool x3d_SeparateBackColor;\n\nuniform float x3d_AmbientIntensity;\nuniform vec3  x3d_DiffuseColor;\nuniform vec3  x3d_SpecularColor;\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Shininess;\nuniform float x3d_Transparency;\n\nuniform float x3d_BackAmbientIntensity;\nuniform vec3  x3d_BackDiffuseColor;\nuniform vec3  x3d_BackSpecularColor;\nuniform vec3  x3d_BackEmissiveColor;\nuniform float x3d_BackShininess;\nuniform float x3d_BackTransparency;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n\nvarying vec4  frontColor; // color\nvarying vec4  backColor;  // color\nvarying vec4  t;          // texCoord\nvarying vec3  v;          // point on geometry\n\nvec4\ngetMaterialColor (in vec3 N,\n                  in vec3 v,\n                  in float x3d_AmbientIntensity,\n                  in vec3  x3d_DiffuseColor,\n                  in vec3  x3d_SpecularColor,\n                  in vec3  x3d_EmissiveColor,\n                  in float x3d_Shininess,\n                  in float x3d_Transparency)\n{\n\tvec3 V = normalize (-v); // normalized vector from point on geometry to viewer's position\n\n\t// Calculate diffuseFactor & alpha\n\n\tvec3  diffuseFactor = vec3 (1.0, 1.0, 1.0);\n\tfloat alpha         = 1.0 - x3d_Transparency;\n\n\tif (x3d_ColorMaterial)\n\t{\n\t\tdiffuseFactor  = x3d_Color .rgb;\n\t\talpha         *= x3d_Color .a;\n\t}\n\telse\n\t\tdiffuseFactor = x3d_DiffuseColor;\n\n\tvec3 ambientTerm = diffuseFactor * x3d_AmbientIntensity;\n\n\t// Apply light sources\n\n\tvec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n\tfor (int i = 0; i < x3d_MaxLights; ++ i)\n\t{\n\t\tint lightType = x3d_LightType [i];\n\n\t\tif (lightType == x3d_NoneLight)\n\t\t\tbreak;\n\n\t\tvec3  vL = x3d_LightLocation [i] - v;\n\t\tfloat dL = length (vL);\n\t\tbool  di = lightType == x3d_DirectionalLight;\n\n\t\tif (di || dL <= x3d_LightRadius [i])\n\t\t{\n\t\t\tvec3 d = x3d_LightDirection [i];\n\t\t\tvec3 c = x3d_LightAttenuation [i];\n\t\t\tvec3 L = di ? -d : normalize (vL);\n\t\t\tvec3 H = normalize (L + V); // specular term\n\n\t\t\tvec3  diffuseTerm    = diffuseFactor * max (dot (N, L), 0.0);\n\t\t\tfloat specularFactor = x3d_Shininess > 0.0 ? pow (max (dot (N, H), 0.0), x3d_Shininess * 128.0) : 1.0;\n\t\t\tvec3  specularTerm   = x3d_SpecularColor * specularFactor;\n\n\t\t\tfloat attenuation = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\tfloat spot        = 1.0;\n\n\t\t\tif (lightType == x3d_SpotLight)\n\t\t\t{\n\t\t\t\tfloat spotAngle   = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\t\t\tfloat cutOffAngle = x3d_LightCutOffAngle [i];\n\t\t\t\tfloat beamWidth   = x3d_LightBeamWidth [i];\n\t\t\t\t\n\t\t\t\tif (spotAngle >= cutOffAngle)\n\t\t\t\t\tspot = 0.0;\n\t\t\t\telse if (spotAngle <= beamWidth)\n\t\t\t\t\tspot = 1.0;\n\t\t\t\telse\n\t\t\t\t\tspot = (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n\t\t\t}\n\t\t\n\t\t\tvec3 lightFactor  = (attenuation * spot) * x3d_LightColor [i];\n\t\t\tvec3 ambientLight = (lightFactor * x3d_LightAmbientIntensity [i]) * ambientTerm;\n\n\t\t\tlightFactor *= x3d_LightIntensity [i];\n\t\t\tfinalColor  += ambientLight + lightFactor * (diffuseTerm + specularTerm);\n\t\t}\n\t}\n\n\tfinalColor += x3d_EmissiveColor;\n\n\treturn vec4 (clamp (finalColor, 0.0, 1.0), alpha);\n}\n\nvoid\nmain ()\n{\n\tgl_PointSize = x3d_LinewidthScaleFactor;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tt = x3d_TextureMatrix [0] * x3d_TexCoord;\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n\n\tif (x3d_Lighting)\n\t{\n\t\tvec3 N = normalize (x3d_NormalMatrix * x3d_Normal);\n\n\t\tfloat ambientIntensity = x3d_AmbientIntensity;\n\t\tvec3  diffuseColor     = x3d_DiffuseColor;\n\t\tvec3  specularColor    = x3d_SpecularColor;\n\t\tvec3  emissiveColor    = x3d_EmissiveColor;\n\t\tfloat shininess        = x3d_Shininess;\n\t\tfloat transparency     = x3d_Transparency;\n\n\t\tfrontColor = getMaterialColor (N, v,\n\t\t                               ambientIntensity,\n\t\t                               diffuseColor,\n\t\t                               specularColor,\n\t\t                               emissiveColor,\n\t\t                               shininess,\n\t\t                               transparency);\n\n\t\tif (x3d_SeparateBackColor)\n\t\t{\n\t\t\tambientIntensity = x3d_BackAmbientIntensity;\n\t\t\tdiffuseColor     = x3d_BackDiffuseColor;\n\t\t\tspecularColor    = x3d_BackSpecularColor;\n\t\t\temissiveColor    = x3d_BackEmissiveColor;\n\t\t\tshininess        = x3d_BackShininess;\n\t\t\ttransparency     = x3d_BackTransparency;\n\t\t}\n\n\t\tbackColor = getMaterialColor (-N, v,\n\t\t                              ambientIntensity,\n\t\t                              diffuseColor,\n\t\t                              specularColor,\n\t\t                              emissiveColor,\n\t\t                              shininess,\n\t\t                              transparency);\n\t}\n\telse\n\t{\n\t   frontColor = backColor = x3d_ColorMaterial ? x3d_Color : vec4 (1.0, 1.0, 1.0, 1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/Gouraud.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform int x3d_GeometryType;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int         x3d_TextureType [x3d_MaxTextures]; // x3d_NoneTexture, x3d_TextureType2D or x3d_TextureTypeCubeMapTexture\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nvarying vec4 frontColor; // color\nvarying vec4 backColor;  // color\nvarying vec4 t;          // texCoord\nvarying vec3 v;          // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvec4\ngetTextureColor ()\n{\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn texture2D (x3d_Texture2D [0], vec2 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn texture2D (x3d_Texture2D [0], vec2 (1.0 - t .s, t .t));\n\t}\n\n \tif (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n\t}\n \n\treturn vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_FogType == x3d_NoneFog)\n\t\treturn 1.0;\n\n\tif (x3d_FogVisibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v);\n\n\tif (dV >= x3d_FogVisibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_FogType == x3d_LinearFog)\n\t\treturn (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n\tif (x3d_FogType == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_FogVisibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvoid\nmain ()\n{\n \tclip ();\n\n\tvec4 finalColor = gl_FrontFacing ? frontColor : backColor;\n\n\tif (x3d_TextureType [0] != x3d_NoneTexture)\n\t{\n\t\tif (x3d_Lighting)\n\t\t\tfinalColor *= getTextureColor ();\n\t\telse\n\t\t{\n\t\t\tif (x3d_ColorMaterial)\n\t\t\t\tfinalColor *= getTextureColor ();\n\t\t\telse\n\t\t\t\tfinalColor = getTextureColor ();\n\t\t}\n\t}\n\n\tgl_FragColor .rgb = mix (x3d_FogColor, finalColor .rgb, getFogInterpolant ());\n\tgl_FragColor .a   = finalColor .a;\n}\n"}),define("text!x_ite/Browser/Shaders/Phong.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;  // true if a X3DMaterialNode is attached, otherwise false\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\nvoid\nmain ()\n{\n\tgl_PointSize = x3d_LinewidthScaleFactor;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tif (x3d_Lighting)\n\t\tvN = normalize (x3d_NormalMatrix * x3d_Normal);\n\n\tt = x3d_TextureMatrix [0] * x3d_TexCoord;\n\tC = x3d_Color;\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n}\n"}),define("text!x_ite/Browser/Shaders/Phong.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform int x3d_GeometryType;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int   x3d_LightType [x3d_MaxLights];\nuniform bool  x3d_LightOn [x3d_MaxLights];\nuniform vec3  x3d_LightColor [x3d_MaxLights];\nuniform float x3d_LightIntensity [x3d_MaxLights];\nuniform float x3d_LightAmbientIntensity [x3d_MaxLights];\nuniform vec3  x3d_LightAttenuation [x3d_MaxLights];\nuniform vec3  x3d_LightLocation [x3d_MaxLights];\nuniform vec3  x3d_LightDirection [x3d_MaxLights];\nuniform float x3d_LightRadius [x3d_MaxLights];\nuniform float x3d_LightBeamWidth [x3d_MaxLights];\nuniform float x3d_LightCutOffAngle [x3d_MaxLights];\n\nuniform bool x3d_SeparateBackColor;\n\nuniform float x3d_AmbientIntensity;\nuniform vec3  x3d_DiffuseColor;\nuniform vec3  x3d_SpecularColor;\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Shininess;\nuniform float x3d_Transparency;\n\nuniform float x3d_BackAmbientIntensity;\nuniform vec3  x3d_BackDiffuseColor;\nuniform vec3  x3d_BackSpecularColor;\nuniform vec3  x3d_BackEmissiveColor;\nuniform float x3d_BackShininess;\nuniform float x3d_BackTransparency;\n\nuniform int         x3d_TextureType [x3d_MaxTextures]; // true if a X3DTexture2DNode is attached, otherwise false\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvec4\ngetTextureColor ()\n{\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn texture2D (x3d_Texture2D [0], vec2 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn texture2D (x3d_Texture2D [0], vec2 (1.0 - t .s, t .t));\n\t}\n\n\tif (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n\t}\n\n\treturn vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nfloat\ngetSpotFactor (in float cutOffAngle, in float beamWidth, in vec3 L, in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor ()\n{\n\tif (x3d_Lighting)\n\t{\n\t\tvec3  N  = normalize (gl_FrontFacing ? vN : -vN);\n\t\tvec3  V  = normalize (-v); // normalized vector from point on geometry to viewer's position\n\t\tfloat dV = length (v);\n\n\t\t// Calculate diffuseFactor & alpha\n\n\t\tbool frontColor = gl_FrontFacing || ! x3d_SeparateBackColor;\n\n\t\tfloat ambientIntensity = frontColor ? x3d_AmbientIntensity : x3d_BackAmbientIntensity;\n\t\tvec3  diffuseColor     = frontColor ? x3d_DiffuseColor     : x3d_BackDiffuseColor;\n\t\tvec3  specularColor    = frontColor ? x3d_SpecularColor    : x3d_BackSpecularColor;\n\t\tvec3  emissiveColor    = frontColor ? x3d_EmissiveColor    : x3d_BackEmissiveColor;\n\t\tfloat shininess        = frontColor ? x3d_Shininess        : x3d_BackShininess;\n\t\tfloat transparency     = frontColor ? x3d_Transparency     : x3d_BackTransparency;\n\n\t\tvec3  diffuseFactor = vec3 (1.0, 1.0, 1.0);\n\t\tfloat alpha         = 1.0 - transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_NoneTexture)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tdiffuseFactor  = T .rgb * C .rgb;\n\t\t\t\talpha         *= T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = C .rgb;\n\n\t\t\talpha *= C .a;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_NoneTexture)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tdiffuseFactor  = T .rgb * diffuseColor;\n\t\t\t\talpha         *= T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = diffuseColor;\n\t\t}\n\n\t\tvec3 ambientTerm = diffuseFactor * ambientIntensity;\n\n\t\t// Apply light sources\n\n\t\tvec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n\t\tfor (int i = 0; i < x3d_MaxLights; ++ i)\n\t\t{\n\t\t\tint lightType = x3d_LightType [i];\n\n\t\t\tif (lightType == x3d_NoneLight)\n\t\t\t\tbreak;\n\n\t\t\tvec3  vL = x3d_LightLocation [i] - v;\n\t\t\tfloat dL = length (vL);\n\t\t\tbool  di = lightType == x3d_DirectionalLight;\n\n\t\t\tif (di || dL <= x3d_LightRadius [i])\n\t\t\t{\n\t\t\t\tvec3 d = x3d_LightDirection [i];\n\t\t\t\tvec3 c = x3d_LightAttenuation [i];\n\t\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\t\tfloat specularFactor = shininess > 0.0 ? pow (max (dot (N, H), 0.0), shininess * 128.0) : 1.0;\n\t\t\t\tvec3  specularTerm   = specularColor * specularFactor;\n\n\t\t\t\tfloat attenuationFactor           = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\t\tfloat spotFactor                  = lightType == x3d_SpotLight ? getSpotFactor (x3d_LightCutOffAngle [i], x3d_LightBeamWidth [i], L, d) : 1.0;\n\t\t\t\tfloat attenuationSpotFactor       = attenuationFactor * spotFactor;\n\t\t\t\tvec3  ambientColor                = x3d_LightAmbientIntensity [i] * ambientTerm;\n\t\t\t\tvec3  ambientDiffuseSpecularColor = ambientColor + x3d_LightIntensity [i] * (diffuseTerm + specularTerm);\n\n\t\t\t\tfinalColor += attenuationSpotFactor * (x3d_LightColor [i] * ambientDiffuseSpecularColor);\n\t\t\t}\n\t\t}\n\n\t\tfinalColor += emissiveColor;\n\n\t\treturn vec4 (finalColor, alpha);\n\t}\n\telse\n\t{\n\t\tvec4 finalColor = vec4 (1.0, 1.0, 1.0, 1.0);\n\t\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_NoneTexture)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tfinalColor = T * C;\n\t\t\t}\n\t\t\telse\n\t\t\t\tfinalColor = C;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_NoneTexture)\n\t\t\t\tfinalColor = getTextureColor ();\n\t\t}\n\n\t\treturn finalColor;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_FogType == x3d_NoneFog)\n\t\treturn 1.0;\n\n\tif (x3d_FogVisibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v);\n\n\tif (dV >= x3d_FogVisibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_FogType == x3d_LinearFog)\n\t\treturn (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n\tif (x3d_FogType == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_FogVisibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = getMaterialColor ();\n\n\tgl_FragColor .rgb = mix (x3d_FogColor, gl_FragColor .rgb, getFogInterpolant ());\n}\n"}),define("text!x_ite/Browser/Shaders/Depth.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Vertex;\n\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n}\n"}),define("text!x_ite/Browser/Shaders/Depth.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvec4\npack (in float f)\n{\n\tvec4 color;\n\n\tf *= 255.0;\n\tcolor .r = floor (f);\n\n\tf -= color .r;\n\tf *= 255.0;\n\tcolor .g = floor (f);\n\n\tf -= color .g;\n\tf *= 255.0;\n\tcolor .b = floor (f);\n\n\tf -= color .b;\n\tf *= 255.0;\n\tcolor .a = floor (f);\n\n\treturn color / 255.0;\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = pack (gl_FragCoord .z);\n}\n"}),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(t,e){this.point=t.copy(),this.direction=e.copy()}return e.prototype={constructor:e,u:new t(0,0,0),pvec:new t(0,0,0),tvec:new t(0,0,0),copy:function(){var t=Object.create(e.prototype);return t.point=this.point.copy(),t.direction=this.direction.copy(),t},assign:function(t){return this.point.assign(t.point),this.direction.assign(t.direction),this},set:function(t,e){return this.point.assign(t),this.direction.assign(e),this},setPoints:function(t,e){return this.point.assign(t),this.direction.assign(e).subtract(t).normalize(),this},multMatrixLine:function(t){return t.multMatrixVec(this.point),t.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(t){return t.multVecMatrix(this.point),t.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(t,e){var i=e.assign(t).subtract(this.point),n=i.dot(this.direction);return e.assign(this.direction).multiply(n).add(this.point)},getClosestPointToLine:function(e,i){var n=this.point,r=e.point,o=this.direction,s=e.direction,a=t.dot(o,s);if(Math.abs(a)>=1)return!1;var u=this.u.assign(r).subtract(n);return a=(t.dot(u,o)-a*t.dot(u,s))/(1-a*a),i.assign(o).multiply(a).add(n),!0},getPerpendicularVector:function(e){var i=t.subtract(this.point,e);return i.subtract(this.direction.copy().multiply(t.dot(i,this.direction)))},intersectsTriangle:function(t,e,i,n){var r=e.subtract(t),o=i.subtract(t),s=this.pvec.assign(this.direction).cross(o),a=r.dot(s);if(0===a)return!1;var u=1/a,l=this.tvec.assign(this.point).subtract(t),h=l.dot(s)*u;if(h<0||h>1)return!1;var c=l.cross(r),d=this.direction.dot(c)*u;if(d<0||h+d>1)return!1;var p=o.dot(c)*u;return n.u=h,n.v=d,n.t=p,!0},toString:function(){return this.point+", "+this.direction}},e.Points=function(i,n){var r=Object.create(e.prototype);return r.point=i.copy(),r.direction=t.subtract(n,i).normalize(),r},e}),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function i(t,e){this.normal=e.copy(),this.distanceFromOrigin=e.dot(t)}var n=new t(0,0,0),r=new t(0,0,0),o=new e;return i.prototype={constructor:i,copy:function(){var t=Object.create(i.prototype);return t.normal=this.normal.copy(),t.distanceFromOrigin=this.distanceFromOrigin,t},assign:function(t){return this.normal.assign(t.normal),this.distanceFromOrigin=t.distanceFromOrigin,this},set:function(t,e){return this.normal.assign(e),this.distanceFromOrigin=e.dot(t),this},multRight:function(t){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(t).inverse(),o.multMatrixDir(n.assign(this.normal)).normalize(),t.multVecMatrix(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},multLeft:function(t){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(t).inverse(),o.multDirMatrix(n.assign(this.normal)).normalize(),t.multá¸¾atrixVec(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},getDistanceToPoint:function(e){return t.dot(e,this.normal)-this.distanceFromOrigin},intersectsLine:function(t,e){var i=t.point,n=t.direction,r=n.dot(this.normal);if(0===r)return!1;var o=(this.distanceFromOrigin-this.normal.dot(i))/r;return e.x=i.x+n.x*o,e.y=i.y+n.y*o,e.z=i.z+n.z*o,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},i}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("poly2tri/dist/poly2tri",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.poly2tri=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return r(i||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){e.exports={version:"1.5.0"}},{}],2:[function(t,e,i){var n=function(t,e){this.point=t,this.triangle=e||null,this.next=null,this.prev=null,this.value=t.x},r=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t};r.prototype.head=function(){return this.head_},r.prototype.setHead=function(t){this.head_=t},r.prototype.tail=function(){return this.tail_},r.prototype.setTail=function(t){this.tail_=t},r.prototype.search=function(){return this.search_node_},r.prototype.setSearch=function(t){this.search_node_=t},r.prototype.findSearchNode=function(){return this.search_node_},r.prototype.locateNode=function(t){var e=this.search_node_;if(t<e.value){for(;e=e.prev;)if(t>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},r.prototype.locatePoint=function(t){var e=t.x,i=this.findSearchNode(e),n=i.point.x;if(e===n){if(t!==i.point)if(t===i.prev.point)i=i.prev;else{if(t!==i.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");i=i.next}}else if(e<n)for(;(i=i.prev)&&t!==i.point;);else for(;(i=i.next)&&t!==i.point;);return i&&(this.search_node_=i),i},e.exports=r,e.exports.Node=n},{}],3:[function(t,e,i){function n(t,e){if(!t)throw new Error(e||"Assert Failed")}e.exports=n},{}],4:[function(t,e,i){var n=t("./xy"),r=function(t,e){this.x=+t||0,this.y=+e||0,this._p2t_edge_list=null};r.prototype.toString=function(){return n.toStringBase(this)},r.prototype.toJSON=function(){return{x:this.x,y:this.y}},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.set_zero=function(){return this.x=0,this.y=0,this},r.prototype.set=function(t,e){return this.x=+t||0,this.y=+e||0,this},r.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},r.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},r.prototype.mul=function(t){return this.x*=t,this.y*=t,this},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},r.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},r.negate=function(t){return new r(-t.x,-t.y)},r.add=function(t,e){return new r(t.x+e.x,t.y+e.y)},r.sub=function(t,e){return new r(t.x-e.x,t.y-e.y)},r.mul=function(t,e){return new r(t*e.x,t*e.y)},r.cross=function(t,e){return"number"==typeof t?"number"==typeof e?t*e:new r(-t*e.y,t*e.x):"number"==typeof e?new r(e*t.y,-e*t.x):t.x*e.y-t.y*e.x},r.toString=n.toString,r.compare=n.compare,r.cmp=n.compare,r.equals=n.equals,r.dot=function(t,e){return t.x*e.x+t.y*e.y},e.exports=r},{"./xy":11}],5:[function(t,e,i){var n=t("./xy"),r=function(t,e){this.name="PointError",this.points=e=e||[],this.message=t||"Invalid Points!";for(var i=0;i<e.length;i++)this.message+=" "+n.toString(e[i])};r.prototype=new Error,r.prototype.constructor=r,e.exports=r},{"./xy":11}],6:[function(t,e,i){(function(e){var n=e.poly2tri;i.noConflict=function(){return e.poly2tri=n,i},i.VERSION=t("../dist/version.json").version,i.PointError=t("./pointerror"),i.Point=t("./point"),i.Triangle=t("./triangle"),i.SweepContext=t("./sweepcontext");var r=t("./sweep");i.triangulate=r.triangulate,i.sweep={Triangulate:r.triangulate}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(t,e,i){function n(t){t.initTriangulation(),t.createAdvancingFront(),r(t),o(t)}function r(t){var e,i=t.pointCount();for(e=1;e<i;++e)for(var n=t.getPoint(e),r=s(t,n),o=n._p2t_edge_list,u=0;o&&u<o.length;++u)a(t,o[u],r)}function o(t){for(var e=t.front().head().next.triangle,i=t.front().head().next.point;!e.getConstrainedEdgeCW(i);)e=e.neighborCCW(i);t.meshClean(e)}function s(t,e){var i=t.locateNode(e),n=h(t,e,i);return e.x<=i.point.x+R&&c(t,i),d(t,n),n}function a(t,e,i){t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,l(i.triangle,e.p,e.q)||(v(t,e,i),u(t,e.p,e.q,i.triangle,e.q))}function u(t,e,i,n,r){
if(!l(n,e,i)){var o=n.pointCCW(r),s=z(i,o,e);if(s===k.COLLINEAR)throw new E("poly2tri EdgeEvent: Collinear not supported!",[i,o,e]);var a=n.pointCW(r),h=z(i,a,e);if(h===k.COLLINEAR)throw new E("poly2tri EdgeEvent: Collinear not supported!",[i,a,e]);s===h?(n=s===k.CW?n.neighborCCW(r):n.neighborCW(r),u(t,e,i,n,r)):M(t,e,i,n,r)}}function l(t,e,i){var n=t.edgeIndex(e,i);if(-1!==n){t.markConstrainedEdgeByIndex(n);var r=t.getNeighbor(n);return r&&r.markConstrainedEdgeByPoints(e,i),!0}return!1}function h(t,e,i){var n=new A(e,i.point,i.next.point);n.markNeighbor(i.triangle),t.addToMap(n);var r=new P(e);return r.next=i.next,r.prev=i,i.next.prev=r,i.next=r,f(t,n)||t.mapTriangleToNodes(n),r}function c(t,e){var i=new A(e.prev.point,e.point,e.next.point);i.markNeighbor(e.prev.triangle),i.markNeighbor(e.triangle),t.addToMap(i),e.prev.next=e.next,e.next.prev=e.prev,f(t,i)||t.mapTriangleToNodes(i)}function d(t,e){for(var i=e.next;i.next&&!j(i.point,i.next.point,i.prev.point);)c(t,i),i=i.next;for(i=e.prev;i.prev&&!j(i.point,i.next.point,i.prev.point);)c(t,i),i=i.prev;e.next&&e.next.next&&p(e)&&x(t,e)}function p(t){var e=t.point.x-t.next.next.point.x,i=t.point.y-t.next.next.point.y;return I(i>=0,"unordered y"),e>=0||Math.abs(e)<i}function f(t,e){for(var i=0;i<3;++i)if(!e.delaunay_edge[i]){var n=e.getNeighbor(i);if(n){var r=e.getPoint(i),o=n.oppositePoint(e,r),s=n.index(o);if(n.constrained_edge[s]||n.delaunay_edge[s]){e.constrained_edge[i]=n.constrained_edge[s];continue}var a=g(r,e.pointCCW(r),e.pointCW(r),o);if(a){e.delaunay_edge[i]=!0,n.delaunay_edge[s]=!0,m(e,r,n,o);var u=!f(t,e);return u&&t.mapTriangleToNodes(e),u=!f(t,n),u&&t.mapTriangleToNodes(n),e.delaunay_edge[i]=!1,n.delaunay_edge[s]=!1,!0}}}return!1}function g(t,e,i,n){var r=t.x-n.x,o=t.y-n.y,s=e.x-n.x,a=e.y-n.y,u=r*a,l=s*o,h=u-l;if(h<=0)return!1;var c=i.x-n.x,d=i.y-n.y,p=c*o,f=r*d,g=p-f;return!(g<=0)&&(r*r+o*o)*(s*d-c*a)+(s*s+a*a)*g+(c*c+d*d)*h>0}function m(t,e,i,n){var r,o,s,a;r=t.neighborCCW(e),o=t.neighborCW(e),s=i.neighborCCW(n),a=i.neighborCW(n);var u,l,h,c;u=t.getConstrainedEdgeCCW(e),l=t.getConstrainedEdgeCW(e),h=i.getConstrainedEdgeCCW(n),c=i.getConstrainedEdgeCW(n);var d,p,f,g;d=t.getDelaunayEdgeCCW(e),p=t.getDelaunayEdgeCW(e),f=i.getDelaunayEdgeCCW(n),g=i.getDelaunayEdgeCW(n),t.legalize(e,n),i.legalize(n,e),i.setDelaunayEdgeCCW(e,d),t.setDelaunayEdgeCW(e,p),t.setDelaunayEdgeCCW(n,f),i.setDelaunayEdgeCW(n,g),i.setConstrainedEdgeCCW(e,u),t.setConstrainedEdgeCW(e,l),t.setConstrainedEdgeCCW(n,h),i.setConstrainedEdgeCW(n,c),t.clearNeighbors(),i.clearNeighbors(),r&&i.markNeighbor(r),o&&t.markNeighbor(o),s&&t.markNeighbor(s),a&&i.markNeighbor(a),t.markNeighbor(i)}function x(t,e){for(z(e.point,e.next.point,e.next.next.point)===k.CCW?t.basin.left_node=e.next.next:t.basin.left_node=e.next,t.basin.bottom_node=t.basin.left_node;t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node!==t.basin.left_node){for(t.basin.right_node=t.basin.bottom_node;t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;t.basin.right_node!==t.basin.bottom_node&&(t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,y(t,t.basin.bottom_node))}}function y(t,e){if(!_(t,e)){c(t,e);if(e.prev!==t.basin.left_node||e.next!==t.basin.right_node){if(e.prev===t.basin.left_node){if(z(e.point,e.next.point,e.next.next.point)===k.CW)return;e=e.next}else if(e.next===t.basin.right_node){if(z(e.point,e.prev.point,e.prev.prev.point)===k.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;y(t,e)}}}function _(t,e){var i;return i=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y,t.basin.width>i}function v(t,e,i){t.edge_event.right?w(t,e,i):F(t,e,i)}function w(t,e,i){for(;i.next.point.x<e.p.x;)z(e.q,i.next.point,e.p)===k.CCW?b(t,e,i):i=i.next}function b(t,e,i){i.point.x<e.p.x&&(z(i.point,i.next.point,i.next.next.point)===k.CCW?S(t,e,i):(C(t,e,i),b(t,e,i)))}function S(t,e,i){c(t,i.next),i.next.point!==e.p&&z(e.q,i.next.point,e.p)===k.CCW&&z(i.point,i.next.point,i.next.next.point)===k.CCW&&S(t,e,i)}function C(t,e,i){z(i.next.point,i.next.next.point,i.next.next.next.point)===k.CCW?S(t,e,i.next):z(e.q,i.next.next.point,e.p)===k.CCW&&C(t,e,i.next)}function F(t,e,i){for(;i.prev.point.x>e.p.x;)z(e.q,i.prev.point,e.p)===k.CW?T(t,e,i):i=i.prev}function T(t,e,i){i.point.x>e.p.x&&(z(i.point,i.prev.point,i.prev.prev.point)===k.CW?O(t,e,i):(N(t,e,i),T(t,e,i)))}function N(t,e,i){z(i.prev.point,i.prev.prev.point,i.prev.prev.prev.point)===k.CW?O(t,e,i.prev):z(e.q,i.prev.prev.point,e.p)===k.CW&&N(t,e,i.prev)}function O(t,e,i){c(t,i.prev),i.prev.point!==e.p&&z(e.q,i.prev.point,e.p)===k.CW&&z(i.point,i.prev.point,i.prev.prev.point)===k.CW&&O(t,e,i)}function M(t,e,i,n,r){var o=n.neighborAcross(r);I(o,"FLIP failed due to missing triangle!");var s=o.oppositePoint(n,r);if(n.getConstrainedEdgeAcross(r)){var a=n.index(r);throw new E("poly2tri Intersecting Constraints",[r,s,n.getPoint((a+1)%3),n.getPoint((a+2)%3)])}if(X(r,n.pointCCW(r),n.pointCW(r),s))if(m(n,r,o,s),t.mapTriangleToNodes(n),t.mapTriangleToNodes(o),r===i&&s===e)i===t.edge_event.constrained_edge.q&&e===t.edge_event.constrained_edge.p&&(n.markConstrainedEdgeByPoints(e,i),o.markConstrainedEdgeByPoints(e,i),f(t,n),f(t,o));else{var l=z(i,s,e);n=V(t,l,n,o,r,s),M(t,e,i,n,r)}else{B(t,e,i,n,o,D(e,i,o,s)),u(t,e,i,n,r)}}function V(t,e,i,n,r,o){var s;return e===k.CCW?(s=n.edgeIndex(r,o),n.delaunay_edge[s]=!0,f(t,n),n.clearDelaunayEdges(),i):(s=i.edgeIndex(r,o),i.delaunay_edge[s]=!0,f(t,i),i.clearDelaunayEdges(),n)}function D(t,e,i,n){var r=z(e,n,t);if(r===k.CW)return i.pointCCW(n);if(r===k.CCW)return i.pointCW(n);throw new E("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,n,t])}function B(t,e,i,n,r,o){var s=r.neighborAcross(o);I(s,"FLIP failed due to missing triangle");var a=s.oppositePoint(r,o);if(X(i,n.pointCCW(i),n.pointCW(i),a))M(t,i,a,s,a);else{B(t,e,i,n,s,D(e,i,s,a))}}var I=t("./assert"),E=t("./pointerror"),A=t("./triangle"),P=t("./advancingfront").Node,L=t("./utils"),R=L.EPSILON,k=L.Orientation,z=L.orient2d,X=L.inScanArea,j=L.isAngleObtuse;i.triangulate=n},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(t,e,i){var n=t("./pointerror"),r=t("./point"),o=t("./triangle"),s=t("./sweep"),a=t("./advancingfront"),u=a.Node,l=function(t,e){if(this.p=t,this.q=e,t.y>e.y)this.q=t,this.p=e;else if(t.y===e.y)if(t.x>e.x)this.q=t,this.p=e;else if(t.x===e.x)throw new n("poly2tri Invalid Edge constructor: repeated points!",[t]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},h=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};h.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var c=function(){this.constrained_edge=null,this.right=!1},d=function(t,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?t.slice(0):t,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new h,this.edge_event=new c,this.initEdges(this.points_)};d.prototype.addHole=function(t){this.initEdges(t);var e,i=t.length;for(e=0;e<i;e++)this.points_.push(t[e]);return this},d.prototype.AddHole=d.prototype.addHole,d.prototype.addHoles=function(t){var e,i=t.length;for(e=0;e<i;e++)this.initEdges(t[e]);return this.points_=this.points_.concat.apply(this.points_,t),this},d.prototype.addPoint=function(t){return this.points_.push(t),this},d.prototype.AddPoint=d.prototype.addPoint,d.prototype.addPoints=function(t){return this.points_=this.points_.concat(t),this},d.prototype.triangulate=function(){return s.triangulate(this),this},d.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},d.prototype.getTriangles=function(){return this.triangles_},d.prototype.GetTriangles=d.prototype.getTriangles,d.prototype.front=function(){return this.front_},d.prototype.pointCount=function(){return this.points_.length},d.prototype.head=function(){return this.head_},d.prototype.setHead=function(t){this.head_=t},d.prototype.tail=function(){return this.tail_},d.prototype.setTail=function(t){this.tail_=t},d.prototype.getMap=function(){return this.map_},d.prototype.initTriangulation=function(){var t,e=this.points_[0].x,i=this.points_[0].x,n=this.points_[0].y,o=this.points_[0].y,s=this.points_.length;for(t=1;t<s;t++){var a=this.points_[t];a.x>e&&(e=a.x),a.x<i&&(i=a.x),a.y>n&&(n=a.y),a.y<o&&(o=a.y)}this.pmin_=new r(i,o),this.pmax_=new r(e,n);var u=.3*(e-i),l=.3*(n-o);this.head_=new r(e+u,o-l),this.tail_=new r(i-u,o-l),this.points_.sort(r.compare)},d.prototype.initEdges=function(t){var e,i=t.length;for(e=0;e<i;++e)this.edge_list.push(new l(t[e],t[(e+1)%i]))},d.prototype.getPoint=function(t){return this.points_[t]},d.prototype.addToMap=function(t){this.map_.push(t)},d.prototype.locateNode=function(t){return this.front_.locateNode(t.x)},d.prototype.createAdvancingFront=function(){var t,e,i,n=new o(this.points_[0],this.tail_,this.head_);this.map_.push(n),t=new u(n.getPoint(1),n),e=new u(n.getPoint(0),n),i=new u(n.getPoint(2)),this.front_=new a(t,i),t.next=e,e.next=i,e.prev=t,i.prev=e},d.prototype.removeNode=function(t){},d.prototype.mapTriangleToNodes=function(t){for(var e=0;e<3;++e)if(!t.getNeighbor(e)){var i=this.front_.locatePoint(t.pointCW(t.getPoint(e)));i&&(i.triangle=t)}},d.prototype.removeFromMap=function(t){var e,i=this.map_,n=i.length;for(e=0;e<n;e++)if(i[e]===t){i.splice(e,1);break}},d.prototype.meshClean=function(t){for(var e,i,n=[t];e=n.pop();)if(!e.isInterior())for(e.setInterior(!0),this.triangles_.push(e),i=0;i<3;i++)e.constrained_edge[i]||n.push(e.getNeighbor(i))},e.exports=d},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(t,e,i){var n=t("./xy"),r=function(t,e,i){this.points_=[t,e,i],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},o=n.toString;r.prototype.toString=function(){return"["+o(this.points_[0])+o(this.points_[1])+o(this.points_[2])+"]"},r.prototype.getPoint=function(t){return this.points_[t]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(t){return this.neighbors_[t]},r.prototype.containsPoint=function(t){var e=this.points_;return t===e[0]||t===e[1]||t===e[2]},r.prototype.containsEdge=function(t){return this.containsPoint(t.p)&&this.containsPoint(t.q)},r.prototype.containsPoints=function(t,e){return this.containsPoint(t)&&this.containsPoint(e)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(t){return this.interior_=t,this},r.prototype.markNeighborPointers=function(t,e,i){var n=this.points_;if(t===n[2]&&e===n[1]||t===n[1]&&e===n[2])this.neighbors_[0]=i;else if(t===n[0]&&e===n[2]||t===n[2]&&e===n[0])this.neighbors_[1]=i;else{if(!(t===n[0]&&e===n[1]||t===n[1]&&e===n[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=i}},r.prototype.markNeighbor=function(t){var e=this.points_;t.containsPoints(e[1],e[2])?(this.neighbors_[0]=t,t.markNeighborPointers(e[1],e[2],this)):t.containsPoints(e[0],e[2])?(this.neighbors_[1]=t,t.markNeighborPointers(e[0],e[2],this)):t.containsPoints(e[0],e[1])&&(this.neighbors_[2]=t,t.markNeighborPointers(e[0],e[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(t){var e=this.points_;return t===e[0]?e[2]:t===e[1]?e[0]:t===e[2]?e[1]:null},r.prototype.pointCCW=function(t){var e=this.points_;return t===e[0]?e[1]:t===e[1]?e[2]:t===e[2]?e[0]:null},r.prototype.neighborCW=function(t){return t===this.points_[0]?this.neighbors_[1]:t===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(t){return t===this.points_[0]?this.neighbors_[2]:t===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(t){return t===this.points_[0]?this.constrained_edge[1]:t===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(t){return t===this.points_[0]?this.constrained_edge[2]:t===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(t){return t===this.points_[0]?this.constrained_edge[0]:t===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(t,e){t===this.points_[0]?this.constrained_edge[1]=e:t===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},r.prototype.setConstrainedEdgeCCW=function(t,e){t===this.points_[0]?this.constrained_edge[2]=e:t===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},r.prototype.getDelaunayEdgeCW=function(t){return t===this.points_[0]?this.delaunay_edge[1]:t===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(t){return t===this.points_[0]?this.delaunay_edge[2]:t===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(t,e){t===this.points_[0]?this.delaunay_edge[1]=e:t===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},r.prototype.setDelaunayEdgeCCW=function(t,e){t===this.points_[0]?this.delaunay_edge[2]=e:t===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},r.prototype.neighborAcross=function(t){return t===this.points_[0]?this.neighbors_[0]:t===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(t,e){var i=t.pointCW(e);return this.pointCW(i)},r.prototype.legalize=function(t,e){var i=this.points_;if(t===i[0])i[1]=i[0],i[0]=i[2],i[2]=e;else if(t===i[1])i[2]=i[1],i[1]=i[0],i[0]=e;else{if(t!==i[2])throw new Error("poly2tri Invalid Triangle.legalize() call");i[0]=i[2],i[2]=i[1],i[1]=e}},r.prototype.index=function(t){var e=this.points_;if(t===e[0])return 0;if(t===e[1])return 1;if(t===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(t,e){var i=this.points_;if(t===i[0]){if(e===i[1])return 2;if(e===i[2])return 1}else if(t===i[1]){if(e===i[2])return 0;if(e===i[0])return 2}else if(t===i[2]){if(e===i[0])return 1;if(e===i[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(t){this.constrained_edge[t]=!0},r.prototype.markConstrainedEdgeByEdge=function(t){this.markConstrainedEdgeByPoints(t.p,t.q)},r.prototype.markConstrainedEdgeByPoints=function(t,e){var i=this.points_;e===i[0]&&t===i[1]||e===i[1]&&t===i[0]?this.constrained_edge[2]=!0:e===i[0]&&t===i[2]||e===i[2]&&t===i[0]?this.constrained_edge[1]=!0:(e===i[1]&&t===i[2]||e===i[2]&&t===i[1])&&(this.constrained_edge[0]=!0)},e.exports=r},{"./xy":11}],10:[function(t,e,i){function n(t,e,i){var n=(t.x-i.x)*(e.y-i.y),r=(t.y-i.y)*(e.x-i.x),o=n-r;return o>-s&&o<s?a.COLLINEAR:o>0?a.CCW:a.CW}function r(t,e,i,n){return!((t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)>=-s)&&!((t.x-i.x)*(n.y-i.y)-(n.x-i.x)*(t.y-i.y)<=s)}function o(t,e,i){var n=e.x-t.x,r=e.y-t.y;return n*(i.x-t.x)+r*(i.y-t.y)<0}var s=1e-12;i.EPSILON=s;var a={CW:1,CCW:-1,COLLINEAR:0};i.Orientation=a,i.orient2d=n,i.inScanArea=r,i.isAngleObtuse=o},{}],11:[function(t,e,i){function n(t){return"("+t.x+";"+t.y+")"}function r(t){var e=t.toString();return"[object Object]"===e?n(t):e}function o(t,e){return t.y===e.y?t.x-e.x:t.y-e.y}function s(t,e){return t.x===e.x&&t.y===e.y}e.exports={toString:r,toStringBase:n,compare:o,equals:s}},{}]},{},[6])(6)}),define("poly2tri",["poly2tri/dist/poly2tri"],function(t){return t}),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","poly2tri"],function(t,e,i){"use strict";var n=new t(0,0,0),r=new t(0,0,0),o=new t(0,0,0),s=new t(0,0,0),a=new t(0,0,0),u=new t(0,0,0),l=new e;return{area:function(t,e,i){return r.assign(e).subtract(t).cross(o.assign(i).subtract(t)).abs()/2},normal:function(t,e,i,n){var r=i.x-e.x,o=i.y-e.y,s=i.z-e.z,a=t.x-e.x,u=t.y-e.y,l=t.z-e.z;return n.set(o*l-s*u,s*a-r*l,r*u-o*a),n.normalize()},quadNormal:function(t,e,i,n,r){var o=i.x-t.x,s=i.y-t.y,a=i.z-t.z,u=n.x-e.x,l=n.y-e.y,h=n.z-e.z;return r.set(s*h-a*l,a*u-o*h,o*l-s*u),r.normalize()},removeCollinearPoints:function(t){for(var e=0,i=0,n=t.length,r=n-1;e<n;++e){var o=(e+r)%n,s=(e+1)%n;this.isCollinear(t[o],t[e],t[s])||(t[i++]=t[e])}t.length=i},isCollinear:function(t,e,i){var r=n.assign(t).subtract(e).normalize(),s=o.assign(i).subtract(e).normalize();return 0==r.abs()||(0==s.abs()||Math.abs(r.dot(s))>=1)},triangulatePolygon:function(t,e){try{this.removeCollinearPoints(t);var n=t[0],r=t[1];this.getPolygonNormal(t,u),s.assign(r).subtract(n),a.assign(u).cross(s),s.normalize(),a.normalize(),l.set(s.x,s.y,s.z,0,a.x,a.y,a.z,0,u.x,u.y,u.z,0,n.x,n.y,n.z,1),l.inverse();for(var o=0,h=t.length;o<h;++o)l.multVecMatrix(t[o]);for(var c=new i.SweepContext(t),d=c.triangulate().getTriangles(),o=0,h=d.length;o<h;++o)e.push(d[o].getPoint(0),d[o].getPoint(1),d[o].getPoint(2))}catch(i){this.triangulateConvexPolygon(t,e)}},triangulateConvexPolygon:function(t,e){for(var i=1,n=t.length-1;i<n;++i)e.push(t[0],t[i],t[i+1])},getPolygonNormal:function(t,e){e.set(0,0,0);for(var i=t[0],n=0,r=t.length;n<r;++n){var o=i,i=t[(n+1)%r];e.x+=(o.y-i.y)*(o.z+i.z),e.y+=(o.z-i.z)*(o.x+i.x),e.z+=(o.x-i.x)*(o.y+i.y)}return e.normalize()}}}),define("standard/Math/Geometry/ViewVolume",["jquery","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s){"use strict";function a(){this.viewport=new o(0,0,0,0),this.scissor=new o(0,0,0,0),this.planes=[new i(r.Zero,r.Zero),new i(r.Zero,r.Zero),new i(r.Zero,r.Zero),new i(r.Zero,r.Zero),new i(r.Zero,r.Zero),new i(r.Zero,r.Zero)]}var u=new r(0,0,0),l=new r(0,0,0),h=new r(0,0,0),c=new r(0,0,0),d=new r(0,0,0),p=new r(0,0,0),f=new r(0,0,0),g=new r(0,0,0),m=new s,x=new r(0,0,0),y=new o(0,0,0,0);return a.prototype={constructor:a,set:function(t,e,i){try{this.viewport.assign(e),this.scissor.assign(i);var r=i[0],o=i[0]+i[2],s=i[1],f=i[1]+i[3];m.assign(t).inverse(),a.unProjectPointMatrix(r,f,1,m,e,u),a.unProjectPointMatrix(r,s,1,m,e,l),a.unProjectPointMatrix(r,s,0,m,e,h),a.unProjectPointMatrix(o,s,0,m,e,c),a.unProjectPointMatrix(o,f,0,m,e,d),a.unProjectPointMatrix(o,f,1,m,e,p),this.planes[0].set(c,n.normal(h,c,d,x)),this.planes[1].set(l,n.normal(u,l,h,x)),this.planes[2].set(d,n.normal(p,d,c,x)),this.planes[3].set(p,n.normal(d,p,u,x)),this.planes[4].set(h,n.normal(c,h,l,x)),this.planes[5].set(u,n.normal(l,u,p,x)),this.valid=!0}catch(t){this.valid=!1,console.log(t)}return this},getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},intersectsSphere:function(t,e){var i=this.planes;return!(i[0].getDistanceToPoint(e)>t)&&(!(i[1].getDistanceToPoint(e)>t)&&(!(i[2].getDistanceToPoint(e)>t)&&(!(i[3].getDistanceToPoint(e)>t)&&(!(i[4].getDistanceToPoint(e)>t)&&!(i[5].getDistanceToPoint(e)>t)))))}},t.extend(a,{unProjectPoint:function(t,e,i,n,r,o,s){return m.assign(n).multRight(r).inverse(),this.unProjectPointMatrix(t,e,i,m,o,s)},unProjectPointMatrix:function(t,e,i,n,r,o){if(y.set((t-r[0])/r[2]*2-1,(e-r[1])/r[3]*2-1,2*i-1,1),n.multVecMatrix(y),0===y.w)throw new Error("Couldn't unproject point: divisor is 0.");var s=1/y.w;return o.set(y.x*s,y.y*s,y.z*s)},unProjectRay:function(t,e,i,n,r,o){return m.assign(i).multRight(n).inverse(),a.unProjectPointMatrix(t,e,0,m,r,f),a.unProjectPointMatrix(t,e,.9,m,r,g),o.setPoints(f,g)},projectPoint:function(t,e,i,n,r){if(y.set(t.x,t.y,t.z,1),i.multVecMatrix(e.multVecMatrix(y)),0===y.w)throw new Error("Couldn't project point: divisor is 0.");var o=1/(2*y.w);return r.set((y.x*o+.5)*n[2]+n[0],(y.y*o+.5)*n[3]+n[1],y.z*o+.5)},projectLine:function(t,e,i,n,o){return a.projectPoint(t.point,e,i,n,f),a.projectPoint(r.multiply(t.direction,1e9).add(t.point),e,i,n,g),f.z=0,g.z=0,o.setPoints(f,g)}}),a}),define("x_ite/Rendering/DepthBuffer",["standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i){"use strict";function n(t,n,r){var o=t.getContext();this.browser=t,this.width=n,this.height=r,this.array=new Uint8Array(n*r*4),this.invProjectionMatrix=new i,this.point=new e(0,0,0),this.lastBuffer=o.getParameter(o.FRAMEBUFFER_BINDING),this.buffer=o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,this.buffer),this.depthTexture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.depthTexture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n,r,0,o.RGBA,o.UNSIGNED_BYTE,null),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.depthTexture,0);var s=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,s),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,n,r),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,s);var a=o.checkFramebufferStatus(o.FRAMEBUFFER)===o.FRAMEBUFFER_COMPLETE;if(o.bindFramebuffer(o.FRAMEBUFFER,this.lastBuffer),!a)throw new Error("Couldn't create frame buffer.")}return n.prototype={constructor:n,getWidth:function(){return this.width},getHeight:function(){return this.height},getDepthTexture:function(){return this.depthTexture},readPixels:function(){var t=this.browser.getContext(),e=this.array,i=this.width,n=this.height;return t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,e),e},getDepth:function(e,i){try{var n=this.browser.getContext(),r=this.array,o=this.width,s=this.height,a=this.invProjectionMatrix.assign(e).inverse(),u=0,l=0,h=Number.POSITIVE_INFINITY;n.readPixels(0,0,o,s,n.RGBA,n.UNSIGNED_BYTE,r);for(var c=0,d=0;c<s;++c)for(var p=0;p<o;++p,d+=4){var f=r[d]/255+r[d+1]/65025+r[d+2]/16581375+r[d+3]/4228250625;f<h&&(u=p,l=c,h=f)}return t.unProjectPointMatrix(u,l,h,a,i,this.point),this.point.z}catch(t){return 0}},bind:function(){var t=this.browser.getContext();this.lastBuffer=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this.buffer)},unbind:function(){var t=this.browser.getContext();t.bindFramebuffer(t.FRAMEBUFFER,this.lastBuffer)}},n}),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Vector3"],function(t){"use strict";var e=new t(0,0,0),i=new t(0,0,0);return{frustum:function(t,e,i,n,r,o,s){var a=e-t,u=n-i,l=o-r,h=2*r,c=(e+t)/a,d=(n+i)/u,p=-(o+r)/l,f=-h*o/l,g=h/a,m=h/u;return s.set(g,0,0,0,0,m,0,0,c,d,p,-1,0,0,f,0)},perspective:function(t,e,i,n,r,o){var s=Math.tan(t/2)*e;if(n>r){var a=n*s/r;return this.frustum(-a,a,-s,s,e,i,o)}var a=r*s/n;return this.frustum(-s,s,-a,a,e,i,o)},ortho:function(t,e,i,n,r,o,s){var a=e-t,u=n-i,l=o-r,h=2/a,c=2/u,d=-2/l,p=-(e+t)/a,f=-(n+i)/u,g=-(o+r)/l;return s.set(h,0,0,0,0,c,0,0,0,0,d,0,p,f,g,1)},orthoBox:function(t,n){return t.getExtents(e,i),this.ortho(e.x,i.x,e.y,i.y,-i.z,-e.z,n)}}}),define("x_ite/Browser/Shaders/ShaderTest",["x_ite/Rendering/DepthBuffer","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera"],function(t,e,i,n,r){"use strict";function o(e,o){var u=e.getContext(),l=new t(e,16,16),h=u.createBuffer(),c=u.createBuffer();l.bind(),o.useProgram(u),u.viewport(0,0,16,16),u.bindBuffer(u.ARRAY_BUFFER,c),u.bufferData(u.ARRAY_BUFFER,new Float32Array(a),u.STATIC_DRAW),u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,new Float32Array(s),u.STATIC_DRAW),o.setClipPlanes(u,[]),u.uniform1i(o.x3d_FogType,0),u.uniform1i(o.x3d_ColorMaterial,!1),u.uniform1i(o.x3d_Lighting,!0),u.uniform1i(o.x3d_SeparateBackColor,!1),u.uniform1f(o.x3d_AmbientIntensity,0),u.uniform3f(o.x3d_DiffuseColor,1,0,0),u.uniform3f(o.x3d_SpecularColor,1,0,0),u.uniform3f(o.x3d_EmissiveColor,1,0,0),u.uniform1f(o.x3d_Shininess,0),u.uniform1f(o.x3d_Transparency,0),u.uniform1i(o.x3d_LightType[0],0),o.textureTypeArray[0]=0,u.uniform1iv(o.x3d_TextureType,o.textureTypeArray),u.uniformMatrix4fv(o.x3d_ProjectionMatrix,!1,new Float32Array(r.ortho(-1,1,-1,1,-1,1,new n))),u.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,new Float32Array(new n)),u.uniformMatrix3fv(o.x3d_NormalMatrix,!1,new Float32Array(new i)),u.disable(u.BLEND),u.frontFace(u.CCW),u.cullFace(u.BACK),o.enableNormalAttribute(u,h),o.enableVertexAttribute(u,c),u.drawArrays(u.TRIANGLES,0,6);var d=l.readPixels();return l.unbind(),255==d[0]&&0==d[1]&&0==d[2]&&255==d[3]}var s=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],a=[2,2,0,1,-2,2,0,1,-2,-2,0,1,2,2,0,1,-2,-2,0,1,2,-2,0,1];return o}),define("x_ite/Browser/Rendering/X3DRenderingContext",["jquery","x_ite/Fields","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","text!x_ite/Browser/Shaders/PointSet.fs","text!x_ite/Browser/Shaders/Wireframe.vs","text!x_ite/Browser/Shaders/Wireframe.fs","text!x_ite/Browser/Shaders/Gouraud.vs","text!x_ite/Browser/Shaders/Gouraud.fs","text!x_ite/Browser/Shaders/Phong.vs","text!x_ite/Browser/Shaders/Phong.fs","text!x_ite/Browser/Shaders/Depth.vs","text!x_ite/Browser/Shaders/Depth.fs","x_ite/Browser/Shaders/ShaderTest","standard/Math/Numbers/Vector4"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f){"use strict";function g(){this.addChildObjects("viewport",new e.MFInt32(0,0,300,150)),this.clipPlanes=[]}return g.prototype={initialize:function(){var e=this.getContext();e.enable(e.SCISSOR_TEST),e.cullFace(e.BACK),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.onfullscreen.bind(this)),setInterval(this.reshape.bind(this),401),this.reshape(),this.depthShader=this.createShader(this,"DepthShader",c,d),this.pointShader=this.createShader(this,"PointShader",o,r),this.lineShader=this.createShader(this,"WireframeShader",o,s),this.gouraudShader=this.createShader(this,"GouraudShader",a,u),this.phongShader=this.createShader(this,"PhongShader",l,h),this.pointShader.setGeometryType(0),this.lineShader.setGeometryType(1),this.setShading("GOURAUD"),this.phongShader.isValid_.addInterest("set_phong_shader_valid__",this)},set_phong_shader_valid__:function(t){t.getValue()&&p(this,this.phongShader)||(console.warn("X_ITE: Phong shading is not available, using Gouraud shading."),this.phongShader=this.gouraudShader)},getVendor:function(){return this.getContext().getParameter(this.getContext().VENDOR)},getWebGLVersion:function(){return this.getContext().getParameter(this.getContext().VERSION)},getAntialiased:function(){return this.getContext().getParameter(this.getContext().SAMPLES)>0},getMaxClipPlanes:function(){return 6},getDepthSize:function(){var t=this.context;return t.getParameter(t.DEPTH_BITS)},getColorDepth:function(){var t=this.context,e=0;return e+=t.getParameter(t.RED_BITS),e+=t.getParameter(t.BLUE_BITS),e+=t.getParameter(t.GREEN_BITS),e+=t.getParameter(t.ALPHA_BITS)},getViewport:function(){return this.viewport_},createShader:function(t,e,r,o){var s=new n(t.getPrivateScene());s.url_.push("data:text/plain;charset=utf-8,"+r),s.setup();var a=new n(t.getPrivateScene());a.type_="FRAGMENT",a.url_.push("data:text/plain;charset=utf-8,"+o),a.setup();var u=new i(t.getPrivateScene());return u.setName(e),u.language_="GLSL",u.parts_.push(s),u.parts_.push(a),u.setCustom(!1),u.setup(),this.getLoadSensor().watchList_.push(s),this.getLoadSensor().watchList_.push(a),u},setShading:function(t){this.context;switch(t){case"PHONG":this.defaultShader=this.phongShader;break;default:this.defaultShader=this.gouraudShader}this.pointShader.setGeometryType(0),this.lineShader.setGeometryType(1),this.defaultShader.setGeometryType(3);var e=this.getShaders();for(var i in e)e[i].setShading(t)},getDefaultShader:function(){return this.defaultShader},getPointShader:function(){return this.pointShader},getLineShader:function(){return this.lineShader},getGouraudShader:function(){return this.gouraudShader},getDepthShader:function(){return this.depthShader},getClipPlanes:function(){return this.clipPlanes},reshape:function(){var t=this.canvas,e=t.width(),i=t.height();t=t[0],e===t.width&&i===t.height||(this.viewport_.setValue([0,0,e,i]),this.context.viewport(0,0,e,i),this.context.scissor(0,0,e,i),t.width=e,t.height=i,this.addBrowserEvent())},onfullscreen:function(){this.getElement().fullScreen()?this.getElement().addClass("x_ite-fullscreen"):this.getElement().removeClass("x_ite-fullscreen")}},g}),define("x_ite/Browser/Geometry2D/Arc2DOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Fields"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addChildObjects("dimension",new i.SFInt32(32))}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"ArcClose2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"arcClose2DOptions"}}),n}),define("x_ite/Browser/Geometry2D/ArcClose2DOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Fields"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addChildObjects("dimension",new i.SFInt32(32))}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"Arc2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"arc2DOptions"}}),n}),define("standard/Math/Numbers/Complex",["jquery"],function(t){"use strict";function e(t,e){this.real=t,this.imag=e}return e.prototype={constructor:e,copy:function(){var t=Object.create(e.prototype);return t.real=this.real,t.imag=this.imag,t},assign:function(t){return this.real=t.real,this.imag=t.imag,this},equals:function(t){return this.real===t.real&&this.imag===t.imag},setRadius:function(t){return this.setPolar(t,this.getAngle())},getRadius:function(){return this.real?this.imag?Math.sqrt(this.real*this.real+this.imag*this.imag):Math.abs(this.real):Math.abs(this.imag)},setAngle:function(t){return this.setPolar(this.getRadius(),t)},getAngle:function(){return Math.atan2(this.imag,this.real)},setPolar:function(t,e){this.real=t*Math.cos(e),this.imag=t*Math.sin(e)},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){var t=this.real*this.real+this.imag*this.imag;return this.real/=t,this.imag/=-t,this},add:function(t){return this.real+=t.real,this.imag+=t.imag,this},subtract:function(t){return this.real-=t.real,this.imag-=t.imag,this},multiply:function(t){return this.real*=t,this.imag*=t,this},multComp:function(){var t=this.real,e=this.imag;return this.real=t*value.real-e*value.imag,this.imag=t*value.imag+e*value.real,this},divComp:function(t){var e=this.real,i=this.imag,n=t.real,r=t.imag,o=n*n+r*r;return this.real=(e*n+i*r)/o,this.imag=(i*n-e*r)/o,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":String(this.real)}},t.extend(e,{Polar:function(t,i){var n=Object.create(e.prototype);return n.real=t*Math.cos(i),n.imag=t*Math.sin(i),n},multiply:function(t,e){var i=Object.create(this.prototype);return i.real=t.real*e,i.imag=t.imag*e,i},multComp:function(t,e){var i=Object.create(this.prototype);return i.real=t.real*e.real-lsh.imag*e.imag,i.imag=t.real*e.imag+lsh.imag*e.real,i}}),e}),
define("x_ite/Browser/Geometry2D/Circle2DOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Fields","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t){e.call(this,t),this.addChildObjects("dimension",new i.SFInt32(40)),this.vertices=[]}return o.prototype=t.extend(Object.create(e.prototype),{constructor:o,getTypeName:function(){return"Circle2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest("build",this),this.build()},getVertices:function(){return this.vertices},build:function(){var t=this.dimension_.getValue(),e=2*Math.PI/t;this.vertices.length=0;for(var i=0;i<t;++i){var r=n.Polar(1,e*i);this.vertices.push(r.real,r.imag,0,1)}}}),o}),define("x_ite/Browser/Geometry2D/Disk2DOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Fields","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t){e.call(this,t),this.addChildObjects("dimension",new i.SFInt32(40)),this.circleVertices=[],this.diskTexCoords=[],this.diskNormals=[],this.diskVertices=[]}var s=new n(.5,.5);return o.prototype=t.extend(Object.create(e.prototype),{constructor:o,getTypeName:function(){return"Disk2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest("build",this),this.build()},getCircleVertices:function(){return this.circleVertices},getDiskTexCoords:function(){return this.diskTexCoords},getDiskNormals:function(){return this.diskNormals},getDiskVertices:function(){return this.diskVertices},build:function(){var t=this.dimension_.getValue(),e=2*Math.PI/t;this.circleVertices.length=0,this.diskTexCoords.length=0,this.diskNormals.length=0,this.diskVertices.length=0;for(var i=0;i<t;++i){var r=e*i,o=e*(i+1),a=n.Polar(.5,r).add(s),u=n.Polar(.5,o).add(s),l=n.Polar(1,r),h=n.Polar(1,o);this.circleVertices.push(l.real,l.imag,0,1),this.diskTexCoords.push(.5,.5,0,1,a.real,a.imag,0,1,u.real,u.imag,0,1),this.diskNormals.push(0,0,1,0,0,1,0,0,1),this.diskVertices.push(0,0,0,1,l.real,l.imag,0,1,h.real,h.imag,0,1)}}}),o}),define("standard/Math/Algorithms/SAT",[],function(){"use strict";function t(){}function e(t,e,i){i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY;for(var n=0,r=t.length;n<r;++n){var o=t[n],s=o.dot(e);s<i.min&&(i.min=s),s>i.max&&(i.max=s)}}function i(t,e,i,r){return n(i,t,e)||n(t,i,r)}function n(t,e,i){return e<=t&&t<=i}var r={min:0,max:0},o={min:0,max:0};return t.isSeparated=function(t,n,s){for(var a=0,u=t.length;a<u;++a){var l=t[a];if(e(n,l,r),e(s,l,o),!i(r.min,r.max,o.min,o.max))return!0}return!1},t}),define("standard/Math/Geometry/Box3",["standard/Math/Geometry/Triangle3","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Algorithms/SAT"],function(t,e,i,n){"use strict";function r(t,i){switch(arguments.length){case 0:return void(this.matrix=new e(.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,0,t.y/2,0,0,0,0,t.z/2,0,i.x,i.y,i.z,1));case 3:var n=arguments[0],r=arguments[1],o=(r.x-n.x)/2,s=(r.y-n.y)/2,a=(r.z-n.z)/2,u=(r.x+n.x)/2,l=(r.y+n.y)/2,h=(r.z+n.z)/2;return void(this.matrix=new e(o,0,0,0,0,s,0,0,0,0,a,0,u,l,h,1))}}var o=new i(0,0,0),s=new i(0,0,0),a=new i(0,0,0),u=new i(0,0,0),l=new i(0,0,0),h=new i(0,0,0),c=new i(0,0,0),d=new i(0,0,0),p=new i(0,0,0),f=new i(0,0,0),g=new i(0,0,0),m=new i(0,0,0),x=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],y=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],_=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],v=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],w=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],b=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],S=[],C=[new i(0,0,0)],F=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return r.prototype={constructor:r,copy:function(){var t=Object.create(r.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},getMatrix:function(){return this.matrix},set:function(t,e){x.box===this&&(x.box=null),_.box===this&&(_.box=null);var i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=.5,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=.5,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=0,this;case 2:return i[0]=t.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t.y/2,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t.z/2,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}},setExtents:function(t,e){x.box===this&&(x.box=null),_.box===this&&(_.box=null);var i=this.matrix,n=(e.x-t.x)/2,r=(e.y-t.y)/2,o=(e.z-t.z)/2,s=(e.x+t.x)/2,a=(e.y+t.y)/2,u=(e.z+t.z)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=o,i[11]=0,i[12]=s,i[13]=a,i[14]=u,i[15]=1,this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(t,e){var i=this.matrix;a.set(i[0],i[1],i[2]),u.set(i[4],i[5],i[6]),l.set(i[8],i[9],i[10]),h.assign(u).add(l);var n=l.subtract(u);c.assign(a).add(h),d.assign(a).add(n);var r=h.subtract(a),o=n.subtract(a);t.assign(c),e.assign(c),t.min(r,o,d),e.max(r,o,d),c.negate(),r.negate(),o.negate(),d.negate(),t.min(c,r,o,d),e.max(c,r,o,d)},getPoints:function(t){var e=this.matrix;a.set(e[0],e[1],e[2]),u.set(e[4],e[5],e[6]),l.set(e[8],e[9],e[10]),h.assign(u).add(l);var i=l.subtract(u);t[0].assign(a).add(h),t[1].assign(h).subtract(a),t[2].assign(i).subtract(a),t[3].assign(a).add(i),t[4].assign(t[2]).negate(),t[5].assign(t[3]).negate(),t[6].assign(t[0]).negate(),t[7].assign(t[1]).negate();var n=this.center;return t[0].add(n),t[1].add(n),t[2].add(n),t[3].add(n),t[4].add(n),t[5].add(n),t[6].add(n),t[7].add(n),t},getAxes:function(t){var e=this.matrix;return t[0].set(e[0],e[1],e[2]),t[1].set(e[4],e[5],e[6]),t[2].set(e[8],e[9],e[10]),t},getPlanes:function(t){var e=this.matrix;return t[0].set(e[0],e[1],e[2]).cross(l),t[1].set(e[4],e[5],e[6]).cross(a),t[2].set(e[8],e[9],e[10]).cross(u),t},isEmpty:function(){return 0===this.matrix[15]},add:function(t){return this.isEmpty()?this.assign(t):t.isEmpty()?this:(this.getExtents(p,f),t.getExtents(g,m),this.assign(new r(p.min(g),f.max(m),!0)))},multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},intersectsPoint:function(t){return this.getExtents(o,s),o.x<=t.x&&s.x>=t.x&&o.y<=t.y&&s.y>=t.y&&o.z<=t.z&&s.z>=t.z},intersectsBox:function(t){if(this.isEmpty())return!1;if(t.isEmpty())return!1;if(this.getPoints(x),t.getPoints(y),n.isSeparated(this.getPlanes(b),x,y))return!1;if(n.isSeparated(t.getPlanes(b),x,y))return!1;this.getAxes(_),t.getAxes(v);for(var e=0;e<3;++e)for(var i=0;i<3;++i)w[3*e+i].assign(_[e]).cross(v[i]);return!n.isSeparated(w,x,y)},intersectsTriangle:function(e,i,r){if(this.isEmpty())return!1;if(x.box!==this&&(x.box=this,this.getPoints(x)),S[0]=e,S[1]=i,S[2]=r,n.isSeparated(this.getPlanes(b),x,S))return!1;if(t.normal(e,i,r,C[0]),n.isSeparated(C,x,S))return!1;_.box!==this&&(_.box=this,this.getAxes(_)),F[0].assign(e).subtract(i),F[1].assign(i).subtract(r),F[2].assign(r).subtract(e);for(var o=0;o<3;++o)for(var s=0;s<3;++s)w[3*o+s].assign(_[o]).cross(F[s]);return!n.isSeparated(w,x,y)},toString:function(){return this.size+", "+this.center}},Object.defineProperty(r.prototype,"size",{get:function(){var t=new i(0,0,0);return this.getAbsoluteExtents(o,t),t.subtract(o)},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),r}),define("x_ite/Components/Rendering/X3DGeometryNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c,d){"use strict";function p(t){i.call(this,t),this.addType(n.X3DGeometryNode),this.addChildObjects("transparent",new e.SFBool,"bbox_changed",new e.SFTime),this.geometryType=3,this.currentTexCoordNode=this.getBrowser().getDefaultTextureCoordinate()}var f=new s(0,0,0),g=new s(0,0,0),m=new s(0,0,0),x=new u,y=new u,_=[new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0),new s(1,0,0)];return p.prototype=t.extend(Object.create(i.prototype),{constructor:p,intersection:new s(0,0,0),uvt:{u:0,v:0,t:0},v0:new s(0,0,0),v1:new s(0,0,0),v2:new s(0,0,0),normal:new s(0,0,0),setup:function(){this.setTainted(!0),i.prototype.setup.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed(),this.setTainted(!1)},initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this);var t=this.getBrowser().getContext();if(this.min=new s(0,0,0),this.max=new s(0,0,0),this.bbox=new l(this.min,this.max,!0),this.solid=!0,this.flatShading=void 0,this.attribNodes=[],this.attribs=[],this.colors=[],this.texCoords=[],this.defaultTexCoords=[],this.texCoordParams={min:new s(0,0,0)},this.normals=[],this.flatNormals=[],this.vertices=[],this.vertexCount=0,this.primitiveMode=t.TRIANGLES,this.frontFace=t.CCW,this.attribBuffers=[],this.colorBuffer=t.createBuffer(),this.texCoordBuffers=[],this.normalBuffer=t.createBuffer(),this.vertexBuffer=t.createBuffer(),this.attribArray=[],this.colorArray=new Float32Array,this.texCoordArray=[],this.vertexArray=new Float32Array,this.planes=[],this.geometryType>1)for(var e=0;e<5;++e)this.planes[e]=new h(s.Zero,_[0]);this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype,this.set_live__()},getExtendedEventHandling:function(){return!1},setGeometryType:function(t){this.geometryType=t},getGeometryType:function(){return this.geometryType},getBBox:function(){return this.bbox},setBBox:function(t){if(!t.equals(this.bbox)){t.getExtents(f,g),this.min.assign(f),this.max.assign(g),this.bbox.assign(t);for(var e=0;e<5;++e)this.planes[e].set(e%2?f:g,_[e]);this.bbox_changed_.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return u.Identity},setPrimitiveMode:function(t){this.primitiveMode=t},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(t){this.solid=t},setCCW:function(t){this.frontFace=t?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribs},addColor:function(t){this.colors.push(t.r,t.g,t.b,3===t.length?1:t.a)},setColors:function(t){for(var e=this.colors,i=0,n=t.length;i<n;++i)e[i]=t[i];e.length=n},getColors:function(){return this.colors},setTexCoords:function(t){for(var e=this.texCoords,i=0,n=t.length;i<n;++i)e[i]=t[i];e.length=n},getTexCoords:function(){return this.texCoords},setCurrentTexCoord:function(t){this.currentTexCoordNode=t||this.getBrowser().getDefaultTextureCoordinate()},addNormal:function(t){this.normals.push(t.x,t.y,t.z)},setNormals:function(t){for(var e=this.normals,i=0,n=t.length;i<n;++i)e[i]=t[i];e.length=n},getNormals:function(){return this.normals},addVertex:function(t){this.min.min(t),this.max.max(t),this.vertices.push(t.x,t.y,t.z,1)},setVertices:function(t){for(var e=this.vertices,i=0,n=t.length;i<n;++i)e[i]=t[i];e.length=n},getVertices:function(){return this.vertices},buildTexCoords:function(){var t=this.getTexCoordParams(),e=t.min,i=t.Sindex,n=t.Tindex,r=t.Ssize,o=e[i],s=e[n],a=this.defaultTexCoords,u=this.vertices;a.length=0,this.texCoords.push(a);for(var l=0,h=u.length;l<h;l+=4)a.push((u[l+i]-o)/r,(u[l+n]-s)/r,0,1)},getTexCoordParams:function(){var t=this.texCoordParams,e=this.getBBox(),i=e.size,n=i.x,r=i.y,o=i.z;return t.min.assign(e.center).subtract(i.divide(2)),n>=r&&n>=o?(t.Ssize=n,t.Sindex=0,t.Tindex=r>=o?1:2):r>=n&&r>=o?(t.Ssize=r,t.Sindex=1,t.Tindex=n>=o?0:2):(t.Ssize=o,t.Sindex=2,t.Tindex=n>=r?0:1),t},refineNormals:function(t,e,i){if(0===i)return e;var n=Math.cos(d.clamp(i,0,Math.PI)),r=[];for(var o in t)for(var a=t[o],u=0,l=a.length;u<l;++u){for(var h=a[u],c=e[h],p=new s(0,0,0),f=0;f<l;++f){var g=e[a[f]];g.dot(c)>=n&&p.add(g)}r[h]=p.normalize()}return r},isClipped:function(t,e){return e.some(function(e){return e.isClipped(t)})},transformLine:function(t){},transformMatrix:function(t){},intersectsLine:function(t,e,i,n){try{var r=!1;if(this.intersectsBBox(t)){this.transformLine(t),this.transformMatrix(x.assign(i));for(var a=this.texCoords[0],u=this.normals,l=this.vertices,h=this.uvt,c=this.v0,d=this.v1,p=this.v2,f=0,g=this.vertexCount;f<g;f+=3){var y=4*f;if(c.x=l[y+0],c.y=l[y+1],c.z=l[y+2],d.x=l[y+4],d.y=l[y+5],d.z=l[y+6],p.x=l[y+8],p.y=l[y+9],p.z=l[y+10],t.intersectsTriangle(c,d,p,h)){var _=h.u,v=h.v,w=1-_-v,b=new s(w*l[y+0]+_*l[y+4]+v*l[y+8],w*l[y+1]+_*l[y+5]+v*l[y+9],w*l[y+2]+_*l[y+6]+v*l[y+10]);if(this.isClipped(x.multVecMatrix(m.assign(b)),e))continue;var S=new o(w*a[y+0]+_*a[y+4]+v*a[y+8],w*a[y+1]+_*a[y+5]+v*a[y+9]),C=3*f,F=new s(w*u[C+0]+_*u[C+3]+v*u[C+6],w*u[C+1]+_*u[C+4]+v*u[C+7],w*u[C+2]+_*u[C+5]+v*u[C+8]);n.push({texCoord:S,normal:F,point:this.getMatrix().multVecMatrix(b)}),r=!0}}}return r}catch(t){return console.log(t),!1}},intersectsBBox:function(t){var e=this.planes,i=this.min,n=this.max,r=i.x,o=n.x,s=i.y,a=n.y,u=i.z,l=n.z,h=this.intersection;return!!(e[0].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.y>=s&&h.y<=a)||(!!(e[1].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.y>=s&&h.y<=a)||(!!(e[2].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.z>=u&&h.z<=l)||(!!(e[3].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.z>=u&&h.z<=l)||!!(e[4].intersectsLine(t,h)&&h.y>=s&&h.y<=a&&h.z>=u&&h.z<=l))))},intersectsBox:function(t,e,i){try{if(t.intersectsBox(this.bbox)){t.multRight(y.assign(this.getMatrix()).inverse()),this.transformMatrix(i);for(var n=this.vertices,r=this.v0,o=this.v1,s=this.v2,a=0,u=this.vertexCount;a<u;a+=3){var l=4*a;if(r.x=n[l+0],r.y=n[l+1],r.z=n[l+2],o.x=n[l+4],o.y=n[l+5],o.z=n[l+6],s.x=n[l+8],s.y=n[l+9],s.z=n[l+10],t.intersectsTriangle(r,o,s)){if(e.length){if(this.isClipped(i.multVecMatrix(m.assign(r)),e))continue;if(this.isClipped(i.multVecMatrix(m.assign(o)),e))continue;if(this.isClipped(i.multVecMatrix(m.assign(s)),e))continue}return!0}}}return!1}catch(t){return console.log(t),!1}},set_live__:function(){this.isLive().getValue()?this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this)},set_shading__:function(t){if(!(this.geometryType<2)){var e="FLAT"===t.getValue();if(e!==this.flatShading){this.flatShading=e;var i=this.getBrowser().getContext();if(e&&!this.flatNormals.length)for(var n=this.frontFace===i.CW,r=this.flatNormals,o=this.vertices,s=this.v0,a=this.v1,u=this.v2,l=this.normal,h=0,d=o.length;h<d;h+=12)c.normal(s.set(o[h+0],o[h+1],o[h+2]),a.set(o[h+4],o[h+5],o[h+6]),u.set(o[h+8],o[h+9],o[h+10]),l),n&&l.negate(),r.push(l.x,l.y,l.z,l.x,l.y,l.z,l.x,l.y,l.z);i.bindBuffer(i.ARRAY_BUFFER,this.normalBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(e?this.flatNormals:this.normals),i.STATIC_DRAW)}}},eventsProcessed:function(){if(i.prototype.eventsProcessed.call(this),this.clear(),this.build(),this.vertices.length?this.bbox.setExtents(this.min,this.max):this.bbox.setExtents(this.min.set(0,0,0),this.max.set(0,0,0)),this.bbox_changed_.addEvent(),this.geometryType>1){for(var t=this.min,e=this.max,n=0;n<5;++n)this.planes[n].set(n%2?t:e,_[n]);0===this.texCoords.length&&this.buildTexCoords()}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()},clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var t=this.getAttrib(),e=t.length,i=this.getAttribs(),n=0,r=i.length;n<r;++n)i[n].length=0;for(var n=i.length;n<e;++n)i[n]=[];i.length=e,this.flatShading=void 0,this.colors.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){for(var t=this.getBrowser().getContext(),e=this.vertices.length/4,i=this.attribBuffers.length,n=this.attribs.length;i<n;++i)this.attribBuffers.push(t.createBuffer()),this.attribArray.push(new Float32Array);this.attribBuffers.length=this.attribs.length;for(var i=0,n=this.attribs.length;i<n;++i)this.attribArray[i].length!==this.attribs[i].length?this.attribArray[i]=new Float32Array(this.attribs[i]):this.attribArray[i].set(this.attribs[i]),t.bindBuffer(t.ARRAY_BUFFER,this.attribBuffers[i]),t.bufferData(t.ARRAY_BUFFER,this.attribArray[i],t.STATIC_DRAW);this.colorArray.length!==this.colors.length?this.colorArray=new Float32Array(this.colors):this.colorArray.set(this.colors),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW);for(var i=this.texCoordBuffers.length,n=this.texCoords.length;i<n;++i)this.texCoordBuffers.push(t.createBuffer()),this.texCoordArray.push(new Float32Array);this.texCoordBuffers.length=this.texCoords.length;for(var i=0,n=this.texCoords.length;i<n;++i)this.texCoordArray[i].length!==this.texCoords[i].length?this.texCoordArray[i]=new Float32Array(this.texCoords[i]):this.texCoordArray[i].set(this.texCoords[i]),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[i]),t.bufferData(t.ARRAY_BUFFER,this.texCoordArray[i],t.STATIC_DRAW);this.vertexArray.length!==this.vertices.length?this.vertexArray=new Float32Array(this.vertices):this.vertexArray.set(this.vertices),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.vertexCount=e,this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(t,e){},depth:function(t,e){var i=t.renderer.getBrowser().getContext();e.enableVertexAttribute(i,this.vertexBuffer),i.drawArrays(this.primitiveMode,0,this.vertexCount)},display:function(t){try{var e=t.renderer.getBrowser(),i=e.getContext(),n=t.shaderNode,r=this.attribNodes,o=this.attribBuffers;t.geometryType=this.geometryType,t.colorMaterial=this.colors.length,n.setLocalUniforms(i,t);for(var s=0,a=r.length;s<a;++s)r[s].enable(i,n,o[s]);if(this.colors.length&&n.enableColorAttribute(i,this.colorBuffer),n.enableTexCoordAttribute(i,this.texCoordBuffers),n.enableNormalAttribute(i,this.normalBuffer),n.enableVertexAttribute(i,this.vertexBuffer),n.wireframe)for(var s=0,a=this.vertexCount;s<a;s+=3)i.drawArrays(n.primitiveMode,s,3);else{var l=u.prototype.determinant3.call(t.modelViewMatrix)>0;i.frontFace(l?this.frontFace:this.frontFace===i.CCW?i.CW:i.CCW),t.transparent&&!this.solid?(i.enable(i.CULL_FACE),i.cullFace(i.FRONT),i.drawArrays(n.primitiveMode,0,this.vertexCount),i.cullFace(i.BACK),i.drawArrays(n.primitiveMode,0,this.vertexCount)):(this.solid?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),i.drawArrays(n.primitiveMode,0,this.vertexCount))}for(var s=0,a=r.length;s<a;++s)r[s].disable(i,n);n.disableColorAttribute(i),n.disableTexCoordAttribute(i),n.disableNormalAttribute(i)}catch(t){console.log(t)}},displayParticlesDepth:function(t,e,i,n){var r=t.renderer.getBrowser().getContext();e.enableVertexAttribute(r,this.vertexBuffer);for(var o=t.modelViewMatrix,s=o[12],a=o[13],l=o[14],h=0;h<n;++h)o[12]=s,o[13]=a,o[14]=l,u.prototype.translate.call(o,i[h].position),r.uniformMatrix4fv(e.x3d_ModelViewMatrix,!1,o),r.drawArrays(e.primitiveMode,0,this.vertexCount)},displayParticles:function(t,e,i){try{var n=t.renderer.getBrowser(),r=n.getContext(),o=t.shaderNode,s=this.attribNodes,l=this.attribBuffers;t.geometryType=this.geometryType,t.colorMaterial=this.colors.length,o.setLocalUniforms(r,t);for(var h=0,c=s.length;h<c;++h)s[h].enable(r,o,l[h]);this.colors.length&&o.enableColorAttribute(r,this.colorBuffer),o.enableTexCoordAttribute(r,this.texCoordBuffers),o.enableNormalAttribute(r,this.normalBuffer),o.enableVertexAttribute(r,this.vertexBuffer);var d=t.materialNode,p=d||o.getCustom(),f=o.normalMatrixArray,g=t.modelViewMatrix,m=g[12],x=g[13],y=g[14];if(o.wireframe)for(var _=0;_<i;++_){g[12]=m,g[13]=x,g[14]=y,u.prototype.translate.call(g,e[_].position),p&&(f[0]=g[0],f[1]=g[4],f[2]=g[8],f[3]=g[1],f[4]=g[5],f[5]=g[9],f[6]=g[2],f[7]=g[6],f[8]=g[10],a.prototype.inverse.call(f),r.uniformMatrix3fv(o.x3d_NormalMatrix,!1,f)),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,g);for(var h=0,c=this.vertexCount;h<c;h+=3)r.drawArrays(o.primitiveMode,h,3)}else{var v=u.prototype.determinant3.call(t.modelViewMatrix)>0;if(r.frontFace(v?this.frontFace:this.frontFace===r.CCW?r.CW:r.CCW),t.transparent&&!this.solid)for(var _=0;_<i;++_)g[12]=m,g[13]=x,g[14]=y,u.prototype.translate.call(g,e[_].position),p&&(f[0]=g[0],f[1]=g[4],f[2]=g[8],f[3]=g[1],f[4]=g[5],f[5]=g[9],f[6]=g[2],f[7]=g[6],f[8]=g[10],a.prototype.inverse.call(f),r.uniformMatrix3fv(o.x3d_NormalMatrix,!1,f)),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,g),r.enable(r.CULL_FACE),r.cullFace(r.FRONT),r.drawArrays(o.primitiveMode,0,this.vertexCount),r.cullFace(r.BACK),r.drawArrays(o.primitiveMode,0,this.vertexCount);else{this.solid?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE);for(var _=0;_<i;++_)g[12]=m,g[13]=x,g[14]=y,u.prototype.translate.call(g,e[_].position),(d||o.getCustom())&&(f[0]=g[0],f[1]=g[4],f[2]=g[8],f[3]=g[1],f[4]=g[5],f[5]=g[9],f[6]=g[2],f[7]=g[6],f[8]=g[10],a.prototype.inverse.call(f),r.uniformMatrix3fv(o.x3d_NormalMatrix,!1,f)),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,g),r.drawArrays(o.primitiveMode,0,this.vertexCount)}}for(var h=0,c=s.length;h<c;++h)s[h].disable(r,o);o.disableColorAttribute(r),o.disableTexCoordAttribute(r),o.disableNormalAttribute(r)}catch(t){console.log(t)}}}),p}),define("x_ite/Components/Rendering/X3DComposedGeometryNode",["jquery","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t){e.call(this,t),this.addType(n.X3DComposedGeometryNode),this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return o.prototype=t.extend(Object.create(e.prototype),{constructor:o,initialize:function(){e.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.coord_.addInterest("set_coord__",this),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var t=this.getAttrib(),e=0,r=t.length;e<r;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,r=this.attrib_.length;e<r;++e){var o=i(n.X3DVertexAttributeNode,this.attrib_[e]);o&&t.push(o)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=i(n.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=i(n.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=i(n.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=i(n.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},getPolygonIndex:function(t){return t},getTriangleIndex:function(t){return t},build:function(t,e,i,n){if(this.coordNode&&!this.coordNode.isEmpty()){e-=e%t,n-=n%i;var r=this.colorPerVertex_.getValue(),o=this.normalPerVertex_.getValue(),s=this.getAttrib(),a=s.length,u=this.getAttribs(),l=this.getColor(),h=this.getTexCoord(),c=this.getNormal(),d=this.getCoord(),p=this.getTexCoords(),f=0;h&&h.init(p);for(var g=0;g<n;++g){f=Math.floor(g/i);for(var m=this.getPolygonIndex(this.getTriangleIndex(g)),x=0;x<a;++x)attrib[x].addValue(u[x],m);l&&(r?this.addColor(l.get1Color(m)):this.addColor(l.get1Color(f))),h&&h.addTexCoord(p,m),c&&(o?this.addNormal(c.get1Vector(m)):this.addNormal(c.get1Vector(f))),this.addVertex(d.get1Point(m))}this.getNormal()||this.buildNormals(t,e,n),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},buildNormals:function(t,e,i){for(var n=this.createNormals(t,e),r=0;r<i;++r)this.addNormal(n[this.getTriangleIndex(r)])},createNormals:function(t,e){var i=this.createFaceNormals(t,e);if(this.normalPerVertex_.getValue()){for(var n=[],r=0;r<e;++r){var o=this.getPolygonIndex(r);n[o]||(n[o]=[]),n[o].push(r)}return this.refineNormals(n,i,Math.PI)}return i},createFaceNormals:function(t,e){for(var i=!this.ccw_.getValue(),n=this.coordNode,r=[],o=0;o<e;o+=t){var s=this.getPolygonNormal(t,n);i&&s.negate();for(var a=0;a<t;++a)r.push(s)}return r},getPolygonNormal:function(t,e){for(var i=new r(0,0,0),n=e.get1Point(this.getPolygonIndex(0)),o=0;o<t;++o){var s=n,n=e.get1Point(this.getPolygonIndex((o+1)%t));i.x+=(s.y-n.y)*(s.z+n.z),i.y+=(s.z-n.z)*(s.x+n.x),i.z+=(s.x-n.x)*(s.y+n.y)}return i.normalize()}}),o}),define("x_ite/Components/Geometry3D/IndexedFaceSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(o.IndexedFaceSet),this.creaseAngle_.setUnit("angle")}var h=[0,1,2],c=[],d=[],p=[];return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"convex",new e.SFBool(!0)),new i(o.initializeOnly,"creaseAngle",new e.SFFloat),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"colorIndex",new e.MFInt32),new i(o.inputOutput,"texCoordIndex",new e.MFInt32),new i(o.inputOutput,"normalIndex",new e.MFInt32),new i(o.inputOutput,"coordIndex",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getTexCoordPerVertexIndex:function(t){return t<this.texCoordIndex_.length?this.texCoordIndex_[t]:this.coordIndex_[t]},getColorPerVertexIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:this.coordIndex_[t]},getColorIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:t},getNormalPerVertexIndex:function(t){return t<this.normalIndex_.length?this.normalIndex_[t]:this.coordIndex_[t]},getNormalIndex:function(t){return t<this.normalIndex_.length?this.normalIndex_[t]:t},build:function(){var t=this.triangulate();if(0!==t.length){var e=this.colorPerVertex_.getValue(),i=this.normalPerVertex_.getValue(),n=this.coordIndex_.getValue(),r=this.getAttrib(),o=r.length,s=this.getAttribs(),a=this.getColor(),u=this.getTexCoord(),l=this.getNormal(),h=this.getCoord(),c=this.getTexCoords();u&&u.init(c);for(var d=0,p=t.length;d<p;++d){for(var f=t[d],g=f.vertices,m=f.triangles,x=f.face,y=0,_=m.length;y<_;++y){for(var v=g[m[y]],w=n[v].getValue(),b=0;b<o;++b)r[b].addValue(s[b],w);a&&(e?this.addColor(a.get1Color(this.getColorPerVertexIndex(v))):this.addColor(a.get1Color(this.getColorIndex(x)))),u&&u.addTexCoord(c,this.getTexCoordPerVertexIndex(v)),l&&(i?this.addNormal(l.get1Vector(this.getNormalPerVertexIndex(v))):this.addNormal(l.get1Vector(this.getNormalIndex(x)))),this.addVertex(h.get1Point(w))}++x}this.getNormal()||this.buildNormals(t),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},triangulate:function(){var t=this.convex_.getValue(),e=this.coordIndex_.getValue(),i=e.length,n=[];if(!this.getCoord())return n;if(i){this.coordIndex_[i-1]>-1&&(this.coordIndex_.push(-1),++i);for(var r=[],o=0,s=0;s<i;++s){if(e[s].getValue()>-1)r.push(s);else{if(r.length)switch(r[0]===r[r.length-1]&&r.pop(),r.length){case 0:case 1:case 2:r.length=0;break;case 3:n.push({vertices:r,triangles:h,face:o}),r=[];break;default:var a=[],u={vertices:r,triangles:a,face:o};t?this.triangulateConvexPolygon(u):this.triangulatePolygon(u),a.length<3?r.length=0:(n.push(u),r=[])}++o}}}return n},triangulatePolygon:function(t){for(var e=t.vertices,i=t.triangles,n=this.coordIndex_.getValue(),r=this.getCoord(),o=0,s=e.length;o<s;++o){var a=r.get1Point(n[e[o]].getValue()).copy();a.index=o,c[o]=a}c.length=s,u.triangulatePolygon(c,i);for(var o=0,s=i.length;o<s;++o)i[o]=i[o].index},triangulateConvexPolygon:function(t){for(var e=t.vertices,i=t.triangles,n=1,r=e.length-1;n<r;++n)i.push(0,n,n+1)},buildNormals:function(t){for(var e=0,i=this.createNormals(t),n=0,r=t.length;n<r;++n){for(var o=t[n],s=o.vertices,a=o.triangles,u=0,l=a.length;u<l;++u)this.addNormal(i[e+a[u]]);e+=s.length}},createNormals:function(t){var e=!this.ccw_.getValue(),i=this.coordIndex_.getValue(),n=this.getCoord(),r=null;d.length=0,p.length=0;for(var o=0,s=t.length;o<s;++o){var a=t[o],u=a.vertices,l=u.length;switch(l){case 3:r=n.getNormal(i[u[0]].getValue(),i[u[1]].getValue(),i[u[2]].getValue());break;case 4:r=n.getQuadNormal(i[u[0]].getValue(),i[u[1]].getValue(),i[u[2]].getValue(),i[u[3]].getValue());break;default:r=this.getPolygonNormal(u,i,n)}for(var h=0;h<l;++h){var c=i[u[h]].getValue();p[c]||(p[c]=[]),p[c].push(d.length+h)}e&&r.negate();for(var h=0,f=l;h<f;++h)d.push(r)}return this.refineNormals(p,d,this.creaseAngle_.getValue())},getPolygonNormal:function(t,e,i){for(var n=new s(0,0,0),r=i.get1Point(e[t[0]].getValue()),o=0,a=t.length;o<a;++o){var u=r,r=i.get1Point(e[t[(o+1)%a]].getValue());n.x+=(u.y-r.y)*(u.z+r.z),n.y+=(u.z-r.z)*(u.x+r.x),n.z+=(u.x-r.x)*(u.y+r.y)}return n.normalize()}}),l}),define("x_ite/Components/Rendering/X3DGeometricPropertyNode",["jquery","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DGeometricPropertyNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Rendering/X3DCoordinateNode",["jquery","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t){e.call(this,t),this.addType(i.X3DCoordinateNode),this.point=this.point_.getValue()}return o.prototype=t.extend(Object.create(e.prototype),{constructor:o,isEmpty:function(){return 0==this.point.length},getSize:function(){return this.point.length},get1Point:function(t){
return t<this.point.length?this.point[t].getValue():new r(0,0,0)},getNormal:function(t,e,i){var o=this.point,s=o.length;return t<s&&e<s&&i<s?n.normal(o[t].getValue(),o[e].getValue(),o[i].getValue(),new r(0,0,0)):new r(0,0,0)},getQuadNormal:function(t,e,i,o){var s=this.point,a=s.length;return t<a&&e<a&&i<a&&o<a?n.quadNormal(s[t].getValue(),s[e].getValue(),s[i].getValue(),s[o].getValue(),new r(0,0,0)):new r(0,0,0)}}),o}),define("x_ite/Components/Rendering/Coordinate",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Coordinate),this.point_.setUnit("length")}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),s}),define("x_ite/Components/Texturing/X3DTextureCoordinateNode",["jquery","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DTextureCoordinateNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,init:function(t){t.push([])},addTexCoord:function(t,e){this.addTexCoordToChannel(t[0],e)}}),n}),define("x_ite/Components/Texturing/TextureCoordinate",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.TextureCoordinate)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(t,e){if(e>=0&&e<this.point_.length){var i=this.point_[e];t.push(i.x,i.y,0,1)}else t.push(0,0,0,1)},getTexCoord:function(t){for(var e=this.point_.getValue(),i=0,n=e.length;i<n;++i){var r=e[i].getValue();t[i]=new s(r.x,r.y,0,1)}return t.length=n,t}}),a}),define("x_ite/Browser/Geometry2D/Rectangle2DOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){e.call(this,t)}return a.prototype=t.extend(Object.create(e.prototype),{constructor:a,getTypeName:function(){return"Rectangle2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"rectangle2DOptions"},initialize:function(){e.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext());var t=this.geometry,e=this.geometry.texCoord_.getValue(),a=this.geometry.coord_.getValue();return t.texCoordIndex_=[0,1,2,3,-1],t.coordIndex_=[0,1,2,3,-1],e.point_=[new o(1,1),new o(0,1),new o(0,0),new o(1,0)],a.point_=[new s(1,1,0),new s(-1,1,0),new s(-1,-1,0),new s(1,-1,0)],e.setup(),a.setup(),t.setup(),this.geometry}}),a}),define("x_ite/Browser/Geometry2D/X3DGeometry2DContext",["x_ite/Browser/Geometry2D/Arc2DOptions","x_ite/Browser/Geometry2D/ArcClose2DOptions","x_ite/Browser/Geometry2D/Circle2DOptions","x_ite/Browser/Geometry2D/Disk2DOptions","x_ite/Browser/Geometry2D/Rectangle2DOptions"],function(t,e,i,n,r){"use strict";function o(t,e){return this[t]?this[t]:(this[t]=new e(this.getPrivateScene()),this[t].setup(),this[t])}function s(){}return s.prototype={initialize:function(){},getArc2DOptions:function(){return o.call(this,"arc2DOptions",t)},getArcClose2DOptions:function(){return o.call(this,"arcClose2DOptions",e)},getCircle2DOptions:function(){return o.call(this,"circle2DOptions",i)},getDisk2DOptions:function(){return o.call(this,"disk2DOptions",n)},getRectangle2DOptions:function(){return o.call(this,"rectangle2DOptions",r)}},s}),define("x_ite/Browser/Geometry3D/BoxOptions",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){e.call(this,t)}return a.prototype=t.extend(Object.create(e.prototype),{constructor:a,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"boxOptions"},initialize:function(){e.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext());var t=this.geometry,e=this.geometry.texCoord_.getValue(),a=this.geometry.coord_.getValue();return t.texCoordIndex_=[0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1],t.coordIndex_=[0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1],e.point_=[new o(1,1),new o(0,1),new o(0,0),new o(1,0)],a.point_=[new s(1,1,1),new s(-1,1,1),new s(-1,-1,1),new s(1,-1,1),new s(1,1,-1),new s(-1,1,-1),new s(-1,-1,-1),new s(1,-1,-1)],e.setup(),a.setup(),t.setup(),this.geometry}}),a}),define("x_ite/Browser/Geometry3D/ConeOptions",["jquery","x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(t,e,i){"use strict";function n(t){i.call(this,t),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return n.prototype=t.extend(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"coneOptions"}}),n}),define("x_ite/Browser/Geometry3D/CylinderOptions",["jquery","x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(t,e,i){"use strict";function n(t){i.call(this,t),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return n.prototype=t.extend(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"cylinderOptions"}}),n}),define("x_ite/Browser/Geometry3D/QuadSphereOptions",["jquery","x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){i.call(this,t),this.addChildObjects("xDimension",new e.SFInt32(32),"yDimension",new e.SFInt32(15))}return l.prototype=t.extend(Object.create(i.prototype),{constructor:l,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){i.prototype.initialize.call(this),this.addInterest("eventsProcessed",this)},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),i=this.geometry.texCoordIndex_,n=0,r=t-1;n<r;++n)i.push(n),i.push(n+t-1),i.push(n+t),i.push(-1);for(var o=t-1,s=0,a=e-3;s<a;++s,++o)for(var n=0,r=t-1;n<r;++n,++o)i.push(o),i.push(o+t),i.push(o+t+1),i.push(o+1),i.push(-1);for(var o=(e-2)*t-1,n=0,r=t-1;n<r;++n,++o)i.push(o+t),i.push(o+1),i.push(o),i.push(-1)},createTexCoord:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),i=this.geometry.texCoord_.getValue().point_,n=-.5/(t-1),r=1;r<t;++r){var o=r/(t-1)+n;i.push(new a(o,1))}for(var s=1,u=e-1;s<u;++s)for(var l=1-s/(e-1),r=0;r<t;++r){var o=r/(t-1);i.push(new a(o,l))}for(var r=1;r<t;++r){var o=r/(t-1)+n;i.push(new a(o,0))}},createCoordIndex:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),i=this.geometry.coordIndex_,n=1,r=t-1;n<r;++n)i.push(0),i.push(n),i.push(n+1),i.push(-1);i.push(0),i.push(n),i.push(1),i.push(-1);for(var o=1,s=0,a=e-3;s<a;++s,++o){for(var n=0,r=t-2;n<r;++n,++o)i.push(o),i.push(o+t-1),i.push(o+t),i.push(o+1),i.push(-1);i.push(o),i.push(o+t-1),i.push(o+1),i.push(o-t+2),i.push(-1)}for(var u=o+t-1,n=0,r=t-2;n<r;++n,++o)i.push(u),i.push(o+1),i.push(o),i.push(-1);i.push(u),i.push(u-t+1),i.push(o),i.push(-1)},createPoints:function(){var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),i=this.geometry.coord_.getValue().point_;i.push(new u(0,1,0));for(var n=1,r=e-1;n<r;++n)for(var o=s.Polar(1,-Math.PI*n/r),a=0,l=t-1;a<l;++a){var h=s.Polar(o.imag,2*Math.PI*a/l);i.push(new u(h.imag,o.real,h.real))}i.push(new u(0,-1,0))},eventsProcessed:function(){this.geometry=new n(this.getExecutionContext()),this.geometry.texCoord_=new o(this.getExecutionContext()),this.geometry.coord_=new r(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();var t=this.geometry,e=this.geometry.texCoord_.getValue(),i=this.geometry.coord_.getValue();t.creaseAngle_=Math.PI,e.setup(),i.setup(),t.setup()}}),l}),define("x_ite/Browser/Geometry3D/X3DGeometry3DContext",["x_ite/Browser/Geometry3D/BoxOptions","x_ite/Browser/Geometry3D/ConeOptions","x_ite/Browser/Geometry3D/CylinderOptions","x_ite/Browser/Geometry3D/QuadSphereOptions"],function(t,e,i,n){"use strict";function r(t,e){return this[t]?this[t]:(this[t]=new e(this.getPrivateScene()),this[t].setup(),this[t])}function o(){}return o.prototype={initialize:function(){},getBoxOptions:function(){return r.call(this,"boxOptions",t)},getConeOptions:function(){return r.call(this,"coneOptions",e)},getCylinderOptions:function(){return r.call(this,"cylinderOptions",i)},getSphereOptions:function(){return r.call(this,"sphereOptions",n)}},o}),define("x_ite/Browser/PointingDeviceSensor/PointingDevice",["jquery","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function i(t){e.call(this,t),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,initialize:function(){var t=this.getBrowser().getCanvas();t.bind("mousedown.PointingDevice",this.mousedown.bind(this)),t.bind("mouseup.PointingDevice",this.mouseup.bind(this)),t.bind("dblclick.PointingDevice",this.dblclick.bind(this)),t.bind("mousemove.PointingDevice",this.mousemove.bind(this)),t.bind("mouseout.PointingDevice",this.onmouseout.bind(this))},mousewheel:function(t){},mousedown:function(e){var i=this.getBrowser();if(i.getCanvas().focus(),!(i.getShiftKey()&&i.getControlKey()||0!==e.button)){var n=i.getCanvas().offset(),r=e.pageX-n.left,o=i.getCanvas().height()-(e.pageY-n.top);i.getCanvas().unbind("mousemove.PointingDevice"),t(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),i.buttonPressEvent(r,o)&&(e.preventDefault(),e.stopImmediatePropagation(),i.setCursor("HAND"),i.finished().addInterest("onverifymotion",this,r,o))}},mouseup:function(e){e.preventDefault();var i=this.getBrowser();if(0===e.button){e.preventDefault(),i.buttonReleaseEvent();var n=i.getCanvas().offset(),r=e.pageX-n.left,o=i.getCanvas().height()-(e.pageY-n.top);t(document).unbind(".PointingDevice"+this.getId()),i.getCanvas().bind("mousemove.PointingDevice",this.mousemove.bind(this)),i.setCursor(this.isOver?"HAND":"DEFAULT"),i.finished().addInterest("onverifymotion",this,r,o),i.addBrowserEvent(),this.cursor="DEFAULT"}},dblclick:function(t){this.isOver&&t.stopImmediatePropagation()},mousemove:function(t){t.preventDefault();var e=this.getBrowser();if(this.motionTime!==e.getCurrentTime()){this.motionTime=e.getCurrentTime();var i=e.getCanvas().offset(),n=t.pageX-i.left,r=e.getCanvas().height()-(t.pageY-i.top);this.onmotion(n,r)}},onmotion:function(t,e){var i=this.getBrowser();i.motionNotifyEvent(t,e)?this.isOver||(this.isOver=!0,this.cursor=i.getCursor(),i.setCursor("HAND")):this.isOver&&(this.isOver=!1,i.setCursor(this.cursor))},onmouseout:function(t){this.getBrowser().leaveNotifyEvent()},onverifymotion:function(t,e,i){this.getBrowser().finished().removeInterest("onverifymotion",this),this.onmotion(e,i)}}),i}),define("standard/Math/Algorithms/MergeSort",[],function(){"use strict";function t(t,e){this.array=t,this.auxiliary=[],e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){this.mergeSort(t,e-1)},mergeSort:function(t,e){if(t<e){var i=t+e>>>1;this.mergeSort(t,i),this.mergeSort(i+1,e),this.merge(t,i,e)}},merge:function(t,e,i){var n,r,o;for(n=0,r=t;r<=e;)this.auxiliary[n++]=this.array[r++];for(n=0,o=t;o<r&&r<=i;)this.compare(this.array[r],this.auxiliary[n])?this.array[o++]=this.array[r++]:this.array[o++]=this.auxiliary[n++];for(;o<r;)this.array[o++]=this.auxiliary[n++]}},t}),define("x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["jquery","x_ite/Browser/PointingDeviceSensor/PointingDevice","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(){this.pointingDevice=new e(this),this.pointer=new s(0,0),this.hitRay=new r(a.Zero,a.Zero),this.hits=[],this.enabledSensors=[{}],this.selectedLayer=null,this.overSensors={},this.activeSensors={},this.hitPointSorter=new l(this.hits,function(t,e){return t.intersection.point.z<e.intersection.point.z}),this.layerSorter=new l(this.hits,function(t,e){return t.layerNumber<e.layerNumber}),this.pickingTime=0}var d=new r(a.Zero,a.Zero);return c.prototype={initialize:function(){this.getCanvas().attr("tabindex",0),this.setCursor("DEFAULT"),this.pointingDevice.setup()},setCursor:function(t){this.cursorType=t;var e=this.getBrowser().getElement().find(".x_ite-private-surface");switch(t){case"HAND":e.css("cursor","pointer");break;case"MOVE":e.css("cursor","move");break;case"CROSSHAIR":e.css("cursor","crosshair");break;default:this.loadCount_.getValue()?e.css("cursor","wait"):this.pointingDevice&&this.pointingDevice.isOver?e.css("cursor","pointer"):e.css("cursor","default")}},getCursor:function(){return this.cursorType},isPointerInRectangle:function(t){return this.pointer.x>t.x&&this.pointer.x<t.x+t.z&&this.pointer.y>t.y&&this.pointer.y<t.y+t.w},setLayerNumber:function(t){this.layerNumber=t},getSelectedLayer:function(){return this.selectedLayer},setHitRay:function(t,e){try{o.unProjectRay(this.pointer.x,this.pointer.y,u.Identity,t,e,this.hitRay)}catch(t){this.hitRay.set(a.Zero,a.Zero)}},getHitRay:function(){return this.hitRay},getSensors:function(){return this.enabledSensors},addHit:function(t,e){this.hits.push({pointer:this.pointer,hitRay:this.hitRay.copy(),intersection:t,sensors:this.enabledSensors[this.enabledSensors.length-1],layer:e,layerNumber:this.layerNumber})},getHits:function(){return this.hits},getNearestHit:function(){return this.hits[this.hits.length-1]},buttonPressEvent:function(e,i){if(this.touch(e,i),0===this.hits.length)return!1;var n=this.getNearestHit();this.selectedLayer=n.layer,this.activeSensors=n.sensors;for(var r in this.activeSensors)this.activeSensors[r].set_active__(!0,n);return!t.isEmptyObject(n.sensors)},buttonReleaseEvent:function(){this.selectedLayer=null;for(var t in this.activeSensors)this.activeSensors[t].set_active__(!1,null);return this.activeSensors={},!0},motionNotifyEvent:function(e,i){return this.touch(e,i),this.motion(),this.hits.length&&!t.isEmptyObject(this.hits[this.hits.length-1].sensors)},leaveNotifyEvent:function(){},touch:function(t,e){var n=performance.now();this.pointer.set(t,e),this.hits.length=0,this.getWorld().traverse(i.POINTER,null),this.hitPointSorter.sort(0,this.hits.length),this.layerSorter.sort(0,this.hits.length),this.addBrowserEvent(),this.pickingTime=performance.now()-n},motion:function(){if(this.hits.length)var e=this.hits[this.hits.length-1];else var i=this.selectedLayer?this.hitRay:d,e={pointer:this.pointer,modelViewMatrix:new u,hitRay:i,intersection:null,sensors:{},shape:null,layer:null,layerNumber:0};if(this.hits.length)var n=h.set_difference(this.overSensors,e.sensors,{});else var n=t.extend({},this.overSensors);for(var r in n)n[r].set_over__(!1,e);if(this.hits.length){this.overSensors=e.sensors;for(var r in this.overSensors)this.overSensors[r].set_over__(!0,e)}else this.overSensors={};for(var r in this.activeSensors)this.activeSensors[r].set_motion__(e)}},c}),define("x_ite/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext",["jquery","x_ite/Fields"],function(t,e){"use strict";function i(){this.keyDeviceSensorNode=null,this.addChildObjects("controlKey",new e.SFBool,"shiftKey",new e.SFBool,"altKey",new e.SFBool,"altGrKey",new e.SFBool)}return i.prototype={initialize:function(){this.getCanvas().bind("keydown.X3DKeyDeviceSensorContext",this.keydown.bind(this)),this.getCanvas().bind("keyup.X3DKeyDeviceSensorContext",this.keyup.bind(this))},setKeyDeviceSensorNode:function(t){this.keyDeviceSensorNode=t},getKeyDeviceSensorNode:function(){return this.keyDeviceSensorNode},getShiftKey:function(){return this.shiftKey_.getValue()},getControlKey:function(){return this.controlKey_.getValue()},getAltKey:function(){return this.altKey_.getValue()},getAltGrKey:function(){return this.altGrKey_.getValue()},keydown:function(t){switch(t.preventDefault(),t.stopImmediatePropagation(),this.keyDeviceSensorNode&&this.keyDeviceSensorNode.keydown(t),t.which){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 49:this.getDebug()&&this.getControlKey()&&(this.setBrowserOption("Shading","POINTSET"),this.getNotification().string_="Shading: Pointset");break;case 50:this.getDebug()&&this.getControlKey()&&(this.setBrowserOption("Shading","WIREFRAME"),this.getNotification().string_="Shading: Wireframe");break;case 51:this.getDebug()&&this.getControlKey()&&(this.setBrowserOption("Shading","FLAT"),this.getNotification().string_="Shading: Flat");break;case 52:this.getDebug()&&this.getControlKey()&&(this.setBrowserOption("Shading","GOURAUD"),this.getNotification().string_="Shading: Gouraud");break;case 53:this.getDebug()&&this.getControlKey()&&(this.setBrowserOption("Shading","PHONG"),this.getNotification().string_="Shading: Phong");break;case 83:this.getDebug()&&this.getControlKey()&&(this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification().string_=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this.altGrKey_=!0;break;case 171:case 187:this.getControlKey()&&this.getBrowserTimings().setEnabled(!this.getBrowserTimings().getEnabled());break;case 36:this.firstViewpoint();break;case 35:this.lastViewpoint();break;case 33:this.previousViewpoint();break;case 34:this.nextViewpoint()}},keyup:function(t){switch(t.preventDefault(),t.stopImmediatePropagation(),this.keyDeviceSensorNode&&this.keyDeviceSensorNode.keyup(t),t.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 225:this.altGrKey_=!1}}},i}),define("x_ite/Components/Core/X3DBindableNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DBindableNode),this.layers=[]}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.set_bind_.addInterest("set_bind__",this)},getCameraObject:function(){return!0},addLayer:function(t){this.layers.push(t)},transitionStart:function(){},set_bind__:function(){if(this.set_bind_.getValue()){this.layers=this.getLayers();for(var t=0;t<this.layers.length;++t)this.bindToLayer(this.layers[t])}else for(var t=0;t<this.layers.length;++t)this.unbindFromLayer(this.layers[t])}}),n}),define("x_ite/Components/Time/X3DTimeDependentNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){this.addType(n.X3DTimeDependentNode),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return r.prototype=t.extend(Object.create(i.prototype),{constructor:r,initialize:function(){i.prototype.initialize.call(this),this.addChildObjects("initialized",new e.SFTime,"isEvenLive",new e.SFBool),this.isLive().addInterest("set_live__",this),this.isEvenLive_.addInterest("_set_live__",this),this.initialized_.addInterest("set_loop__",this),this.enabled_.addInterest("set_enabled__",this),this.loop_.addInterest("set_loop__",this),this.startTime_.addInterest("set_startTime__",this),this.pauseTime_.addInterest("set_pauseTime__",this),this.resumeTime_.addInterest("set_resumeTime__",this),this.stopTime_.addInterest("set_stopTime__",this),this.startTimeValue=this.startTime_.getValue(),this.pauseTimeValue=this.pauseTime_.getValue(),this.resumeTimeValue=this.resumeTime_.getValue(),this.stopTimeValue=this.stopTime_.getValue(),this.initialized_=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},getLiveState:function(){return this.getLive()&&(this.getExecutionContext().isLive().getValue()||this.isEvenLive_.getValue())},set_live__:function(){this.isLive().getValue()?this.disabled&&(this.disabled=!1,this.isActive_.getValue()&&!this.isPaused_.getValue()&&this.real_resume()):this.disabled||!this.isActive_.getValue()||this.isPaused_.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this.enabled_.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this.enabled_.getValue()&&this.loop_.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this.startTime_.getValue(),this.enabled_.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this.pauseTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this.resumeTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this.stopTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this.isActive_.getValue()||(this.start=this.getBrowser().getCurrentTime(),this.pauseInterval=0,this.isActive_=!0,this.set_start(),this.isLive().getValue()?this.getBrowser().timeEvents().addInterest("set_time",this):this.disabled||(this.disabled=!0,this.real_pause()),this.elapsedTime_=0,this.cycleTime_=this.getBrowser().getCurrentTime())},do_pause:function(){this.isActive_.getValue()&&!this.isPaused_.getValue()&&(this.isPaused_=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().timeEvents().removeInterest("set_time",this)},do_resume:function(){this.isActive_.getValue()&&this.isPaused_.getValue()&&(this.isPaused_=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_resume())},real_resume:function(){var t=(performance.now()-this.pause)/1e3;this.pauseInterval+=t,this.set_resume(t),this.getBrowser().timeEvents().addInterest("set_time",this),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this.isActive_.getValue()&&(this.set_stop(),this.elapsedTime_=this.getElapsedTime(),this.isPaused_.getValue()&&(this.isPaused_=!1),this.isActive_=!1,this.isLive().getValue()&&this.getBrowser().timeEvents().removeInterest("set_time",this))},timeout:function(t){this.enabled_.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[t]())},addTimeout:function(t,e,i){this.removeTimeout(t),this[t]=setTimeout(this.timeout.bind(this,e),1e3*(i-this.getBrowser().getCurrentTime()))},removeTimeout:function(t){clearTimeout(this[t]),this[t]=null},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){},set_time:function(){}}),r}),define("x_ite/Components/Time/TimeSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DSensorNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.TimeSensor),this.addChildObjects("range",new e.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.fraction=0,this.first=0,this.last=1,this.scale=1}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"cycleInterval",new e.SFTime(1)),new i(s.inputOutput,"loop",new e.SFBool),new i(s.inputOutput,"startTime",new e.SFTime),new i(s.inputOutput,"resumeTime",new e.SFTime),new i(s.inputOutput,"pauseTime",new e.SFTime),new i(s.inputOutput,"stopTime",new e.SFTime),new i(s.outputOnly,"isPaused",new e.SFBool),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"cycleTime",new e.SFTime),new i(s.outputOnly,"elapsedTime",new e.SFTime),new i(s.outputOnly,"fraction_changed",new e.SFFloat),new i(s.outputOnly,"time",new e.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.cycleInterval_.addInterest("set_cycleInterval__",this),this.range_.addInterest("set_range__",this)},setRange:function(t,e,i){this.fraction=t>=1?0:t,this.first=e,this.last=i,this.scale=this.last-this.first;var n=(this.fraction-this.first)*this.cycleInterval_.getValue();this.interval=this.cycleInterval_.getValue()*this.scale,this.cycle=this.getBrowser().getCurrentTime()-n},set_cycleInterval__:function(){this.isActive_.getValue()&&this.setRange(this.fraction,this.range_[1],this.range_[2])},set_range__:function(){this.isActive_.getValue()&&(this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.isPaused_.getValue()||this.set_fraction(this.getBrowser().getCurrentTime()))},set_start:function(){this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.fraction_changed_=this.range_[0],this.time_=this.getBrowser().getCurrentTime()},set_resume:function(t){this.setRange(this.fraction,this.range_[1],this.range_[2])},set_fraction:function(t){var e=(t-this.cycle)/this.interval;this.fraction_changed_=this.fraction=this.first+(e-Math.floor(e))*this.scale},set_time:function(){var t=this.getBrowser().getCurrentTime();t-this.cycle>=this.interval?this.loop_.getValue()?this.interval&&(this.cycle+=this.interval*Math.floor((t-this.cycle)/this.interval),this.fraction_changed_=this.fraction=this.last,this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=t):(this.fraction_changed_=this.fraction=this.last,this.stop()):(this.set_fraction(t),this.elapsedTime_=this.getElapsedTime()),this.time_=t}}),a}),define("x_ite/Components/Interpolation/X3DInterpolatorNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DInterpolatorNode)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,setup:function(){this.set_key__(),this.key_.length&&this.interpolate(0,0,0),e.prototype.setup.call(this)},initialize:function(){e.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.key_.addInterest("set_key__",this)},set_fraction__:function(){var t=this.key_,e=t.length,i=this.set_fraction_.getValue();switch(e){case 0:return;case 1:return this.interpolate(0,0,0);default:if(i<=t[0])return this.interpolate(0,1,0);var r=n.upperBound(t,0,e,i,n.less);if(r!==e){var o=r-1,s=(i-t[o])/(t[r]-t[o]);this.interpolate(o,r,n.clamp(s,0,1))}else this.interpolate(e-2,e-1,1)}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),r}),define("x_ite/Components/Interpolation/EaseInEaseOut",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.EaseInEaseOut)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"easeInEaseOut",new e.MFVec2f),new i(o.outputOnly,"modifiedFraction_changed",new e.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.easeInEaseOut_.addInterest("set_keyValue__",this)},set_keyValue__:function(){this.easeInEaseOut_.length<this.key_.length&&this.easeInEaseOut_.resize(this.key_.length,this.easeInEaseOut_.length?this.easeInEaseOut_[this.easeInEaseOut_.length-1]:new e.SFVec2f)},interpolate:function(t,e,i){var n=this.easeInEaseOut_[t].y,r=this.easeInEaseOut_[e].x,o=n+r;if(o<0)this.modifiedFraction_changed_=i;else{o>1&&(r/=o,n/=o);var s=1/(2-n-r);if(i<n)this.modifiedFraction_changed_=s/n*i*i;else if(i<=1-r)this.modifiedFraction_changed_=s*(2*i-n);else{var a=1-i;this.modifiedFraction_changed_=1-s*a*a/r}}}}),s}),define("x_ite/Components/Interpolation/PositionInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionInterpolator)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFVec3f),new i(o.outputOnly,"value_changed",new e.SFVec3f)]),keyValue:new s(0,0,0),getTypeName:function(){
return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(t,e,i){this.value_changed_=this.keyValue.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[e].getValue(),i)}}),a}),define("x_ite/Components/Interpolation/OrientationInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.OrientationInterpolator)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFRotation),new i(o.outputOnly,"value_changed",new e.SFRotation)]),keyValue:new s,getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation)},interpolate:function(t,e,i){try{this.value_changed_=this.keyValue.assign(this.keyValue_[t].getValue()).slerp(this.keyValue_[e].getValue(),i)}catch(t){}}}),a}),define("x_ite/Components/Navigation/X3DViewpointNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Time/TimeSensor","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l,h,c,d){"use strict";function p(t){i.call(this,t),this.addType(u.X3DViewpointNode),this.userPosition=new h(0,1,0),this.userOrientation=new c(0,0,1,0),this.userCenterOfRotation=new h(0,0,0),this.transformationMatrix=new d,this.cameraSpaceMatrix=new d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.inverseCameraSpaceMatrix=new d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1);var e=this.getBrowser();this.timeSensor=new n(e.getPrivateScene()),this.easeInEaseOut=new r(e.getPrivateScene()),this.positionInterpolator=new o(e.getPrivateScene()),this.orientationInterpolator=new s(e.getPrivateScene()),this.scaleInterpolator=new o(e.getPrivateScene()),this.scaleOrientationInterpolator=new s(e.getPrivateScene())}var f=new h(0,1,0),g=new h(0,0,1),m=new h(0,0,0),x=new c(0,0,1,0),y=new h(0,0,0),_=new c(0,0,1,0),v=new h(0,0,0),w=new h(0,0,0),b=new h(0,0,0),S=new h(0,0,0),C=new c(0,0,1,0);return p.prototype=t.extend(Object.create(i.prototype),{constructor:p,initialize:function(){i.prototype.initialize.call(this),this.addChildObjects("positionOffset",new e.SFVec3f,"orientationOffset",new e.SFRotation,"scaleOffset",new e.SFVec3f(1,1,1),"scaleOrientationOffset",new e.SFRotation,"centerOfRotationOffset",new e.SFVec3f,"fieldOfViewScale",new e.SFFloat(1)),this.timeSensor.stopTime_=1,this.timeSensor.setup(),this.easeInEaseOut.key_=[0,1],this.easeInEaseOut.easeInEaseOut_=[new l(0,0),new l(0,0)],this.easeInEaseOut.setup(),this.positionInterpolator.key_=[0,1],this.orientationInterpolator.key_=[0,1],this.scaleInterpolator.key_=[0,1],this.scaleOrientationInterpolator.key_=[0,1],this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor.fraction_changed_.addFieldInterest(this.easeInEaseOut.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.positionInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.orientationInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleOrientationInterpolator.set_fraction_),this.positionInterpolator.value_changed_.addFieldInterest(this.positionOffset_),this.orientationInterpolator.value_changed_.addFieldInterest(this.orientationOffset_),this.scaleInterpolator.value_changed_.addFieldInterest(this.scaleOffset_),this.scaleOrientationInterpolator.value_changed_.addFieldInterest(this.scaleOrientationOffset_),this.isBound_.addInterest("set_bound__",this)},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},bindToLayer:function(t){t.getViewpointStack().push(this)},unbindFromLayer:function(t){t.getViewpointStack().pop(this)},removeFromLayer:function(t){t.getViewpointStack().remove(this)},getPosition:function(){return this.position_.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this.positionOffset_.getValue())},getOrientation:function(){return this.orientation_.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this.orientationOffset_.getValue())},getCenterOfRotation:function(){return this.centerOfRotation_.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this.centerOfRotationOffset_.getValue())},getProjectionMatrix:function(t){var e=t.getNavigationInfo();return this.getProjectionMatrixWithLimits(e.getNearValue(),e.getFarValue(this),t.getLayer().getViewport().getRectangle(t.getBrowser()))},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getTransformationMatrix:function(){return this.transformationMatrix},getUpVector:function(){return f},getSpeedFactor:function(){return 1},getMaxZFar:function(){return 1e5},transitionStart:function(t){try{if(this.jump_.getValue()){var e=this.getLayers();this.retainUserOffsets_.getValue()||this.resetUserOffsets();for(var i=0;i<e.length;++i){var n=e[i].getNavigationInfo();n.transitionStart_=!0;var r=n.getTransitionType(),o=n.transitionTime_.getValue()}switch(r){case"TELEPORT":for(var i=0;i<e.length;++i)e[i].getNavigationInfo().transitionComplete_=!0;return;case"ANIMATE":this.easeInEaseOut.easeInEaseOut_=[new l(0,1),new l(1,0)];break;default:this.easeInEaseOut.easeInEaseOut_=[new l(0,0),new l(0,0)]}this.timeSensor.cycleInterval_=o,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.getRelativeTransformation(t,m,x,y,_),this.positionInterpolator.keyValue_=[m,this.positionOffset_.getValue()],this.orientationInterpolator.keyValue_=[x,this.orientationOffset_.getValue()],this.scaleInterpolator.keyValue_=[y,this.scaleOffset_.getValue()],this.scaleOrientationInterpolator.keyValue_=[_,this.scaleOrientationOffset_.getValue()],this.positionOffset_=m,this.orientationOffset_=x,this.scaleOffset_=y,this.scaleOrientationOffset_=_,this.setInterpolators(t)}else this.getRelativeTransformation(t,m,x,y,_),this.positionOffset_=m,this.orientationOffset_=x,this.scaleOffset_=y,this.scaleOrientationOffset_=_,this.setInterpolators(t)}catch(t){console.log(t)}},transitionStop:function(){this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.removeInterest("set_active__",this)},resetUserOffsets:function(){this.positionOffset_=h.Zero,this.orientationOffset_=c.Identity,this.scaleOffset_=h.One,this.scaleOrientationOffset_=c.Identity,this.centerOfRotationOffset_=h.Zero,this.fieldOfViewScale_=1},getRelativeTransformation:function(t,e,i,n,r){this.transformationMatrix.copy().multRight(t.getInverseCameraSpaceMatrix()).inverse().get(e,i,n,r),e.subtract(this.getPosition()),i.assign(this.getOrientation().copy().inverse().multRight(i))},straightenHorizon:function(t){return t.multVecRot(w.assign(g)),t.multVecRot(v.assign(f)),b.assign(w).cross(this.getUpVector()),S.assign(w).cross(v),C.setFromToVec(S,b),t.multRight(C)},lookAtPoint:function(t,e,i){if(this.getBrowser().getActiveLayer())try{this.getCameraSpaceMatrix().multVecMatrix(t),d.inverse(this.getTransformationMatrix()).multVecMatrix(t);var n=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearValue();this.lookAt(t,n,e,i)}catch(t){console.error(t)}},lookAt:function(t,e,i,n){for(var r=this.getLayers(),o=t.copy().add(this.getUserOrientation().multVecRot(new h(0,0,e))).subtract(this.getPosition()),s=0;s<r.length;++s)r[s].getNavigationInfo().transitionStart_=!0;this.timeSensor.cycleInterval_=.2,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.easeInEaseOut.easeInEaseOut_=[new l(0,1),new l(1,0)];var a=h.lerp(this.positionOffset_.getValue(),o,i),u=h.add(this.getPosition(),a).subtract(t),d=c.multRight(this.orientationOffset_.getValue(),new c(this.getUserOrientation().multVecRot(new h(0,0,1)),u));n&&(d=c.inverse(this.getOrientation()).multRight(this.straightenHorizon(c.multRight(this.getOrientation(),d)))),this.positionInterpolator.keyValue_=[this.positionOffset_.getValue(),a],this.orientationInterpolator.keyValue_=[this.orientationOffset_.getValue(),d],this.scaleInterpolator.keyValue_=[this.scaleOffset_.getValue(),this.scaleOffset_.getValue()],this.scaleOrientationInterpolator.keyValue_=[this.scaleOrientationOffset_.getValue(),this.scaleOrientationOffset_.getValue()],this.centerOfRotationOffset_=h.subtract(t,this.getCenterOfRotation()),this.set_bind_=!0},set_active__:function(t){if(!t.getValue()&&1===this.timeSensor.fraction_changed_.getValue()){for(var e=this.getLayers(),i=0;i<e.length;++i)e[i].getNavigationInfo().transitionComplete_=!0;this.easeInEaseOut.set_fraction_=1}},set_bound__:function(){this.isBound_.getValue()?this.getBrowser().getNotification().string_=this.description_:this.timeSensor.stopTime_=this.getBrowser().getCurrentTime()},traverse:function(t,e){e.getLayer().getViewpoints().push(this),this.transformationMatrix.assign(e.getModelViewMatrix().get())},update:function(){try{this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this.scaleOffset_.getValue(),this.scaleOrientationOffset_.getValue()),this.cameraSpaceMatrix.multRight(this.transformationMatrix),this.inverseCameraSpaceMatrix.assign(this.cameraSpaceMatrix).inverse()}catch(t){console.log(t)}}}),p}),define("x_ite/Components/Navigation/OrthoViewpoint",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(o.OrthoViewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("length"),this.projectionMatrix=new l}var c=new u(0,0,0),d=new a(0,0);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_bind",new e.SFBool),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"position",new e.SFVec3f(0,0,10)),new i(o.inputOutput,"orientation",new e.SFRotation),new i(o.inputOutput,"centerOfRotation",new e.SFVec3f),new i(o.inputOutput,"fieldOfView",new e.MFFloat(-1,-1,1,1)),new i(o.inputOutput,"jump",new e.SFBool(!0)),new i(o.inputOutput,"retainUserOffsets",new e.SFBool),new i(o.outputOnly,"isBound",new e.SFBool),new i(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.fieldOfView_.addInterest("set_fieldOfView___",this),this.fieldOfViewScale_.addInterest("set_fieldOfView___",this),this.set_fieldOfView___()},set_fieldOfView___:function(){var t=this.fieldOfView_.length,e=this.fieldOfViewScale_.getValue();this.minimumX=(t>0?this.fieldOfView_[0]:-1)*e,this.minimumY=(t>1?this.fieldOfView_[1]:-1)*e,this.maximumX=(t>2?this.fieldOfView_[2]:1)*e,this.maximumY=(t>3?this.fieldOfView_[3]:1)*e,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getScreenScale:function(t,e){var i=e[2],n=e[3],r=this.sizeX,o=this.sizeY;if(i/n>r/o){var s=o/n;return c.set(s,s,s)}var s=r/i;return c.set(s,s,s)},getViewportSize:function(t){var e=t[2],i=t[3],n=this.sizeX,r=this.sizeY,o=e/i;return o>n/r?d.set(r*o,r):d.set(n,n/o)},getLookAtDistance:function(t){return t.size.abs()/2+10},getProjectionMatrixWithLimits:function(t,e,i){var n=i[2],r=i[3],o=n/r,a=this.sizeX,u=this.sizeY;if(o>a/u){var l=(this.minimumX+this.maximumX)/2,h=u*o/2;return s.ortho(l-h,l+h,this.minimumY,this.maximumY,t,e,this.projectionMatrix)}var l=(this.minimumY+this.maximumY)/2,h=a/o/2;return s.ortho(this.minimumX,this.maximumX,l-h,l+h,t,e,this.projectionMatrix)}}),h}),define("x_ite/Browser/Navigation/X3DViewer",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o){"use strict";function s(t){e.call(this,t)}function a(t,e,i){var n=Math.sqrt(e*e+i*i);if(n<t*Math.sqrt(.5))return Math.sqrt(t*t-n*n);var r=t/Math.sqrt(2);return r*r/n}var u=new r(0,0,0),l=new r(0,0,0),h=new r(0,0,0);return s.prototype=t.extend(Object.create(e.prototype),{constructor:s,initialize:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},getPointOnCenterPlane:function(t,e,r){try{var s=this.getNavigationInfo(),a=this.getActiveViewpoint(),c=this.getViewport().getRectangle(this.getBrowser()),d=a.getProjectionMatrixWithLimits(s.getNearValue(),s.getFarValue(a),c);if(n.unProjectPoint(t,this.getBrowser().getViewport()[3]-e,.9,o.Identity,d,c,h),a instanceof i)return r.set(h.x,h.y,-this.getDistanceToCenter(l).abs());var p=h.normalize();return r.assign(p).multiply(this.getDistanceToCenter(l).abs()/p.dot(u.set(0,0,-1)))}catch(t){return console.log(t),r.set(0,0,0)}},getDistanceToCenter:function(t){var e=this.getActiveViewpoint();return t.assign(e.getUserPosition()).subtract(e.getUserCenterOfRotation())},trackballProjectToSphere:function(t,e,i){return t=t/this.getBrowser().getViewport()[2]-.5,e=-e/this.getBrowser().getViewport()[3]+.5,i.set(t,e,a(.5,t,e))},lookAt:function(t,e,i){if(this.touch(t,e)){var n=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(n.intersection.point,.381966,i)}},touch:function(t,e){return this.getBrowser().touch(t,e),this.getBrowser().getHits().length},dispose:function(){}}),s}),function(t){"function"==typeof define&&define.amd?define("jquery-mousewheel/jquery.mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var s=e||window.event,a=u.call(arguments,1),l=0,c=0,d=0,p=0,f=0,g=0;if(e=t.event.fix(s),e.type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(c=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(c=-1*d,d=0),l=0===d?c:d,"deltaY"in s&&(d=-1*s.deltaY,l=d),"deltaX"in s&&(c=s.deltaX,0===d&&(l=-1*c)),0!==d||0!==c){if(1===s.deltaMode){var m=t.data(this,"mousewheel-line-height");l*=m,d*=m,c*=m}else if(2===s.deltaMode){var x=t.data(this,"mousewheel-page-height");l*=x,d*=x,c*=x}if(p=Math.max(Math.abs(d),Math.abs(c)),(!o||p<o)&&(o=p,n(s,p)&&(o/=40)),n(s,p)&&(l/=40,c/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/o),c=Math[c>=1?"floor":"ceil"](c/o),d=Math[d>=1?"floor":"ceil"](d/o),h.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=e.clientX-y.left,g=e.clientY-y.top}return e.deltaX=c,e.deltaY=d,e.deltaFactor=o,e.offsetX=f,e.offsetY=g,e.deltaMode=0,a.unshift(e,l,c,d),r&&clearTimeout(r),r=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function i(){o=null}function n(t,e){return h.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var r,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice;if(t.event.fixHooks)for(var l=s.length;l;)t.event.fixHooks[s[--l]]=t.event.mouseHooks;var h=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",h.getLineHeight(this)),t.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],function(t){return t}),define("x_ite/Browser/Navigation/ExamineViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","jquery-mousewheel"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.button=-1,this.orientationOffset=new n(0,0,1,0),this.rotation=new n(0,0,1,0),this.fromVector=new i(0,0,0),this.toVector=new i(0,0,0),this.fromPoint=new i(0,0,0),this.toPoint=new i(0,0,0),this.pressTime=0,this.motionTime=0,this.spinId=void 0}var o=new i(0,0,0),s=new i(0,0,0),a=new i(0,0,0),u=new i(0,0,0),l=new n(0,0,1,0),h=new n(0,0,1,0),c=new n(0,0,1,0);return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser(),i=t.getCanvas();i.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),i.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),i.bind("dblclick.ExamineViewer",this.dblclick.bind(this)),i.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this))},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getCanvas().offset(),r=e.pageX-i.left,o=e.pageY-i.top;switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.trackballProjectToSphere(r,o,this.fromVector),this.rotation.assign(n.Identity),this.motionTime=0;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,this.getBrowser().getCanvas().unbind("mousemove.ExamineViewer"),t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(r,o,this.fromPoint)}}},mouseup:function(e){if(e.button===this.button)switch(this.button=-1,t(document).unbind("mousemove.ExamineViewer"+this.getId()),t(document).unbind("mouseup.ExamineViewer"+this.getId()),e.button){case 0:if(e.preventDefault(),e.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>.006&&performance.now()-this.motionTime<10)try{this.rotation.assign(l.assign(n.Identity).slerp(this.rotation,.6)),this.addSpinning()}catch(t){console.log(t)}break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT")}},dblclick:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getCanvas().offset(),i=t.pageX-e.left,n=this.getBrowser().getCanvas().height()-(t.pageY-e.top);this.lookAt(i,n)},mousemove:function(t){var e=this.getBrowser().getCanvas().offset(),i=t.pageX-e.left,n=t.pageY-e.top;switch(this.button){case 0:t.preventDefault();var r=this.getActiveViewpoint(),a=this.trackballProjectToSphere(i,n,this.toVector);if(this.rotation.setFromToVec(a,this.fromVector),Math.abs(this.rotation.angle)<.006&&performance.now()-this.pressTime<50)return!1;r.orientationOffset_=this.getOrientationOffset(),r.positionOffset_=this.getPositionOffset(),this.fromVector.assign(a),this.motionTime=performance.now();break;case 1:t.preventDefault(),t.stopImmediatePropagation();var r=this.getActiveViewpoint(),l=this.getPointOnCenterPlane(i,n,this.toPoint),h=r.getUserOrientation().multVecRot(u.assign(this.fromPoint).subtract(l));r.positionOffset_=o.assign(r.positionOffset_.getValue()).add(h),r.centerOfRotationOffset_=s.assign(r.centerOfRotationOffset_.getValue()).add(h),this.fromPoint.assign(l)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getActiveViewpoint(),i=this.getDistanceToCenter(a).multiply(.02);e.getUserOrientation().multVecRot(o.set(0,0,i.abs())),t.deltaY>0?e.positionOffset_=e.positionOffset_.getValue().subtract(o):t.deltaY<0&&(e.positionOffset_=e.positionOffset_.getValue().add(o))},getPositionOffset:function(){var t=this.getActiveViewpoint();return this.getDistanceToCenter(a),h.assign(this.orientationOffset).inverse().multRight(t.orientationOffset_.getValue()).multVecRot(u.assign(a)).subtract(a).add(t.positionOffset_.getValue())},getOrientationOffset:function(){var t=this.getActiveViewpoint();return this.orientationOffset.assign(t.orientationOffset_.getValue()),c.assign(t.getOrientation()).inverse().multRight(this.rotation).multRight(t.getUserOrientation())},spin:function(){var t=this.getActiveViewpoint();t.orientationOffset_=this.getOrientationOffset(),t.positionOffset_=this.getPositionOffset()},addSpinning:function(){this.spinId||(this.spinId=setInterval(this.spin.bind(this),1e3/60))},disconnect:function(){clearInterval(this.spinId),this.spinId=void 0},dispose:function(){this.disconnect(),this.getBrowser().getCanvas().unbind(".ExamineViewer"),t(document).unbind(".ExamineViewer"+this.getId())}}),r}),define("x_ite/Browser/Navigation/X3DFlyViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],function(t,e,i,n,r,o){"use strict";function s(t){e.call(this,t);var o=this.getBrowser().getContext();this.button=-1,this.fromVector=new i(0,0,0),this.toVector=new i(0,0,0),this.direction=new i(0,0,0),this.sourceRotation=new n(0,0,1,0),this.destinationRotation=new n(0,0,1,0),this.startTime=0,this.lineBuffer=o.createBuffer(),this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.event=null,this.projectionMatrix=new r,this.projectionMatrixArray=new Float32Array(this.projectionMatrix),this.modelViewMatrixArray=new Float32Array(this.projectionMatrix)}var a=Math.PI/32,u=new i(0,1,0),l=(new i(0,0,1),new Float32Array([0,0,0])),h=new Float32Array([1,1,1]),c=new i(0,0,0),d=new i(0,0,0),p=new i(0,0,0),f=new i(0,0,0),g=new i(0,0,0),m=new n(0,0,1,0),x=new n(0,0,1,0),y=new n(0,0,1,0),_=new n(0,0,1,0),v=new n(0,0,1,0),w=new n(0,0,1,0),b=new n(0,0,1,0);return s.prototype=t.extend(Object.create(e.prototype),{constructor:s,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getCanvas();t.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),t.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),t.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this)),this.getBrowser().controlKey_.addInterest("set_controlKey_",this)},addCollision:function(){},removeCollision:function(){},set_controlKey_:function(){this.event&&0===this.event.button&&(this.button=-1,this.mousedown(this.event))},mousedown:function(e){if(!(this.button>=0)){this.event=e;var i=this.getBrowser().getCanvas().offset(),n=e.pageX-i.left,r=e.pageY-i.top;switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().getControlKey()?this.trackballProjectToSphere(n,r,this.fromVector):(this.fromVector.set(n,0,r),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,0));break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(n,-r,0),this.toVector.assign(this.fromVector),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,1)}}},mouseup:function(e){e.preventDefault(),e.button===this.button&&(this.event=null,this.button=-1,t(document).unbind("mousemove.X3DFlyViewer"+this.getId()),t(document).unbind("mouseup.X3DFlyViewer"+this.getId()),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision())},mousemove:function(t){this.getBrowser().addBrowserEvent(),this.event=t;var e=this.getBrowser().getCanvas().offset(),i=t.pageX-e.left,n=t.pageY-e.top;switch(this.button){case 0:if(this.getBrowser().getControlKey()){t.preventDefault();var r=this.getActiveViewpoint(),o=r.getUserOrientation(),s=this.trackballProjectToSphere(i,n,this.toVector);x.setFromToVec(s,this.fromVector).multRight(o),r.straightenHorizon(x),r.orientationOffset_=y.assign(r.getOrientation()).inverse().multRight(x),this.fromVector.assign(s)}else this.toVector.set(i,0,n),this.direction.assign(this.toVector).subtract(this.fromVector),this.addFly();break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.toVector.set(i,-n,0),this.direction.assign(this.toVector).subtract(this.fromVector),this.addPan()}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation(),this.getActiveViewpoint().transitionStop(),t.deltaY>0?this.addRoll(-a):t.deltaY<0&&this.addRoll(a)},fly:function(){var t=performance.now(),e=(t-this.startTime)/1e3,i=this.getNavigationInfo(),r=this.getActiveViewpoint();p.assign(r.getUpVector()),w.setFromToVec(u,p),this.direction.z>0?_.setFromToVec(w.multVecRot(f.assign(this.direction)),w.multVecRot(g.set(0,0,1))):_.setFromToVec(w.multVecRot(g.set(0,0,-1)),w.multVecRot(f.assign(this.direction)));var o=this.direction.abs(),s=1-_.angle/(Math.PI/2);s*=i.speed_.getValue(),s*=r.getSpeedFactor(),s*=this.getBrowser().getShiftKey()?.028:.007,s*=e;var a=this.getTranslationOffset(f.assign(this.direction).multiply(s));this.getActiveLayer().constrainTranslation(a,!0),r.positionOffset_=a.add(r.positionOffset_.getValue());var l=1.4*e;l*=Math.pow(o/(o+40),2),r.orientationOffset_=y.assign(n.Identity).slerp(_,l).multLeft(r.orientationOffset_.getValue()),b.setFromToVec(p,r.getUpVector()),r.orientationOffset_=b.multLeft(r.orientationOffset_.getValue()),this.startTime=t},pan:function(){var t=performance.now(),e=(t-this.startTime)/1e3,i=this.getNavigationInfo(),n=this.getActiveViewpoint(),r=n.getUpVector();this.constrainPanDirection(f.assign(this.direction));var o=1;o*=i.speed_.getValue(),o*=n.getSpeedFactor(),o*=this.getBrowser().getShiftKey()?.0098:.007,o*=e;var s=n.getUserOrientation().multRight(m.setFromToVec(n.getUserOrientation().multVecRot(g.assign(u)),r)),a=s.multVecRot(f.multiply(o));this.getActiveLayer().constrainTranslation(a,!0),n.positionOffset_=a.add(n.positionOffset_.getValue()),this.startTime=t},roll:function(){var t=performance.now(),e=(t-this.startTime)/1e3;if(e>.2)return this.disconnect();this.getActiveViewpoint().orientationOffset_=y.assign(this.sourceRotation).slerp(this.destinationRotation,e/.2)},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("fly",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("pan",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(t){var e=this.getActiveViewpoint();this.getBrowser().prepareEvents().hasInterest("roll",this)?v.assign(e.orientationOffset_.getValue()).inverse().multLeft(this.destinationRotation):v.set(0,0,1,0),m.setAxisAngle(e.getUserOrientation().multVecRot(g.set(1,0,0)),t+v.angle),this.getBrowser().prepareEvents().addInterest("roll",this),this.getBrowser().addBrowserEvent(),this.sourceRotation.assign(e.orientationOffset_.getValue()),this.destinationRotation.assign(this.sourceRotation).multRight(m),this.startTime=performance.now()},display:function(t,e){var i=this.getBrowser(),n=i.getViewport(),r=n[2],s=n[3];o.ortho(0,r,0,s,-1,1,this.projectionMatrix),this.projectionMatrixArray.set(this.projectionMatrix),0===e?(c.set(this.fromVector.x,s-this.fromVector.z,0),d.set(this.toVector.x,s-this.toVector.z,0)):(c.set(this.fromVector.x,s+this.fromVector.y,0),d.set(this.toVector.x,s+this.toVector.y,0)),this.transfer(c,d);var a=i.getContext(),u=i.getLineShader(),p=a.getParameter(a.LINE_WIDTH);u.useProgram(a),u.enableVertexAttribute(a,this.lineBuffer),a.uniform4fv(u.x3d_ClipPlane[0],u.x3d_NoneClipPlane),a.uniform1i(u.x3d_FogType,0),a.uniform1i(u.x3d_ColorMaterial,!1),a.uniform1i(u.x3d_Lighting,!0),a.uniformMatrix4fv(u.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),a.uniformMatrix4fv(u.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),a.disable(a.DEPTH_TEST),a.lineWidth(2),a.uniform3fv(u.x3d_EmissiveColor,l),a.uniform1f(u.x3d_Transparency,0),a.drawArrays(a.LINES,0,this.lineCount),a.lineWidth(1),a.uniform3fv(u.x3d_EmissiveColor,h),a.drawArrays(a.LINES,0,this.lineCount),a.enable(a.DEPTH_TEST),a.lineWidth(p)},transfer:function(t,e){var i=this.getBrowser().getContext(),n=this.lineVertices;n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=1,n[4]=e.x,n[5]=e.y,n[6]=e.z,n[7]=1,this.lineArray.set(n),i.bindBuffer(i.ARRAY_BUFFER,this.lineBuffer),i.bufferData(i.ARRAY_BUFFER,this.lineArray,i.STATIC_DRAW)},disconnect:function(){var t=this.getBrowser();t.addBrowserEvent(),t.prepareEvents().removeInterest("fly",this),t.prepareEvents().removeInterest("pan",this),t.prepareEvents().removeInterest("roll",this),t.finished().removeInterest("display",this),
this.startTime=0},dispose:function(){this.disconnect(),this.getBrowser().controlKey_.removeInterest("set_controlKey_",this),this.getBrowser().getCanvas().unbind(".X3DFlyViewer"),t(document).unbind(".X3DFlyViewer"+this.getId())}}),s}),define("x_ite/Browser/Navigation/WalkViewer",["jquery","x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,i,n){"use strict";function r(t){e.call(this,t)}var o=new i(0,1,0);return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getTranslationOffset:function(t){var e=this.getActiveViewpoint(),i=e.getUpVector(),r=e.getUserOrientation().copy();return r.multRight(new n(r.multVecRot(o.copy()),i)).multVecRot(t)},constrainPanDirection:function(t){return t.y<0&&(t.y=0),t},dispose:function(){this.getBrowser().removeCollision(this),e.prototype.dispose.call(this)}}),r}),define("x_ite/Browser/Navigation/FlyViewer",["jquery","x_ite/Browser/Navigation/X3DFlyViewer"],function(t,e){"use strict";function i(t){e.call(this,t)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getTranslationOffset:function(t){return this.getActiveViewpoint().getUserOrientation().multVecRot(t)},constrainPanDirection:function(t){return t}}),i}),define("x_ite/Components/Interpolation/ScalarInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.ScalarInterpolator)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFFloat),new i(o.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,e=this.keyValue_;e.length<t.length&&e.resize(t.length,e.length?e[e.length-1]:0)},interpolate:function(t,e,i){this.value_changed_=s.lerp(this.keyValue_[t],this.keyValue_[e],i)}}),a}),define("x_ite/Components/Navigation/Viewpoint",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(s.Viewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new o(this.getBrowser().getPrivateScene())}var c=new u(0,0,1),d=new u(0,0,0),p=new u(0,0,0);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_bind",new e.SFBool),new i(s.inputOutput,"description",new e.SFString),new i(s.inputOutput,"position",new e.SFVec3f(0,0,10)),new i(s.inputOutput,"orientation",new e.SFRotation),new i(s.inputOutput,"centerOfRotation",new e.SFVec3f),new i(s.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new i(s.inputOutput,"jump",new e.SFBool(!0)),new i(s.inputOutput,"retainUserOffsets",new e.SFBool),new i(s.outputOnly,"isBound",new e.SFBool),new i(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.fieldOfViewInterpolator.key_=[0,1],this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(t){if(t.getType().indexOf(s.Viewpoint)<0)this.fieldOfViewInterpolator.keyValue_=[this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()];else{var e=t.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=[e,this.fieldOfViewScale_.getValue()],this.fieldOfViewScale_=e}},getFieldOfView:function(){var t=this.fieldOfView_.getValue()*this.fieldOfViewScale_.getValue();return t>0&&t<Math.PI?t:Math.PI/4},getScreenScale:function(t,e){var i=e[2],n=e[3],r=2*Math.tan(this.getFieldOfView()/2)*t.abs();return r*=Math.abs(p.assign(t).normalize().dot(c)),r/=i>n?n:i,d.set(r,r,r)},getLookAtDistance:function(t){return t.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(t,e,i){return a.perspective(this.getFieldOfView(),t,e,i[2],i[3],this.projectionMatrix)}}),h}),define("standard/Math/Geometry/Spheroid3",[],function(){"use strict";function t(t,e){switch(arguments.length){case 0:this.semiMajorAxis=0,this.semiMinorAxis=0;break;case 2:this.semiMajorAxis=t,this.semiMinorAxis=e;break;case 3:var i=arguments[1];this.semiMajorAxis=t,this.semiMinorAxis=t*(1-1/i)}}return t.prototype={constructor:t,getSemiMajorAxis:function(){return this.semiMajorAxis},getSemiMinorAxis:function(){return this.semiMinorAxis},toString:function(){return this.semiMajorAxis+" "+this.semiMinorAxis}},t}),define("standard/Geospatial/ReferenceEllipsoids",["standard/Math/Geometry/Spheroid3"],function(t){"use strict";return{AA:new t(6377563.396,299.3249646,!0),AM:new t(6377340.189,299.3249646,!0),AN:new t(6378160,298.25,!0),BN:new t(6377483.865,299.1528128,!0),BR:new t(6377397.155,299.1528128,!0),CC:new t(6378206.4,294.9786982,!0),CD:new t(6378249.145,293.465,!0),EA:new t(6377276.345,300.8017,!0),EB:new t(6377298.556,300.8017,!0),EC:new t(6377301.243,300.8017,!0),ED:new t(6377295.664,300.8017,!0),EE:new t(6377304.063,300.8017,!0),EF:new t(6377309.613,300.8017,!0),FA:new t(6378155,298.3,!0),HE:new t(6378200,298.3,!0),HO:new t(6378270,297,!0),ID:new t(6378160,298.247,!0),IN:new t(6378388,297,!0),KA:new t(6378245,298.3,!0),RF:new t(6378137,298.257222101,!0),SA:new t(6378160,298.25,!0),WD:new t(6378135,298.26,!0),WE:new t(6378137,298.257223563,!0),SUN:new t(696342e3,1/9e-6,!0),MERCURY:new t(2439700,2439700),VENUS:new t(6051800,6051800),MOON:new t(1738140,1735970),MARS:new t(3395428,3377678),JUPITER:new t(71492e3,66854e3),SATURN:new t(60268e3,54364e3),URANUS:new t(2555e3,24973e3),NEPTUNE:new t(24764e3,24341e3),PLUTO:new t(1153e3,1153e3)}}),define("standard/Geospatial/Geodetic",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e){"use strict";function i(t,e,i){this.longitudeFirst=!e,this.degrees=!i,this.a=t.getSemiMajorAxis(),this.c=t.getSemiMinorAxis(),this.c2a2=Math.pow(t.getSemiMinorAxis()/this.a,2),this.ecc2=1-this.c2a2}return i.prototype={constructor:i,convert:function(t,e){var i=t.z;if(this.longitudeFirst){var n=t.y;r=t.x}else var n=t.x,r=t.y;return this.degrees&&(n*=Math.PI/180,r*=Math.PI/180),this.convertRadians(n,r,i,e)},convertRadians:function(t,e,i,n){var r=Math.sin(t),o=Math.pow(r,2),s=Math.cos(t),a=this.a/Math.sqrt(1-this.ecc2*o),u=(a+i)*s;return n.set(u*Math.cos(e),u*Math.sin(e),(a*this.c2a2+i)*r)},apply:function(t,e){if(this.applyRadians(t,e),this.degrees&&(e.x*=180/Math.PI,e.y*=180/Math.PI),this.longitudeFirst){var i=e.x;e.x=e.y,e.y=i}return e},applyRadians:function(t,e){var i=t.x,n=t.y,r=t.z,o=Math.sqrt(i*i+n*n);if(0==o)return e.set(Math.PI,0,r-this.c);for(var s=0,a=Math.atan2(n,i),u=0,l=this.a,h=l,c=this.ecc2,d=0;d<30;++d){var p=u,f=s;s=Math.atan(r/o/(1-c*h/(h+u)));var g=Math.sin(s);if(h=l/Math.sqrt(1-c*g*g),u=o/Math.cos(s)-h,Math.abs(u-p)<.001&&Math.abs(s-f)<1e-10)break}return e.set(s,a,u)},normal:function(t,e){var i=this.applyRadians(t,e),n=i.x,r=i.y,o=Math.cos(n),s=Math.cos(r)*o,a=Math.sin(r)*o,u=Math.sin(n);return e.set(s,a,u)}},i}),define("standard/Geospatial/UniversalTransverseMercator",["standard/Geospatial/Geodetic","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i){"use strict";function n(e,n,o,s){var a=e.getSemiMajorAxis(),u=1-Math.pow(e.getSemiMinorAxis()/a,2),l=u/(1-u),h=(1-Math.sqrt(1-u))/(1+Math.sqrt(1-u));this.southernHemisphere=!o,this.eastingFirst=!s,this.a=a,this.ecc2=u,this.EE=l,this.E8=8*l,this.E9=9*l,this.E252=252*l,this.e1=h,this.A=r*(a*(1-u/4-3*u*u/64-5*u*u*u/256)),this.B=3*h/2-7*h*h*h/32,this.C=21*h*h/16-55*h*h*h*h/32,this.D=151*h*h*h/96,this.E=a*(1-u),this.W=1-u/4-3*u*u/64-5*u*u*u/256,this.X=3*u/8+3*u*u/32+45*u*u*u/1024,this.Y=15*u*u/256+45*u*u*u/1024,this.Z=35*u*u*u/3072,this.longitude0=i.radians(6*n-183),this.geodeticConverter=new t(e,!0,!0)}var r=.9996;return n.prototype={constructor:n,convert:function(t,e){if(this.eastingFirst){var i=t.y;n=t.x}else var i=t.x,n=t.y;var o=this.southernHemisphere;i<0&&(o=!this.southernHemisphere,i=-i),o&&(i-=1e7),n-=5e5;var s=i/this.A,a=s+this.B*Math.sin(2*s)+this.C*Math.sin(4*s)+this.D*Math.sin(6*s),u=Math.pow(Math.sin(a),2),l=Math.cos(a),h=Math.tan(a),c=this.a/Math.sqrt(1-this.ecc2*u),d=Math.pow(h,2),p=Math.pow(h,8),f=this.EE*d,g=f*f,m=this.E/Math.pow(1-this.ecc2*u,1.5),x=n/(c*r),y=(5+3*d+10*f-4*g-this.E9)*Math.pow(x,4)/24,_=(61+90*d+298*f+45*p-this.E252-3*g)*Math.pow(x,6)/720,v=(5-2*f+28*d-3*g+this.E8+24*p)*Math.pow(x,5)/120,w=a-c*h/m*(x*x/2-y+_),b=this.longitude0+(x-(1+2*d+f)*Math.pow(x,3)/6+v)/l;return this.geodeticConverter.convertRadians(w,b,t.z,e)},apply:function(t,e){var i=this.geodeticConverter.applyRadians(t,e),n=i.x,o=i.y,s=Math.tan(n),a=Math.cos(n),u=this.EE,l=this.a/Math.sqrt(1-this.ecc2*Math.pow(Math.sin(n),2)),h=s*s,c=h*h*h,d=u*a*a,p=a*(o-this.longitude0),f=this.a*(this.W*n-this.X*Math.sin(2*n)+this.Y*Math.sin(4*n)-this.Z*Math.sin(6*n)),g=r*l*(p+(1-h+d)*Math.pow(p,3)/6+(5-18*c+72*d-58*u)*Math.pow(p,5)/120)+5e5,m=r*(f+l*s*(p*p/2+(5-h+9*d+4*d*d)*Math.pow(p,4)/24+(61-58*c+600*d-330*u)*Math.pow(p,6)/720));return n<0?(m+=1e7,this.southernHemisphere||(m=-m)):this.southernHemisphere&&(m=-m),this.eastingFirst?e.set(g,m,i.z):e.set(m,g,i.z)}},n}),define("x_ite/Browser/Geospatial/Geocentric",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e){"use strict";function i(){}return i.prototype={constructor:i,convert:function(t,e){return e.assign(t)},apply:function(t,e){return e.assign(t)},slerp:function(t,i,n){var r=t.abs(),o=i.abs();return t.normalize(),i.normalize(),e.simpleSlerp(t,i,n).multiply(e.lerp(r,o,n))}},i}),define("x_ite/Browser/Geospatial/Geospatial",["standard/Geospatial/ReferenceEllipsoids","standard/Geospatial/Geodetic","standard/Geospatial/UniversalTransverseMercator","x_ite/Browser/Geospatial/Geocentric"],function(t,e,i,n){"use strict";var r=0,o=r++,s=r++,a=r++,u={GD:o,GDC:o,UTM:s,GC:a,GCC:a,GS:a},l=/^Z(\d+)$/;return{GD:o,UTM:s,GC:a,getReferenceFrame:function(r,u){switch(this.getCoordinateSystem(r)){case o:return new e(this.getEllipsoid(r),this.getLatitudeFirst(r),u);case s:return new i(this.getEllipsoid(r),this.getZone(r),this.getNorthernHemisphere(r),this.getNorthingFirst(r));case a:return new n}return new e(t.WE,!0,u)},getElevationFrame:function(t,i){return new e(this.getEllipsoid(t),!0,i)},getCoordinateSystem:function(t){for(var e=0,i=t.length;e<i;++e){var n=u[t[e]];if(void 0!==n)return n}return o},getEllipsoid:function(e){for(var i=0,n=e.length;i<n;++i){var r=t[e[i]];if(void 0!==r)return r}return t.WE},getEllipsoidString:function(e){for(var i=0,n=e.length;i<n;++i){if(void 0!==t[e[i]])return e[i]}return"WE"},isStandardOrder:function(t){switch(this.getCoordinateSystem(t)){case o:return this.getLatitudeFirst(t);case s:return this.getNorthingFirst(t);case a:return!0}return this.getLatitudeFirst(t)},getLatitudeFirst:function(t){for(var e=0,i=t.length;e<i;++e)if("longitude_first"===t[e])return!1;return!0},getNorthingFirst:function(t){for(var e=0,i=t.length;e<i;++e)if("easting_first"===t[e])return!1;return!0},getZone:function(t){for(var e=0,i=t.length;e<i;++e){var n=t[e].match(l);if(n)return parseInt(n[1])}return 1},getNorthernHemisphere:function(t){for(var e=0,i=t.length;e<i;++e)if("S"===t[e])return!1;return!0}}}),define("x_ite/Components/Geospatial/X3DGeospatialObject",["jquery","x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o){"use strict";function s(t){this.addType(e.X3DGeospatialObject),this.radians=!1,this.origin=new r(0,0,0),this.originMatrix=new o,this.invOriginMatrix=new o}function a(t,e){return this.invOriginMatrix.multVecMatrix(this.referenceFrame.convert(t,e))}function u(t,e){return this.referenceFrame.apply(this.originMatrix.multVecMatrix(d.assign(t)),e)}function l(t,e){return this.invOriginMatrix.multDirMatrix(this.elevationFrame.normal(this.originMatrix.multVecMatrix(d.assign(t)),e))}function h(t,e){return c.call(this,t,e).multRight(this.invOriginMatrix)}function c(t,e){return this.referenceFrame.convert(t,f),this.elevationFrame.normal(f,m),g.set(0,0,1).cross(m),g.equals(r.Zero)&&g.set(1,0,0),x.assign(g).cross(m),g.normalize(),x.normalize(),e.set(g.x,g.y,g.z,0,m.x,m.y,m.z,0,x.x,x.y,x.z,0,f.x,f.y,f.z,1)}var d=new r(0,0,0),p=new r(0,0,0),f=new r(0,0,0),g=new r(0,0,0),m=new r(0,0,0),x=new r(0,0,0);return s.prototype={constructor:s,initialize:function(){this.geoSystem_.addInterest("set_geoSystem__",this),this.geoOrigin_.addInterest("set_geoOrigin__",this),this.set_geoSystem__(),this.set_geoOrigin__()},set_geoSystem__:function(){this.coordinateSystem=i.getCoordinateSystem(this.geoSystem_),this.referenceFrame=i.getReferenceFrame(this.geoSystem_,this.radians),this.elevationFrame=i.getElevationFrame(this.geoSystem_,this.radians),this.standardOrder=i.isStandardOrder(this.geoSystem_)},set_geoOrigin__:function(){this.geoOriginNode&&(this.geoOriginNode.removeInterest("set_origin__",this),this.geoOriginNode.removeInterest("set_rotateYUp__",this),this.geoOriginNode.removeInterest("addNodeEvent",this)),this.geoOriginNode=n(e.GeoOrigin,this.geoOrigin_),this.geoOriginNode&&(this.geoOriginNode.addInterest("set_origin__",this),this.geoOriginNode.addInterest("set_rotateYUp__",this),this.geoOriginNode.addInterest("addNodeEvent",this)),this.set_origin__(),this.set_rotateYUp__()},set_origin__:function(){this.geoOriginNode?this.geoOriginNode.getOrigin(this.origin):this.origin.set(0,0,0),this.set_originMatrix__()},set_originMatrix__:function(){try{if(this.geoOriginNode){var t=this.origin;this.elevationFrame.normal(t,m),g.set(0,0,1).cross(m),g.equals(r.Zero)&&g.set(1,0,0),x.assign(g).cross(m),g.normalize(),x.normalize(),this.originMatrix.set(g.x,g.y,g.z,0,m.x,m.y,m.z,0,x.x,x.y,x.z,0,t.x,t.y,t.z,1),this.invOriginMatrix.assign(this.originMatrix).inverse()}}catch(t){}},set_rotateYUp__:function(){this.geoOriginNode&&this.geoOriginNode.rotateYUp_.getValue()?(this.getCoord=a,this.getGeoCoord=u,this.getGeoUpVector=l,this.getLocationMatrix=h):(delete this.getCoord,delete this.getGeoCoord,delete this.getGeoUpVector,delete this.getLocationMatrix)},getReferenceFrame:function(){return this.referenceFrame},getStandardOrder:function(){return this.standardOrder},getCoord:function(t,e){return this.referenceFrame.convert(t,e).subtract(this.origin)},getGeoCoord:function(t,e){return this.referenceFrame.apply(d.assign(t).add(this.origin),e)},getGeoElevation:function(t){return this.getGeoCoord(t,p).z},getGeoUpVector:function(t,e){return this.elevationFrame.normal(d.assign(t).add(this.origin),e)},getLocationMatrix:function(t,e){var i=this.origin,n=c.call(this,t,e);return n[12]-=i.x,n[13]-=i.y,n[14]-=i.z,n}},s}),define("x_ite/Components/Navigation/NavigationInfo",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.NavigationInfo),this.addChildObjects("availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this.avatarSize_.setUnit("length"),this.speed_.setUnit("speed"),this.visibilityLimit_.setUnit("speed")}var u={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_bind",new e.SFBool),new i(s.inputOutput,"type",new e.MFString("EXAMINE","ANY")),new i(s.inputOutput,"avatarSize",new e.MFFloat(.25,1.6,.75)),new i(s.inputOutput,"speed",new e.SFFloat(1)),new i(s.inputOutput,"headlight",new e.SFBool(!0)),new i(s.inputOutput,"visibilityLimit",new e.SFFloat),new i(s.inputOutput,"transitionType",new e.MFString("LINEAR")),new i(s.inputOutput,"transitionTime",new e.SFTime(1)),new i(s.outputOnly,"transitionComplete",new e.SFBool),new i(s.outputOnly,"isBound",new e.SFBool),new i(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.type_.addInterest("set_type__",this),this.headlight_.addInterest("set_headlight__",this),this.set_type__(),this.set_headlight__()},set_type__:function(){this.availableViewers_.length=0;var t=!1,e=!1,i=!1,n=!1,r=!1,o=!1;this.viewer_="EXAMINE";for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this.viewer_=a;break;case"PLANE_create3000.de":this.viewer_="PLANE";break;default:continue}break}if(this.type_.length)for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":t=!0;continue;case"WALK":e=!0;continue;case"FLY":i=!0;continue;case"LOOKAT":o=!0;continue;case"PLANE":n=!0;continue;case"NONE":r=!0;continue}if("ANY"==a){t=!0,e=!0,i=!0,n=!0,r=!0,o=!0;break}t=!0}else t=!0,e=!0,i=!0,n=!0,r=!0,o=!0;t&&this.availableViewers_.push("EXAMINE"),e&&this.availableViewers_.push("WALK"),i&&this.availableViewers_.push("FLY"),n&&this.availableViewers_.push("PLANE"),o&&this.availableViewers_.push("LOOKAT"),r&&this.availableViewers_.push("NONE")},set_headlight__:function(){this.headlight_.getValue()?delete this.enable:this.enable=Function.prototype},bindToLayer:function(t){t.getNavigationInfoStack().push(this)},unbindFromLayer:function(t){t.getNavigationInfoStack().pop(this)},removeFromLayer:function(t){t.getNavigationInfoStack().remove(this)},getViewer:function(){return this.viewer_.getValue()},getCollisionRadius:function(){return this.avatarSize_.length>0&&this.avatarSize_[0]>0?this.avatarSize_[0]:.25},getAvatarHeight:function(){return this.avatarSize_.length>1?this.avatarSize_[1]:1.6},getStepHeight:function(){return this.avatarSize_.length>2?this.avatarSize_[2]:.75},getNearValue:function(){var t=this.getCollisionRadius();return 0===t?1e-5:t/2},getFarValue:function(t){return this.visibilityLimit_.getValue()?this.visibilityLimit_.getValue():t.getMaxZFar()},getTransitionType:function(){for(var t=0,e=this.transitionType_.length;t<e;++t){var i=this.transitionType_[t];if(u[i])return i}return"LINEAR"},enable:function(t,e){t===o.DISPLAY&&this.headlight_.getValue()&&e.getGlobalLights().push(e.getBrowser().getHeadlight())},traverse:function(t,e){e.getLayer().getNavigationInfos().push(this)}}),a}),define("x_ite/Components/Geospatial/GeoViewpoint",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Navigation/NavigationInfo","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p){"use strict";function f(t,e){r.prototype.traverse.call(this,t,e),this.navigationInfoNode.traverse(t,e)}function g(t){switch(r.call(this,t),o.call(this,t),this.addType(u.GeoViewpoint),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.navigationInfoNode=new a(t),this.fieldOfViewInterpolator=new s(this.getBrowser().getPrivateScene()),this.projectionMatrix=new d,this.position=new h,this.elevation=0,t.specificationVersion){case"2.0":case"3.0":case"3.1":case"3.2":this.traverse=f}}var m=new h(0,0,1),x=new h(0,0,0),y=new h(0,0,0),_=new h(0,0,0),v=new d,w=new h(0,0,0),b=new c(0,0,1,0),S=new h(0,0,0),C=new h(0,0,0),F=new c(0,0,1,0);new h(0,0,0);return g.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:g,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.initializeOnly,"geoOrigin",new e.SFNode),new i(u.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(u.inputOnly,"set_bind",new e.SFBool),new i(u.inputOutput,"description",new e.SFString),new i(u.inputOutput,"position",new e.SFVec3d(0,0,1e5)),new i(u.inputOutput,"orientation",new e.SFRotation),new i(u.inputOutput,"centerOfRotation",new e.SFVec3d),new i(u.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new i(u.inputOutput,"jump",new e.SFBool(!0)),new i(u.inputOutput,"retainUserOffsets",new e.SFBool),new i(u.inputOutput,"navType",new e.MFString("EXAMINE","ANY")),new i(u.inputOutput,"headlight",new e.SFBool(!0)),new i(u.initializeOnly,"speedFactor",new e.SFFloat(1)),new i(u.outputOnly,"isBound",new e.SFBool),new i(u.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"GeoViewpoint"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.positionOffset_.addInterest("set_position__",this),this.navType_.addFieldInterest(this.navigationInfoNode.type_),this.headlight_.addFieldInterest(this.navigationInfoNode.headlight_),this.navigationInfoNode.setup(),this.set_position__(),this.fieldOfViewInterpolator.key_=[0,1],this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(t){if(t.getType().indexOf(u.GeoViewpoint)<0)this.fieldOfViewInterpolator.keyValue_=[this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()];else{var e=t.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=[e,this.fieldOfViewScale_.getValue()],this.fieldOfViewScale_=e}},setPosition:function(t){this.position_.setValue(this.getGeoCoord(t,C))},getPosition:function(){return this.getCoord(this.position_.getValue(),w)},set_position__:function(){this.getCoord(this.position_.getValue(),this.position),this.elevation=this.getGeoElevation(w.assign(this.position).add(this.positionOffset_.getValue()))},setOrientation:function(t){var e=this.getLocationMatrix(this.position_.getValue(),v).submatrix;F.setMatrix(e),this.orientation_.setValue(F.inverse().multLeft(t))},getOrientation:function(){var t=this.getLocationMatrix(this.position_.getValue(),v).submatrix;return b.setMatrix(t),b.multLeft(this.orientation_.getValue())},getCenterOfRotation:function(){return this.getCoord(this.centerOfRotation_.getValue(),S)},getFieldOfView:function(){var t=this.fieldOfView_*this.fieldOfViewScale_;return t>0&&t<Math.PI?t:Math.PI/4},getUpVector:function(){return this.getGeoUpVector.call(this,w.assign(this.position).add(this.positionOffset_.getValue()),_)},getSpeedFactor:function(){return(Math.max(this.elevation,0)+10)/10*this.speedFactor_.getValue()},getMaxZFar:function(){return 1e9},getScreenScale:function(t,e){var i=e[2],n=e[3],r=2*Math.tan(this.getFieldOfView()/2)*t.abs();return r*=Math.abs(y.assign(t).normalize().dot(m)),r/=i>n?n:i,x.set(r,r,r)},getLookAtDistance:function(t){return t.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(t,e,i,n){if(n)return l.perspective(this.getFieldOfView(),t,e,i[2],i[3],this.projectionMatrix);var r=Math.max(p.lerp(Math.min(t,1e4),1e4,this.elevation/1e7),1),o=Math.max(p.lerp(1e6,Math.max(e,1e6),this.elevation/1e7),1e6);return l.perspective(this.getFieldOfView(),r,o,i[2],i[3],this.projectionMatrix)}}),g}),define("x_ite/Browser/Navigation/PlaneViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Geospatial/GeoViewpoint","standard/Math/Numbers/Vector3","jquery-mousewheel"],function(t,e,i,n,r){"use strict";function o(t){e.call(this,t),this.button=-1,this.fromPoint=new r(0,0,0),this.toPoint=new r(0,0,0)}var s=new r(0,0,0),a=new r(0,0,0),u=new r(0,0,0);return o.prototype=t.extend(Object.create(e.prototype),{constructor:o,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser(),i=t.getCanvas();i.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),i.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),i.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),i.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getCanvas().offset(),n=e.pageX-i.left,r=e.pageY-i.top;switch(e.button){case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,this.getBrowser().getCanvas().unbind("mousemove.PlaneViewer"),t(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint)}}},mouseup:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.button===this.button&&(this.button=-1,t(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getCanvas().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"))},mousemove:function(t){var e=this.getBrowser().getCanvas().offset(),i=t.pageX-e.left,n=t.pageY-e.top;switch(this.button){case 1:t.preventDefault(),t.stopImmediatePropagation();var r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(i,n,this.toPoint),s=r.getUserOrientation().multVecRot(this.fromPoint.subtract(o));r.positionOffset_=a.assign(r.positionOffset_.getValue()).add(s),r.centerOfRotationOffset_=u.assign(r.centerOfRotationOffset_.getValue()).add(s),this.fromPoint.assign(o)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getCanvas().offset(),i=t.pageX-e.left,n=t.pageY-e.top,r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(i,n,this.fromPoint);r.transitionStop(),t.deltaY>0?r.fieldOfViewScale_=Math.max(1e-5,.95*r.fieldOfViewScale_.getValue()):t.deltaY<0&&(r.fieldOfViewScale_=1.05*r.fieldOfViewScale_.getValue(),this.constrainFieldOfViewScale()),r.set_fieldOfView___&&r.set_fieldOfView___();var l=this.getPointOnCenterPlane(i,n,this.toPoint),h=r.getUserOrientation().multVecRot(s.assign(o).subtract(l));r.positionOffset_=a.assign(r.positionOffset_.getValue()).add(h),r.centerOfRotationOffset_=u.assign(r.centerOfRotationOffset_.getValue()).add(h)},constrainFieldOfViewScale:function(){var t=this.getActiveViewpoint();(t instanceof i||t instanceof n)&&t.fieldOfView_.getValue()*t.fieldOfViewScale_.getValue()>=Math.PI&&(t.fieldOfViewScale_=(Math.PI-.001)/t.fieldOfView_.getValue())},dispose:function(){this.getBrowser().getCanvas().unbind(".PlaneViewer"),t(document).unbind(".PlaneViewer"+this.getId())}}),o}),define("x_ite/Browser/Navigation/NoneViewer",["jquery","x_ite/Browser/Navigation/X3DViewer"],function(t,e){"use strict";function i(t){e.call(this,t)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Browser/Navigation/LookAtViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","jquery-mousewheel"],function(t,e){"use strict";function i(t){e.call(this,t),this.button=-1}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser(),i=t.getCanvas();i.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),i.bind("mouseup.LookAtViewer",this.mouseup.bind(this))},mousedown:function(e){if(!(this.button>=0))switch(this.pressTime=performance.now(),e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),this.getActiveViewpoint().transitionStop()}},mouseup:function(e){if(e.button===this.button){this.button=-1,t(document).unbind(".LookAtViewer"+this.getId());var i=this.getBrowser().getCanvas().offset(),n=e.pageX-i.left,r=this.getBrowser().getCanvas().height()-(e.pageY-i.top);switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.lookAt(n,r,!0)}}},dispose:function(){this.getBrowser().getCanvas().unbind(".LookAtViewer"),t(document).unbind(".LookAtViewer"+this.getId())}}),i}),define("x_ite/Components/Lighting/X3DLightNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,i,n,r,o){"use strict";function s(t){e.call(this,t),this.addType(n.X3DLightNode),this.shadowDiffusion_.setUnit("length")}var a=new r(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);return s.prototype=t.extend(Object.create(e.prototype),{constructor:s,getGlobal:function(){return this.global_.getValue()},getColor:function(){return this.color_.getValue()},getIntensity:function(){return o.clamp(this.intensity_.getValue(),0,1)},getAmbientIntensity:function(){return o.clamp(this.ambientIntensity_.getValue(),0,1)},getDirection:function(){return this.direction_.getValue()},getShadowColor:function(){return this.shadowColor_.getValue()},getShadowIntensity:function(){return o.clamp(this.shadowIntensity_.getValue(),0,1)},getShadowDiffusion:function(){return Math.max(this.shadowDiffusion_.getValue(),0)},getShadowMapSize:function(){return Math.min(this.shadowMapSize_.getValue(),this.getBrowser().getMaxTextureSize())},getBiasMatrix:function(){return a},push:function(t,e){if(this.on_.getValue())if(t.isIndependent()){var i=this.getLights().pop();this.global_.getValue()?(i.set(t.getBrowser(),this,t.getLayer().getGroup(),t.getModelViewMatrix().get()),t.getGlobalLights().push(i),t.getLights().push(i)):(i.set(t.getBrowser(),this,e,t.getModelViewMatrix().get()),t.getLocalLights().push(i),t.getLights().push(i))}else{var i=t.getLightContainer();this.global_.getValue()?(i.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getGlobalLights().push(i),t.getLights().push(i)):(i.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getLocalLights().push(i),t.getLights().push(i))}},pop:function(t){if(this.on_.getValue()){if(this.global_.getValue())return;t.isIndependent()?t.getBrowser().getLocalLights().push(t.getLocalLights().pop()):t.getLocalLights().pop()}}}),s}),define("x_ite/Components/Grouping/X3DBoundedObject",["jquery","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(t,e,i,n,r){"use strict";function o(t){this.addType(i.X3DBoundedObject),this.bboxSize_.setUnit("length"),this.bboxCenter_.setUnit("length"),this.childBBox=new r}return o.prototype={constructor:o,defaultBBoxSize:new n(-1,-1,-1),initialize:function(){},getBBox:function(t,n){n.set();for(var r=0,o=t.length;r<o;++r){var s=e(i.X3DBoundedObject,t[r]);s&&n.add(s.getBBox(this.childBBox))}return n}},o}),
define("x_ite/Components/Grouping/X3DGroupingNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s){"use strict";function a(t){return t?t.getValue().getId():-1}function u(t,e,i,n,r,o){function s(t){return u[a(t)]}for(var u={},l=r;l<o;++l)u[a(n[l])]=!0;return t.remove(e,i,s)}function l(t){i.call(this,t),n.call(this,t),this.addType(o.X3DGroupingNode),this.hidden=!1,this.pointingDeviceSensors=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.clipPlanes=[],this.localFogs=[],this.lights=[],this.childNodes=[]}var h=new e.MFBool;return l.prototype=t.extend(Object.create(i.prototype),n.prototype,{constructor:l,initialize:function(){i.prototype.initialize.call(this),n.prototype.initialize.call(this),this.addChildren_.addInterest("set_addChildren__",this),this.removeChildren_.addInterest("set_removeChildren__",this),this.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(t){return this.bboxSize_.getValue().equals(this.defaultBBoxSize)?n.prototype.getBBox.call(this,this.children_.getValue(),t):t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getMatrix:function(){return s.Identity},setHidden:function(t){t!==this.hidden&&(this.hidden=t,this.set_children__())},getVisible:function(){return h},getChild:function(t){try{if(t>=0&&t<this.children_.length){var e=this.children_[t];if(e)return e.getValue().getInnerNode()}}catch(t){}return null},set_addChildren__:function(){if(0!==this.addChildren_.length){this.addChildren_.setTainted(!0),this.addChildren_.erase(u(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length),this.addChildren_.length),this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this));var t=this.children_.length;this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(t,this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1)}},set_removeChildren__:function(){0!==this.removeChildren_.length&&0!==this.children_.length&&(this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.erase(u(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length),this.children_.length),this.remove(this.removeChildren_),this.removeChildren_.set([]))},set_children__:function(){this.clear(),this.add(0,this.children_)},connectChildren:function(){this.children_.removeInterest("connectChildren",this),this.children_.addInterest("set_children__",this)},add:function(t,e){if(!this.hidden){for(var i=this.getVisible(),n=i.length,r=0,s=t,a=e.length;r<a;++r,++s){var u=e[r];if(u&&(s>=n||i[s]))try{for(var l=u.getValue().getInnerNode(),h=l.getType(),c=h.length-1;c>=0;--c){switch(h[c]){case o.X3DPointingDeviceSensorNode:this.pointingDeviceSensors.push(l);break;case o.ClipPlane:this.clipPlanes.push(l);break;case o.LocalFog:this.localFogs.push(l);break;case o.X3DLightNode:this.lights.push(l);break;case o.X3DBindableNode:this.maybeCameraObjects.push(l);break;case o.X3DBackgroundNode:case o.X3DChildNode:l.isCameraObject_.addInterest("set_cameraObjects__",this),this.maybeCameraObjects.push(l),this.childNodes.push(l);break;case o.BooleanFilter:case o.BooleanToggle:case o.NurbsOrientationInterpolator:case o.NurbsPositionInterpolator:case o.NurbsSurfaceInterpolator:case o.TimeSensor:case o.X3DFollowerNode:case o.X3DInfoNode:case o.X3DInterpolatorNode:case o.X3DLayoutNode:case o.X3DScriptNode:case o.X3DSequencerNode:case o.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__()}},remove:function(t){for(var e=0,i=t.length;e<i;++e){var n=t[e];if(n)try{for(var r=n.getValue().getInnerNode(),s=r.getType(),a=s.length-1;a>=0;--a){switch(s[a]){case o.X3DPointingDeviceSensorNode:var u=this.pointingDeviceSensors.indexOf(r);u>=0&&this.pointingDeviceSensors.splice(u,1);break;case o.ClipPlane:var u=this.clipPlanes.indexOf(r);u>=0&&this.clipPlanes.splice(u,1);break;case o.LocalFog:var u=this.localFogs.indexOf(r);u>=0&&this.localFogs.splice(u,1);break;case o.X3DLightNode:var u=this.lights.indexOf(r);u>=0&&this.lights.splice(u,1);break;case o.X3DBindableNode:var u=this.maybeCameraObjects.indexOf(r);u>=0&&this.maybeCameraObjects.splice(u,1);break;case o.X3DBackgroundNode:case o.X3DChildNode:r.isCameraObject_.removeInterest("set_cameraObjects__",this);var u=this.maybeCameraObjects.indexOf(r);u>=0&&this.maybeCameraObjects.splice(u,1);var u=this.childNodes.indexOf(r);u>=0&&this.childNodes.splice(u,1);break;case o.BooleanFilter:case o.BooleanToggle:case o.NurbsOrientationInterpolator:case o.NurbsPositionInterpolator:case o.NurbsSurfaceInterpolator:case o.TimeSensor:case o.X3DFollowerNode:case o.X3DInfoNode:case o.X3DInterpolatorNode:case o.X3DLayoutNode:case o.X3DScriptNode:case o.X3DSequencerNode:case o.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__()},clear:function(){for(var t=0,e=this.childNodes.length;t<e;++t)this.childNodes[t].isCameraObject_.removeInterest("set_cameraObjects__",this);this.pointingDeviceSensors.length=0,this.maybeCameraObjects.length=0,this.cameraObjects.length=0,this.clipPlanes.length=0,this.localFogs.length=0,this.lights.length=0,this.childNodes.length=0},set_cameraObjects__:function(){this.cameraObjects.length=0;for(var t=0,e=this.maybeCameraObjects.length;t<e;++t){var i=this.maybeCameraObjects[t];i.getCameraObject()&&this.cameraObjects.push(i)}this.setCameraObject(this.cameraObjects.length)},traverse:function(t,e){switch(t){case r.POINTER:var i=this.pointingDeviceSensors,n=this.clipPlanes,o=this.childNodes;if(i.length){var s={};e.getBrowser().getSensors().push(s);for(var a=0,u=i.length;a<u;++a)i[a].push(e,s)}for(var a=0,u=n.length;a<u;++a)n[a].push(e);for(var a=0,u=o.length;a<u;++a)o[a].traverse(t,e);for(var a=0,u=n.length;a<u;++a)n[a].pop(e);return void(i.length&&e.getBrowser().getSensors().pop());case r.CAMERA:for(var l=this.cameraObjects,a=0,u=l.length;a<u;++a)l[a].traverse(t,e);return;case r.COLLISION:case r.DEPTH:for(var n=this.clipPlanes,o=this.childNodes,a=0,u=n.length;a<u;++a)n[a].push(e);for(var a=0,u=o.length;a<u;++a)o[a].traverse(t,e);for(var a=0,u=n.length;a<u;++a)n[a].pop(e);return;case r.DISPLAY:for(var n=this.clipPlanes,h=this.localFogs,c=this.lights,o=this.childNodes,a=0,u=n.length;a<u;++a)n[a].push(e);for(var a=0,u=h.length;a<u;++a)h[a].push(e);for(var a=0,u=c.length;a<u;++a)c[a].push(e,this);for(var a=0,u=o.length;a<u;++a)o[a].traverse(t,e);for(var a=0,u=c.length;a<u;++a)c[a].pop(e);for(var a=0,u=h.length;a<u;++a)h[a].pop(e);for(var a=0,u=n.length;a<u;++a)n[a].pop(e);return}}}),l}),define("standard/Math/Utility/MatrixStack",["jquery"],function(t){"use strict";function e(e){return t.extend([new e],{top:0,set:function(t){this[this.top].assign(t)},get:function(t){return this[this.top]},push:function(){var t=++this.top;t<this.length?this[t].assign(this[t-1]):this[t]=this[t-1].copy()},pushMatrix:function(t){var e=++this.top;e<this.length?this[e].assign(t):this[e]=t.copy()},pop:function(){--this.top},clear:function(){this.top=0},size:function(){return this.top+1},identity:function(){this[this.top].identity()},multLeft:function(t){this[this.top].multLeft(t)},translate:function(t){this[this.top].translate(t)},rotate:function(t){this[this.top].rotate(t)},scale:function(t){this[this.top].scale(t)}})}return e});define("standard/Utility/ObjectCache",[],function(){"use strict";return function(t){return{stack:[],last:-1,pop:function(){if(this.last>-1){var e=this.stack[this.last];return this.last--,e}return new t},push:function(t){return this.last++,this.stack[this.last]=t},clear:function(){this.stack.length=0,this.last=-1}}}}),define("x_ite/Components/Lighting/DirectionalLight",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Utility/ObjectCache"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m){"use strict";function x(){this.direction=new c(0,0,0),this.shadowBuffer=null,this.bbox=new u,this.viewVolume=new h,this.viewport=new d(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.transformationMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new f,this.rotation=new p,this.textureUnit=0}function y(t){r.call(this,t),this.addType(a.DirectionalLight),this.global_=!1}var _=m(x);return x.prototype={constructor:x,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.transformationMatrix.assign(this.modelViewMatrix.get()).multRight(i),r=this.invLightSpaceMatrix.assign(e.getGlobal()?n:f.Identity);r.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),r.inverse();var a=o.prototype.getBBox.call(this.groupNode,this.bbox),u=a.multRight(r),h=e.getShadowMapSize(),d=this.viewport.set(0,0,h,h),p=l.orthoBox(u,this.projectionMatrix),g=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(p,d,d)),t.getProjectionMatrix().pushMatrix(p),t.getModelViewMatrix().pushMatrix(r),t.getModelViewMatrix().multLeft(g),t.render(s.DEPTH,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||r.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(r).multRight(p).multRight(e.getBiasMatrix())}catch(t){console.log(t)}},setGlobalVariables:function(t){this.modelViewMatrix.get().multDirMatrix(this.direction.assign(this.lightNode.getDirection())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e,i){var n=this.lightNode,r=n.getColor(),o=this.direction,s=n.getShadowColor();t.uniform1i(e.x3d_LightType[i],1),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightDirection[i],o.x,o.y,o.z),this.textureUnit?(t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowDiffusion[i],n.getShadowDiffusion()),t.uniform3f(e.x3d_ShadowColor[i],s.r,s.g,s.b),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):t.uniform1f(e.x3d_ShadowIntensity[i],0)},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,_.push(this)}},y.prototype=t.extend(Object.create(r.prototype),{constructor:y,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"global",new e.SFBool(!0)),new i(a.inputOutput,"on",new e.SFBool(!0)),new i(a.inputOutput,"color",new e.SFColor(1,1,1)),new i(a.inputOutput,"intensity",new e.SFFloat(1)),new i(a.inputOutput,"ambientIntensity",new e.SFFloat),new i(a.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new i(a.inputOutput,"shadowColor",new e.SFColor),new i(a.inputOutput,"shadowIntensity",new e.SFFloat),new i(a.inputOutput,"shadowDiffusion",new e.SFFloat),new i(a.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return _}}),y}),define("x_ite/Browser/Navigation/X3DNavigationContext",["x_ite/Fields","x_ite/Browser/Navigation/ExamineViewer","x_ite/Browser/Navigation/WalkViewer","x_ite/Browser/Navigation/FlyViewer","x_ite/Browser/Navigation/PlaneViewer","x_ite/Browser/Navigation/NoneViewer","x_ite/Browser/Navigation/LookAtViewer","x_ite/Components/Lighting/DirectionalLight","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){var e=new a(t.getPrivateScene());e.setup();var i=e.getLights().pop();return i.set(t,e,null,u.Identity),i.dispose=function(){},i}function h(){this.addChildObjects("availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE")),this.activeCollisions={},this.collisionCount=0,this.activeLayerNode=null,this.navigationInfoNode=null,this.viewerNode=null}return h.prototype={initialize:function(){this.viewer_.addInterest("set_viewer__",this),this.initialized().addInterest("set_world__",this),this.shutdown().addInterest("remove_world__",this),this.headlightContainer=l(this)},getHeadlight:function(){return this.headlightContainer},getActiveLayer:function(){return this.activeLayerNode},getCurrentViewer:function(){return this.viewer_.getValue()},addCollision:function(t){this.activeCollisions.hasOwnProperty(t.getId())||(this.activeCollisions[t.getId()]=!0,++this.collisionCount)},removeCollision:function(t){this.activeCollisions.hasOwnProperty(t.getId())&&(delete this.activeCollisions[t.getId()],--this.collisionCount)},getCollisionCount:function(){return this.collisionCount},remove_world__:function(){this.getWorld().activeLayer_.removeInterest("set_activeLayer__",this)},set_world__:function(){this.getWorld().activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__()},set_activeLayer__:function(){this.activeLayerNode&&this.activeLayerNode.getNavigationInfoStack().removeInterest("set_navigationInfo__",this),this.activeLayerNode=this.getWorld().getActiveLayer(),this.activeLayerNode&&this.activeLayerNode.getNavigationInfoStack().addInterest("set_navigationInfo__",this),this.set_navigationInfo__()},set_navigationInfo__:function(){if(this.navigationInfoNode&&this.navigationInfoNode.viewer_.removeFieldInterest(this.viewer_),!this.activeLayerNode)return this.navigationInfoNode=null,void(this.viewer_="NONE");this.navigationInfoNode=this.activeLayerNode.getNavigationInfo(),this.navigationInfoNode.viewer_.addFieldInterest(this.viewer_),this.viewer_=this.navigationInfoNode.viewer_},set_viewer__:function(t){switch(this.navigationInfoNode?this.availableViewers_=this.navigationInfoNode.availableViewers_:this.availableViewers_.length=0,this.viewerNode&&this.viewerNode.dispose(),t.getValue()){case"EXAMINE":this.viewerNode=new e(this);break;case"WALK":this.viewerNode=new i(this);break;case"FLY":this.viewerNode=new n(this);break;case"PLANE":case"PLANE_create3000.de":this.viewerNode=new r(this);break;case"NONE":this.viewerNode=new o(this);break;case"LOOKAT":this.viewerNode=new s(this);break;default:this.viewerNode=new e(this)}this.viewerNode.setup()}},h}),define("x_ite/Components/Layering/X3DViewportNode",["jquery","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DViewportNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Layering/Viewport",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DViewportNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(o.Viewport),this.rectangle=new l(0,0,0,0)}var c=a(u);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"clipBoundary",new e.MFFloat(0,1,0,1)),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},getRectangle:function(t){var e=t.getViewport(),i=Math.floor(e[2]*this.getLeft()),n=Math.floor(e[2]*this.getRight()),r=Math.floor(e[3]*this.getBottom()),o=Math.floor(e[3]*this.getTop());return this.rectangle.set(i,r,Math.max(0,n-i),Math.max(0,o-r)),this.rectangle},getLeft:function(){return this.clipBoundary_.length>0?this.clipBoundary_[0]:0},getRight:function(){return this.clipBoundary_.length>1?this.clipBoundary_[1]:1},getBottom:function(){return this.clipBoundary_.length>2?this.clipBoundary_[2]:0},getTop:function(){return this.clipBoundary_.length>3?this.clipBoundary_[3]:1},traverse:function(t,e){switch(this.push(e),t){case s.POINTER:e.getBrowser().isPointerInRectangle(this.rectangle)&&r.prototype.traverse.call(this,t,e);break;default:r.prototype.traverse.call(this,t,e)}this.pop(e)},push:function(t){var e=t.getViewVolumes(),i=this.getRectangle(t.getBrowser()),n=e.length?e[e.length-1].getViewport():i,r=c.pop();r.set(t.getProjectionMatrix().get(),n,i),e.push(r)},pop:function(t){c.push(t.getViewVolumes().pop())}}),h}),define("x_ite/Browser/Layering/X3DLayeringContext",["x_ite/Components/Layering/Viewport"],function(t){"use strict";function e(){this.defaultViewport=new t(this.getPrivateScene())}return e.prototype={initialize:function(){this.defaultViewport.setup()},getDefaultViewport:function(){return this.defaultViewport}},e}),define("x_ite/Components/Texturing/TextureProperties",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TextureProperties)}var a={CLAMP:"CLAMP_TO_EDGE",CLAMP_TO_EDGE:"CLAMP_TO_EDGE",CLAMP_TO_BOUNDARY:"CLAMP_TO_EDGE",MIRRORED_REPEAT:"MIRRORED_REPEAT",REPEAT:"REPEAT"},u={AVG_PIXEL_AVG_MIPMAP:"LINEAR_MIPMAP_LINEAR",AVG_PIXEL:"LINEAR",AVG_PIXEL_NEAREST_MIPMAP:"LINEAR_MIPMAP_NEAREST",NEAREST_PIXEL_AVG_MIPMAP:"NEAREST_MIPMAP_LINEAR",NEAREST_PIXEL_NEAREST_MIPMAP:"NEAREST_MIPMAP_NEAREST",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR_MIPMAP_LINEAR",FASTEST:"NEAREST"},l={AVG_PIXEL:"LINEAR",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR",FASTEST:"NEAREST"};return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"borderColor",new e.SFColorRGBA),new i(o.inputOutput,"borderWidth",new e.SFInt32),new i(o.inputOutput,"anisotropicDegree",new e.SFFloat(1)),new i(o.initializeOnly,"generateMipMaps",new e.SFBool),new i(o.inputOutput,"minificationFilter",new e.SFString("FASTEST")),new i(o.inputOutput,"magnificationFilter",new e.SFString("FASTEST")),new i(o.inputOutput,"boundaryModeS",new e.SFString("REPEAT")),new i(o.inputOutput,"boundaryModeT",new e.SFString("REPEAT")),new i(o.inputOutput,"boundaryModeR",new e.SFString("REPEAT")),new i(o.inputOutput,"textureCompression",new e.SFString("FASTEST")),new i(o.inputOutput,"texturePriority",new e.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBoundaryMode:function(t){var e=a[t];return void 0!==e?e:"REPEAT"},getBoundaryModeS:function(){return this.getBoundaryMode(this.boundaryModeS_.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this.boundaryModeT_.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this.boundaryModeR_.getValue())},getMinificationFilter:function(){if(this.generateMipMaps_.getValue()){var t=u[this.minificationFilter_.getValue()];return void 0!==t?t:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"},getMagnificationFilter:function(){var t=l[this.magnificationFilter_.getValue()];return void 0!==t?t:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}),s}),define("x_ite/Browser/Layout/X3DLayoutContext",["jquery","x_ite/Components/Texturing/TextureProperties"],function(t,e){"use strict";function i(){this.screenTextureProperties=new e(this.getPrivateScene())}return i.prototype={initialize:function(){this.screenTextureProperties.boundaryModeS_="CLAMP",this.screenTextureProperties.boundaryModeT_="CLAMP",this.screenTextureProperties.boundaryModeR_="CLAMP",this.screenTextureProperties.minificationFilter_="NEAREST",this.screenTextureProperties.magnificationFilter_="NEAREST",this.screenTextureProperties.generateMipMaps_=!1,this.screenTextureProperties.setup();var e=t("<div></div>");this.pointSize=e.appendTo(t("body")).css("height","1in").css("display","none").height()/72,e.remove()},getScreenTextureProperties:function(){return this.screenTextureProperties},getPointSize:function(){return this.pointSize}},i}),define("text!x_ite/Browser/Shaders/BackgroundSphereVertexShader.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv           = p .xyz;\n\tgl_Position = x3d_ProjectionMatrix * p;\n\tC           = x3d_Color;\n}\n"}),define("text!x_ite/Browser/Shaders/BackgroundSphereFragmentShader.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (x3d_ClipPlane [i] == x3d_NoneClipPlane)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = C;\n}\n"}),define("x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Texturing/TextureProperties","text!x_ite/Browser/Shaders/BackgroundSphereVertexShader.vs","text!x_ite/Browser/Shaders/BackgroundSphereFragmentShader.fs"],function(t,e,i,n,r){"use strict";function o(){this.backgroundTextureProperties=new i(this.getPrivateScene())}return o.prototype={initialize:function(){this.backgroundSphereShader=this.createShader(this,"BackgroundSphereShader",n,r),this.backgroundTextureProperties.boundaryModeS_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeT_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeR_="CLAMP_TO_EDGE",this.backgroundTextureProperties.minificationFilter_="NICEST",this.backgroundTextureProperties.magnificationFilter_="NICEST",this.backgroundTextureProperties.setup()},getBackgroundSphereShader:function(){return this.backgroundSphereShader},getBackgroundTextureProperties:function(){return this.backgroundTextureProperties}},o}),define("x_ite/Browser/Lighting/X3DLightingContext",["x_ite/Rendering/DepthBuffer"],function(t){"use strict";function e(){this.localLights=[],this.shadowBuffers=[]}return e.prototype={initialize:function(){},getMaxLights:function(){return 8},getLocalLights:function(){return this.localLights},popShadowBuffer:function(e){try{var i=this.shadowBuffers[e];if(i){if(i.length)return i.pop()}else this.shadowBuffers[e]=[];return new t(this,e,e)}catch(t){return console.log(t),null}},pushShadowBuffer:function(t){t&&this.shadowBuffers[t.getWidth()].push(t)}},e}),define("x_ite/Browser/Sound/X3DSoundContext",["x_ite/Fields"],function(t){"use strict";function e(){this.addChildObjects("volume",new t.SFFloat(1),"mute",new t.SFBool)}return e.prototype={initialize:function(){this.volume_.addInterest("set_volume__",this),this.mute_.addInterest("set_mute__",this);var t=this.getDataStorage()["X3DSoundContext.volume"],e=this.getDataStorage()["X3DSoundContext.mute"];void 0!==t&&(this.volume_=t),void 0!==e&&(this.mute_=e)},set_volume__:function(t){this.getDataStorage()["X3DSoundContext.volume"]=t.getValue()},set_mute__:function(t){this.getDataStorage()["X3DSoundContext.mute"]=t.getValue()}},e}),define("x_ite/Browser/Text/TextAlignment",[],function(){"use strict";var t=0,e={BEGIN:++t,FIRST:++t,MIDDLE:++t,END:++t};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("standard/Utility/Shuffle",[],function(){"use strict";return function(t){for(var e=t.length;e>1;){var i=--e,n=Math.floor(Math.random()*i),r=t[i];t[i]=t[n],t[n]=r}return t}}),define("x_ite/Components/Text/X3DFontStyleNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Browser/Text/TextAlignment","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Utility/Shuffle","standard/Networking/URI","x_ite/Browser/VERSION","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){i.call(this,t),this.addType(s.X3DFontStyleNode),this.addChildObjects("loadState",new e.SFInt32(s.NOT_STARTED_STATE)),this.familyStack=[],this.alignments=[],this.loader=new o(this)}var p=c?"latest":h,f=["http://media.create3000.de/fonts/","https://cdn.rawgit.com/create3000/x_ite/"+p+"/fonts/","https://cdn.jsdelivr.net/gh/create3000/x_ite@"+p+"/fonts/","https://rawgit.com/create3000/x_ite/"+p+"/fonts/"];u(f);var g={SERIF:{PLAIN:"DroidSerif-Regular.ttf",ITALIC:"DroidSerif-Italic.ttf",BOLD:"DroidSerif-Bold.ttf",BOLDITALIC:"DroidSerif-BoldItalic.ttf"},SANS:{PLAIN:"Ubuntu-R.ttf",ITALIC:"Ubuntu-RI.ttf",BOLD:"Ubuntu-B.ttf",BOLDITALIC:"Ubuntu-BI.ttf"},TYPEWRITER:{PLAIN:"UbuntuMono-R.ttf",ITALIC:"UbuntuMono-RI.ttf",BOLD:"UbuntuMono-B.ttf",BOLDITALIC:"UbuntuMono-BI.ttf"}};return d.prototype=t.extend(Object.create(i.prototype),{constructor:d,initialize:function(){i.prototype.initialize.call(this),this.style_.addInterest("set_style__",this),this.justify_.addInterest("set_justify__",this),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__(),this.requestAsyncLoad()},setLoadState:n.prototype.setLoadState,checkLoadState:n.prototype.checkLoadState,getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1]},set_style__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},set_justify__:function(){var t=this.horizontal_.getValue()?this.leftToRight_.getValue():this.topToBottom_.getValue();this.alignments[0]=this.justify_.length>0?this.getAlignment(0,t):t?r.BEGIN:r.END;var e=this.horizontal_.getValue()?this.topToBottom_.getValue():this.leftToRight_.getValue();this.alignments[1]=this.justify_.length>1?this.getAlignment(1,e):e?r.FIRST:r.END},getAlignment:function(t,e){if(e)switch(this.justify_[t]){case"FIRST":return r.FIRST;case"BEGIN":return r.BEGIN;case"MIDDLE":return r.MIDDLE;case"END":return r.END}else switch(this.justify_[t]){case"FIRST":case"BEGIN":return r.END;case"MIDDLE":return r.MIDDLE;case"END":return r.BEGIN}return t?r.FIRST:r.BEGIN},requestAsyncLoad:function(){if(this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE){this.setLoadState(s.IN_PROGRESS_STATE);var t=this.family_.copy();t.push("SERIF"),this.familyStack.length=0;for(var e=0,i=t.length;e<i;++e){var n=t[e],r=this.getDefaultFont(n);if(r)for(var o=0;o<f.length;++o)this.familyStack.push(f[o]+r);else this.familyStack.push(n)}this.loadNext()}},getDefaultFont:function(t){var e=g[t];if(e){var i=e[this.style_.getValue()];return i||e.PLAIN}},loadNext:function(){try{if(0===this.familyStack.length)return this.setLoadState(s.FAILED_STATE),void(this.font=null);this.family=this.familyStack.shift(),this.URL=this.loader.transform(this.family),this.getBrowser().getFont(this.URL,this.setFont.bind(this),this.setError.bind(this))}catch(t){this.setError(t.message)}},setError:function(t){this.URL.toString();"data"!==this.URL.scheme&&console.warn("Error loading font '"+this.URL.toString()+"':",t),this.loadNext()},setFont:function(t){this.font=t,this.setLoadState(s.COMPLETE_STATE),this.addNodeEvent()},getFont:function(){return this.font}}),d}),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],function(t,e){"use strict";function i(e,i){switch(arguments.length){case 0:return void(this.matrix=new t(.5,0,0,0,.5,0,0,0,0));case 2:return void(this.matrix=new t(e.x/2,0,0,0,e.y/2,0,i.x,i.y,1));case 3:var n=arguments[0],r=arguments[1],o=(r.x-n.x)/2,s=(r.y-n.y)/2,a=(r.x+n.x)/2,u=(r.y+n.y)/2;return void(this.matrix=new t(o,0,0,0,s,0,a,u,1))}}var n=new e(0,0),r=new e(0,0),o=new e(0,0),s=new e(0,0),a=new e(0,0),u=new e(0,0),l=new e(0,0),h=new e(0,0),c=new e(0,0);return i.prototype={constructor:i,copy:function(){var t=Object.create(i.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},set:function(t,e){var i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=.5,i[5]=0,i[6]=0,i[7]=0,i[8]=0,this;case 2:return i[0]=t.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=t.y/2,i[5]=0,i[6]=e.x,i[7]=e.y,i[8]=1,this}},setExtents:function(t,e){var i=this.matrix,n=(e.x-t.x)/2,r=(e.y-t.y)/2,o=(e.x+t.x)/2,s=(e.y+t.y)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=r,i[5]=0,i[6]=o,i[7]=s,i[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(t){return this.isEmpty()?this.assign(t):t.isEmpty()?this:(this.getExtents(u,l),t.getExtents(h,c),this.assign(new i(u.min(h),l.max(c),!0)))},multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(t,e){var i=this.matrix;n.set(i[0],i[1]),r.set(i[3],i[4]),a.assign(n).add(r);var o=r.subtract(n);t.assign(a).min(o),e.assign(a).max(o),a.negate(),o.negate(),t.min(a,o),e.max(a,o)},intersectsPoint:function(t){return this.getExtents(o,s),o.x<=t.x&&s.x>=t.x&&o.y<=t.y&&s.y>=t.y},toString:function(){return this.size+", "+this.center}},Object.defineProperty(i.prototype,"size",{get:function(){var t=new e(0,0);return this.getAbsoluteExtents(o,t),t.subtract(o)},enumerable:!0,configurable:!1}),Object.defineProperty(i.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),i}),define("x_ite/Browser/Text/X3DTextGeometry",["x_ite/Browser/Text/TextAlignment","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t,e){this.text=t,this.fontStyle=e,
this.glyphs=[],this.minorAlignment=new n(0,0),this.translations=[],this.charSpacings=[],this.bearing=new n(0,0),this.yPad=[],this.bbox=new i}var s={},a=new e,u=new e,l=new n(0,0),h=new n(0,0),c=new n(0,0),d=new n(0,0),p=new r(0,0,0),f=new r(0,0,0),g=new n(0,0),m=new n(0,0),x=new n(0,0),y=new n(0,0),_=new n(0,0),v=new r(0,0,0),w=new n(0,0),b=new e,S=new n(0,0),C=new r(0,0,0);return o.prototype={constructor:o,getBrowser:function(){return this.text.getBrowser()},getText:function(){return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var t=this.text,e=this.fontStyle,i=t.string_.length;if(t.lineBounds_.length=i,this.glyphs.length=0,0===i||!e.getFont())return t.origin_.setValue(C),t.textBounds_.setValue(S),void this.bbox.set();if(e.horizontal_.getValue())this.resizeArray(this.translations,i),this.resizeArray(this.charSpacings,i),this.horizontal(t,e);else{for(var n=t.string_.getValue(),r=0,o=0,s=n.length;o<s;++o)r+=n[o].length;this.resizeArray(this.translations,r),this.resizeArray(this.charSpacings,r),this.vertical(t,e)}},resizeArray:function(t,e){for(var i=t.length;i<e;++i)t.push(new n(0,0));t.length=e},horizontal:function(e,i){var n=i.getFont(),r=e.string_.getValue(),o=r.length,s=Math.max(0,e.maxExtent_.getValue()),u=i.topToBottom_.getValue(),c=i.getScale(),d=i.spacing_.getValue();a.set();for(var y=u?0:o-1,w=u?o:-1,S=u?1:-1,C=y,F=0;C!==w;C+=S,++F){var T=r[C],N=this.getHorizontalLineExtents(i,T,l,h,F);g.assign(h).subtract(l);var O=u?C:o-C-1,M=0,V=e.getLength(C);switch(_.set(g.x,0==O?h.y-n.descender/n.unitsPerEm:d).multiply(c),s&&(V=V?Math.min(s,V):Math.min(s,g.x*c)),V&&(M=(V-_.x)/(N.length-1),_.x=V,g.x=V/c),this.charSpacings[F]=M,e.lineBounds_[C]=_,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.translations[F].set(0,-F*d);break;case t.MIDDLE:this.translations[F].set(-l.x-g.x/2,-F*d);break;case t.END:this.translations[F].set(-l.x-g.x,-F*d)}this.translations[F].multiply(c),m.assign(l).add(x.assign(g).divide(2)),a.add(b.set(g.multiply(c),m.multiply(c).add(this.translations[F])))}switch(a.getExtents(l,h),g.assign(h).subtract(l),e.textBounds_=g,this.bearing.set(0,-h.y),i.getMinorAlignment()){case t.BEGIN:this.minorAlignment.assign(this.bearing);break;case t.FIRST:this.minorAlignment.set(0,0);break;case t.MIDDLE:this.minorAlignment.set(0,g.y/2-h.y);break;case t.END:this.minorAlignment.set(0,(o-1)*d*c)}l.add(this.minorAlignment),h.add(this.minorAlignment),e.origin_.setValue(v.set(l.x,h.y,0)),this.bbox.setExtents(p.set(l.x,l.y,0),f.set(h.x,h.y,0))},vertical:function(e,i){var n=i.getFont(),r=e.string_.getValue(),o=r.length,s=Math.max(0,e.maxExtent_.getValue()),d=i.leftToRight_.getValue(),S=i.topToBottom_.getValue(),C=i.getScale(),F=i.spacing_.getValue(),T=this.yPad,N=this.getBrowser().getBrowserOptions().getPrimitiveQuality();a.set();for(var O=d?0:o-1,M=d?o:-1,V=d?1:-1,D=0,B=O;B!==M;B+=V){var I=this.stringToGlyphs(n,r[B],!0,B),E=D,A=I.length;u.set();for(var P=S?0:A-1,L=S?A:-1,R=S?1:-1,k=P;k!==L;k+=R,++D){var z=I[k];this.getGlyphExtents(z,N,l,h),g.assign(h).subtract(l);var X=S?k:A-k-1;this.translations[D].set((F-g.x-l.x)/2,-X),m.assign(l).add(x.assign(g).divide(2)).add(this.translations[D]),u.add(b.set(g,m))}u.getExtents(l,h),g.assign(h).subtract(l);var j=d?B:o-B-1,U=(F-g.x)/2,G=0,q=e.getLength(B);switch(_.set(0===B?F-U:F,g.y).multiply(C),s&&(q=q?Math.min(s,q):Math.min(s,g.y*C)),q&&(G=(q-_.y)/(I.length-1)/C,_.y=q,g.y=q/C,l.y=h.y-g.y),e.lineBounds_[B]=_,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:y.set(j*F,-1);break;case t.MIDDLE:y.set(j*F,g.y/2-h.y);break;case t.END:this.getGlyphExtents(I[S?A-1:0],N,c,w),y.set(j*F,g.y-h.y+c.y)}for(var H=0,W=E;W<D;++W)this.translations[W].add(y),this.translations[W].y-=H,this.translations[W].multiply(C),H+=G;switch(i.getMajorAlignment()){case t.BEGIN:case t.FIRST:T[B]=h.y+y.y;break;case t.MIDDLE:T[B]=0;break;case t.END:T[B]=l.y+y.y}m.assign(l).add(x.assign(g).divide(2)),a.add(b.set(g.multiply(C),m.add(y).multiply(C)))}switch(a.getExtents(l,h),g.assign(h).subtract(l),i.getMajorAlignment()){case t.BEGIN:case t.FIRST:for(var Y=e.lineBounds_.getValue(),$=0,q=Y.length;$<q;++$)Y[$].y+=h.y-T[$]*C;break;case t.MIDDLE:break;case t.END:for(var Y=e.lineBounds_.getValue(),$=0,q=Y.length;$<q;++$)Y[$].y+=T[$]*C-l.y}switch(e.textBounds_=g,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.bearing.set(-l.x,h.y);break;case t.MIDDLE:this.bearing.set(-l.x,0);break;case t.END:this.bearing.set(-l.x,l.y)}switch(i.getMinorAlignment()){case t.BEGIN:case t.FIRST:this.minorAlignment.set(-l.x,0);break;case t.MIDDLE:this.minorAlignment.set(-l.x-g.x/2,0);break;case t.END:this.minorAlignment.set(-l.x-g.x,0)}l.add(this.minorAlignment),h.add(this.minorAlignment),e.origin_.setValue(v.set(l.x,h.y,0)),this.bbox.set(p.set(l.x,l.y,0),f.set(h.x,h.y,0),!0)},stringToGlyphs:function(t,e,i,n){e=e.getValue();var r=s[t.fontName],o=this.glyphs[n];r||(r=s[t.fontName]=[]),o||(o=this.glyphs[n]=[]),o.length=e.length;for(var a=i?0:e.length-1,u=i?e.length:-1,l=i?1:-1,h=a,c=0;h!==u;h+=l,++c){var d=e.charCodeAt(h),p=null;(p=r[d])||(p=t.stringToGlyphs(e[h])[0],r[d]=p,p.extents={}),o[c]=p}return o},getHorizontalLineExtents:function(e,i,n,r,o){for(var s=e.getFont(),a=e.horizontal_.getValue()?e.leftToRight_.getValue():e.topToBottom_.getValue(),u=this.stringToGlyphs(s,i,a,o),l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),h=0,p=0,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=0,x=u.length;m<x;++m){var y=u[m],_=m+1<x?s.getKerningValue(y,u[m+1]):0;this.getGlyphExtents(y,l,c,d),p+=y.advanceWidth+_,f=Math.min(f,c.y),g=Math.max(g,d.y)}switch(u.length?(this.getGlyphExtents(u[0],l,c,d),h=c.x):(f=0,g=0),n.set(h,f),r.set(p/s.unitsPerEm,g),e.getMajorAlignment()){case t.BEGIN:case t.FIRST:n.x=0}return u},traverse:function(t,e){}},o}),define("standard/Math/Geometry/Triangle2",[],function(){"use strict";return{isPointInTriangle:function(t,e,i,n){var r=(e.y-i.y)*(t.x-i.x)+(i.x-e.x)*(t.y-i.y);if(0==r)return!1;var o=((e.y-i.y)*(n.x-i.x)+(i.x-e.x)*(n.y-i.y))/r;if(o<0||o>1)return!1;var s=((i.y-t.y)*(n.x-i.x)+(t.x-i.x)*(n.y-i.y))/r;if(s<0||s>1)return!1;var a=1-o-s;return!(a<0||a>1)}}});var Bezier=function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";t.exports=i(1)},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(){function e(t,e,i,n,r){void 0===r&&(r=.5);var o=c.projectionratio(r,t),s=1-o,a={x:o*e.x+s*n.x,y:o*e.y+s*n.y},u=c.abcratio(r,t);return{A:{x:i.x+(i.x-a.x)/u,y:i.y+(i.y-a.y)/u},B:i,C:a}}var r=Math.abs,o=Math.min,s=Math.max,a=Math.acos,u=Math.sqrt,l=Math.PI,h={x:0,y:0,z:0},c=i(2),d=i(3),p=function(t){var e=t&&t.forEach?t:[].slice.call(arguments),i=!1;if("object"===n(e[0])){i=e.length;var o=[];e.forEach(function(t){["x","y","z"].forEach(function(e){void 0!==t[e]&&o.push(t[e])})}),e=o}var s=!1,a=e.length;if(i){if(i>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var u=!s&&(9===a||12===a)||t&&t[0]&&void 0!==t[0].z;this._3d=u;for(var l=[],h=0,d=u?3:2;a>h;h+=d){var p={x:e[h],y:e[h+1]};u&&(p.z=e[h+2]),l.push(p)}this.order=l.length-1,this.points=l;var f=["x","y"];u&&f.push("z"),this.dims=f,this.dimlen=f.length,function(t){for(var e=t.order,i=t.points,n=c.align(i,{p1:i[0],p2:i[e]}),o=0;o<n.length;o++)if(r(n[o].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()};p.fromSVG=function(t){var e=t.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat);return/[cq]/.test(t)?(e=e.map(function(t,i){return 2>i?t:t+e[i%2]}),new p(e)):new p(e)},p.quadraticFromPoints=function(t,i,n,r){if(void 0===r&&(r=.5),0===r)return new p(i,i,n);if(1===r)return new p(t,i,i);var o=e(2,t,i,n,r);return new p(t,o.A,n)},p.cubicFromPoints=function(t,i,n,r,o){void 0===r&&(r=.5);var s=e(3,t,i,n,r);void 0===o&&(o=c.dist(i,s.C));var a=o*(1-r)/r,u=c.dist(t,n),l=(n.x-t.x)/u,h=(n.y-t.y)/u,d=o*l,f=o*h,g=a*l,m=a*h,x={x:i.x-d,y:i.y-f},y={x:i.x+g,y:i.y+m},_=s.A,v={x:_.x+(x.x-_.x)/(1-r),y:_.y+(x.y-_.y)/(1-r)},w={x:_.x+(y.x-_.x)/r,y:_.y+(y.y-_.y)/r},b={x:t.x+(v.x-t.x)/r,y:t.y+(v.y-t.y)/r},S={x:n.x+(w.x-n.x)/(1-r),y:n.y+(w.y-n.y)/(1-r)};return new p(t,b,S,n)};var f=function(){return c};p.getUtils=f,p.prototype={getUtils:f,valueOf:function(){return this.toString()},toString:function(){return c.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,i=e[0].x,n=e[0].y,r=["M",i,n,2===this.order?"Q":"C"],o=1,s=e.length;s>o;o++)r.push(e[o].x),r.push(e[o].y);return r.join(" ")},update:function(){this.dpoints=[];for(var t=this.points,e=t.length,i=e-1;e>1;e--,i--){for(var n,r=[],o=0;i>o;o++)n={x:i*(t[o+1].x-t[o].x),y:i*(t[o+1].y-t[o].y)},this._3d&&(n.z=i*(t[o+1].z-t[o].z)),r.push(n);this.dpoints.push(r),t=r}this.computedirection()},computedirection:function(){var t=this.points,e=c.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return c.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(t=t||100,this._lut.length===t)return this._lut;this._lut=[];for(var e=0;t>=e;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var i,n=this.getLUT(),r=[],o=0,s=0;s<n.length;s++)i=n[s],c.dist(i,t)<e&&(r.push(i),o+=s/n.length);return!!r.length&&(o/=r.length)},project:function(t){var e=this.getLUT(),i=e.length-1,n=c.closest(e,t),r=n.mdist,o=n.mpos;if(0===o||o===i){var s=o/i,a=this.compute(s);return a.t=s,a.d=r,a}var u,s,l,h,d=(o-1)/i,p=(o+1)/i,f=.1/i;for(r+=1,s=d,u=s;p+f>s;s+=f)l=this.compute(s),h=c.dist(t,l),r>h&&(r=h,u=s);return l=this.compute(u),l.t=u,l.d=r,l},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){if(0===t)return this.points[0];if(1===t)return this.points[this.order];var e=this.points,i=1-t;if(1===this.order)return l={x:i*e[0].x+t*e[1].x,y:i*e[0].y+t*e[1].y},this._3d&&(l.z=i*e[0].z+t*e[1].z),l;if(this.order<4){var n,r,o,s=i*i,a=t*t,u=0;2===this.order?(e=[e[0],e[1],e[2],h],n=s,r=i*t*2,o=a):3===this.order&&(n=s*i,r=s*t*3,o=i*a*3,u=t*a);var l={x:n*e[0].x+r*e[1].x+o*e[2].x+u*e[3].x,y:n*e[0].y+r*e[1].y+o*e[2].y+u*e[3].y};return this._3d&&(l.z=n*e[0].z+r*e[1].z+o*e[2].z+u*e[3].z),l}for(var c=JSON.parse(JSON.stringify(this.points));c.length>1;){for(var d=0;d<c.length-1;d++)c[d]={x:c[d].x+(c[d+1].x-c[d].x)*t,y:c[d].y+(c[d+1].y-c[d].y)*t},void 0!==c[d].z&&(c[d]=c[d].z+(c[d+1].z-c[d].z)*t);c.splice(c.length-1,1)}return c[0]},raise:function(){for(var t,e,i,n=this.points,r=[n[0]],o=n.length,t=1;o>t;t++)e=n[t],i=n[t-1],r[t]={x:(o-t)/o*e.x+t/o*i.x,y:(o-t)/o*e.y+t/o*i.y};return r[o]=n[o-1],new p(r)},derivative:function(t){var e,i,n=1-t,r=0,o=this.dpoints[0];2===this.order&&(o=[o[0],o[1],h],e=n,i=t),3===this.order&&(e=n*n,i=n*t*2,r=t*t);var s={x:e*o[0].x+i*o[1].x+r*o[2].x,y:e*o[0].y+i*o[1].y+r*o[2].y};return this._3d&&(s.z=e*o[0].z+i*o[1].z+r*o[2].z),s},inflections:function(){return c.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),i=u(e.x*e.x+e.y*e.y);return{x:-e.y/i,y:e.x/i}},__normal3:function(t){var e=this.derivative(t),i=this.derivative(t+.01),n=u(e.x*e.x+e.y*e.y+e.z*e.z),r=u(i.x*i.x+i.y*i.y+i.z*i.z);e.x/=n,e.y/=n,e.z/=n,i.x/=r,i.y/=r,i.z/=r;var o={x:i.y*e.z-i.z*e.y,y:i.z*e.x-i.x*e.z,z:i.x*e.y-i.y*e.x},s=u(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;var a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:a[0]*e.x+a[1]*e.y+a[2]*e.z,y:a[3]*e.x+a[4]*e.y+a[5]*e.z,z:a[6]*e.x+a[7]*e.y+a[8]*e.z}},hull:function(t){var e,i=this.points,n=[],r=[],o=0,s=0,a=0;for(r[o++]=i[0],r[o++]=i[1],r[o++]=i[2],3===this.order&&(r[o++]=i[3]);i.length>1;){for(n=[],s=0,a=i.length-1;a>s;s++)e=c.lerp(t,i[s],i[s+1]),r[o++]=e,n.push(e);i=n}return r},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var i=this.hull(t),n={left:new p(2===this.order?[i[0],i[3],i[5]]:[i[0],i[4],i[7],i[9]]),right:new p(2===this.order?[i[5],i[4],i[2]]:[i[9],i[8],i[6],i[3]]),span:i};return n.left._t1=c.map(0,0,1,this._t1,this._t2),n.left._t2=c.map(t,0,1,this._t1,this._t2),n.right._t1=c.map(t,0,1,this._t1,this._t2),n.right._t2=c.map(1,0,1,this._t1,this._t2),e?(e=c.map(e,t,1,0,1),n.right.split(e).left):n},extrema:function(){var t,e,i=this.dims,n={},r=[];return i.forEach(function(i){e=function(t){return t[i]},t=this.dpoints[0].map(e),n[i]=c.droots(t),3===this.order&&(t=this.dpoints[1].map(e),n[i]=n[i].concat(c.droots(t))),n[i]=n[i].filter(function(t){return t>=0&&1>=t}),r=r.concat(n[i].sort())}.bind(this)),r=r.sort().filter(function(t,e){return r.indexOf(t)===e}),n.values=r,n},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(i){e[i]=c.getminmax(this,i,t[i])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),i=t.bbox();return c.bboxoverlap(e,i)},offset:function(t,e){if(void 0!==e){var i=this.get(t),n=this.normal(t),r={c:i,n:n,x:i.x+n.x*e,y:i.y+n.y*e};return this._3d&&(r.z=i.z+n.z*e),r}if(this._linear){var o=this.normal(0),s=this.points.map(function(e){var i={x:e.x+t*o.x,y:e.y+t*o.y};return e.z&&n.z&&(i.z=e.z+t*o.z),i});return[new p(s)]}return this.reduce().map(function(e){return e.scale(t)})},simple:function(){if(3===this.order){var t=c.angle(this.points[0],this.points[3],this.points[1]),e=c.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&0>e||0>t&&e>0)return!1}var i=this.normal(0),n=this.normal(1),o=i.x*n.x+i.y*n.y;this._3d&&(o+=i.z*n.z);var s=r(a(o));return l/3>s},reduce:function(){var t,e,i=0,n=0,o=.01,s=[],a=[],u=this.extrema().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),i=u[0],t=1;t<u.length;t++)n=u[t],e=this.split(i,n),e._t1=i,e._t2=n,s.push(e),i=n;return s.forEach(function(t){for(i=0,n=0;1>=n;)for(n=i+o;1+o>=n;n+=o)if(e=t.split(i,n),!e.simple()){if(n-=o,r(i-n)<o)return[];e=t.split(i,n),e._t1=c.map(i,0,1,t._t1,t._t2),e._t2=c.map(n,0,1,t._t1,t._t2),a.push(e),i=n;break}1>i&&(e=t.split(i,1),e._t1=c.map(i,0,1,t._t1,t._t2),e._t2=t._t2,a.push(e))}),a},scale:function(t){var e=this.order,i=!1;if("function"==typeof t&&(i=t),i&&2===e)return this.raise().scale(i);var n=this.clockwise,r=i?i(0):t,o=i?i(1):t,s=[this.offset(0,10),this.offset(1,10)],a=c.lli4(s[0],s[0].c,s[1],s[1].c);if(!a)throw new Error("cannot scale this curve. Try reducing it first.");var l=this.points,h=[];return[0,1].forEach(function(t){var i=h[t*e]=c.copy(l[t*e]);i.x+=(t?o:r)*s[t].n.x,i.y+=(t?o:r)*s[t].n.y}.bind(this)),i?([0,1].forEach(function(r){if(2!==this.order||!r){var o=l[r+1],s={x:o.x-a.x,y:o.y-a.y},c=i?i((r+1)/e):t;i&&!n&&(c=-c);var d=u(s.x*s.x+s.y*s.y);s.x/=d,s.y/=d,h[r+1]={x:o.x+c*s.x,y:o.y+c*s.y}}}.bind(this)),new p(h)):([0,1].forEach(function(t){if(2!==this.order||!t){var i=h[t*e],n=this.derivative(t),r={x:i.x+n.x,y:i.y+n.y};h[t+1]=c.lli4(i,r,a,l[t+1])}}.bind(this)),new p(h))},outline:function(t,e,i,n){function r(t,e,i,n,r){return function(o){var s=n/i,a=(n+r)/i,u=e-t;return c.map(o,0,1,t+s*u,t+a*u)}}e=void 0===e?t:e;var o,s=this.reduce(),a=s.length,u=[],l=[],h=0,p=this.length(),f=void 0!==i&&void 0!==n;s.forEach(function(o){b=o.length(),f?(u.push(o.scale(r(t,i,p,h,b))),l.push(o.scale(r(-e,-n,p,h,b)))):(u.push(o.scale(t)),l.push(o.scale(-e))),h+=b}),l=l.map(function(t){return o=t.points,o[3]?t.points=[o[3],o[2],o[1],o[0]]:t.points=[o[2],o[1],o[0]],t}).reverse();var g=u[0].points[0],m=u[a-1].points[u[a-1].points.length-1],x=l[a-1].points[l[a-1].points.length-1],y=l[0].points[0],_=c.makeline(x,g),v=c.makeline(m,y),w=[_].concat(u).concat([v]).concat(l),b=w.length;return new d(w)},outlineshapes:function(t,e,i){e=e||t;for(var n=this.outline(t,e).curves,r=[],o=1,s=n.length;s/2>o;o++){var a=c.makeshape(n[o],n[s-o],i);a.startcap.virtual=o>1,a.endcap.virtual=s/2-1>o,r.push(a)}return r},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof p&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=o(t.p1.x,t.p2.x),i=o(t.p1.y,t.p2.y),n=s(t.p1.x,t.p2.x),r=s(t.p1.y,t.p2.y),a=this;return c.roots(this.points,t).filter(function(t){var o=a.get(t);return c.between(o.x,e,n)&&c.between(o.y,i,r)})},selfintersects:function(t){var e,i,n,r,o=this.reduce(),s=o.length-2,a=[];for(e=0;s>e;e++)n=o.slice(e,e+1),r=o.slice(e+2),i=this.curveintersects(n,r,t),a=a.concat(i);return a},curveintersects:function(t,e,i){var n=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&n.push({left:t,right:e})})});var r=[];return n.forEach(function(t){var e=c.pairiteration(t.left,t.right,i);e.length>0&&(r=r.concat(e))}),r},arcs:function(t){t=t||.5;var e=[];return this._iterate(t,e)},_error:function(t,e,i,n){var o=(n-i)/4,s=this.get(i+o),a=this.get(n-o),u=c.dist(t,e),l=c.dist(t,s),h=c.dist(t,a);return r(l-u)+r(h-u)},_iterate:function(t,e){var i,n=0,r=1;do{i=0,r=1;var o,s,a,u,l,h=this.get(n),d=!1,p=!1,f=r,g=1,m=0;do{p=d,u=a,f=(n+r)/2,m++,o=this.get(f),s=this.get(r),a=c.getccenter(h,o,s),a.interval={start:n,end:r};if(d=t>=this._error(a,h,n,r),l=p&&!d,l||(g=r),d){if(r>=1){a.interval.end=g=1,u=a;break}r+=(r-n)/2}else r=f}while(!l&&i++<100);if(i>=100)break;u=u||a,e.push(u),n=g}while(1>r);return e}},t.exports=p}()},function(t,e,i){"use strict";!function(){var e=Math.abs,n=Math.cos,r=Math.sin,o=Math.acos,s=Math.atan2,a=Math.sqrt,u=Math.pow,l=function(t){return 0>t?-u(-t,1/3):u(t,1/3)},h=Math.PI,c=2*h,d=h/2,p=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,g={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var i=e(t),n=i.x*i.x+i.y*i.y;return void 0!==i.z&&(n+=i.z*i.z),a(n)},between:function(t,e,i){return t>=e&&i>=t||g.approximately(t,e)||g.approximately(t,i)},approximately:function(t,i,n){return e(t-i)<=(n||1e-6)},length:function(t){var e,i,n=0,r=g.Tvalues.length;for(e=0;r>e;e++)i=.5*g.Tvalues[e]+.5,n+=g.Cvalues[e]*g.arcfn(i,t);return.5*n},map:function(t,e,i,n,r){return n+(t-e)/(i-e)*(r-n)},lerp:function(t,e,i){var n={x:e.x+t*(i.x-e.x),y:e.y+t*(i.y-e.y)};return e.z&&i.z&&(n.z=e.z+t*(i.z-e.z)),n},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(g.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=i.x-t.x,a=i.y-t.y;return s(n*a-r*o,n*o+r*a)},round:function(t,e){var i=""+t,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(t,e){var i=t.x-e.x,n=t.y-e.y;return a(i*i+n*n)},closest:function(t,e){var i,n,r=u(2,63);return t.forEach(function(t,o){n=g.dist(e,t),r>n&&(r=n,i=o)}),{mdist:r,mpos:i}},abcratio:function(t,i){if(2!==i&&3!==i)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=u(t,i)+u(1-t,i);return e((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var i=u(1-t,e);return i/(u(t,e)+i)},lli8:function(t,e,i,n,r,o,s,a){var u=(t*n-e*i)*(r-s)-(t-i)*(r*a-o*s),l=(t*n-e*i)*(o-a)-(e-n)*(r*a-o*s),h=(t-i)*(o-a)-(e-n)*(r-s);return 0!=h&&{x:u/h,y:l/h}},lli4:function(t,e,i,n){var r=t.x,o=t.y,s=e.x,a=e.y,u=i.x,l=i.y,h=n.x,c=n.y;return g.lli8(r,o,s,a,u,l,h,c)},lli:function(t,e){return g.lli4(t,t.c,e,e.c)},makeline:function(t,e){var n=i(1),r=t.x,o=t.y,s=e.x,a=e.y,u=(s-r)/3,l=(a-o)/3;return new n(r,o,r+u,o+l,r+2*u,o+2*l,s,a)},findbbox:function(t){var e=p,i=p,n=f,r=f;return t.forEach(function(t){var o=t.bbox();e>o.x.min&&(e=o.x.min),i>o.y.min&&(i=o.y.min),n<o.x.max&&(n=o.x.max),r<o.y.max&&(r=o.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+r)/2,max:r,size:r-i}}},shapeintersections:function(t,e,i,n,r){if(!g.bboxoverlap(e,n))return[];var o=[],s=[t.startcap,t.forward,t.back,t.endcap],a=[i.startcap,i.forward,i.back,i.endcap];return s.forEach(function(e){e.virtual||a.forEach(function(n){if(!n.virtual){var s=e.intersects(n,r);s.length>0&&(s.c1=e,s.c2=n,s.s1=t,s.s2=i,o.push(s))}})}),o},makeshape:function(t,e,i){var n=e.points.length,r=t.points.length,o=g.makeline(e.points[n-1],t.points[0]),s=g.makeline(t.points[r-1],e.points[0]),a={startcap:o,forward:t,back:e,endcap:s,bbox:g.findbbox([o,t,e,s])},u=g;return a.intersections=function(t){return u.shapeintersections(a,a.bbox,t,t.bbox,i)},a},getminmax:function(t,e,i){if(!i)return{min:0,max:0};var n,r,o=p,s=f;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var a=0,u=i.length;u>a;a++)n=i[a],r=t.get(n),r[e]<o&&(o=r[e]),r[e]>s&&(s=r[e]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(t,e){var i=e.p1.x,o=e.p1.y,a=-s(e.p2.y-o,e.p2.x-i),u=function(t){return{x:(t.x-i)*n(a)-(t.y-o)*r(a),y:(t.x-i)*r(a)+(t.y-o)*n(a)}};return t.map(u)},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=t.length-1,r=g.align(t,e),s=function(t){return t>=0&&1>=t};if(2===i){var u=r[0].y,h=r[1].y,d=r[2].y,p=u-2*h+d;if(0!==p){var f=-a(h*h-u*d),m=-u+h,x=-(f+m)/p;return[x,-(-f+m)/p].filter(s)}return h!==d&&0===p?[(2*h-d)/2*(h-d)].filter(s):[]}var y,x,_,v,w,b=r[0].y,S=r[1].y,C=r[2].y,F=r[3].y,p=3*S-b-3*C+F,u=(3*b-6*S+3*C)/p,h=(-3*b+3*S)/p,d=b/p,r=(3*h-u*u)/3,T=r/3,N=(2*u*u*u-9*u*h+27*d)/27,O=N/2,M=O*O+T*T*T;if(0>M){var V=-r/3,D=V*V*V,B=a(D),I=-N/(2*B),E=-1>I?-1:I>1?1:I,A=o(E),P=l(B),L=2*P;return _=L*n(A/3)-u/3,v=L*n((A+c)/3)-u/3,w=L*n((A+2*c)/3)-u/3,[_,v,w].filter(s)}if(0===M)return y=0>O?l(-O):-l(O),_=2*y-u/3,v=-y-u/3,[_,v].filter(s);var R=a(M);return y=l(-O+R),x=l(O+R),[y-x-u/3].filter(s)},droots:function(t){if(3===t.length){var e=t[0],i=t[1],n=t[2],r=e-2*i+n;if(0!==r){var o=-a(i*i-e*n),s=-e+i;return[-(o+s)/r,-(-o+s)/r]}return i!==n&&0===r?[(2*i-n)/(2*(i-n))]:[]}if(2===t.length){var e=t[0],i=t[1];return e!==i?[e/(e-i)]:[]}},inflections:function(t){if(t.length<4)return[];var e=g.align(t,{p1:t[0],p2:t.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,r=e[1].x*e[2].y,o=e[3].x*e[2].y,s=18*(-3*i+2*n+3*r-o),a=18*(3*i-n-3*r),u=18*(r-i);if(g.approximately(s,0)){if(!g.approximately(a,0)){var l=-u/a;if(l>=0&&1>=l)return[l]}return[]}var h=a*a-4*s*u,c=Math.sqrt(h),o=2*s;return g.approximately(o,0)?[]:[(c-a)/o,-(a+c)/o].filter(function(t){return t>=0&&1>=t})},bboxoverlap:function(t,i){var n,r,o,s,a,u=["x","y"],l=u.length;for(n=0;l>n;n++)if(r=u[n],o=t[r].mid,s=i[r].mid,a=(t[r].size+i[r].size)/2,e(o-s)>=a)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,i){var n=t.bbox(),r=e.bbox(),o=1e5,s=i||.5;if(n.x.size+n.y.size<s&&r.x.size+r.y.size<s)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];var a=t.split(.5),u=e.split(.5),l=[{left:a.left,right:u.left},{left:a.left,right:u.right},{left:a.right,right:u.right},{left:a.right,right:u.left}];l=l.filter(function(t){return g.bboxoverlap(t.left.bbox(),t.right.bbox())});var h=[];return 0===l.length?h:(l.forEach(function(t){h=h.concat(g.pairiteration(t.left,t.right,s))}),h=h.filter(function(t,e){return h.indexOf(t)===e}))},getccenter:function(t,e,i){var o,a=e.x-t.x,u=e.y-t.y,l=i.x-e.x,h=i.y-e.y,p=a*n(d)-u*r(d),f=a*r(d)+u*n(d),m=l*n(d)-h*r(d),x=l*r(d)+h*n(d),y=(t.x+e.x)/2,_=(t.y+e.y)/2,v=(e.x+i.x)/2,w=(e.y+i.y)/2,b=y+p,S=_+f,C=v+m,F=w+x,T=g.lli8(y,_,b,S,v,w,C,F),N=g.dist(T,t),O=s(t.y-T.y,t.x-T.x),M=s(e.y-T.y,e.x-T.x),V=s(i.y-T.y,i.x-T.x);return V>O?((O>M||M>V)&&(O+=c),O>V&&(o=V,V=O,O=o)):M>V&&O>M?(o=V,V=O,O=o):V+=c,T.s=O,T.e=V,T.r=N,T}};t.exports=g}()},function(t,e,i){"use strict";!function(){var e=i(2),n=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};n.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(t){return e.pointsToString(t.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,i=t[0].bbox(),n=1;n<t.length;n++)e.expandbox(i,t[n].bbox());return i},offset:function(t){var e=[];return this.curves.forEach(function(i){e=e.concat(i.offset(t))}),new n(e)}},t.exports=n}()}]);define("bezier",["bezier/bezier"],function(t){return t}),define("bezier/bezier",function(){}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("earcut/dist/earcut.dev",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.earcut=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return r(i||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,o=n?e[0]*i:t.length,a=r(t,0,o,i,!0),u=[];if(!a)return u;var l,h,d,p,f,g,m;if(n&&(a=c(t,e,a,i)),t.length>80*i){l=d=t[0],h=p=t[1];for(var x=i;x<o;x+=i)f=t[x],g=t[x+1],f<l&&(l=f),g<h&&(h=g),f>d&&(d=f),g>p&&(p=g);m=Math.max(d-l,p-h)}return s(a,u,i,l,h,m),u}function r(t,e,i,n,r){var o,s;if(r===D(t,e,i,n)>0)for(o=e;o<i;o+=n)s=O(o,t[o],t[o+1],s);else for(o=i-n;o>=e;o-=n)s=O(o,t[o],t[o+1],s);return s&&b(s,s.next)&&(M(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!b(n,n.next)&&0!==w(n.prev,n,n.next))n=n.next;else{if(M(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function s(t,e,i,n,r,c,d){if(t){!d&&c&&g(t,n,r,c);for(var p,f,m=t;t.prev!==t.next;)if(p=t.prev,f=t.next,c?u(t,n,r,c):a(t))e.push(p.i/i),e.push(t.i/i),e.push(f.i/i),M(t),t=f.next,m=f.next;else if((t=f)===m){d?1===d?(t=l(t,e,i),s(t,e,i,n,r,c,2)):2===d&&h(t,e,i,n,r,c):s(o(t),e,i,n,r,c,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(w(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(_(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,i,n){var r=t.prev,o=t,s=t.next;if(w(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,u=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,h=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=x(a,u,e,i,n),d=x(l,h,e,i,n),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function l(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!b(r,o)&&S(r,n,n.next,o)&&F(r,o)&&F(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),M(n),M(n.next),n=t=o),n=n.next}while(n!==t);return n}function h(t,e,i,n,r,a){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&v(u,l)){var h=N(u,l);return u=o(u,u.next),h=o(h,h.next),s(u,e,i,n,r,a),void s(h,e,i,n,r,a)}l=l.next}u=u.next}while(u!==t)}function c(t,e,i,n){var s,a,u,l,h,c=[];for(s=0,a=e.length;s<a;s++)u=e[s]*n,l=s<a-1?e[s+1]*n:t.length,h=r(t,u,l,n,!1),h===h.next&&(h.steiner=!0),c.push(y(h));for(c.sort(d),s=0;s<c.length;s++)p(c[s],i),i=o(i,i.next);return i}function d(t,e){return t.x-e.x}function p(t,e){if(e=f(t,e)){var i=N(e,t);o(i,i.next)}}function f(t,e){var i,n=e,r=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s){if(s=a,a===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===s)return i.prev;var u,l=i,h=i.x,c=i.y,d=1/0;for(n=i.next;n!==l;)r>=n.x&&n.x>=h&&_(o<c?r:s,o,h,c,o<c?s:r,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(r-n.x))<d||u===d&&n.x>i.x)&&F(n,t)&&(i=n,d=u),n=n.next;return i}function g(t,e,i,n){var r=t;do{null===r.z&&(r.z=x(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,i,n,r,o,s,a,u,l=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,n=i,a=0,e=0;e<l&&(a++,n=n.nextZ);e++);for(u=l;a>0||u>0&&n;)0===a?(r=n,n=n.nextZ,u--):0!==u&&n?i.z<=n.z?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,u--):(r=i,i=i.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,l*=2}while(s>1);return t}function x(t,e,i,n,r){return t=32767*(t-i)/r,e=32767*(e-n)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function y(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function _(t,e,i,n,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(r-s)*(n-a)>=0}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!C(t,e)&&F(t,e)&&F(e,t)&&T(t,e)}function w(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,i,n){return!!(b(t,e)&&b(i,n)||b(t,n)&&b(i,e))||w(t,e,i)>0!=w(t,e,n)>0&&w(i,n,t)>0!=w(i,n,e)>0}function C(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&S(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function F(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function T(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function N(t,e){var i=new V(t.i,t.x,t.y),n=new V(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function O(t,e,i,n){var r=new V(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function V(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(t,e,i,n){for(var r=0,o=e,s=i-n;o<i;o+=n)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}e.exports=n,n.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,s=Math.abs(D(t,0,o,i));if(r)for(var a=0,u=e.length;a<u;a++){
var l=e[a]*i,h=a<u-1?e[a+1]*i:t.length;s-=Math.abs(D(t,l,h,i))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,p=n[a+1]*i,f=n[a+2]*i;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[r][o][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},{}]},{},[1])(1)}),define("earcut",["earcut/dist/earcut.dev"],function(t){return t}),define("x_ite/Browser/Text/PolygonText",["jquery","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Text/X3DTextGeometry","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle2","bezier","poly2tri","earcut"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t,e){i.call(this,t,e),t.transparent_=!1,this.texCoords=[]}var h=new n(0,0,0),c=new n(0,0,0),d=[],p=[],f=[];return l.prototype=t.extend(Object.create(i.prototype),{constructor:l,getMatrix:function(){return r.Identity},build:function(){var t=this.getFontStyle(),e=t.getFont();if(e){var i=this.getText(),n=this.getGlyphs(),r=this.getMinorAlignment(),o=this.getTranslations(),s=this.getCharSpacings(),a=t.getScale(),u=t.spacing_.getValue(),l=i.origin_.getValue(),d=a/e.unitsPerEm,p=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),f=this.texCoords,g=i.getNormals(),m=i.getVertices();if(f.length=0,i.getTexCoords().push(f),this.getBBox().getExtents(h,c),i.getMin().assign(h),i.getMax().assign(c),t.horizontal_.getValue())for(var x=0,y=n.length;x<y;++x)for(var _=n[x],v=s[x],w=o[x],b=0,S=0,C=_.length;S<C;++S){for(var F=_[S],T=this.getGlyphGeometry(F,p),N=0,O=T.length;N<O;++N){var M=T[N].x*a+r.x+w.x+b+S*v,V=T[N].y*a+r.y+w.y;f.push((M-l.x)/u,(V-l.y)/u,0,1),g.push(0,0,1),m.push(M,V,0,1)}var D=0;S+1<_.length&&(D=e.getKerningValue(F,_[S+1])),b+=(F.advanceWidth+D)*d}else for(var B=t.leftToRight_.getValue(),I=t.topToBottom_.getValue(),E=B?0:i.string_.length-1,A=B?i.string_.length:-1,P=B?1:-1,x=E,L=0;x!==A;x+=P)for(var _=n[x],R=_.length,k=I?0:R-1,z=I?R:-1,X=I?1:-1,S=k;S!==z;S+=X,++L)for(var w=o[L],T=this.getGlyphGeometry(_[S],p),N=0,O=T.length;N<O;++N){var M=T[N].x*a+r.x+w.x,V=T[N].y*a+r.y+w.y;f.push((M-l.x)/u,(V-l.y)/u,0,1),g.push(0,0,1),m.push(M,V,0,1)}}},getGlyphExtents:function(t,e,i,n){var r=t.extents[e];if(r)return i.assign(r.min),void n.assign(r.max);var o=this.getGlyphGeometry(t,e);if(o.length){var s=o[0];i.assign(s),n.assign(s);for(var a=1,u=o.length;a<u;++a){var s=o[a];i.min(s),n.max(s)}}else i.set(0,0,0),n.set(0,0,0);var r=t.extents[e]={};r.min=i.copy(),r.max=n.copy()},getGlyphGeometry:function(t,e){var i=this.getFontStyle(),n=i.getFont(),r=this.getBrowser().getFontGeometryCache(),o=r[n.fontName];o||(r[n.fontName]=o=[[],[],[]]);var s=o[e][t.index];return s||(s=o[e][t.index]=[],this.createGlyphGeometry(t,s,e),s)},createGlyphGeometry:function(t,e,i){var n=this.getFontStyle(),r=n.getFont(),o=t.components,s=this.getBezierDimension(i),a="cff"===r.outlinesFormat;if(d.length=0,p.length=0,f.length=0,t.isComposite)for(var u=0,l=o.length;u<l;++u){var h=o[u];d.push(r.glyphs.get(h.glyphIndex).getPath(h.dx/r.unitsPerEm,h.dy/-r.unitsPerEm,1))}else d.push(t.getPath(0,0,1));for(var c=0,g=0,m=0,x=d.length;m<x;++m)for(var y=d[m].commands,_=0,l=y.length;_<l;++_){var v=y[_];switch(v.type){case"M":case"Z":p.length>2&&(p[0].x===p[p.length-1].x&&p[0].y===p[p.length-1].y&&p.pop(),f.push(a?p.reverse():p)),p=[],"M"===v.type&&p.push({x:v.x,y:-v.y});break;case"L":p.push({x:v.x,y:-v.y});break;case"C":for(var w=new Bezier(c,-g,v.x1,-v.y1,v.x2,-v.y2,v.x,-v.y),b=w.getLUT(s),S=1,C=b.length;S<C;++S)p.push(b[S]);break;case"Q":for(var w=new Bezier(c,-g,v.x1,-v.y1,v.x,-v.y),b=w.getLUT(s),S=1,C=b.length;S<C;++S)p.push(b[S]);break;default:continue}c=v.x,g=v.y}f.map(this.removeCollinearPoints);for(var F=this.getContours(f),_=0,T=F.length;_<T;++_)this.triangulate(F[_],F[_].holes,e)},getBezierDimension:function(t){switch(t){case e.LOW:return 3;case e.HIGH:return 7;default:return 5}},removeCollinearPoints:function(t){for(var e=0,i=0,n=t.length;e<n;++e){var r=(e-1+n)%n,o=(e+1)%n;(function(t,e,i){return Math.abs((t.y-e.y)*(t.x-i.x)-(t.y-i.y)*(t.x-e.x))<1e-8})(t[r],t[e],t[o])||(t[i++]=t[e])}t.length=i},getContours:function(t){for(var e=0,i=t.length;e<i;++e)try{var n=t[e],r=new a.SweepContext(n.slice()),o=r.triangulate().getTriangles();n.holes=[];for(var s=0,u=t.length;s<u;++s)if(s!=e){var l=t[s];this.isCurveHole(o,l)&&(l.hole=!0,n.holes.push(l))}}catch(t){return console.error("X_ITE (PoylgonText.getContours): can't triangulate glyph.",t),[]}for(var h=[],e=0,i=t.length;e<i;++e){var n=t[e];n.hole||h.push(n)}return h},isCurveHole:function(t,e){for(var i=0,n=t.length;i<n;++i){var r=t[i].getPoint(0),s=t[i].getPoint(1),a=t[i].getPoint(2);if(o.isPointInTriangle(r,s,a,e[0]))return!0}return!1},triangulate:function(t,e,i){try{for(var n=new a.SweepContext(t).addHoles(e),r=n.triangulate().getTriangles(),o=0,s=r.length;o<s;++o)i.push(r[o].getPoint(0),r[o].getPoint(1),r[o].getPoint(2))}catch(n){this.earcutTriangulate(t,e,i)}},earcutTriangulate:function(t,e,i){try{for(var n=[],r=[],o=0,s=t.length;o<s;++o)n.push(t[o].x,t[o].y);for(var a=0,l=e.length;a<l;++a)for(var h=e[a],o=0,c=h.length;o<c;++o)r.push(n.length/2),n.push(h[o].x,h[o].y),t.push(h[o]);for(var d=u(n,r),p=0,f=d.length;p<f;++p)i.push(t[d[p]])}catch(t){}},display:function(t){},transformLine:function(t){},transformMatrix:function(t){}}),l}),define("x_ite/Components/Text/FontStyle",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Text/PolygonText","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.FontStyle),this.size_.setUnit("length")}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"language",new e.SFString),new i(s.initializeOnly,"family",new e.MFString("SERIF")),new i(s.initializeOnly,"style",new e.SFString("PLAIN")),new i(s.initializeOnly,"size",new e.SFFloat(1)),new i(s.initializeOnly,"spacing",new e.SFFloat(1)),new i(s.initializeOnly,"horizontal",new e.SFBool(!0)),new i(s.initializeOnly,"leftToRight",new e.SFBool(!0)),new i(s.initializeOnly,"topToBottom",new e.SFBool(!0)),new i(s.initializeOnly,"justify",new e.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(t){return new o(t,this)},getScale:function(){return this.size_.getValue()}}),a}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("lib/opentype.js/dist/opentype",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.opentype=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return r(i||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){i.argument=function(t,e){if(!t)throw new Error(e)},i.assert=i.argument},{}],2:[function(t,e,i){function n(t,e,i,n,r){t.beginPath(),t.moveTo(e,i),t.lineTo(n,r),t.stroke()}i.line=n},{}],3:[function(t,e,i){function n(t){this.font=t}function r(t){this.cmap=t}function o(t,e){this.encoding=t,this.charset=e}function s(t){var e;switch(t.version){case 1:this.names=i.standardNames.slice();break;case 2:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<i.standardNames.length?this.names[e]=i.standardNames[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-i.standardNames.length];break;case 2.5:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)this.names[e]=i.standardNames[e+t.glyphNameIndex[e]];break;case 3:this.names=[]}}function a(t){for(var e,i=t.tables.cmap.glyphIndexMap,n=Object.keys(i),r=0;r<n.length;r+=1){var o=n[r],s=i[o];e=t.glyphs.get(s),e.addUnicode(parseInt(o))}for(r=0;r<t.glyphs.length;r+=1)e=t.glyphs.get(r),t.cffEncoding?e.name=t.cffEncoding.charset[r]:e.name=t.glyphNames.glyphIndexToName(r)}var u=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],h=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],c=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];n.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),i=this.font.glyphs;if(!i)return null;for(var n=0;n<i.length;n+=1)for(var r=i.get(n),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===e)return n},r.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),i=this.encoding[e];return this.charset.indexOf(i)},s.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},s.prototype.glyphIndexToName=function(t){return this.names[t]},i.cffStandardStrings=u,i.cffStandardEncoding=l,i.cffExpertEncoding=h,i.standardNames=c,i.DefaultEncoding=n,i.CmapEncoding=r,i.CffEncoding=o,i.GlyphNames=s,i.addGlyphNames=a},{}],4:[function(t,e,i){function n(t){t=t||{},this.familyName=t.familyName||" ",this.styleName=t.styleName||" ",this.designer=t.designer||" ",this.designerURL=t.designerURL||" ",this.manufacturer=t.manufacturer||" ",this.manufacturerURL=t.manufacturerURL||" ",this.license=t.license||" ",this.licenseURL=t.licenseURL||" ",this.version=t.version||"Version 0.1",this.description=t.description||" ",this.copyright=t.copyright||" ",this.trademark=t.trademark||" ",this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.supported=!0,this.glyphs=new a.GlyphSet(this,t.glyphs||[]),this.encoding=new s.DefaultEncoding(this),this.tables={}}var r=t("./path"),o=t("./tables/sfnt"),s=t("./encoding"),a=t("./glyphset");n.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},n.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},n.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},n.prototype.stringToGlyphs=function(t){for(var e=[],i=0;i<t.length;i+=1){var n=t[i];e.push(this.charToGlyph(n))}return e},n.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},n.prototype.nameToGlyph=function(t){var e=this.nametoGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},n.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},n.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var i=this.getGposKerningValue;return i?i(t,e):this.kerningPairs[t+","+e]||0},n.prototype.forEachGlyph=function(t,e,i,n,r,o){e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:72,r=r||{};for(var s=void 0===r.kerning||r.kerning,a=1/this.unitsPerEm*n,u=this.stringToGlyphs(t),l=0;l<u.length;l+=1){var h=u[l];if(o(h,e,i,n,r),h.advanceWidth&&(e+=h.advanceWidth*a),s&&l<u.length-1){e+=this.getKerningValue(h,u[l+1])*a}}},n.prototype.getPath=function(t,e,i,n,o){var s=new r.Path;return this.forEachGlyph(t,e,i,n,o,function(t,e,i,n){var r=t.getPath(e,i,n);s.extend(r)}),s},n.prototype.draw=function(t,e,i,n,r,o){this.getPath(e,i,n,r,o).draw(t)},n.prototype.drawPoints=function(t,e,i,n,r,o){this.forEachGlyph(e,i,n,r,o,function(e,i,n,r){e.drawPoints(t,i,n,r)})},n.prototype.drawMetrics=function(t,e,i,n,r,o){this.forEachGlyph(e,i,n,r,o,function(e,i,n,r){e.drawMetrics(t,i,n,r)})},n.prototype.validate=function(){function t(t,e){t||i.push(e)}function e(e){t(n[e]&&n[e].trim().length>0,"No "+e+" specified.")}var i=[],n=this;e("familyName"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),t(this.unitsPerEm>0,"No unitsPerEm specified.")},n.prototype.toTables=function(){return o.fontToTable(this)},n.prototype.toBuffer=function(){for(var t=this.toTables(),e=t.encode(),i=new ArrayBuffer(e.length),n=new Uint8Array(i),r=0;r<e.length;r++)n[r]=e[r];return i},n.prototype.download=function(){var t=this.familyName.replace(/\s/g,"")+"-"+this.styleName+".otf",e=this.toBuffer();window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,e.byteLength,function(i){i.root.getFile(t,{create:!0},function(t){t.createWriter(function(i){var n=new DataView(e),r=new Blob([n],{type:"font/opentype"});i.write(r),i.addEventListener("writeend",function(){location.href=t.toURL()},!1)})})},function(t){throw t})},i.Font=n},{"./encoding":3,"./glyphset":6,"./path":9,"./tables/sfnt":24}],5:[function(t,e,i){function n(t,e){var i=e||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof i&&(i=i()),i},set:function(t){i=t}}}function r(t){this.bindConstructorValues(t)}var o=t("./check"),s=t("./draw"),a=t("./path");r.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",n(this,t.path))},r.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},r.prototype.getPath=function(t,e,i){t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:72;for(var n=1/this.path.unitsPerEm*i,r=new a.Path,o=this.path.commands,s=0;s<o.length;s+=1){var u=o[s];"M"===u.type?r.moveTo(t+u.x*n,e+-u.y*n):"L"===u.type?r.lineTo(t+u.x*n,e+-u.y*n):"Q"===u.type?r.quadraticCurveTo(t+u.x1*n,e+-u.y1*n,t+u.x*n,e+-u.y*n):"C"===u.type?r.curveTo(t+u.x1*n,e+-u.y1*n,t+u.x2*n,e+-u.y2*n,t+u.x*n,e+-u.y*n):"Z"===u.type&&r.closePath()}return r},r.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],i=0;i<this.points.length;i+=1){var n=this.points[i];e.push(n),n.lastPointOfContour&&(t.push(e),e=[])}return o.argument(0===e.length,"There are still points left in the current contour."),t},r.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],i=[],n=0;n<t.length;n+=1){var r=t[n];"Z"!==r.type&&(e.push(r.x),i.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),i.push(r.y1)),"C"===r.type&&(e.push(r.x2),i.push(r.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,i),leftSideBearing:0};return o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},r.prototype.draw=function(t,e,i,n){this.getPath(e,i,n).draw(t)},r.prototype.drawPoints=function(t,e,i,n){function r(e,i,n,r){var o=2*Math.PI;t.beginPath();for(var s=0;s<e.length;s+=1)t.moveTo(i+e[s].x*r,n+e[s].y*r),t.arc(i+e[s].x*r,n+e[s].y*r,2,0,o,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:24;for(var o=1/this.path.unitsPerEm*n,s=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var h=u.commands[l];void 0!==h.x&&s.push({x:h.x,y:-h.y}),void 0!==h.x1&&a.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&a.push({x:h.x2,y:-h.y2})}t.fillStyle="blue",r(s,e,i,o),t.fillStyle="red",r(a,e,i,o)},r.prototype.drawMetrics=function(t,e,i,n){var r;e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:24,r=1/this.path.unitsPerEm*n,t.lineWidth=1,t.strokeStyle="black",s.line(t,e,-1e4,e,1e4),s.line(t,-1e4,i,1e4,i);var o=this.xMin||0,a=this.yMin||0,u=this.xMax||0,l=this.yMax||0,h=this.advanceWidth||0;t.strokeStyle="blue",s.line(t,e+o*r,-1e4,e+o*r,1e4),s.line(t,e+u*r,-1e4,e+u*r,1e4),s.line(t,-1e4,i+-a*r,1e4,i+-a*r),s.line(t,-1e4,i+-l*r,1e4,i+-l*r),t.strokeStyle="green",s.line(t,e+h*r,-1e4,e+h*r,1e4)},i.Glyph=r},{"./check":1,"./draw":2,"./path":9}],6:[function(t,e,i){function n(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var i=0;i<e.length;i++)this.glyphs[i]=e[i];this.length=e&&e.length||0}function r(t,e){return new a.Glyph({index:e,font:t})}function o(t,e,i,n,r,o){return function(){var s=new a.Glyph({index:e,font:t});return s.path=function(){i(s,n,r);var e=o(t.glyphs,s);return e.unitsPerEm=t.unitsPerEm,e},s}}function s(t,e,i,n){return function(){var r=new a.Glyph({index:e,font:t});return r.path=function(){var e=i(t,r,n);return e.unitsPerEm=t.unitsPerEm,e},r}}var a=t("./glyph");n.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},n.prototype.push=function(t,e){this.glyphs[t]=e,this.length++},i.GlyphSet=n,i.glyphLoader=r,i.ttfGlyphLoader=o,i.cffGlyphLoader=s},{"./glyph":5}],7:[function(t,e,i){function n(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;n+=1)i[n]=t[n];return e}function r(e,i){t("fs").readFile(e,function(t,e){if(t)return i(t.message);i(null,n(e))})}function o(t,e){var i=new XMLHttpRequest;i.open("get",t,!0),i.responseType="arraybuffer",i.onload=function(){return 200!==i.status?e("Font could not be loaded: "+i.statusText):e(null,i.response)},i.onerror=function(){return e("Font could not be loaded: error")},i.send()}function s(t){var e,i,n,r,o,s,a,u=new h.Font,c=new DataView(t,0),p=d.getFixed(c,0);if(1===p)u.outlinesFormat="truetype";else{if("OTTO"!==(p=d.getTag(c,0)))throw new Error("Unsupported OpenType version "+p);u.outlinesFormat="cff"}for(var N=d.getUShort(c,4),O=12,M=0;M<N;M+=1){var V=d.getTag(c,O),D=d.getULong(c,O+8);switch(V){case"cmap":u.tables.cmap=f.parse(c,D),u.encoding=new l.CmapEncoding(u.tables.cmap);break;case"head":u.tables.head=y.parse(c,D),u.unitsPerEm=u.tables.head.unitsPerEm,e=u.tables.head.indexToLocFormat;break;case"hhea":u.tables.hhea=_.parse(c,D),u.ascender=u.tables.hhea.ascender,u.descender=u.tables.hhea.descender,u.numberOfHMetrics=u.tables.hhea.numberOfHMetrics;break;case"hmtx":i=D;break;case"maxp":u.tables.maxp=S.parse(c,D),u.numGlyphs=u.tables.maxp.numGlyphs;break;case"name":u.tables.name=C.parse(c,D),u.familyName=u.tables.name.fontFamily,u.styleName=u.tables.name.fontSubfamily;break;case"OS/2":u.tables.os2=F.parse(c,D);break;case"post":u.tables.post=T.parse(c,D),u.glyphNames=new l.GlyphNames(u.tables.post);break;case"glyf":n=D;break;case"loca":r=D;break;case"CFF ":o=D;break;case"kern":s=D;break;case"GPOS":a=D}O+=16}if(n&&r){var B=0===e,I=b.parse(c,r,u.numGlyphs,B);u.glyphs=m.parse(c,n,I,u),v.parse(c,i,u.numberOfHMetrics,u.numGlyphs,u.glyphs),l.addGlyphNames(u)}else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");g.parse(c,o,u),l.addGlyphNames(u)}return u.kerningPairs=s?w.parse(c,s):{},a&&x.parse(c,a,u),u}function a(t,e){("undefined"==typeof window?r:o)(t,function(t,i){if(t)return e(t);var n=s(i);return e(null,n)})}function u(e){return s(n(t("fs").readFileSync(e)))}var l=t("./encoding"),h=t("./font"),c=t("./glyph"),d=t("./parse"),p=t("./path"),f=t("./tables/cmap"),g=t("./tables/cff"),m=t("./tables/glyf"),x=t("./tables/gpos"),y=t("./tables/head"),_=t("./tables/hhea"),v=t("./tables/hmtx"),w=t("./tables/kern"),b=t("./tables/loca"),S=t("./tables/maxp"),C=t("./tables/name"),F=t("./tables/os2"),T=t("./tables/post");i._parse=d,i.Font=h.Font,i.Glyph=c.Glyph,i.Path=p.Path,i.parse=s,i.load=a,i.loadSync=u},{"./encoding":3,"./font":4,"./glyph":5,"./parse":8,"./path":9,"./tables/cff":11,"./tables/cmap":12,"./tables/glyf":13,"./tables/gpos":14,"./tables/head":15,"./tables/hhea":16,"./tables/hmtx":17,"./tables/kern":18,"./tables/loca":19,"./tables/maxp":20,"./tables/name":21,"./tables/os2":22,"./tables/post":23,fs:void 0}],8:[function(t,e,i){function n(t,e){this.data=t,this.offset=e,this.relativeOffset=0}i.getByte=function(t,e){return t.getUint8(e)},i.getCard8=i.getByte,i.getUShort=function(t,e){return t.getUint16(e,!1)},i.getCard16=i.getUShort,i.getShort=function(t,e){return t.getInt16(e,!1)},i.getULong=function(t,e){return t.getUint32(e,!1)},i.getFixed=function(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535},i.getTag=function(t,e){for(var i="",n=e;n<e+4;n+=1)i+=String.fromCharCode(t.getInt8(n));return i},i.getOffset=function(t,e,i){for(var n=0,r=0;r<i;r+=1)n<<=8,n+=t.getUint8(e+r);return n},i.getBytes=function(t,e,i){for(var n=[],r=e;r<i;r+=1)n.push(t.getUint8(r));return n},i.bytesToString=function(t){for(var e="",i=0;i<t.length;i+=1)e+=String.fromCharCode(t[i]);return e};var r={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};n.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseCard8=n.prototype.parseByte,n.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseCard16=n.prototype.parseUShort,n.prototype.parseSID=n.prototype.parseUShort,n.prototype.parseOffset16=n.prototype.parseUShort,n.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},n.prototype.parseULong=function(){var t=i.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},
n.prototype.parseFixed=function(){var t=i.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},n.prototype.parseOffset16List=n.prototype.parseUShortList=function(t){for(var e=new Array(t),n=this.data,r=this.offset+this.relativeOffset,o=0;o<t;o++)e[o]=i.getUShort(n,r),r+=2;return this.relativeOffset+=2*t,e},n.prototype.parseString=function(t){var e=this.data,i=this.offset+this.relativeOffset,n="";this.relativeOffset+=t;for(var r=0;r<t;r++)n+=String.fromCharCode(e.getUint8(i+r));return n},n.prototype.parseTag=function(){return this.parseString(4)},n.prototype.parseLongDateTime=function(){var t=i.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,t},n.prototype.parseFixed=function(){var t=i.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t/65536},n.prototype.parseVersion=function(){var t=i.getUShort(this.data,this.offset+this.relativeOffset),e=i.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},n.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=r[t]*e},i.Parser=n},{}],9:[function(t,e,i){function n(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}n.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},n.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},n.prototype.curveTo=n.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.commands.push({type:"C",x1:t,y1:e,x2:i,y2:n,x:r,y:o})},n.prototype.quadTo=n.prototype.quadraticCurveTo=function(t,e,i,n){this.commands.push({type:"Q",x1:t,y1:e,x:i,y:n})},n.prototype.close=n.prototype.closePath=function(){this.commands.push({type:"Z"})},n.prototype.extend=function(t){t.commands&&(t=t.commands),Array.prototype.push.apply(this.commands,t)},n.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var i=this.commands[e];"M"===i.type?t.moveTo(i.x,i.y):"L"===i.type?t.lineTo(i.x,i.y):"C"===i.type?t.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?t.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},n.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function i(){for(var t="",i=0;i<arguments.length;i+=1){var n=arguments[i];n>=0&&i>0&&(t+=" "),t+=e(n)}return t}t=void 0!==t?t:2;for(var n="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];"M"===o.type?n+="M"+i(o.x,o.y):"L"===o.type?n+="L"+i(o.x,o.y):"C"===o.type?n+="C"+i(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?n+="Q"+i(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(n+="Z")}return n},n.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},i.Path=n},{}],10:[function(t,e,i){function n(t,e,i){var n;for(n=0;n<e.length;n+=1){var r=e[n];this[r.name]=r.value}if(this.tableName=t,this.fields=e,i){var o=Object.keys(i);for(n=0;n<o.length;n+=1){var s=o[n],a=i[s];void 0!==this[s]&&(this[s]=a)}}}var r=t("./check"),o=t("./types").encode,s=t("./types").sizeOf;n.prototype.sizeOf=function(){for(var t=0,e=0;e<this.fields.length;e+=1){var i=this.fields[e],n=this[i.name];if(void 0===n&&(n=i.value),"function"==typeof n.sizeOf)t+=n.sizeOf();else{var o=s[i.type];r.assert("function"==typeof o,"Could not find sizeOf function for field"+i.name),t+=o(n)}}return t},n.prototype.encode=function(){return o.TABLE(this)},i.Table=n},{"./check":1,"./types":25}],11:[function(t,e,i){function n(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i+=1)if(!n(t[i],e[i]))return!1;return!0}return!1}function r(t,e,i){var n,r,o,s=[],a=[],u=A.getCard16(t,e);if(0!==u){var l=A.getByte(t,e+2);r=e+(u+1)*l+2;var h=e+3;for(n=0;n<u+1;n+=1)s.push(A.getOffset(t,h,l)),h+=l;o=r+s[u]}else o=e+2;for(n=0;n<s.length-1;n+=1){var c=A.getBytes(t,r+s[n],r+s[n+1]);i&&(c=i(c)),a.push(c)}return{objects:a,startOffset:e,endOffset:o}}function o(t){for(var e="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var n=t.parseByte(),r=n>>4,o=15&n;if(15===r)break;if(e+=i[r],15===o)break;e+=i[o]}return parseFloat(e)}function s(t,e){var i,n,r,s;if(28===e)return i=t.parseByte(),n=t.parseByte(),i<<8|n;if(29===e)return i=t.parseByte(),n=t.parseByte(),r=t.parseByte(),s=t.parseByte(),i<<24|n<<16|r<<8|s;if(30===e)return o(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return i=t.parseByte(),256*(e-247)+i+108;if(e>=251&&e<=254)return i=t.parseByte(),256*-(e-251)-i-108;throw new Error("Invalid b0 "+e)}function a(t){for(var e={},i=0;i<t.length;i+=1){var n,r=t[i][0],o=t[i][1];if(n=1===o.length?o[0]:o,e.hasOwnProperty(r))throw new Error("Object "+e+" already has key "+r);e[r]=n}return e}function u(t,e,i){e=void 0!==e?e:0;var n=new A.Parser(t,e),r=[],o=[];for(i=void 0!==i?i:t.length;n.relativeOffset<i;){var u=n.parseByte();u<=21?(12===u&&(u=1200+n.parseByte()),r.push([u,o]),o=[]):o.push(s(n,u))}return a(r)}function l(t,e){return e=e<=390?I.cffStandardStrings[e]:t[e-391]}function h(t,e,i){for(var n={},r=0;r<e.length;r+=1){var o=e[r],s=t[o.op];void 0===s&&(s=void 0!==o.value?o.value:null),"SID"===o.type&&(s=l(i,s)),n[o.name]=s}return n}function c(t,e){var i={};return i.formatMajor=A.getCard8(t,e),i.formatMinor=A.getCard8(t,e+1),i.size=A.getCard8(t,e+2),i.offsetSize=A.getCard8(t,e+3),i.startOffset=e,i.endOffset=e+4,i}function d(t,e){return h(u(t,0,t.byteLength),R,e)}function p(t,e,i,n){return h(u(t,e,i),k,n)}function f(t,e,i,n){var r,o,s,a=new A.Parser(t,e);i-=1;var u=[".notdef"],h=a.parseCard8();if(0===h)for(r=0;r<i;r+=1)o=a.parseSID(),u.push(l(n,o));else if(1===h)for(;u.length<=i;)for(o=a.parseSID(),s=a.parseCard8(),r=0;r<=s;r+=1)u.push(l(n,o)),o+=1;else{if(2!==h)throw new Error("Unknown charset format "+h);for(;u.length<=i;)for(o=a.parseSID(),s=a.parseCard16(),r=0;r<=s;r+=1)u.push(l(n,o)),o+=1}return u}function g(t,e,i){var n,r,o={},s=new A.Parser(t,e),a=s.parseCard8();if(0===a){var u=s.parseCard8();for(n=0;n<u;n+=1)r=s.parseCard8(),o[r]=n}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();for(r=1,n=0;n<l;n+=1)for(var h=s.parseCard8(),c=s.parseCard8(),d=h;d<=h+c;d+=1)o[d]=r,r+=1}return new I.CffEncoding(o,i)}function m(t,e,i){function n(t,e){g&&h.closePath(),h.moveTo(t,e),g=!0}function r(){var e;e=c.length%2!=0,e&&!p&&(f=c.shift()+t.nominalWidthX),d+=c.length>>1,c.length=0,p=!0}function o(i){for(var y,_,v,w,b,S,C,F,T,N,O,M,V=0;V<i.length;){var D=i[V];switch(V+=1,D){case 1:case 3:r();break;case 4:c.length>1&&!p&&(f=c.shift()+t.nominalWidthX,p=!0),x+=c.pop(),n(m,x);break;case 5:for(;c.length>0;)m+=c.shift(),x+=c.shift(),h.lineTo(m,x);break;case 6:for(;c.length>0&&(m+=c.shift(),h.lineTo(m,x),0!==c.length);)x+=c.shift(),h.lineTo(m,x);break;case 7:for(;c.length>0&&(x+=c.shift(),h.lineTo(m,x),0!==c.length);)m+=c.shift(),h.lineTo(m,x);break;case 8:for(;c.length>0;)s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l+c.shift(),h.curveTo(s,a,u,l,m,x);break;case 10:b=c.pop()+t.subrsBias,S=t.subrs[b],S&&o(S);break;case 11:return;case 12:switch(D=i[V],V+=1,D){case 35:s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),C=u+c.shift(),F=l+c.shift(),T=C+c.shift(),N=F+c.shift(),O=T+c.shift(),M=N+c.shift(),m=O+c.shift(),x=M+c.shift(),c.shift(),h.curveTo(s,a,u,l,C,F),h.curveTo(T,N,O,M,m,x);break;case 34:s=m+c.shift(),a=x,u=s+c.shift(),l=a+c.shift(),C=u+c.shift(),F=l,T=C+c.shift(),N=l,O=T+c.shift(),M=x,m=O+c.shift(),h.curveTo(s,a,u,l,C,F),h.curveTo(T,N,O,M,m,x);break;case 36:s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),C=u+c.shift(),F=l,T=C+c.shift(),N=l,O=T+c.shift(),M=N+c.shift(),m=O+c.shift(),h.curveTo(s,a,u,l,C,F),h.curveTo(T,N,O,M,m,x);break;case 37:s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),C=u+c.shift(),F=l+c.shift(),T=C+c.shift(),N=F+c.shift(),O=T+c.shift(),M=N+c.shift(),Math.abs(O-m)>Math.abs(M-x)?m=O+c.shift():x=M+c.shift(),h.curveTo(s,a,u,l,C,F),h.curveTo(T,N,O,M,m,x);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+D),c.length=0}break;case 14:c.length>0&&!p&&(f=c.shift()+t.nominalWidthX,p=!0),g&&(h.closePath(),g=!1);break;case 18:r();break;case 19:case 20:r(),V+=d+7>>3;break;case 21:c.length>2&&!p&&(f=c.shift()+t.nominalWidthX,p=!0),x+=c.pop(),m+=c.pop(),n(m,x);break;case 22:c.length>1&&!p&&(f=c.shift()+t.nominalWidthX,p=!0),m+=c.pop(),n(m,x);break;case 23:r();break;case 24:for(;c.length>2;)s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l+c.shift(),h.curveTo(s,a,u,l,m,x);m+=c.shift(),x+=c.shift(),h.lineTo(m,x);break;case 25:for(;c.length>6;)m+=c.shift(),x+=c.shift(),h.lineTo(m,x);s=m+c.shift(),a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l+c.shift(),h.curveTo(s,a,u,l,m,x);break;case 26:for(c.length%2&&(m+=c.shift());c.length>0;)s=m,a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u,x=l+c.shift(),h.curveTo(s,a,u,l,m,x);break;case 27:for(c.length%2&&(x+=c.shift());c.length>0;)s=m+c.shift(),a=x,u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l,h.curveTo(s,a,u,l,m,x);break;case 28:y=i[V],_=i[V+1],c.push((y<<24|_<<16)>>16),V+=2;break;case 29:b=c.pop()+t.gsubrsBias,S=t.gsubrs[b],S&&o(S);break;case 30:for(;c.length>0&&(s=m,a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l+(1===c.length?c.shift():0),h.curveTo(s,a,u,l,m,x),0!==c.length);)s=m+c.shift(),a=x,u=s+c.shift(),l=a+c.shift(),x=l+c.shift(),m=u+(1===c.length?c.shift():0),h.curveTo(s,a,u,l,m,x);break;case 31:for(;c.length>0&&(s=m+c.shift(),a=x,u=s+c.shift(),l=a+c.shift(),x=l+c.shift(),m=u+(1===c.length?c.shift():0),h.curveTo(s,a,u,l,m,x),0!==c.length);)s=m,a=x+c.shift(),u=s+c.shift(),l=a+c.shift(),m=u+c.shift(),x=l+(1===c.length?c.shift():0),h.curveTo(s,a,u,l,m,x);break;default:D<32?console.log("Glyph "+e.index+": unknown operator "+D):D<247?c.push(D-139):D<251?(y=i[V],V+=1,c.push(256*(D-247)+y+108)):D<255?(y=i[V],V+=1,c.push(256*-(D-251)-y-108)):(y=i[V],_=i[V+1],v=i[V+2],w=i[V+3],V+=4,c.push((y<<24|_<<16|v<<8|w)/65536))}}}var s,a,u,l,h=new P.Path,c=[],d=0,p=!1,f=t.defaultWidthX,g=!1,m=0,x=0;return o(i),e.advanceWidth=f,h}function x(t){return t.length<1240?107:t.length<33900?1131:32768}function y(t,e,i){i.tables.cff={};var n=c(t,e),o=r(t,n.endOffset,A.bytesToString),s=r(t,o.endOffset),a=r(t,s.endOffset,A.bytesToString),u=r(t,a.endOffset);i.gsubrs=u.objects,i.gsubrsBias=x(i.gsubrs);var l=new DataView(new Uint8Array(s.objects[0]).buffer),h=d(l,a.objects);i.tables.cff.topDict=h;var y=e+h.private[1],_=p(t,y,h.private[0],a.objects);if(i.defaultWidthX=_.defaultWidthX,i.nominalWidthX=_.nominalWidthX,0!==_.subrs){var v=y+_.subrs,w=r(t,v);i.subrs=w.objects,i.subrsBias=x(i.subrs)}else i.subrs=[],i.subrsBias=0;var b=r(t,e+h.charStrings);i.nGlyphs=b.objects.length;var S=f(t,e+h.charset,i.nGlyphs,a.objects);0===h.encoding?i.cffEncoding=new I.CffEncoding(I.cffStandardEncoding,S):1===h.encoding?i.cffEncoding=new I.CffEncoding(I.cffExpertEncoding,S):i.cffEncoding=g(t,e+h.encoding,S),i.encoding=i.encoding||i.cffEncoding,i.glyphs=new E.GlyphSet(i);for(var C=0;C<i.nGlyphs;C+=1){var F=b.objects[C];i.glyphs.push(C,E.cffGlyphLoader(i,C,m,F))}}function _(t,e){var i,n=I.cffStandardStrings.indexOf(t);return n>=0&&(i=n),n=e.indexOf(t),n>=0?i=n+I.cffStandardStrings.length:(i=I.cffStandardStrings.length+e.length,e.push(t)),i}function v(){return new L.Table("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function w(t){var e=new L.Table("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var i=0;i<t.length;i+=1)e.names.push({name:"name_"+i,type:"NAME",value:t[i]});return e}function b(t,e,i){for(var r={},o=0;o<t.length;o+=1){var s=t[o],a=e[s.name];void 0===a||n(a,s.value)||("SID"===s.type&&(a=_(a,i)),r[s.op]={name:s.name,type:s.type,value:a})}return r}function S(t,e){var i=new L.Table("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=b(R,t,e),i}function C(t){var e=new L.Table("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function F(t){var e=new L.Table("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var i=0;i<t.length;i+=1)e.strings.push({name:"string_"+i,type:"STRING",value:t[i]});return e}function T(){return new L.Table("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function N(t,e){for(var i=new L.Table("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<t.length;n+=1){var r=t[n],o=_(r,e);i.fields.push({name:"glyph_"+n,type:"SID",value:o})}return i}function O(t){var e=[],i=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var n=0,r=0,o=0;o<i.commands.length;o+=1){var s,a,u=i.commands[o];if("Q"===u.type){u={type:"C",x:u.x,y:u.y,x1:1/3*n+2/3*u.x1,y1:1/3*r+2/3*u.y1,x2:1/3*u.x+2/3*u.x1,y2:1/3*u.y+2/3*u.y1}}if("M"===u.type)s=Math.round(u.x-n),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-n),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),n=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-n),h=Math.round(u.y1-r),c=Math.round(u.x2-u.x1),d=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:h}),e.push({name:"dx2",type:"NUMBER",value:c}),e.push({name:"dy2",type:"NUMBER",value:d}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(u.x),r=Math.round(u.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function M(t){for(var e=new L.Table("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),i=0;i<t.length;i+=1){var n=t.get(i),r=O(n);e.charStrings.push({name:n.name,type:"CHARSTRING",value:r})}return e}function V(t,e){var i=new L.Table("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=b(k,t,e),i}function D(t){var e=new L.Table("Private DICT INDEX",[{name:"privateDicts",type:"INDEX",value:[]}]);return e.privateDicts=[{name:"privateDict_0",type:"TABLE",value:t}],e}function B(t,e){for(var i,n=new L.Table("CFF ",[{name:"header",type:"TABLE"},{name:"nameIndex",type:"TABLE"},{name:"topDictIndex",type:"TABLE"},{name:"stringIndex",type:"TABLE"},{name:"globalSubrIndex",type:"TABLE"},{name:"charsets",type:"TABLE"},{name:"charStringsIndex",type:"TABLE"},{name:"privateDictIndex",type:"TABLE"}]),r=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],u=1;u<t.length;u+=1)i=t.get(u),a.push(i.name);var l=[];n.header=v(),n.nameIndex=w([e.postScriptName]);var h=S(o,l);n.topDictIndex=C(h),n.globalSubrIndex=T(),n.charsets=N(a,l),n.charStringsIndex=M(t);var c=V(s,l);n.privateDictIndex=D(c),n.stringIndex=F(l);var d=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return o.charset=d,o.encoding=0,o.charStrings=o.charset+n.charsets.sizeOf(),o.private[1]=o.charStrings+n.charStringsIndex.sizeOf(),h=S(o,l),n.topDictIndex=C(h),n}var I=t("../encoding"),E=t("../glyphset"),A=t("../parse"),P=t("../path"),L=t("../table"),R=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],k=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];i.parse=y,i.make=B},{"../encoding":3,"../glyphset":6,"../parse":8,"../path":9,"../table":10}],12:[function(t,e,i){function n(t,e){var i,n={};n.version=u.getUShort(t,e),a.argument(0===n.version,"cmap table version should be 0."),n.numTables=u.getUShort(t,e+2);var r=-1;for(i=0;i<n.numTables;i+=1){var o=u.getUShort(t,e+4+8*i),s=u.getUShort(t,e+4+8*i+2);if(3===o&&(1===s||0===s)){r=u.getULong(t,e+4+8*i+4);break}}if(-1===r)return null;var l=new u.Parser(t,e+r);n.format=l.parseUShort(),a.argument(4===n.format,"Only format 4 cmap tables are supported."),n.length=l.parseUShort(),n.language=l.parseUShort();var h;n.segCount=h=l.parseUShort()>>1,l.skip("uShort",3),n.glyphIndexMap={};var c=new u.Parser(t,e+r+14),d=new u.Parser(t,e+r+16+2*h),p=new u.Parser(t,e+r+16+4*h),f=new u.Parser(t,e+r+16+6*h),g=e+r+16+8*h;for(i=0;i<h-1;i+=1)for(var m,x=c.parseUShort(),y=d.parseUShort(),_=p.parseShort(),v=f.parseUShort(),w=y;w<=x;w+=1)0!==v?(g=f.offset+f.relativeOffset-2,g+=v,g+=2*(w-y),0!==(m=u.getUShort(t,g))&&(m=m+_&65535)):m=w+_&65535,n.glyphIndexMap[w]=m;return n}function r(t,e,i){t.segments.push({end:e,start:e,delta:-(e-i),offset:0})}function o(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function s(t){var e,i=new l.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(i.segments=[],e=0;e<t.length;e+=1){for(var n=t.get(e),s=0;s<n.unicodes.length;s+=1)r(i,n.unicodes[s],e);i.segments=i.segments.sort(function(t,e){return t.start-e.start})}o(i);var a;a=i.segments.length,i.segCountX2=2*a,i.searchRange=2*Math.pow(2,Math.floor(Math.log(a)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange;var u=[],h=[],c=[],d=[],p=[];for(e=0;e<a;e+=1){var f=i.segments[e];u=u.concat({name:"end_"+e,type:"USHORT",value:f.end}),h=h.concat({name:"start_"+e,type:"USHORT",value:f.start}),c=c.concat({name:"idDelta_"+e,type:"SHORT",value:f.delta}),d=d.concat({name:"idRangeOffset_"+e,type:"USHORT",value:f.offset}),void 0!==f.glyphId&&(p=p.concat({name:"glyph_"+e,type:"USHORT",value:f.glyphId}))}return i.fields=i.fields.concat(u),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(h),i.fields=i.fields.concat(c),i.fields=i.fields.concat(d),i.fields=i.fields.concat(p),i.length=14+2*u.length+2+2*h.length+2*c.length+2*d.length+2*p.length,i}var a=t("../check"),u=t("../parse"),l=t("../table");i.parse=n,i.make=s},{"../check":1,"../parse":8,"../table":10}],13:[function(t,e,i){function n(t,e,i,n,r){var o;return(e&n)>0?(o=t.parseByte(),0==(e&r)&&(o=-o),o=i+o):o=(e&r)>0?i:i+t.parseShort(),o}function r(t,e,i){var r=new d.Parser(e,i);t.numberOfContours=r.parseShort(),t.xMin=r.parseShort(),t.yMin=r.parseShort(),t.xMax=r.parseShort(),t.yMax=r.parseShort();var o,s;if(t.numberOfContours>0){var a,u=t.endPointIndices=[];for(a=0;a<t.numberOfContours;a+=1)u.push(r.parseUShort());for(t.instructionLength=r.parseUShort(),t.instructions=[],a=0;a<t.instructionLength;a+=1)t.instructions.push(r.parseByte());var l=u[u.length-1]+1;for(o=[],a=0;a<l;a+=1)if(s=r.parseByte(),o.push(s),(8&s)>0)for(var c=r.parseByte(),p=0;p<c;p+=1)o.push(s),a+=1;if(h.argument(o.length===l,"Bad flags."),u.length>0){var f,g=[];if(l>0){for(a=0;a<l;a+=1)s=o[a],f={},f.onCurve=!!(1&s),f.lastPointOfContour=u.indexOf(a)>=0,g.push(f);var m=0;for(a=0;a<l;a+=1)s=o[a],f=g[a],f.x=n(r,s,m,2,16),m=f.x;var x=0;for(a=0;a<l;a+=1)s=o[a],f=g[a],f.y=n(r,s,x,4,32),x=f.y}t.points=g}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var y=!0;y;){o=r.parseUShort();var _={glyphIndex:r.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&o)>0?(_.dx=r.parseShort(),_.dy=r.parseShort()):(_.dx=r.parseChar(),_.dy=r.parseChar()),(8&o)>0?_.xScale=_.yScale=r.parseF2Dot14():(64&o)>0?(_.xScale=r.parseF2Dot14(),_.yScale=r.parseF2Dot14()):(128&o)>0&&(_.xScale=r.parseF2Dot14(),_.scale01=r.parseF2Dot14(),_.scale10=r.parseF2Dot14(),_.yScale=r.parseF2Dot14()),t.components.push(_),y=!!(32&o)}}}function o(t,e){for(var i=[],n=0;n<t.length;n+=1){var r=t[n],o={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};i.push(o)}return i}function s(t){for(var e=[],i=[],n=0;n<t.length;n+=1){var r=t[n];i.push(r),r.lastPointOfContour&&(e.push(i),i=[])}return h.argument(0===i.length,"There are still points left in the current contour."),e}function a(t){var e=new p.Path;if(!t)return e;for(var i=s(t),n=0;n<i.length;n+=1){var r,o,a=i[n],u=a[0],l=a[a.length-1];u.onCurve?(r=null,o=!0):(u=l.onCurve?l:{x:(u.x+l.x)/2,y:(u.y+l.y)/2},r=u,o=!1),e.moveTo(u.x,u.y);for(var h=o?1:0;h<a.length;h+=1){var c=a[h],d=0===h?u:a[h-1];if(d.onCurve&&c.onCurve)e.lineTo(c.x,c.y);else if(d.onCurve&&!c.onCurve)r=c;else if(d.onCurve||c.onCurve){if(d.onCurve||!c.onCurve)throw new Error("Invalid state.");e.quadraticCurveTo(r.x,r.y,c.x,c.y),r=null}else{var f={x:(d.x+c.x)/2,y:(d.y+c.y)/2};e.quadraticCurveTo(d.x,d.y,f.x,f.y),r=c}}u!==l&&(r?e.quadraticCurveTo(r.x,r.y,u.x,u.y):e.lineTo(u.x,u.y))}return e.closePath(),e}function u(t,e){if(e.isComposite)for(var i=0;i<e.components.length;i+=1){var n=e.components[i],r=t.get(n.glyphIndex);if(r.points){var s=o(r.points,n);e.points=e.points.concat(s)}}return a(e.points)}function l(t,e,i,n){var o,s=new c.GlyphSet(n);for(o=0;o<i.length-1;o+=1){var a=i[o];a!==i[o+1]?s.push(o,c.ttfGlyphLoader(n,o,r,t,e+a,u)):s.push(o,c.glyphLoader(n,o))}return s}var h=t("../check"),c=t("../glyphset"),d=t("../parse"),p=t("../path");i.parse=l},{"../check":1,"../glyphset":6,"../parse":8,"../path":9}],14:[function(t,e,i){function n(t,e){for(var i=new h.Parser(t,e),n=i.parseUShort(),r=[],o=0;o<n;o++)r[i.parseTag()]={offset:i.parseUShort()};return r}function r(t,e){var i=new h.Parser(t,e),n=i.parseUShort(),r=i.parseUShort();if(1===n)return i.parseUShortList(r);if(2===n){for(var o=[];r--;)for(var s=i.parseUShort(),a=i.parseUShort(),u=i.parseUShort(),l=s;l<=a;l++)o[u++]=l;return o}}function o(t,e){var i=new h.Parser(t,e),n=i.parseUShort();if(1===n){var r=i.parseUShort(),o=i.parseUShort(),s=i.parseUShortList(o);return function(t){return s[t-r]||0}}if(2===n){for(var a=i.parseUShort(),u=[],l=[],c=[],d=0;d<a;d++)u[d]=i.parseUShort(),l[d]=i.parseUShort(),c[d]=i.parseUShort();return function(t){for(var e=0,i=u.length-1;e<i;){var n=e+i+1>>1;t<u[n]?i=n-1:e=n}return u[e]<=t&&t<=l[e]?c[e]||0:0}}}function s(t,e){var i,n=new h.Parser(t,e),s=n.parseUShort(),a=n.parseUShort(),u=r(t,e+a),l=n.parseUShort(),c=n.parseUShort();if(4===l&&0===c){var d={};if(1===s){for(var p=n.parseUShort(),f=[],g=n.parseOffset16List(p),m=0;m<p;m++){var x=g[m],y=d[x];if(!y){y={},n.relativeOffset=x;for(var _=n.parseUShort();_--;){var v=n.parseUShort();l&&(i=n.parseShort()),c&&n.parseShort(),y[v]=i}}f[u[m]]=y}return function(t,e){var i=f[t];if(i)return i[e]}}if(2===s){for(var w=n.parseUShort(),b=n.parseUShort(),S=n.parseUShort(),C=n.parseUShort(),F=o(t,e+w),T=o(t,e+b),N=[],O=0;O<S;O++)for(var M=N[O]=[],V=0;V<C;V++)l&&(i=n.parseShort()),c&&n.parseShort(),M[V]=i;var D={};for(O=0;O<u.length;O++)D[u[O]]=1;return function(t,e){if(D[t]){var i=F(t),n=T(e),r=N[i];return r?r[n]:void 0}}}}}function a(t,e){var i=new h.Parser(t,e),n=i.parseUShort(),r=i.parseUShort(),o=16&r,a=i.parseUShort(),u=i.parseOffset16List(a),l={lookupType:n,lookupFlag:r,markFilteringSet:o?i.parseUShort():-1};if(2===n){for(var c=[],d=0;d<a;d++)c.push(s(t,e+u[d]));l.getKerningValue=function(t,e){for(var i=c.length;i--;){var n=c[i](t,e);if(void 0!==n)return n}return 0}}return l}function u(t,e,i){var r=new h.Parser(t,e),o=r.parseFixed();l.argument(1===o,"Unsupported GPOS table version."),n(t,e+r.parseUShort()),n(t,e+r.parseUShort());var s=r.parseUShort();r.relativeOffset=s;for(var u=r.parseUShort(),c=r.parseOffset16List(u),d=e+s,p=0;p<u;p++){var f=a(t,d+c[p]);2!==f.lookupType||i.getGposKerningValue||(i.getGposKerningValue=f.getKerningValue)}}var l=t("../check"),h=t("../parse");i.parse=u},{"../check":1,"../parse":8}],15:[function(t,e,i){function n(t,e){var i={},n=new s.Parser(t,e);return i.version=n.parseVersion(),i.fontRevision=Math.round(1e3*n.parseFixed())/1e3,i.checkSumAdjustment=n.parseULong(),i.magicNumber=n.parseULong(),o.argument(1594834165===i.magicNumber,"Font header has wrong magic number."),i.flags=n.parseUShort(),i.unitsPerEm=n.parseUShort(),i.created=n.parseLongDateTime(),i.modified=n.parseLongDateTime(),i.xMin=n.parseShort(),i.yMin=n.parseShort(),i.xMax=n.parseShort(),i.yMax=n.parseShort(),i.macStyle=n.parseUShort(),i.lowestRecPPEM=n.parseUShort(),i.fontDirectionHint=n.parseShort(),i.indexToLocFormat=n.parseShort(),i.glyphDataFormat=n.parseShort(),i}function r(t){return new a.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}var o=t("../check"),s=t("../parse"),a=t("../table");i.parse=n,i.make=r},{"../check":1,"../parse":8,"../table":10}],16:[function(t,e,i){function n(t,e){var i={},n=new o.Parser(t,e);return i.version=n.parseVersion(),i.ascender=n.parseShort(),i.descender=n.parseShort(),i.lineGap=n.parseShort(),i.advanceWidthMax=n.parseUShort(),i.minLeftSideBearing=n.parseShort(),i.minRightSideBearing=n.parseShort(),i.xMaxExtent=n.parseShort(),i.caretSlopeRise=n.parseShort(),i.caretSlopeRun=n.parseShort(),i.caretOffset=n.parseShort(),n.relativeOffset+=8,i.metricDataFormat=n.parseShort(),i.numberOfHMetrics=n.parseUShort(),i}function r(t){return new s.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}var o=t("../parse"),s=t("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],17:[function(t,e,i){function n(t,e,i,n,r){for(var s,a,u=new o.Parser(t,e),l=0;l<n;l+=1){l<i&&(s=u.parseUShort(),a=u.parseShort());var h=r.get(l);h.advanceWidth=s,h.leftSideBearing=a}}function r(t){for(var e=new s.Table("hmtx",[]),i=0;i<t.length;i+=1){var n=t.get(i),r=n.advanceWidth||0,o=n.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:o})}return e}var o=t("../parse"),s=t("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],18:[function(t,e,i){function n(t,e){var i={},n=new o.Parser(t,e),s=n.parseUShort();r.argument(0===s,"Unsupported kern table version."),n.skip("uShort",1);var a=n.parseUShort();r.argument(0===a,"Unsupported kern sub-table version."),n.skip("uShort",2);var u=n.parseUShort();n.skip("uShort",3);for(var l=0;l<u;l+=1){var h=n.parseUShort(),c=n.parseUShort(),d=n.parseShort();i[h+","+c]=d}return i}var r=t("../check"),o=t("../parse");i.parse=n},{"../check":1,"../parse":8}],19:[function(t,e,i){function n(t,e,i,n){for(var o=new r.Parser(t,e),s=n?o.parseUShort:o.parseULong,a=[],u=0;u<i+1;u+=1){var l=s.call(o);n&&(l*=2),a.push(l)}return a}var r=t("../parse");i.parse=n},{"../parse":8}],20:[function(t,e,i){function n(t,e){var i={},n=new o.Parser(t,e);return i.version=n.parseVersion(),i.numGlyphs=n.parseUShort(),1===i.version&&(i.maxPoints=n.parseUShort(),i.maxContours=n.parseUShort(),i.maxCompositePoints=n.parseUShort(),i.maxCompositeContours=n.parseUShort(),i.maxZones=n.parseUShort(),i.maxTwilightPoints=n.parseUShort(),i.maxStorage=n.parseUShort(),i.maxFunctionDefs=n.parseUShort(),i.maxInstructionDefs=n.parseUShort(),i.maxStackElements=n.parseUShort(),i.maxSizeOfInstructions=n.parseUShort(),i.maxComponentElements=n.parseUShort(),i.maxComponentDepth=n.parseUShort()),i}function r(t){return new s.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}var o=t("../parse"),s=t("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],21:[function(t,e,i){function n(t,e){var i={},n=new l.Parser(t,e);i.format=n.parseUShort();for(var r=n.parseUShort(),o=n.offset+n.parseUShort(),s=0,a=0;a<r;a++){var u=n.parseUShort(),h=n.parseUShort(),d=n.parseUShort(),p=n.parseUShort(),f=c[p],g=n.parseUShort(),m=n.parseUShort();if(3===u&&1===h&&1033===d){for(var x=[],y=g/2,_=0;_<y;_++,m+=2)x[_]=l.getShort(t,o+m);var v=String.fromCharCode.apply(null,x);f?i[f]=v:(s++,i["unknown"+s]=v)}}return 1===i.format&&(i.langTagCount=n.parseUShort()),i}function r(t,e,i,n,r,o){return new h.Table("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:i},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function o(t,e,i,n){var o=u.STRING(i);return t.records.push(r(1,0,0,e,o.length,n)),t.strings.push(o),n+=o.length}function s(t,e,i,n){var o=u.UTF16(i);return t.records.push(r(3,1,1033,e,o.length,n)),t.strings.push(o),n+=o.length}function a(t){var e=new h.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:0},{name:"stringOffset",type:"USHORT",value:0}]);e.records=[],e.strings=[];var i,n,r=0;for(i=0;i<c.length;i+=1)void 0!==t[c[i]]&&(n=t[c[i]],r=o(e,i,n,r));for(i=0;i<c.length;i+=1)void 0!==t[c[i]]&&(n=t[c[i]],r=s(e,i,n,r));for(e.count=e.records.length,e.stringOffset=6+12*e.count,i=0;i<e.records.length;i+=1)e.fields.push({name:"record_"+i,type:"TABLE",value:e.records[i]});for(i=0;i<e.strings.length;i+=1)e.fields.push({name:"string_"+i,type:"LITERAL",value:e.strings[i]});return e}
var u=t("../types").encode,l=t("../parse"),h=t("../table"),c=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","licence","licenceURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];i.parse=n,i.make=a},{"../parse":8,"../table":10,"../types":25}],22:[function(t,e,i){function n(t){for(var e=0;e<u.length;e+=1){var i=u[e];if(t>=i.begin&&t<i.end)return e}return-1}function r(t,e){var i={},n=new s.Parser(t,e);i.version=n.parseUShort(),i.xAvgCharWidth=n.parseShort(),i.usWeightClass=n.parseUShort(),i.usWidthClass=n.parseUShort(),i.fsType=n.parseUShort(),i.ySubscriptXSize=n.parseShort(),i.ySubscriptYSize=n.parseShort(),i.ySubscriptXOffset=n.parseShort(),i.ySubscriptYOffset=n.parseShort(),i.ySuperscriptXSize=n.parseShort(),i.ySuperscriptYSize=n.parseShort(),i.ySuperscriptXOffset=n.parseShort(),i.ySuperscriptYOffset=n.parseShort(),i.yStrikeoutSize=n.parseShort(),i.yStrikeoutPosition=n.parseShort(),i.sFamilyClass=n.parseShort(),i.panose=[];for(var r=0;r<10;r++)i.panose[r]=n.parseByte();return i.ulUnicodeRange1=n.parseULong(),i.ulUnicodeRange2=n.parseULong(),i.ulUnicodeRange3=n.parseULong(),i.ulUnicodeRange4=n.parseULong(),i.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),i.fsSelection=n.parseUShort(),i.usFirstCharIndex=n.parseUShort(),i.usLastCharIndex=n.parseUShort(),i.sTypoAscender=n.parseShort(),i.sTypoDescender=n.parseShort(),i.sTypoLineGap=n.parseShort(),i.usWinAscent=n.parseUShort(),i.usWinDescent=n.parseUShort(),i.version>=1&&(i.ulCodePageRange1=n.parseULong(),i.ulCodePageRange2=n.parseULong()),i.version>=2&&(i.sxHeight=n.parseShort(),i.sCapHeight=n.parseShort(),i.usDefaultChar=n.parseUShort(),i.usBreakChar=n.parseUShort(),i.usMaxContent=n.parseUShort()),i}function o(t){return new a.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}var s=t("../parse"),a=t("../table"),u=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];i.unicodeRanges=u,i.getUnicodeRange=n,i.parse=r,i.make=o},{"../parse":8,"../table":10}],23:[function(t,e,i){function n(t,e){var i,n={},r=new s.Parser(t,e);switch(n.version=r.parseVersion(),n.italicAngle=r.parseFixed(),n.underlinePosition=r.parseShort(),n.underlineThickness=r.parseShort(),n.isFixedPitch=r.parseULong(),n.minMemType42=r.parseULong(),n.maxMemType42=r.parseULong(),n.minMemType1=r.parseULong(),n.maxMemType1=r.parseULong(),n.version){case 1:n.names=o.standardNames.slice();break;case 2:for(n.numberOfGlyphs=r.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs),i=0;i<n.numberOfGlyphs;i++)n.glyphNameIndex[i]=r.parseUShort();for(n.names=[],i=0;i<n.numberOfGlyphs;i++)if(n.glyphNameIndex[i]>=o.standardNames.length){var a=r.parseChar();n.names.push(r.parseString(a))}break;case 2.5:for(n.numberOfGlyphs=r.parseUShort(),n.offset=new Array(n.numberOfGlyphs),i=0;i<n.numberOfGlyphs;i++)n.offset[i]=r.parseChar()}return n}function r(){return new a.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var o=t("../encoding"),s=t("../parse"),a=t("../table");i.parse=n,i.make=r},{"../encoding":3,"../parse":8,"../table":10}],24:[function(t,e,i){function n(t){return Math.log(t)/Math.log(2)|0}function r(t){for(;t.length%4!=0;)t.push(0);for(var e=0,i=0;i<t.length;i+=4)e+=(t[i]<<24)+(t[i+1]<<16)+(t[i+2]<<8)+t[i+3];return e%=Math.pow(2,32)}function o(t,e,i,n){return new c.Table("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==i?i:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function s(t){var e=new c.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var i=Math.pow(2,n(e.numTables));e.searchRange=16*i,e.entrySelector=n(i),e.rangeShift=16*e.numTables-e.searchRange;for(var s=[],a=[],u=e.sizeOf()+o().sizeOf()*e.numTables;u%4!=0;)u+=1,a.push({name:"padding",type:"BYTE",value:0});for(var l=0;l<t.length;l+=1){var d=t[l];h.argument(4===d.tableName.length,"Table name"+d.tableName+" is invalid.");var p=d.sizeOf(),f=o(d.tableName,r(d.encode()),u,p);for(s.push({name:f.tag+" Table Record",type:"TABLE",value:f}),a.push({name:d.tableName+" table",type:"TABLE",value:d}),u+=p,h.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!=0;)u+=1,a.push({name:"padding",type:"BYTE",value:0})}return s.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(s),e.fields=e.fields.concat(a),e}function a(t,e,i){for(var n=0;n<e.length;n+=1){var r=t.charToGlyphIndex(e[n]);if(r>0){return t.glyphs.get(r).getMetrics()}}return i}function u(t){for(var e=0,i=0;i<t.length;i+=1)e+=t[i];return e/t.length}function l(t){for(var e,i=[],n=[],o=[],l=[],h=[],c=[],w=[],b=0,S=0,C=0,F=0,T=0,N=0;N<t.glyphs.length;N+=1){var O=t.glyphs.get(N),M=0|O.unicode;(e>M||null===e)&&(e=M),b<M&&(b=M);var V=_.getUnicodeRange(M);if(V<32)S|=1<<V;else if(V<64)C|=1<<V-32;else if(V<96)F|=1<<V-64;else{if(!(V<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");T|=1<<V-96}if(".notdef"!==O.name){var D=O.getMetrics();i.push(D.xMin),n.push(D.yMin),o.push(D.xMax),l.push(D.yMax),c.push(D.leftSideBearing),w.push(D.rightSideBearing),h.push(O.advanceWidth)}}var B={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,h),advanceWidthAvg:u(h),minLeftSideBearing:Math.min.apply(null,c),maxLeftSideBearing:Math.max.apply(null,c),minRightSideBearing:Math.min.apply(null,w)};B.ascender=void 0!==t.ascender?t.ascender:B.yMax,B.descender=void 0!==t.descender?t.descender:B.yMin;var I=f.make({unitsPerEm:t.unitsPerEm,xMin:B.xMin,yMin:B.yMin,xMax:B.xMax,yMax:B.yMax}),E=g.make({ascender:B.ascender,descender:B.descender,advanceWidthMax:B.advanceWidthMax,minLeftSideBearing:B.minLeftSideBearing,minRightSideBearing:B.minRightSideBearing,xMaxExtent:B.maxLeftSideBearing+(B.xMax-B.xMin),numberOfHMetrics:t.glyphs.length}),A=x.make(t.glyphs.length),P=_.make({xAvgCharWidth:Math.round(B.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:e,usLastCharIndex:b,ulUnicodeRange1:S,ulUnicodeRange2:C,ulUnicodeRange3:F,ulUnicodeRange4:T,sTypoAscender:B.ascender,sTypoDescender:B.descender,sTypoLineGap:0,usWinAscent:B.ascender,usWinDescent:-B.descender,sxHeight:a(t,"xyvw",{yMax:0}).yMax,sCapHeight:a(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",B).yMax,usBreakChar:t.hasChar(" ")?32:0}),L=m.make(t.glyphs),R=d.make(t.glyphs),k=t.familyName+" "+t.styleName,z=t.familyName.replace(/\s/g,"")+"-"+t.styleName,X=y.make({copyright:t.copyright,fontFamily:t.familyName,fontSubfamily:t.styleName,uniqueID:t.manufacturer+":"+k,fullName:k,version:t.version,postScriptName:z,trademark:t.trademark,manufacturer:t.manufacturer,designer:t.designer,description:t.description,manufacturerURL:t.manufacturerURL,designerURL:t.designerURL,license:t.license,licenseURL:t.licenseURL,preferredFamily:t.familyName,preferredSubfamily:t.styleName}),j=v.make(),U=p.make(t.glyphs,{version:t.version,fullName:k,familyName:t.familyName,weightName:t.styleName,postScriptName:z,unitsPerEm:t.unitsPerEm}),G=[I,E,A,P,X,R,j,U,L],q=s(G),H=q.encode(),W=r(H),Y=q.fields,$=!1;for(N=0;N<Y.length;N+=1)if("head table"===Y[N].name){Y[N].value.checkSumAdjustment=2981146554-W,$=!0;break}if(!$)throw new Error("Could not find head table with checkSum to adjust.");return q}var h=t("../check"),c=t("../table"),d=t("./cmap"),p=t("./cff"),f=t("./head"),g=t("./hhea"),m=t("./hmtx"),x=t("./maxp"),y=t("./name"),_=t("./os2"),v=t("./post");i.computeCheckSum=r,i.make=s,i.fontToTable=l},{"../check":1,"../table":10,"./cff":11,"./cmap":12,"./head":15,"./hhea":16,"./hmtx":17,"./maxp":20,"./name":21,"./os2":22,"./post":23}],25:[function(t,e,i){function n(t){return function(){return t}}var r=t("./check"),o={},s={},a={};s.BYTE=function(t){return r.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},a.BYTE=n(1),s.CHAR=function(t){return[t.charCodeAt(0)]},a.CHAR=n(1),s.CHARARRAY=function(t){for(var e=[],i=0;i<t.length;i+=1)e.push(t.charCodeAt(i));return e},a.CHARARRAY=function(t){return t.length},s.USHORT=function(t){return[t>>8&255,255&t]},a.USHORT=n(2),s.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},a.SHORT=n(2),s.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},a.UINT24=n(3),s.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},a.ULONG=n(4),s.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},a.LONG=n(4),s.FIXED=s.ULONG,a.FIXED=a.ULONG,s.FWORD=s.SHORT,a.FWORD=a.SHORT,s.UFWORD=s.USHORT,a.UFWORD=a.USHORT,s.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},a.LONGDATETIME=n(8),s.TAG=function(t){return r.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},a.TAG=n(4),s.Card8=s.BYTE,a.Card8=a.BYTE,s.Card16=s.USHORT,a.Card16=a.USHORT,s.OffSize=s.BYTE,a.OffSize=a.BYTE,s.SID=s.USHORT,a.SID=a.USHORT,s.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?(t-=108,[247+(t>>8),255&t]):t>=-1131&&t<=-108?(t=-t-108,[251+(t>>8),255&t]):t>=-32768&&t<=32767?s.NUMBER16(t):s.NUMBER32(t)},a.NUMBER=function(t){return s.NUMBER(t).length},s.NUMBER16=function(t){return[28,t>>8&255,255&t]},a.NUMBER16=n(3),s.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},a.NUMBER32=n(5),s.REAL=function(t){var e=t.toString(),i=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(i){var n=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));e=(Math.round(t*n)/n).toString()}var r,o,s="";for(r=0,o=e.length;r<o;r+=1){var a=e[r];s+="e"===a?"-"===e[++r]?"c":"b":"."===a?"a":"-"===a?"e":a}s+=1&s.length?"f":"ff";var u=[30];for(r=0,o=s.length;r<o;r+=2)u.push(parseInt(s.substr(r,2),16));return u},a.REAL=function(t){return s.REAL(t).length},s.NAME=s.CHARARRAY,a.NAME=a.CHARARRAY,s.STRING=s.CHARARRAY,a.STRING=a.CHARARRAY,s.UTF16=function(t){for(var e=[],i=0;i<t.length;i+=1){var n=t.charCodeAt(i);e.push(n>>8&255),e.push(255&n)}return e},a.UTF16=function(t){return 2*t.length},s.INDEX=function(t){var e,i=1,n=[i],r=[],o=0;for(e=0;e<t.length;e+=1){var a=s.OBJECT(t[e]);Array.prototype.push.apply(r,a),o+=a.length,i+=a.length,n.push(i)}if(0===r.length)return[0,0];var u=[],l=1+Math.floor(Math.log(o)/Math.log(2))/8|0,h=[void 0,s.BYTE,s.USHORT,s.UINT24,s.ULONG][l];for(e=0;e<n.length;e+=1){var c=h(n[e]);Array.prototype.push.apply(u,c)}return Array.prototype.concat(s.Card16(t.length),s.OffSize(l),u,r)},a.INDEX=function(t){return s.INDEX(t).length},s.DICT=function(t){for(var e=[],i=Object.keys(t),n=i.length,r=0;r<n;r+=1){var o=parseInt(i[r],0),a=t[o];e=e.concat(s.OPERAND(a.value,a.type)),e=e.concat(s.OPERATOR(o))}return e},a.DICT=function(t){return s.DICT(t).length},s.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},s.OPERAND=function(t,e){var i=[];if(Array.isArray(e))for(var n=0;n<e.length;n+=1)r.argument(t.length===e.length,"Not enough arguments given for type"+e),i=i.concat(s.OPERAND(t[n],e[n]));else if("SID"===e)i=i.concat(s.NUMBER(t));else if("offset"===e)i=i.concat(s.NUMBER32(t));else if("number"===e)i=i.concat(s.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);i=i.concat(s.REAL(t))}return i},s.OP=s.BYTE,a.OP=a.BYTE;var u="function"==typeof WeakMap&&new WeakMap;s.CHARSTRING=function(t){if(u&&u.has(t))return u.get(t);for(var e=[],i=t.length,n=0;n<i;n+=1){var r=t[n];e=e.concat(s[r.type](r.value))}return u&&u.set(t,e),e},a.CHARSTRING=function(t){return s.CHARSTRING(t).length},s.OBJECT=function(t){var e=s[t.type];return r.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},a.OBJECT=function(t){var e=a[t.type];return r.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},s.TABLE=function(t){for(var e=[],i=t.fields.length,n=0;n<i;n+=1){var o=t.fields[n],a=s[o.type];r.argument(void 0!==a,"No encoding function for field type "+o.type);var u=t[o.name];void 0===u&&(u=o.value);var l=a(u);e=e.concat(l)}return e},a.TABLE=function(t){for(var e=0,i=t.fields.length,n=0;n<i;n+=1){var o=t.fields[n],s=a[o.type];r.argument(void 0!==s,"No sizeOf function for field type "+o.type);var u=t[o.name];void 0===u&&(u=o.value),e+=s(u)}return e},s.LITERAL=function(t){return t},a.LITERAL=function(t){return t.length},i.decode=o,i.encode=s,i.sizeOf=a},{"./check":1}]},{},[7])(7)}),define("x_ite/Browser/Text/X3DTextContext",["jquery","x_ite/Components/Text/FontStyle","lib/opentype.js/dist/opentype"],function(t,e,i){"use strict";function n(){this.fontCache={},this.fontGeometryCache={}}return n.prototype={initialize:function(){},getDefaultFontStyle:function(){return this.defaultFontStyle||(this.defaultFontStyle=new e(this.getPrivateScene()),this.defaultFontStyle.setup()),this.defaultFontStyle},getFont:function(e,n,r){0!==e.query.length&&r("Font url with query not supported");var o=this.fontCache[e.filename];o||(o=this.fontCache[e.filename]=t.Deferred(),i.load(e.toString(),this.setFont.bind(this,e))),o.done(n),o.fail(r)},setFont:function(t,e,i){var n=this.fontCache[t.filename];if(e)n.reject(e);else{i.fontName=i.familyName+i.styleName;for(var r=0,o=i.numGlyphs;r<o;++r)i.glyphs.get(r).getPath(0,0,1);n.resolve(i)}},getFontGeometryCache:function(){return this.fontGeometryCache}},n}),define("x_ite/Components/Texturing/X3DTextureTransformNode",["jquery","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DTextureTransformNode),this.matrix=new n,this.matrixArray=new Float32Array(this.matrix)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,setMatrix:function(t){this.matrixArray.set(t)},getMatrix:function(){return this.matrix},setShaderUniforms:function(t,e){t.uniformMatrix4fv(e.x3d_TextureMatrix,!1,this.matrixArray)}}),r}),define("x_ite/Components/Texturing/TextureTransform",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.TextureTransform),this.rotation_.setUnit("angle"),this.matrix3=new a}var l=new s(0,0);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"translation",new e.SFVec2f),new i(o.inputOutput,"rotation",new e.SFFloat),new i(o.inputOutput,"scale",new e.SFVec2f(1,1)),new i(o.inputOutput,"center",new e.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){r.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var t=this.translation_.getValue(),e=this.rotation_.getValue(),i=this.scale_.getValue(),n=this.center_.getValue(),o=this.matrix3;o.identity(),n.equals(s.Zero)||o.translate(l.assign(n).negate()),i.equals(s.One)||o.scale(i),0!==e&&o.rotate(e),n.equals(s.Zero)||o.translate(n),t.equals(s.Zero)||o.translate(t);var a=this.getMatrix();a[0]=o[0],a[1]=o[1],a[4]=o[3],a[5]=o[4],a[12]=o[6],a[13]=o[7],this.setMatrix(a)}}),u}),define("x_ite/Browser/Texturing/X3DTexturingContext",["x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/TextureCoordinate"],function(t,e,i){"use strict";function n(){this.textureUnits=[],this.combinedTextureUnits=[],this.textureStages=1,this.defaultTextureProperties=new t(this.getPrivateScene()),this.defaultTextureTransform=new e(this.getPrivateScene()),this.defaultTextureCoordinate=new i(this.getPrivateScene())}return n.prototype={initialize:function(){var t=this.getBrowser().getContext();this.defaultTextureProperties.magnificationFilter_.setValue("NICEST"),this.defaultTextureProperties.minificationFilter_.setValue("AVG_PIXEL_AVG_MIPMAP"),this.defaultTextureProperties.textureCompression_.setValue("NICEST"),this.defaultTextureProperties.generateMipMaps_.setValue(!0),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxTextureUnits=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxCombinedTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.textureMemory=NaN;for(var e=this.textureUnits,i=this.combinedTextureUnits,n=this.maxTextureUnits-1;n>=0;--n)e.push(n);for(var n=this.maxTextureUnits,r=this.maxCombinedTextureUnits;n<r;++n)i.push(n);this.defaultTextureProperties.setup(),this.defaultTextureTransform.setup(),this.defaultTextureCoordinate.setup();var o=new Uint8Array([255,255,255,255]);this.defaultTexture2D=t.createTexture(),this.defaultComposedCubeMapTexture=t.createTexture(),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_CUBE_MAP,this.defaultComposedCubeMapTexture),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),t.activeTexture(t.TEXTURE0)},getMaxTextures:function(){return 1},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this.maxTextureSize},getMaxTextureUnits:function(){return this.maxTextureUnits},getMaxCombinedTextureUnits:function(){return this.maxCombinedTextureUnits},getTextureUnits:function(){return this.textureUnits},getCombinedTextureUnits:function(){return this.combinedTextureUnits},getTextureMemory:function(){return this.textureMemory},getDefaultTextureProperties:function(){return this.defaultTextureProperties},getDefaultTextureTransform:function(){return this.defaultTextureTransform},getDefaultTextureCoordinate:function(){return this.defaultTextureCoordinate}},n}),define("x_ite/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(){this.currentPosition=new t(0,0,0)}var i=new t(0,0,0);return e.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this.currentTime},advanceTime:function(t){t=(t+performance.timing.navigationStart)/1e3;var e=t-this.currentTime;if(this.currentTime=t,this.currentFrameRate=e?1/e:0,this.getWorld()&&this.getActiveLayer()){var n=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();i.assign(this.currentPosition),this.currentPosition.set(n[12],n[13],n[14]),this.currentSpeed=i.subtract(this.currentPosition).abs()*this.currentFrameRate}else this.currentSpeed=0}},e}),define("standard/Math/Algorithms/QuickSort",[],function(){"use strict";function t(t,e){this.array=t,e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){e-t>1&&this.quicksort(t,e-1)},quicksort:function(t,e){for(var i=t,n=e,r=this.array,o=this.compare,s=r[t+e>>>1];;){for(;o(r[i],s);)++i;for(;o(s,r[n]);)--n;if(!(i<n)){i===n&&(++i,--n);break}var a=r[i];r[i]=r[n],r[n]=a,i++,n--}t<n&&this.quicksort(t,n),i<e&&this.quicksort(i,e)}},t}),define("x_ite/Components/ParticleSystems/X3DParticleEmitterNode",["jquery","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Algorithm","standard/Math/Algorithms/QuickSort"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t,e){return g.getDistanceToPoint(t)<g.getDistanceToPoint(e)}function h(t,e){return t<g.getDistanceToPoint(e)}function c(t){e.call(this,t),this.addType(i.X3DParticleEmitterNode),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.rotations=[],this.intersections=[],this.intersectionNormals=[],this.sorter=new u(this.intersections,l)}var d=new n(0,0,0),p=new n(0,0,0),f=new o(n.Zero,n.zAxis),g=new s(n.Zero,n.zAxis);return c.prototype=t.extend(Object.create(e.prototype),{constructor:c,initialize:function(){e.prototype.initialize.call(this),this.speed_.addInterest("set_speed__",this),this.variation_.addInterest("set_variation__",this),this.mass_.addInterest("set_mass__",this),this.set_speed__(),this.set_variation__(),this.set_mass__()},set_speed__:function(){this.speed=this.speed_.getValue()},set_variation__:function(){this.variation=this.variation_.getValue()},set_mass__:function(){this.mass=this.mass_.getValue()},isExplosive:function(){return!1},getMass:function(){return this.mass},getRandomLifetime:function(t,e){var i=t*e,n=Math.max(0,t-i),r=t+i;return Math.random()*(r-n)+n},getRandomSpeed:function(){var t=this.speed,e=t*this.variation,i=Math.max(0,t-e),n=t+e;return Math.random()*(n-i)+i},getSphericalRandomVelocity:function(t){return this.getRandomNormal(t).multiply(this.getRandomSpeed())},getRandomValue:function(t,e){return Math.random()*(e-t)+t},getRandomNormal:function(t){var e=this.getRandomValue(-1,1)*Math.PI,i=this.getRandomValue(-1,1),n=Math.acos(i),r=Math.sin(n);return t.set(Math.sin(e)*r,Math.cos(e)*r,i)},getRandomNormalWithAngle:function(t,e){var i=(2*Math.random()-1)*Math.PI,n=this.getRandomValue(Math.cos(t),1),r=Math.acos(n),o=Math.sin(r);return e.set(Math.sin(i)*o,Math.cos(i)*o,n)},getRandomNormalWithDirectionAndAngle:function(t,e,i){return rotation.setFromToVec(n.zAxis,t),rotation.multVecRot(this.getRandomNormalAngle(e,i))},getRandomSurfaceNormal:function(t){var e=this.getRandomValue(-1,1)*Math.PI,i=Math.pow(Math.random(),1/3),n=Math.acos(i),r=Math.sin(n);return t.set(Math.sin(e)*r,Math.cos(e)*r,i)},animate:function(t,e){for(var i=t.particles,o=t.numParticles,s=t.createParticles,a=t.particleLifetime,u=t.lifetimeVariation,l=t.speeds,h=t.velocities,c=t.turbulences,f=this.rotations,g=t.numForces,m=t.boundedVertices.length,x=t.boundedVolume,y=f.length;y<g;++y)f[y]=new r(0,0,1,0);for(var y=0;y<g;++y)f[y].setFromToVec(n.zAxis,h[y]);for(var y=0;y<o;++y){var _=i[y],v=_.elapsedTime+e;if(v>_.lifetime)_.lifetime=this.getRandomLifetime(a,u),_.elapsedTime=0,s?(this.getRandomPosition(_.position),this.getRandomVelocity(_.velocity)):_.position.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);else{for(var w=_.position,b=_.velocity,S=0;S<g;++S)b.add(f[S].multVecRot(this.getRandomNormalWithAngle(c[S],d)).multiply(l[S]));m?(p.x=w.x,p.y=w.y,p.z=w.z,w.x+=b.x*e,w.y+=b.y*e,w.z+=b.z*e,this.bounce(x,p,w,b)):(w.x+=b.x*e,w.y+=b.y*e,w.z+=b.z*e),_.elapsedTime=v}}t.colorMaterial&&this.getColors(i,t.colorKeys,t.colorRamp,o)},bounce:function(t,e,i,n){d.assign(n).normalize(),f.set(e,d);var r=this.intersections,o=this.intersectionNormals,s=t.intersectsLine(f,r,o);if(s){for(var u=0;u<s;++u)r[u].index=u;g.set(e,d),this.sorter.sort(0,s);var l=a.upperBound(r,0,s,0,h);if(l<s){var c=r[l],p=o[c.index];if(g.set(c,p),g.getDistanceToPoint(e)*g.getDistanceToPoint(i)<0){var m=2*p.dot(n);n.x-=p.x*m,n.y-=p.y*m,n.z-=p.z*m,d.assign(n).normalize();var x=c.distance(e);i.x=c.x+d.x*x,i.y=c.y+d.y*x,i.z=c.z+d.z*x}}}},getColors:function(t,e,i,n){for(var r=e.length,o=0,s=0,u=0,l=0;l<n;++l){var h=t[l],c=h.elapsedTime/h.lifetime,d=h.color;if(1==r||c<=e[0])o=0,s=0,u=0;else if(c>=e[r-1])o=r-2,s=r-1,u=1;else{var p=a.upperBound(e,0,r,c,a.less);if(p<r){s=p,o=p-1;var f=e[o],g=e[s];u=a.clamp((c-f)/(g-f),0,1)}else o=0,s=0,u=0}var m=i[o],x=i[s];d.x=m.x+u*(x.x-m.x),d.y=m.y+u*(x.y-m.y),d.z=m.z+u*(x.z-m.z),d.w=m.w+u*(x.w-m.w)}}}),c}),define("x_ite/Components/ParticleSystems/PointEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PointEmitter),this.position_.setUnit("length"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new s(0,0,0)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"position",new e.SFVec3f),new i(o.inputOutput,"direction",new e.SFVec3f(0,1,0)),new i(o.inputOutput,"speed",new e.SFFloat),new i(o.inputOutput,"variation",new e.SFFloat(.25)),new i(o.initializeOnly,"mass",new e.SFFloat),new i(o.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"PointEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.direction_.addInterest("set_direction__",this),this.set_position__(),this.set_direction__()},set_position__:function(){this.position=this.position_.getValue()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(s.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},getRandomPosition:function(t){return t.assign(this.position)},getRandomVelocity:function(t){var e=this.direction,i=this.getRandomSpeed();return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t}}),a}),define("x_ite/Browser/ParticleSystems/X3DParticleSystemsContext",["x_ite/Components/ParticleSystems/PointEmitter"],function(t){"use strict";function e(){this.defaultEmitter=new t(this.getPrivateScene())}return e.prototype={initialize:function(){this.defaultEmitter.setup()},getDefaultEmitter:function(){return this.defaultEmitter}},e}),define("x_ite/Rendering/X3DRenderObject",["jquery","x_ite/Rendering/DepthBuffer","x_ite/Bits/TraverseType","standard/Math/Algorithm","standard/Math/Algorithms/MergeSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(t,e,i,n,r,o,s,a,u,l,h,c,d){"use strict";function p(t,e){return t.distance<e.distance}function f(t){this.cameraSpaceMatrix=new d(c),this.inverseCameraSpaceMatrix=new d(c),this.projectionMatrix=new d(c),
this.modelViewMatrix=new d(c),this.viewVolumes=[],this.clipPlanes=[],this.globalLights=[],this.localLights=[],this.lights=[],this.localFogs=[],this.layouts=[],this.generatedCubeMapTextures=[],this.shaders=[],this.collisions=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.numDepthShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new r(this.transparentShapes,p),this.collisionShapes=[],this.activeCollisions={},this.depthShapes=[],this.invModelViewMatrix=new c,this.speed=0;try{this.depthBuffer=new e(t.getBrowser(),g,m)}catch(t){console.error(t),this.getDepth=function(){return 0}}}var g=16,m=g,x=new Int32Array(4),y=new c,_=new Float32Array(16),v=new c,w=new c,b=new h(0,0,1,0),S=new u(0,1,0),C=new u(0,0,1),F=new u(0,0,0),T=new h(0,0,1,0),N=new l(0,0,g,m),O=new a,M=new s(u.Zero,u.Zero),V=new u(0,0,0);return O.set(c.Identity,N,N),f.prototype={constructor:f,bboxSize:new u(0,0,0),bboxCenter:new u(0,0,0),translation:new u(0,0,0),initialize:function(){},isIndependent:function(){return!0},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getModelViewMatrix:function(){return this.modelViewMatrix},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes[this.viewVolumes.length-1]},getClipPlanes:function(){return this.clipPlanes},getGlobalLights:function(){return this.globalLights},getLocalLights:function(){return this.localLights},getLights:function(){return this.lights},setGlobalFog:function(t){this.localFog=this.localFogs[0]=t},pushLocalFog:function(t){this.localFogs.push(t),this.localFog=t},popLocalFog:function(){this.localFogs.pop(),this.localFog=this.localFogs[this.localFogs.length-1]},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.length?this.layouts[this.layouts.length-1]:null},getGeneratedCubeMapTextures:function(){return this.generatedCubeMapTextures},getShaders:function(){return this.shaders},getCollisions:function(){return this.collisions},constrainTranslation:function(t,e){var i=this.getDistance(t);if((i-=this.getNavigationInfo().getCollisionRadius())>0){return t.abs()>i?t.normalize().multiply(i):t}return e?this.constrainTranslation(t.normalize().multiply(i),!1):t.assign(u.Zero)},getDistance:function(t){try{var e=performance.now(),i=this.getViewpoint(),n=this.getNavigationInfo(),r=n.getCollisionRadius(),s=n.getStepHeight()-n.getAvatarHeight(),a=n.getNearValue(),u=n.getAvatarHeight();o.ortho(-r,r,Math.min(s,-r),r,a,Math.max(2*r,2*u),y),b.assign(i.orientation_.getValue()).inverse().multRight(i.getOrientation()),T.setFromToVec(C,F.assign(t).negate()).multRight(b),i.straightenHorizon(T),w.assign(i.getTransformationMatrix()),w.translate(i.getUserPosition()),w.rotate(T),w.inverse(),w.multRight(y),w.multLeft(i.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(w);var l=this.getDepth(y);return this.getProjectionMatrix().pop(),this.collisionTime+=performance.now()-e,-l}catch(t){console.log(t)}},getDepth:function(t){this.depthBuffer.bind(),this.viewVolumes.push(O),this.depth(this.collisionShapes,this.numCollisionShapes),this.viewVolumes.pop();var e=this.depthBuffer.getDepth(t,N);return this.depthBuffer.unbind(),e},render:function(t,e){switch(t){case i.COLLISION:this.numCollisionShapes=0,e.traverse(t,this),this.collide(),this.gravite();break;case i.DEPTH:this.numDepthShapes=0,e.traverse(t,this),this.depth(this.depthShapes,this.numDepthShapes);break;case i.DISPLAY:this.lightIndex=0,this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),e.traverse(t,this),this.draw(e)}},addCollisionShape:function(t){var e=this.getModelViewMatrix().get(),i=e.multDirMatrix(this.bboxSize.assign(t.getBBoxSize())),n=e.multVecMatrix(this.bboxCenter.assign(t.getBBoxCenter())),r=i.abs()/2,o=this.viewVolumes[this.viewVolumes.length-1];if(o.intersectsSphere(r,n)){this.numCollisionShapes===this.collisionShapes.length&&this.collisionShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});var s=this.collisionShapes[this.numCollisionShapes];++this.numCollisionShapes,s.modelViewMatrix.set(e),s.shapeNode=t,s.scissor=o.getScissor();for(var a=this.getCollisions(),u=s.collisions,l=0,h=a.length;l<h;++l)u[l]=a[l];u.length=a.length;for(var c=this.getClipPlanes(),d=s.clipPlanes,l=0,h=c.length;l<h;++l)d[l]=c[l];return d.length=c.length,!0}return!1},addDepthShape:function(t){var e=this.getModelViewMatrix().get(),i=e.multDirMatrix(this.bboxSize.assign(t.getBBoxSize())),n=e.multVecMatrix(this.bboxCenter.assign(t.getBBoxCenter())),r=i.abs()/2,o=this.viewVolumes[this.viewVolumes.length-1];if(o.intersectsSphere(r,n)){this.numDepthShapes===this.depthShapes.length&&this.depthShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),clipPlanes:[]});var s=this.depthShapes[this.numDepthShapes];++this.numDepthShapes,s.modelViewMatrix.set(e),s.shapeNode=t,s.scissor=o.getScissor();for(var a=this.getClipPlanes(),u=s.clipPlanes,l=0,h=a.length;l<h;++l)u[l]=a[l];return u.length=a.length,!0}return!1},addDisplayShape:function(t){var e=this.getModelViewMatrix().get(),i=e.multDirMatrix(this.bboxSize.assign(t.getBBoxSize())),n=e.multVecMatrix(this.bboxCenter.assign(t.getBBoxCenter())),r=i.abs()/2,o=n.z,s=this.viewVolumes[this.viewVolumes.length-1];if(s.intersectsSphere(r,n)){if(t.isTransparent()){var a=this.numTransparentShapes;a===this.transparentShapes.length&&this.transparentShapes.push(this.createShapeContext(!0));var u=this.transparentShapes[a];++this.numTransparentShapes}else{var a=this.numOpaqueShapes;a===this.opaqueShapes.length&&this.opaqueShapes.push(this.createShapeContext(!1));var u=this.opaqueShapes[a];++this.numOpaqueShapes}u.modelViewMatrix.set(e),u.scissor.assign(s.getScissor()),u.shapeNode=t,u.distance=o-r,u.fogNode=this.localFog;for(var l=this.getClipPlanes(),h=u.clipPlanes,c=0,d=l.length;c<d;++c)h[c]=l[c];h.length=l.length;for(var p=this.getLocalLights(),f=u.localLights,c=0,d=p.length;c<d;++c)f[c]=p[c];return f.length=p.length,!0}return!1},createShapeContext:function(t){return{renderer:this,transparent:!0,geometryType:3,colorMaterial:!1,modelViewMatrix:new Float32Array(16),scissor:new l(0,0,0,0),clipPlanes:[],localLights:[],linePropertiesNode:null,materialNode:null,textureNode:null,textureTransformNode:null,shaderNode:null}},collide:function(){var e={},i=2.2*this.getNavigationInfo().getCollisionRadius();V.set(i,i,i);for(var r=0,o=this.numCollisionShapes;r<o;++r)try{var s=this.collisionShapes[r],a=s.collisions;if(a.length&&(M.set(V,u.Zero),M.multRight(this.invModelViewMatrix.assign(s.modelViewMatrix).inverse()),s.shapeNode.intersectsBox(M,s.clipPlanes,v.assign(s.modelViewMatrix))))for(var l=0;l<a.length;++l)e[a[l].getId()]=a[l]}catch(t){console.log(t)}if(!t.isEmptyObject(this.activeCollisions)){var h=t.isEmptyObject(e)?this.activeCollisions:n.set_difference(this.activeCollisions,e,{});for(var c in h)h[c].set_active(!1)}this.activeCollisions=e;for(var c in e)e[c].set_active(!0)},gravite:function(){try{if(this.getBrowser().getActiveLayer()===this){if("WALK"!==this.getBrowser().getCurrentViewer())return}else if("WALK"!==this.getNavigationInfo().getViewer())return;var t=this.getNavigationInfo(),e=this.getViewpoint(),i=t.getCollisionRadius(),n=t.getNearValue(),r=t.getAvatarHeight(),s=t.getStepHeight();o.ortho(-i,i,-i,i,n,Math.max(2*i,2*r),y);var a=e.getUpVector(),u=T.setFromToVec(C,a);w.assign(e.getTransformationMatrix()),w.translate(e.getUserPosition()),w.rotate(u),w.inverse(),w.multRight(y),w.multLeft(e.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(w);var l=-this.getDepth(y);this.getProjectionMatrix().pop(),l-=r;var h=T.setFromToVec(S,a);if(l>0){var c=this.speed?this.getBrowser().getCurrentFrameRate():1e6;this.speed-=this.getBrowser().getBrowserOptions().Gravity_.getValue()/c;var d=this.speed/c;d<-l&&(d=-l,this.speed=0),e.positionOffset_=e.positionOffset_.getValue().add(h.multVecRot(F.set(0,d,0)))}else if(this.speed=0,(l=-l)>.01&&l<s){var d=this.constrainTranslation(h.multVecRot(this.translation.set(0,l,0)),!1);e.positionOffset_=d.add(e.positionOffset_.getValue())}}catch(t){console.log(t)}},depth:function(t,e){var i=this.getBrowser(),n=i.getContext(),r=this.getViewVolume().getViewport(),o=i.getDepthShader();o.useProgram(n),_.set(this.getProjectionMatrix().get()),n.uniformMatrix4fv(o.x3d_ProjectionMatrix,!1,_),n.viewport(r[0],r[1],r[2],r[3]),n.scissor(r[0],r[1],r[2],r[3]),n.clearColor(1,0,0,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.DEPTH_TEST),n.depthMask(!0),n.disable(n.BLEND),n.disable(n.CULL_FACE);for(var s=0;s<e;++s){var a=t[s],u=a.scissor;n.scissor(u.x,u.y,u.z,u.w),o.setClipPlanes(n,a.clipPlanes),n.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,a.modelViewMatrix),a.shapeNode.depth(a,o)}},draw:function(t){var e=this.getBrowser(),i=e.getContext(),n=this.getViewVolume().getViewport(),r=this.shaders,o=this.lights,s=this.generatedCubeMapTextures;if(this.isIndependent()){for(var a=0,u=o.length;a<u;++a)o[a].renderShadowMap(this);for(var a=0,u=s.length;a<u;++a)s[a].renderTexture(this,t)}e.getHeadlight().setGlobalVariables(this);for(var a=0,u=o.length;a<u;++a)o[a].setGlobalVariables(this);i.viewport(n[0],n[1],n[2],n[3]),i.scissor(n[0],n[1],n[2],n[3]),i.clear(i.DEPTH_BUFFER_BIT),this.getBackground().display(this,n),x.set(n),_.set(this.getProjectionMatrix().get()),e.getPointShader().setGlobalUniforms(this,i,_,x),e.getLineShader().setGlobalUniforms(this,i,_,x),e.getDefaultShader().setGlobalUniforms(this,i,_,x);for(var l in r)r[l].setGlobalUniforms(this,i,_,x);i.enable(i.DEPTH_TEST),i.depthMask(!0),i.disable(i.BLEND);for(var a=0;a<this.numOpaqueShapes;++a){var h=this.opaqueShapes[a],c=h.scissor;i.scissor(c.x,c.y,c.z,c.w),h.shapeNode.display(h)}i.depthMask(!1),i.enable(i.BLEND),this.transparencySorter.sort(0,this.numTransparentShapes);for(var a=0;a<this.numTransparentShapes;++a){var h=this.transparentShapes[a],c=h.scissor;i.scissor(c.x,c.y,c.z,c.w),h.shapeNode.display(h)}i.depthMask(!0),i.disable(i.BLEND),i.activeTexture(i.TEXTURE0);for(var d=this.getBrowser().getClipPlanes(),a=0,u=d.length;a<u;++a)d[a].dispose();if(d.length=0,s.length=0,this.isIndependent()){for(var o=this.globalLights,a=0,u=o.length;a<u;++a)o[a].dispose();for(var o=this.getBrowser().getLocalLights(),a=0,u=o.length;a<u;++a)o[a].dispose();o.length=0}this.globalLights.length=0,this.lights.length=0}},f}),define("x_ite/Execution/BindableStack",["jquery","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function i(t,i,n){e.call(this,t),this.layer=i,this.array=[n]}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"BindableStack"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableStack"},get:function(){return this.array},top:function(){return this.array[this.array.length-1]},forcePush:function(t){t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),this.push(t)},push:function(t){if(0!==this.array.length&&t!==this.array[0]){var e=this.top();t!==e&&(this.pushOnTop(t),e.isBound_.getValue()&&(e.set_bind_=!1,e.isBound_=!1),t.isBound_.getValue()||(t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),t.transitionStart(e)),this.pushOnTop(t),this.addNodeEvent())}},pushOnTop:function(t){var e=this.array.indexOf(t);e>-1&&this.array.splice(e,1),this.array.push(t)},remove:function(t){if(t!==this.array[0]){if(t===this.top())return this.pop(t);var e=this.array.indexOf(t);e>-1&&this.array.splice(e,1)}},pop:function(t){if(t!==this.array[0]){var e=this.top();if(t===e){if(t.isBound_.getValue()&&(t.isBound_=!1),0===this.array.length)return;this.array.pop(),e=this.top(),e.isBound_.getValue()||(e.set_bind_=!0,e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),e.transitionStart(t)),this.addNodeEvent()}}}}),i}),define("x_ite/Execution/BindableList",["jquery","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function i(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}function n(t,i,n){e.call(this,t),this.layer=i,this.collected=[n],this.array=[n]}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"BindableList"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableList"},get:function(){return this.array},getBound:function(t){if(t&&t.length)for(var e=1,i=this.array.length;e<i;++e){var n=this.array[e];if(n.getName()==t)return n}for(var e=1,i=this.array.length;e<i;++e){var n=this.array[e];if(n.isBound_.getValue())return n}return i>1?this.array[1]:this.array[0]},push:function(t){return this.collected.push(t)},update:function(){if(!i(this.collected,this.array)){for(var t=0,e=this.array.length;t<e;++t){var n=this.array[t];this.collected.indexOf(n)<0&&n.isBound_.getValue()&&(n.set_bind_=!1)}var r=this.array;this.array=this.collected,this.collected=r}this.collected.length=1}}),n}),define("x_ite/Components/EnvironmentalEffects/X3DFogObject",["jquery","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function i(t){this.addType(e.X3DFogObject),this.visibilityRange_.setUnit("length"),this.hidden=!1}return i.prototype={constructor:i,initialize:function(){this.fogType_.addInterest("set_fogType__",this),this.set_fogType__()},set_fogType__:function(){switch(this.fogType_.getValue()){case"EXPONENTIAL":this.fogType=2;break;default:this.fogType=1}},setHidden:function(t){this.hidden=t,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},setShaderUniforms:function(t,e,i){if(this.hidden)t.uniform1i(e.x3d_FogType,0);else{var n=this.color_.getValue(),r=Math.max(0,this.visibilityRange_.getValue());0===r&&(r=i.getNavigationInfo().getFarValue(i.getViewpoint())),t.uniform1i(e.x3d_FogType,this.fogType),t.uniform3f(e.x3d_FogColor,n.r,n.g,n.b),t.uniform1f(e.x3d_FogVisibilityRange,r)}}},i}),define("x_ite/Components/EnvironmentalEffects/Fog",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),o.call(this,t),this.addType(a.Fog)}return u.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOnly,"set_bind",new e.SFBool),new i(a.inputOutput,"fogType",new e.SFString("LINEAR")),new i(a.inputOutput,"color",new e.SFColor(1,1,1)),new i(a.inputOutput,"visibilityRange",new e.SFFloat),new i(a.outputOnly,"isBound",new e.SFBool),new i(a.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},bindToLayer:function(t){t.getFogStack().push(this)},unbindFromLayer:function(t){t.getFogStack().pop(this)},removeFromLayer:function(t){t.getFogStack().remove(this)},traverse:function(t,e){e.getLayer().getFogs().push(this)}}),u}),define("x_ite/Components/EnvironmentalEffects/X3DBackgroundNode",["jquery","x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){e.call(this,t),this.addType(n.X3DBackgroundNode),this.skyAngle_.setUnit("angle"),this.groundAngle_.setUnit("angle"),this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.transformationMatrix=new u,this.modelViewMatrixArray=new Float32Array(16),this.clipPlanes=[],this.colors=[],this.sphere=[],this.textures=0}var c=Math.sqrt(.5),d=c,p=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],f=[d,d,-d,1,-d,d,-d,1,-d,-d,-d,1,d,d,-d,1,-d,-d,-d,1,d,-d,-d,1],g=[-d,d,d,1,d,d,d,1,d,-d,d,1,-d,d,d,1,d,-d,d,1,-d,-d,d,1],m=[-d,d,-d,1,-d,d,d,1,-d,-d,d,1,-d,d,-d,1,-d,-d,d,1,-d,-d,-d,1],x=[d,d,d,1,d,d,-d,1,d,-d,-d,1,d,d,d,1,d,-d,-d,1,d,-d,d,1],y=[d,d,d,1,-d,d,d,1,-d,d,-d,1,d,d,d,1,-d,d,-d,1,d,d,-d,1],_=[d,-d,-d,1,-d,-d,-d,1,-d,-d,d,1,d,-d,-d,1,-d,-d,d,1,d,-d,d,1],v=new o(0,0),w=new o(0,0),b=new o(0,0),S=new o(0,0),C=new o(0,0),F=new o(0,0);new s(0,0,0),new u;return h.prototype=t.extend(Object.create(e.prototype),{constructor:h,modelViewMatrix:new u,rotation:new a,scale:new s(0,0,0),textureMatrixArray:new Float32Array(new u),rectangleCount:6,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.colorBuffer=t.createBuffer(),this.sphereBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer(),this.cubeBuffer=t.createBuffer(),this.texCoordBuffers=[t.createBuffer()],this.frontBuffer=t.createBuffer(),this.backBuffer=t.createBuffer(),this.leftBuffer=t.createBuffer(),this.rightBuffer=t.createBuffer(),this.topBuffer=t.createBuffer(),this.bottomBuffer=t.createBuffer(),this.groundAngle_.addInterest("build",this),this.groundColor_.addInterest("build",this),this.skyAngle_.addInterest("build",this),this.skyColor_.addInterest("build",this),this.transparency_.addInterest("build",this),this.build(),this.transferRectangle()},set_frontTexture__:function(t){this.setTexture("frontTexture",t,0)},set_backTexture__:function(t){this.setTexture("backTexture",t,1)},set_leftTexture__:function(t){this.setTexture("leftTexture",t,2)},set_rightTexture__:function(t){this.setTexture("rightTexture",t,3)},set_topTexture__:function(t){this.setTexture("topTexture",t,4)},set_bottomTexture__:function(t){this.setTexture("bottomTexture",t,5)},setTexture:function(t,e,i){this[t]&&this[t].loadState_.removeInterest("setTextureBit",this),this[t]=e,e?(e.loadState_.addInterest("setTextureBit",this,i),this.setTextureBit(e.loadState_,i)):this.textures&=~(1<<i)},setTextureBit:function(t,e){t.getValue()===n.COMPLETE_STATE?this.textures|=1<<e:this.textures&=~(1<<e)},bindToLayer:function(t){t.getBackgroundStack().push(this)},unbindFromLayer:function(t){t.getBackgroundStack().pop(this)},removeFromLayer:function(t){t.getBackgroundStack().remove(this)},setHidden:function(t){this.hidden=t,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},isTransparent:function(){return!!this.hidden||0!==this.transparency_.getValue()&&(!(this.frontTexture&&!this.frontTexture.transparent_.getValue())||(!(this.backTexture&&!this.backTexture.transparent_.getValue())||(!(this.leftTexture&&!this.leftTexture.transparent_.getValue())||(!(this.rightTexture&&!this.rightTexture.transparent_.getValue())||(!(this.topTexture&&!this.topTexture.transparent_.getValue())||!(this.bottomTexture&&!this.bottomTexture.transparent_.getValue()))))))},getColor:function(t,e,i){return e[l.upperBound(i,0,i.length,t,l.less)]},build:function(){if(this.colors.length=0,this.sphere.length=0,!(this.transparency_.getValue()>=1)){var t=1-l.clamp(this.transparency_.getValue(),0,1);if(0===this.groundColor_.length&&1==this.skyColor_.length){var e=c;this.sphere.vertices=36,this.sphere.push(e,e,-e,1,-e,e,-e,1,-e,-e,-e,1,e,e,-e,1,-e,-e,-e,1,e,-e,-e,1,-e,e,e,1,e,e,e,1,-e,-e,e,1,-e,-e,e,1,e,e,e,1,e,-e,e,1,-e,e,-e,1,-e,e,e,1,-e,-e,e,1,-e,e,-e,1,-e,-e,e,1,-e,-e,-e,1,e,e,e,1,e,e,-e,1,e,-e,e,1,e,-e,e,1,e,e,-e,1,e,-e,-e,1,e,e,e,1,-e,e,e,1,-e,e,-e,1,e,e,e,1,-e,e,-e,1,e,e,-e,1,-e,-e,e,1,e,-e,e,1,-e,-e,-e,1,-e,-e,-e,1,e,-e,e,1,e,-e,-e,1);for(var i=this.skyColor_[0],n=0,r=this.sphere.vertices;n<r;++n)this.colors.push(i.r,i.g,i.b,t)}else{if(this.skyColor_.length>this.skyAngle_.length){for(var o=[],n=0,s=this.skyAngle_.length;n<s;++n)o.push(this.skyAngle_[n]);(0===o.length||o[0]>0)&&o.unshift(0);var a=this.groundColor_.length>this.groundAngle_.length?Math.PI/2:Math.PI;o[o.length-1]<a&&o.push(a),this.buildSphere(1,o,this.skyAngle_,this.skyColor_,t,!1)}if(this.groundColor_.length>this.groundAngle_.length){for(var o=[],n=0,s=this.groundAngle_.length;n<s;++n)o.push(this.groundAngle_[n]);o.reverse(),(0===o.length||o[0]<Math.PI/2)&&o.unshift(Math.PI/2),o[o.length-1]>0&&o.push(0),this.buildSphere(1,o,this.groundAngle_,this.groundColor_,t,!0)}}this.transferSphere()}},buildSphere:function(t,e,i,n,r,o){for(var s=0,a=o?Math.PI/2:Math.PI,u=e.length-1,h=0;h<u;++h){var c=l.clamp(e[h],0,a),d=l.clamp(e[h+1],0,a);o&&(c=Math.PI-c,d=Math.PI-d),v.setPolar(t,c),w.setPolar(t,d);for(var p=this.getColor(e[h],n,i),f=this.getColor(e[h+1],n,i),g=0;g<20;++g){var m=g<19?g+1:0;s=2*Math.PI*(g/20),b.setPolar(-v.imag,s),S.setPolar(-w.imag,s),s=2*Math.PI*(m/20),C.setPolar(-w.imag,s),F.setPolar(-v.imag,s),this.colors.push(p.r,p.g,p.b,r,f.r,f.g,f.b,r,f.r,f.g,f.b,r,p.r,p.g,p.b,r,p.r,p.g,p.b,r,f.r,f.g,f.b,r),this.sphere.push(b.imag,v.real,b.real,1,C.imag,w.real,C.real,1,S.imag,w.real,S.real,1,b.imag,v.real,b.real,1,F.imag,v.real,F.real,1,C.imag,w.real,C.real,1)}}},transferSphere:function(){var t=this.getBrowser().getContext();t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.sphereBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.sphere),t.STATIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){var t=this.getBrowser().getContext();t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[0]),t.bufferData(t.ARRAY_BUFFER,new Float32Array(p),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.frontBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(f),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.backBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(g),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.leftBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(m),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.rightBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(x),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.topBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(y),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.bottomBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(_),t.STATIC_DRAW)},traverse:function(t,e){switch(t){case i.CAMERA:e.getLayer().getBackgrounds().push(this),this.transformationMatrix.assign(e.getModelViewMatrix().get());break;case i.DISPLAY:for(var n=e.getClipPlanes(),r=this.clipPlanes,o=0,s=n.length;o<s;++o)r[o]=n[o];r.length=n.length}},display:function(t,e){try{if(this.hidden)return;var i=t.getBrowser(),n=i.getContext();n.disable(n.DEPTH_TEST),n.depthMask(!1),n.enable(n.CULL_FACE),n.frontFace(n.CCW);var r=t.getNavigationInfo().getNearValue(),o=t.getNavigationInfo().getFarValue(t.getViewpoint()),s=this.rotation,a=this.modelViewMatrix.assign(this.transformationMatrix);this.projectionMatrixArray.set(t.getViewpoint().getProjectionMatrixWithLimits(r,1.3*o,e,!0)),a.multRight(t.getInverseCameraSpaceMatrix().get()),a.get(null,s),a.identity(),a.rotate(s),a.scale(this.scale.set(o,o,o)),this.modelViewMatrixArray.set(a),this.drawSphere(t),this.textures&&this.drawCube(t)}catch(t){}},drawSphere:function(t){var e=this.transparency_.getValue();if(!(e>=1)){var i=t.getBrowser(),n=i.getContext(),r=i.getBackgroundSphereShader();r.useProgram(n),r.setClipPlanes(n,this.clipPlanes),r.enableColorAttribute(n,this.colorBuffer),r.enableVertexAttribute(n,this.sphereBuffer),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),e?n.enable(n.BLEND):n.disable(n.BLEND),n.drawArrays(n.TRIANGLES,0,this.sphereCount),r.disableColorAttribute(n)}},drawCube:function(t){var e=t.getBrowser(),i=e.getContext(),n=e.getGouraudShader();n.useProgram(i),n.setClipPlanes(i,this.clipPlanes),n.enableTexCoordAttribute(i,this.texCoordBuffers),i.uniform1i(n.x3d_FogType,0),i.uniform1i(n.x3d_ColorMaterial,!1),i.uniform1i(n.x3d_Lighting,!1),i.uniformMatrix4fv(n.x3d_TextureMatrix,!1,this.textureMatrixArray),i.uniformMatrix4fv(n.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),i.uniformMatrix4fv(n.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.drawRectangle(i,n,this.frontTexture,this.frontBuffer),this.drawRectangle(i,n,this.backTexture,this.backBuffer),this.drawRectangle(i,n,this.leftTexture,this.leftBuffer),this.drawRectangle(i,n,this.rightTexture,this.rightBuffer),this.drawRectangle(i,n,this.topTexture,this.topBuffer),this.drawRectangle(i,n,this.bottomTexture,this.bottomBuffer),n.disableTexCoordAttribute(i)},drawRectangle:function(t,e,i,r){i&&i.checkLoadState()===n.COMPLETE_STATE&&(i.setShaderUniforms(t,e,0),i.transparent_.getValue()?t.enable(t.BLEND):t.disable(t.BLEND),e.enableVertexAttribute(t,r),t.drawArrays(t.TRIANGLES,0,this.rectangleCount))}}),h}),define("x_ite/Components/Texturing/X3DTextureNode",["jquery","x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){i.call(this,t),this.addType(n.X3DTextureNode),this.addChildObjects("transparent",new e.SFBool)}var o=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return r.prototype=t.extend(Object.create(i.prototype),{constructor:r,initialize:function(){i.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.texture=t.createTexture()},getTexture:function(){return this.texture},updateTextureProperties:function(t,e,i,n,r,s,a,u){var l=this.getBrowser().getContext();l.bindTexture(t,this.getTexture()),Math.max(n,r)<this.getBrowser().getMinTextureSize()&&!e?(l.texParameteri(t,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l.NEAREST)):(i.generateMipMaps_.getValue()&&l.generateMipmap(t),l.texParameteri(t,l.TEXTURE_MIN_FILTER,l[i.getMinificationFilter()]),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l[i.getMagnificationFilter()])),e?(l.texParameteri(t,l.TEXTURE_WRAP_S,l[i.getBoundaryModeS()]),l.texParameteri(t,l.TEXTURE_WRAP_T,l[i.getBoundaryModeT()])):(l.texParameteri(t,l.TEXTURE_WRAP_S,s?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(t,l.TEXTURE_WRAP_T,a?l.REPEAT:l.CLAMP_TO_EDGE));for(var h=0;h<o.length;++h){var c=l.getExtension(o[h]);if(c){l.texParameterf(t,c.TEXTURE_MAX_ANISOTROPY_EXT,i.anisotropicDegree_.getValue());break}}}}),r}),define("x_ite/Components/Texturing/X3DTexture2DNode",["jquery","x_ite/Fields","x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r){"use strict";function o(t){i.call(this,t),this.addType(r.X3DTexture2DNode),this.width=0,this.height=0,this.flipY=!1,this.data=null}var s=new Uint8Array([255,255,255,255]);return o.prototype=t.extend(Object.create(i.prototype),{constructor:o,initialize:function(){i.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.target=t.TEXTURE_2D,this.repeatS_.addInterest("updateTextureProperties",this),this.repeatT_.addInterest("updateTextureProperties",this),this.textureProperties_.addInterest("set_textureProperties__",this),t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,s),this.set_textureProperties__()},set_textureProperties__:function(){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest("updateTextureProperties",this),this.texturePropertiesNode=n(r.TextureProperties,this.textureProperties_),this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest("updateTextureProperties",this),this.updateTextureProperties()},getTarget:function(){return this.target},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},setTexture:function(t,e,i,n,r){try{this.transparent_=i,this.width=t,this.height=e,this.flipY=r,this.data=n;var o=this.getBrowser().getContext();o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.bindTexture(o.TEXTURE_2D,this.getTexture()),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,e,0,o.RGBA,o.UNSIGNED_BYTE,n),this.updateTextureProperties(),this.addNodeEvent()}catch(t){}},updateTexture:function(t,e){try{this.data=t;var i=this.getBrowser().getContext();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),i.bindTexture(i.TEXTURE_2D,this.getTexture()),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,t),this.texturePropertiesNode.generateMipMaps_.getValue()&&i.generateMipmap(i.TEXTURE_2D),this.addNodeEvent()}catch(t){}},updateTextureProperties:function(){var t=this.getBrowser().getContext();i.prototype.updateTextureProperties.call(this,t.TEXTURE_2D,this.textureProperties_.getValue(),this.texturePropertiesNode,this.width,this.height,this.repeatS_.getValue(),this.repeatT_.getValue(),!1)},clear:function(){this.setTexture(1,1,!1,s,!1)},resize:function(t,e,i,n,r){for(var o=new Uint8Array(n*r*4),s=n/e,a=r/i,u=0;u<r;++u)for(var l=Math.floor(u/a)*e,h=u*n,c=0;c<n;++c){var d=4*(l+Math.floor(c/s)),p=4*(h+c);o[p]=t[d],o[p+1]=t[d+1],o[p+2]=t[d+2],o[p+3]=t[d+3]}return o},setShaderUniforms:function(t,e,i){e.textureTypeArray[i]=2,t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.uniform1iv(e.x3d_TextureType,e.textureTypeArray)}}),o}),define("x_ite/Components/Texturing/ImageTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){r.call(this,t),o.call(this,t),this.addType(s.ImageTexture),this.addChildObjects("buffer",new e.SFTime),this.urlStack=new e.MFString}return c.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:c,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"url",new e.MFString),new i(s.initializeOnly,"repeatS",new e.SFBool(!0)),new i(s.initializeOnly,"repeatT",new e.SFBool(!0)),new i(s.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.canvas=t("<canvas></canvas>"),this.image=t("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.urlStack.setValue(this.url_),this.loadNext())},loadNext:function(){if(0===this.urlStack.length)return this.clear(),void this.setLoadState(s.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.image.attr("src",this.URL)},setError:function(){var t=this.URL.toString();h&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+t)),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){h&&"data"!==this.URL.scheme&&console.info("Done loading image:",this.URL.toString());try{var t=this.image[0],e=t.width,i=t.height,n=this.canvas[0],r=n.getContext("2d");l.isPowerOfTwo(e)&&l.isPowerOfTwo(i)?(n.width=e,n.height=i,r.save(),r.translate(0,i),r.scale(1,-1),r.drawImage(t,0,0),r.restore()):(e=l.nextPowerOfTwo(e),i=l.nextPowerOfTwo(i),
n.width=e,n.height=i,r.save(),r.translate(0,i),r.scale(1,-1),r.drawImage(t,0,0,t.width,t.height,0,0,e,i),r.restore());for(var o=r.getImageData(0,0,e,i).data,a=!0,u=3;u<o.length;u+=4)if(255!==o[u]){a=!1;break}setTimeout(function(){this.setTexture(e,i,!a,new Uint8Array(o),!1),this.setLoadState(s.COMPLETE_STATE)}.bind(this),16)}catch(t){console.log(t.message),this.setError()}}}),c}),define("x_ite/Components/EnvironmentalEffects/Background",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/Texturing/ImageTexture","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.Background)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_bind",new e.SFBool),new i(s.inputOutput,"frontUrl",new e.MFString),new i(s.inputOutput,"backUrl",new e.MFString),new i(s.inputOutput,"leftUrl",new e.MFString),new i(s.inputOutput,"rightUrl",new e.MFString),new i(s.inputOutput,"topUrl",new e.MFString),new i(s.inputOutput,"bottomUrl",new e.MFString),new i(s.inputOutput,"skyAngle",new e.MFFloat),new i(s.inputOutput,"skyColor",new e.MFColor(new e.SFColor)),new i(s.inputOutput,"groundAngle",new e.MFFloat),new i(s.inputOutput,"groundColor",new e.MFColor),new i(s.inputOutput,"transparency",new e.SFFloat),new i(s.outputOnly,"isBound",new e.SFBool),new i(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this);var t=new o(this.getExecutionContext()),e=new o(this.getExecutionContext()),i=new o(this.getExecutionContext()),n=new o(this.getExecutionContext()),s=new o(this.getExecutionContext()),a=new o(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this.frontUrl_.addFieldInterest(t.url_),this.backUrl_.addFieldInterest(e.url_),this.leftUrl_.addFieldInterest(i.url_),this.rightUrl_.addFieldInterest(n.url_),this.topUrl_.addFieldInterest(s.url_),this.bottomUrl_.addFieldInterest(a.url_),t.url_=this.frontUrl_,e.url_=this.backUrl_,i.url_=this.leftUrl_,n.url_=this.rightUrl_,s.url_=this.topUrl_,a.url_=this.bottomUrl_,t.textureProperties_=u,e.textureProperties_=u,i.textureProperties_=u,n.textureProperties_=u,s.textureProperties_=u,a.textureProperties_=u,t.setup(),e.setup(),i.setup(),n.setup(),s.setup(),a.setup(),this.set_frontTexture__(t),this.set_backTexture__(e),this.set_leftTexture__(i),this.set_rightTexture__(n),this.set_topTexture__(s),this.set_bottomTexture__(a)}}),a}),define("x_ite/Components/Layering/X3DLayerNode",["jquery","x_ite/Components/Core/X3DNode","x_ite/Rendering/X3DRenderObject","x_ite/Components/Layering/X3DViewportNode","x_ite/Execution/BindableStack","x_ite/Execution/BindableList","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/Background","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f){"use strict";function g(t,n,l){e.call(this,t),i.call(this,t),this.addType(c.X3DLayerNode),this.groupNode=l,this.currentViewport=null,this.defaultBackground=new u(t),this.defaultFog=new a(t),this.defaultNavigationInfo=new s(t),this.defaultViewpoint=n,this.backgroundStack=new r(t,this,this.defaultBackground),this.fogStack=new r(t,this,this.defaultFog),this.navigationInfoStack=new r(t,this,this.defaultNavigationInfo),this.viewpointStack=new r(t,this,this.defaultViewpoint),this.backgrounds=new o(t,this,this.defaultBackground),this.fogs=new o(t,this,this.defaultFog),this.navigationInfos=new o(t,this,this.defaultNavigationInfo),this.viewpoints=new o(t,this,this.defaultViewpoint),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.collisionTime=0}var m=new f;return g.prototype=t.extend(Object.create(e.prototype),i.prototype,{constructor:g,layer0:!1,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this),this.groupNode.children_=this.children_,this.groupNode.setPrivate(!0),this.groupNode.setup(),this.defaultNavigationInfo.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.defaultViewpoint.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgrounds.setup(),this.fogs.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.viewport_.addInterest("set_viewport__",this),this.addChildren_.addFieldInterest(this.groupNode.addChildren_),this.removeChildren_.addFieldInterest(this.groupNode.removeChildren_),this.children_.addFieldInterest(this.groupNode.children_),this.set_viewport__()},isLayer0:function(t){this.layer0=t,this.defaultBackground.setHidden(!t)},getLayer:function(){return this},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var t=[],e=0;e<this.viewpoints.get().length;++e){var i=this.viewpoints.get()[e];i.description_.length&&t.push(i)}return t},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getBBox:function(t){return this.groupNode.getBBox(t)},set_viewport__:function(){this.currentViewport=l(c.X3DViewportNode,this.viewport_),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(t){this.traverse(h.CAMERA,this);var e=this.navigationInfos.getBound(),i=this.backgrounds.getBound(),n=this.fogs.getBound(),r=this.viewpoints.getBound(t);this.navigationInfoStack.forcePush(e),this.backgroundStack.forcePush(i),this.fogStack.forcePush(n),this.viewpointStack.forcePush(r),e.addLayer(this),i.addLayer(this),n.addLayer(this),r.addLayer(this),r.resetUserOffsets()},traverse:function(t,e){e=e||this;var i=this.getViewpoint();switch(this.getCameraSpaceMatrix().pushMatrix(i.getCameraSpaceMatrix()),this.getInverseCameraSpaceMatrix().pushMatrix(i.getInverseCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(i.getProjectionMatrix(this)),t){case h.POINTER:this.pointer(t,e);break;case h.CAMERA:this.camera(t,e);break;case h.COLLISION:this.collision(t,e);break;case h.DEPTH:case h.DISPLAY:this.display(t,e)}this.getProjectionMatrix().pop(),this.getInverseCameraSpaceMatrix().pop(),this.getCameraSpaceMatrix().pop()},pointer:function(t,e){if(this.isPickable_.getValue()){var i=this.getBrowser(),n=this.currentViewport.getRectangle(i);if(i.getSelectedLayer()){if(i.getSelectedLayer()!==this)return}else if(!i.isPointerInRectangle(n))return;i.setHitRay(this.getProjectionMatrix().get(),n),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}},camera:function(t,e){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.navigationInfos.update(),this.backgrounds.update(),this.fogs.update(),this.viewpoints.update(),this.getViewpoint().update(),this.getModelViewMatrix().pop()},collision:function(t,e){this.collisionTime=0;var i=this.getNavigationInfo(),n=i.getCollisionRadius(),r=i.getAvatarHeight(),o=Math.max(2*n,2*r);d.ortho(-o,o,-o,o,-o,o,m),this.getProjectionMatrix().pushMatrix(m),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.getProjectionMatrix().pop()},display:function(t,e){this.getNavigationInfo().enable(t,e),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}}),g}),define("x_ite/Components/Grouping/Group",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Group)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/Layering/Layer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t,new o(t),new s(t)),this.addType(a.Layer)}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"isPickable",new e.SFBool(!0)),new i(a.inputOutput,"viewport",new e.SFNode),new i(a.inputOnly,"addChildren",new e.MFNode),new i(a.inputOnly,"removeChildren",new e.MFNode),new i(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"}}),u}),define("x_ite/Components/Layering/LayerSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(u.LayerSet),this.layerNodes=[new o(t)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.inputOutput,"activeLayer",new e.SFInt32),new i(u.inputOutput,"order",new e.MFInt32(0)),new i(u.inputOutput,"layers",new e.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.layerNode0.setPrivate(!0),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this.activeLayer_.addInterest("set_activeLayer",this),this.order_.addInterest("set_layers",this),this.layers_.addInterest("set_layers",this),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(t){this.layerNode0=t,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this.activeLayer_.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{var t=this.activeLayer_-1;t>=0&&t<this.layers_.length?this.activeLayerNode!==this.layers_[t].getValue()&&(this.activeLayerNode=s(u.X3DLayerNode,this.layers_[t])):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){var t=this.layers_.getValue();this.layerNodes.length=0;for(var e=0;e<this.order_.length;++e){var i=this.order_[e];if(0===i)this.layerNodes.push(this.layerNode0);else if(--i>=0&&i<t.length){var n=s(u.X3DLayerNode,t[i]);n&&this.layerNodes.push(n)}}this.set_activeLayer()},bind:function(t){var e=this.layers_.getValue();this.layerNode0.bind(t);for(var i=0,n=e.length;i<n;++i){var r=s(u.X3DLayerNode,e[i]);r&&r.bind(t)}},traverse:function(t,e){var i=this.layerNodes;if(t===a.POINTER)for(var n=0,r=i.length;n<r;++n)this.getBrowser().setLayerNumber(n),i[n].traverse(t,e);else for(var n=0,r=i.length;n<r;++n)i[n].traverse(t,e)}}),l}),define("x_ite/Execution/World",["jquery","x_ite/Fields/SFNode","x_ite/Basic/X3DBaseNode","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){i.call(this,t),this.layerSet=new n(t),this.defaultLayerSet=this.layerSet,this.layer0=new r(t),this.addChildObjects("activeLayer",new e(this.layer0))}return a.prototype=t.extend(Object.create(i.prototype),{constructor:a,getTypeName:function(){return"World"},initialize:function(){i.prototype.initialize.call(this),this.layerSet.setPrivate(!0),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet.activeLayer_.addInterest("set_activeLayer",this),this.getExecutionContext().getRootNodes().addInterest("set_rootNodes",this),this.getExecutionContext().setup(),this.set_rootNodes(),this.layer0.setPrivate(!0),this.layer0.isLayer0(!0),this.layer0.setup(),this.bind()},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this.activeLayer_.getValue()},set_rootNodes:function(){var t=this.layerSet;this.layerSet=this.defaultLayerSet;var e=this.getExecutionContext().getRootNodes();this.layer0.children_=e;for(var i=0;i<e.length;++i){var n=o(s.LayerSet,e[i]);n&&(n.setLayer0(this.layer0),this.layerSet=n)}this.layerSet!==t&&(t.activeLayer_.removeInterest("set_activeLayer",this),this.layerSet.activeLayer_.addInterest("set_activeLayer",this),this.set_activeLayer())},set_activeLayer:function(){this.activeLayer_=this.layerSet.getActiveLayer()},bind:function(){this.layerSet.bind(this.getExecutionContext().getURL().fragment)},traverse:function(t,e){this.layerSet.traverse(t,e)}}),a}),define("x_ite/Browser/X3DBrowserContext",["jquery","x_ite/Fields/SFTime","x_ite/Basic/X3DBaseNode","x_ite/Browser/Core/X3DCoreContext","x_ite/Routing/X3DRoutingContext","x_ite/Browser/Scripting/X3DScriptingContext","x_ite/Browser/Networking/X3DNetworkingContext","x_ite/Browser/Shaders/X3DShadersContext","x_ite/Browser/Shape/X3DShapeContext","x_ite/Browser/Rendering/X3DRenderingContext","x_ite/Browser/Geometry2D/X3DGeometry2DContext","x_ite/Browser/Geometry3D/X3DGeometry3DContext","x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","x_ite/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext","x_ite/Browser/Navigation/X3DNavigationContext","x_ite/Browser/Layering/X3DLayeringContext","x_ite/Browser/Layout/X3DLayoutContext","x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","x_ite/Browser/Lighting/X3DLightingContext","x_ite/Browser/Sound/X3DSoundContext","x_ite/Browser/Text/X3DTextContext","x_ite/Browser/Texturing/X3DTexturingContext","x_ite/Browser/Time/X3DTimeContext","x_ite/Browser/ParticleSystems/X3DParticleSystemsContext","x_ite/Execution/World","x_ite/Bits/TraverseType"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_,v,w,b,S,C,F){"use strict";function T(t){i.call(this,this),r.call(this),n.call(this,t),o.call(this),s.call(this),a.call(this),u.call(this),l.call(this),h.call(this),c.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),x.call(this),y.call(this),_.call(this),v.call(this),w.call(this),b.call(this),S.call(this),this.addChildObjects("initialized",new e,"shutdown",new e,"prepareEvents",new e,"timeEvents",new e,"sensorEvents",new e,"finished",new e),this.changedTime=0,this.renderCallback=this.traverse.bind(this),this.systemTime=0,this.systemStartTime=0,this.browserTime=0,this.pickingTime=0,this.cameraTime=0,this.collisionTime=0,this.displayTime=0}return T.prototype=t.extend(Object.create(i.prototype),r.prototype,n.prototype,o.prototype,s.prototype,a.prototype,u.prototype,l.prototype,h.prototype,c.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,x.prototype,y.prototype,_.prototype,v.prototype,w.prototype,b.prototype,S.prototype,{constructor:T,initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),n.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),h.prototype.initialize.call(this),c.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),x.prototype.initialize.call(this),y.prototype.initialize.call(this),_.prototype.initialize.call(this),v.prototype.initialize.call(this),w.prototype.initialize.call(this),b.prototype.initialize.call(this),S.prototype.initialize.call(this)},initialized:function(){return this.initialized_},shutdown:function(){return this.shutdown_},prepareEvents:function(){return this.prepareEvents_},timeEvents:function(){return this.timeEvents_},sensorEvents:function(){return this.sensorEvents_},finished:function(){return this.finished_},getURL:function(){return this.getExecutionContext().getURL()},getBrowser:function(){return this},getWorld:function(){return this.world},setExecutionContext:function(t){this.world=new C(t),this.world.setup()},getExecutionContext:function(){return this.world.getExecutionContext()},addBrowserEvent:function(){this.changedTime!==this.getCurrentTime()&&(this.changedTime=this.getCurrentTime(),requestAnimationFrame(this.renderCallback))},traverse:function(t){var e=this.getContext(),i=performance.now();this.systemTime=i-this.systemStartTime,this.advanceTime(t),this.prepareEvents_.processInterests(),this.processEvents(),this.timeEvents_.processInterests(),this.processEvents();var n=performance.now();this.world.traverse(F.CAMERA,null),this.cameraTime=performance.now()-n;var r=performance.now();this.getCollisionCount()&&this.world.traverse(F.COLLISION,null),this.collisionTime=performance.now()-r,this.sensorEvents_.processInterests(),this.processEvents();var o=performance.now();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.world.traverse(F.DISPLAY,null),this.displayTime=performance.now()-o,this.browserTime=performance.now()-i,this.systemStartTime=performance.now(),this.finished_.processInterests()}}),T}),define("x_ite/Configuration/ProfileInfo",["jquery"],function(t){"use strict";function e(t,e,i,n){this.name=t,this.title=e,this.providerUrl=i,this.components=n,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return t.extend(e.prototype,{constructor:e,toXMLStream:function(t){}}),e}),define("x_ite/Configuration/ProfileInfoArray",["jquery","x_ite/Configuration/X3DInfoArray"],function(t,e){"use strict";function i(){return e.call(this)}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Configuration/SupportedProfiles",["jquery","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(t,e,i,n,r){"use strict";return function(t){function o(i,o,s){a.add(o,new e(o,i,r.povider,new n(t,s)))}var s=t.supportedComponents,a=new i;return o("Computer-Aided Design (CAD) interchange","CADInterchange",[s.Core,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Lighting,s.Texturing,s.Navigation,s.Shaders,s.CADGeometry]),o("Core","Core",[s.Core]),o("Full","Full",[s.Core,s.Time,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Geometry3D,s.Geometry2D,s.Text,s.Sound,s.Lighting,s.Texturing,s.Interpolation,s.PointingDeviceSensor,s.KeyDeviceSensor,s.EnvironmentalSensor,s.Navigation,s.EnvironmentalEffects,s.Geospatial,s["H-Anim"],s.NURBS,s.DIS,s.Scripting,s.EventUtilities,s.Shaders,s.CADGeometry,s.Texturing3D,s.CubeMapTexturing,s.Layering,s.Layout,s.RigidBodyPhysics,s.Picking,s.Followers,s.ParticleSystems]),o("Immersive","Immersive",[s.Core,s.Time,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Geometry3D,s.Geometry2D,s.Text,s.Sound,s.Lighting,s.Texturing,s.Interpolation,s.PointingDeviceSensor,s.KeyDeviceSensor,s.EnvironmentalSensor,s.Navigation,s.EnvironmentalEffects,s.Scripting,s.EventUtilities]),o("Interactive","Interactive",[s.Core,s.Time,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Geometry3D,s.Lighting,s.Texturing,s.Interpolation,s.PointingDeviceSensor,s.KeyDeviceSensor,s.EnvironmentalSensor,s.Navigation,s.EnvironmentalEffects,s.EventUtilities]),o("Interchange","Interchange",[s.Core,s.Time,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Geometry3D,s.Lighting,s.Texturing,s.Interpolation,s.Navigation,s.EnvironmentalEffects]),o("MPEG-4 interactive","MPEG-4",[s.Core,s.Time,s.Networking,s.Grouping,s.Rendering,s.Shape,s.Geometry3D,s.Lighting,s.Texturing,s.Interpolation,s.PointingDeviceSensor,s.EnvironmentalSensor,s.Navigation,s.EnvironmentalEffects]),Object.preventExtensions(a),Object.freeze(a),Object.seal(a),a}}),define("x_ite/Configuration/SupportedComponents",["jquery","x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(t,e,i){"use strict";return function(t){var n=new e(t);return n.addComponentInfo({title:"Computer-Aided Design (CAD) model geometry",name:"CADGeometry",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Core",name:"Core",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Cube map environmental texturing",name:"CubeMapTexturing",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Distributed interactive simulation (DIS)",name:"DIS",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Environmental effects",name:"EnvironmentalEffects",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Environmental sensor",name:"EnvironmentalSensor",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Event utilities",name:"EventUtilities",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Followers",name:"Followers",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Geometry2D",name:"Geometry2D",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Geometry3D",name:"Geometry3D",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Geospatial",name:"Geospatial",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Grouping",name:"Grouping",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Humanoid animation (H-Anim)",name:"H-Anim",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Interpolation",name:"Interpolation",level:5,providerUrl:i.provider}),n.addComponentInfo({title:"Key device sensor",name:"KeyDeviceSensor",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Layering",name:"Layering",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Layout",name:"Layout",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Lighting",name:"Lighting",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Navigation",name:"Navigation",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Networking",name:"Networking",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Non-uniform Rational B-Spline (NURBS)",name:"NURBS",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Particle systems",name:"ParticleSystems",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Picking sensor",name:"Picking",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Pointing device sensor",name:"PointingDeviceSensor",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Programmable shaders",name:"Shaders",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Rendering",name:"Rendering",level:5,providerUrl:i.provider}),n.addComponentInfo({title:"Rigid body physics",name:"RigidBodyPhysics",level:5,providerUrl:i.provider}),n.addComponentInfo({title:"Scripting",name:"Scripting",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Shape",name:"Shape",level:4,providerUrl:i.provider}),n.addComponentInfo({title:"Sound",name:"Sound",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Text",name:"Text",level:1,providerUrl:i.provider}),n.addComponentInfo({title:"Texturing",name:"Texturing",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Texturing3D",name:"Texturing3D",level:3,providerUrl:i.provider}),n.addComponentInfo({title:"Time",name:"Time",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"Volume rendering",name:"VolumeRendering",level:2,providerUrl:i.provider}),n.addComponentInfo({title:"X_ITE",name:"X_ITE",level:1,providerUrl:i.provider}),Object.preventExtensions(n),Object.freeze(n),Object.seal(n),n}}),define("x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer",["jquery","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(t,e,i){"use strict";function n(t,n,r,o){this.node=null,this.modelViewMatrix=new i,this.projectionMatrix=new i,this.viewport=new e(0,0,0,0),this.set(t,n,r,o)}return n.prototype={set:function(t,e,i,n){this.node=t,this.modelViewMatrix.assign(e),this.projectionMatrix.assign(i),this.viewport.assign(n)},set_over__:function(t,e){this.node.set_over__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_active__:function(t,e){this.node.set_active__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_motion__:function(t){this.node.set_motion__(t,this.modelViewMatrix,this.projectionMatrix,this.viewport)}},n}),define("x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["jquery","x_ite/Components/Core/X3DSensorNode","x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(n.X3DPointingDeviceSensorNode)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this)},getMatrices:function(){return this.matrices},set_enabled__:function(){this.enabled_.getValue()||(this.isActive_.getValue()&&(this.isActive_=!1),this.isOver_.getValue()&&(this.isOver_=!1))},set_over__:function(t,e){t!==this.isOver_.getValue()&&(this.isOver_=t,this.isOver_.getValue()&&(this.getBrowser().getNotification().string_=this.description_))},set_active__:function(t,e){t!==this.isActive_.getValue()&&(this.isActive_=t)},set_motion__:function(t){},push:function(t,e){this.enabled_.getValue()&&(e[this.getId()]=new i(this,t.getModelViewMatrix().get(),t.getProjectionMatrix().get(),t.getViewVolume().getViewport()))}}),r}),define("x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode",["jquery","x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DTouchSensorNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,set_active__:function(t,i){e.prototype.set_active__.call(this,t,i),this.enabled_.getValue()&&this.isOver_.getValue()&&!t&&(this.touchTime_=this.getBrowser().getCurrentTime())}}),n}),define("x_ite/Components/PointingDeviceSensor/TouchSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.TouchSensor),this.hitPoint_changed_.setUnit("length")}var u=new s;return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"description",new e.SFString),new i(o.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new i(o.outputOnly,"hitNormal_changed",new e.SFVec3f),new i(o.outputOnly,"hitPoint_changed",new e.SFVec3f),new i(o.outputOnly,"isOver",new e.SFBool),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(t,e,i,n,o){try{if(r.prototype.set_over__.call(this,t,e,i,n,o),this.isOver_.getValue()){var s=e.intersection;u.assign(i).inverse(),this.hitTexCoord_changed_=s.texCoord,this.hitNormal_changed_=i.multMatrixDir(s.normal.copy()).normalize(),this.hitPoint_changed_=u.multVecMatrix(s.point.copy())}}catch(t){console.log(t)}}}),a}),define("x_ite/Components/Networking/Anchor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),o.call(this,t),this.addType(u.Anchor),this.touchSensorNode=new s(t)}return h.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:h,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.inputOutput,"description",new e.SFString),new i(u.inputOutput,"url",new e.MFString),new i(u.inputOutput,"parameter",new e.MFString),new i(u.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(u.initializeOnly,"bboxCenter",new e.SFVec3f),new i(u.inputOnly,"addChildren",new e.MFNode),new i(u.inputOnly,"removeChildren",new e.MFNode),new i(u.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.description_.addFieldInterest(this.touchSensorNode.description_),this.touchSensorNode.description_=this.description_,this.touchSensorNode.setup();var t=this,e=this.touchSensorNode.set_active__;this.touchSensorNode.set_active__=function(i,n){e.call(this,i,n),this.isOver_.getValue()&&!i&&t.requestAsyncLoad()}},requestAsyncLoad:function(){this.setLoadState(u.IN_PROGRESS_STATE,!1),new l(this).createX3DFromURL(this.url_,this.parameter_,function(t){t?(this.getBrowser().replaceWorld(t),this.setLoadState(u.COMPLETE_STATE,!1)):this.setLoadState(u.FAILED_STATE,!1)}.bind(this),function(t){try{this.getExecutionContext().changeViewpoint(t)}catch(t){}this.setLoadState(u.COMPLETE_STATE,!1)}.bind(this),function(t,e){e?window.open(t,e):location=t,this.setLoadState(u.COMPLETE_STATE,!1)}.bind(this))},traverse:function(t,e){if(t===a.POINTER){var i={};e.getBrowser().getSensors().push(i),this.touchSensorNode.push(e,i),r.prototype.traverse.call(this,t,e),e.getBrowser().getSensors().pop()}else r.prototype.traverse.call(this,t,e)}}),h}),define("x_ite/Components/Rendering/X3DLineGeometryNode",["jquery","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n){"use strict";function r(t){e.call(this,t)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,getShader:function(t){return t.getLineShader()},intersectsLine:function(t,e,i,n){return!1},intersectsBox:function(t,e,i){return!1},display:function(t){try{var e=t.renderer.getBrowser(),i=e.getContext(),n=t.shaderNode,r=this.attribNodes,o=this.attribBuffers;n===e.getDefaultShader()&&(n=this.getShader(e)),t.geometryType=this.getGeometryType(),
t.colorMaterial=this.getColors().length,n.setLocalUniforms(i,t);for(var s=0,a=r.length;s<a;++s)r[s].enable(i,n,o[s]);this.colors.length&&n.enableColorAttribute(i,this.colorBuffer),n.enableVertexAttribute(i,this.vertexBuffer),i.drawArrays(n.primitiveMode===i.POINTS?i.POINTS:this.primitiveMode,0,this.vertexCount);for(var s=0,a=r.length;s<a;++s)r[s].disable(i,n);n.disableColorAttribute(i)}catch(t){console.log(t)}},displayParticles:function(t,e,i){try{var r=t.renderer.getBrowser(),o=r.getContext(),s=t.shaderNode,a=this.attribNodes,u=this.attribBuffers;s===r.getDefaultShader()&&(s=this.getShader(r)),t.geometryType=this.getGeometryType(),t.colorMaterial=this.colors.length,s.setLocalUniforms(o,t);for(var l=0,h=a.length;l<h;++l)a[l].enable(o,s,u[l]);this.colors.length&&s.enableColorAttribute(o,this.colorBuffer),s.enableVertexAttribute(o,this.vertexBuffer);for(var c=t.modelViewMatrix,d=c[12],p=c[13],f=c[14],g=s.primitiveMode===o.POINTS?o.POINTS:this.primitiveMode,m=0;m<i;++m)c[12]=d,c[13]=p,c[14]=f,n.prototype.translate.call(c,e[m].position),o.uniformMatrix4fv(s.x3d_ModelViewMatrix,!1,c),o.drawArrays(g,0,this.vertexCount);for(var l=0,h=a.length;l<h;++l)a[l].disable(o,s);s.disableColorAttribute(o)}catch(t){console.log(t)}}}),r}),define("x_ite/Components/Geometry2D/Arc2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(o.Arc2D),this.setGeometryType(1),this.startAngle_.setUnit("angle"),this.endAngle_.setUnit("angle"),this.radius_.setUnit("length")}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"startAngle",new e.SFFloat),new i(o.inputOutput,"endAngle",new e.SFFloat(1.5708)),new i(o.initializeOnly,"radius",new e.SFFloat(1))]),getTypeName:function(){return"Arc2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getArc2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getArc2DOptions().removeInterest("eventsProcessed",this)},getSweepAngle:function(){var t=u.interval(this.startAngle_.getValue(),0,2*Math.PI),e=u.interval(this.endAngle_.getValue(),0,2*Math.PI);if(t===e)return 2*Math.PI;var i=Math.abs(e-t);return t>e?2*Math.PI-i:isNaN(i)?0:i},build:function(){var t=this.getBrowser().getContext(),e=this.getBrowser().getArc2DOptions(),i=e.dimension_.getValue(),n=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getSweepAngle(),a=o==2*Math.PI,u=Math.floor(o*i/(2*Math.PI)),l=this.getVertices();u=Math.max(3,u),a?this.setPrimitiveMode(t.LINE_LOOP):(++u,this.setPrimitiveMode(t.LINE_STRIP));for(var h=a?u:u-1,c=0;c<u;++c){var d=c/h,p=n+o*d,f=s.Polar(r,p);l.push(f.real,f.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(!1)}}),l}),define("x_ite/Components/Geometry2D/ArcClose2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(o.ArcClose2D),this.setGeometryType(2),this.startAngle_.setUnit("angle"),this.endAngle_.setUnit("angle"),this.radius_.setUnit("length")}var h=new s(.5,.5);return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"closureType",new e.SFString("PIE")),new i(o.inputOutput,"startAngle",new e.SFFloat),new i(o.inputOutput,"endAngle",new e.SFFloat(1.5708)),new i(o.initializeOnly,"radius",new e.SFFloat(1)),new i(o.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"ArcClose2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getArcClose2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getArcClose2DOptions().removeInterest("eventsProcessed",this)},getSweepAngle:function(){var t=u.interval(this.startAngle_.getValue(),0,2*Math.PI),e=u.interval(this.endAngle_.getValue(),0,2*Math.PI);if(t===e)return 2*Math.PI;var i=Math.abs(e-t);return t>e?2*Math.PI-i:isNaN(i)?0:i},build:function(){var t=this.getBrowser().getArcClose2DOptions(),e="CHORD"===this.closureType_.getValue(),i=t.dimension_.getValue(),n=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getSweepAngle(),a=(Math.PI,Math.max(4,Math.floor(o*i/(2*Math.PI)))),u=[],l=this.getNormals(),c=this.getVertices(),d=[],p=[];this.getTexCoords().push(u);for(var f=a-1,g=0;g<a;++g){var m=g/f,x=n+o*m;d.push(s.Polar(.5,x).add(h)),p.push(s.Polar(r,x))}if(e)for(var y=d[0],_=p[0],v=1;v<f;++v){var w=d[v],b=d[v+1],S=p[v],C=p[v+1];u.push(y.real,y.imag,0,1,w.real,w.imag,0,1,b.real,b.imag,0,1),l.push(0,0,1,0,0,1,0,0,1),c.push(_.real,_.imag,0,1,S.real,S.imag,0,1,C.real,C.imag,0,1)}else for(var v=0;v<f;++v){var w=d[v],b=d[v+1],S=p[v],C=p[v+1];u.push(.5,.5,0,1,w.real,w.imag,0,1,b.real,b.imag,0,1),l.push(0,0,1,0,0,1,0,0,1),c.push(0,0,0,1,S.real,S.imag,0,1,C.real,C.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(this.solid_.getValue())}}),l}),define("x_ite/Components/Sound/X3DSoundSourceNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),i.call(this,t),this.addType(n.X3DSoundSourceNode),this.volume=0,this.media=null}return r.prototype=t.extend(Object.create(e.prototype),i.prototype,{constructor:r,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this)},set_browser_live__:function(){i.prototype.set_browser_live__.call(this),this.getDisabled()?(this.getBrowser().volume_.removeInterest("set_volume__",this),this.getBrowser().mute_.removeInterest("set_volume__",this)):(this.getBrowser().volume_.addInterest("set_volume__",this),this.getBrowser().mute_.addInterest("set_volume__",this),this.set_volume__())},setMedia:function(t){if(this.media&&(this.media[0].volume=0,this.media[0].pause(),this.media.unbind("ended")),this.media=t,t){var e=t[0];this.setVolume(0),this.duration_changed_=e.duration,this.enabled_.getValue()&&this.isActive_.getValue()&&(this.loop_.getValue()?e.currentTime=this.getElapsedTime()%e.duration:e.currentTime=this.getElapsedTime(),this.isPaused_.getValue()||this.speed_.getValue()&&e.play())}},getMedia:function(){return this.media},setVolume:function(t){this.volume=t,this.set_volume__()},set_volume__:function(){this.media&&(this.media[0].volume=!this.getBrowser().mute_.getValue()*this.getBrowser().volume_.getValue()*this.volume)},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this.speed_.getValue()&&(this.media[0].currentTime=0,this.media[0].play())},set_pause:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_resume:function(){this.media&&this.speed_.getValue()&&this.media[0].play()},set_stop:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_ended:function(){if(this.media){var t=this.media[0];if(t.currentTime<t.duration)return;this.loop_.getValue()?(this.speed_.getValue()&&t.play(),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=this.getBrowser().getCurrentTime()):this.stop()}},set_time:function(){this.set_ended(),this.elapsedTime_=this.getElapsedTime()}}),r}),define("x_ite/Components/Sound/AudioClip",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),o.call(this,t),this.addType(s.AudioClip),this.addChildObjects("buffer",new e.SFTime),this.urlStack=new e.MFString}return h.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:h,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"description",new e.SFString),new i(s.inputOutput,"url",new e.MFString),new i(s.inputOutput,"speed",new e.SFFloat(1)),new i(s.inputOutput,"pitch",new e.SFFloat(1)),new i(s.inputOutput,"loop",new e.SFBool),new i(s.inputOutput,"startTime",new e.SFTime),new i(s.inputOutput,"resumeTime",new e.SFTime),new i(s.inputOutput,"pauseTime",new e.SFTime),new i(s.inputOutput,"stopTime",new e.SFTime),new i(s.outputOnly,"isPaused",new e.SFBool),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"cycleTime",new e.SFTime),new i(s.outputOnly,"elapsedTime",new e.SFTime),new i(s.outputOnly,"duration_changed",new e.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.audio=t("<audio></audio>"),this.audio.on("error",this.setError.bind(this)),this.audio.bind("abort",this.setError.bind(this)),this.audio[0].preload="auto",this.audio[0].volume=0,this.audio[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.setMedia(null),this.urlStack.setValue(this.url_),this.audio.bind("canplaythrough",this.setAudio.bind(this)),this.loadNext())},loadNext:function(){if(0===this.urlStack.length)return this.duration_changed_=-1,void this.setLoadState(s.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.audio.attr("src",this.URL)},setError:function(){var t=this.URL.toString();l&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+t)),"data"!==this.URL.scheme&&console.warn("Error loading audio:",this.URL.toString()),this.loadNext()},setAudio:function(){l&&"data"!==this.URL.scheme&&console.info("Done loading audio:",this.URL.toString()),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(s.COMPLETE_STATE)}}),h}),define("x_ite/Components/Navigation/Billboard",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(o.Billboard),this.matrix=new l}var c=new l,d=new a(0,1,0),p=new a(0,0,1),f=new a(0,0,0),g=new a(0,0,0),m=new a(0,0,0),x=new a(0,0,0),y=new a(0,0,0),_=new u(0,0,1,0);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"axisOfRotation",new e.SFVec3f(0,1,0)),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},getBBox:function(t){return r.prototype.getBBox.call(this,t).multRight(this.matrix)},getMatrix:function(){return this.matrix},rotate:function(t){c.assign(t).inverse();var e=c.origin.normalize();if(this.axisOfRotation_.getValue().equals(a.Zero)){c.multDirMatrix(f.assign(d)).normalize(),g.assign(f).cross(e),m.assign(e).cross(g);var i=e;g.normalize(),m.normalize(),this.matrix.set(g[0],g[1],g[2],0,m[0],m[1],m[2],0,i[0],i[1],i[2],0,0,0,0,1)}else x.assign(this.axisOfRotation_.getValue()).cross(e),y.assign(this.axisOfRotation_.getValue()).cross(p),this.matrix.setRotation(_.setFromToVec(y,x));return this.matrix},traverse:function(t,e){var i=e.getModelViewMatrix();i.push();try{switch(t){case s.CAMERA:case s.DEPTH:i.multLeft(this.matrix);break;default:i.multLeft(this.rotate(i.get()))}r.prototype.traverse.call(this,t,e)}catch(t){console.log(t)}i.pop()}}),h}),define("x_ite/Components/EventUtilities/BooleanFilter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.BooleanFilter)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_boolean",new e.SFBool),new i(o.outputOnly,"inputTrue",new e.SFBool),new i(o.outputOnly,"inputFalse",new e.SFBool),new i(o.outputOnly,"inputNegate",new e.SFBool)]),getTypeName:function(){return"BooleanFilter"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){var t=this.set_boolean_.getValue();t?this.inputTrue_=!0:this.inputFalse_=!1,this.inputNegate_=!t}}),s}),define("x_ite/Components/EventUtilities/X3DSequencerNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DSequencerNode),this.index=-1}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.previous_.addInterest("set_previous__",this),this.next_.addInterest("set_next__",this),this.key_.addInterest("set_index__",this)},set_fraction__:function(){var t=this.set_fraction_.getValue(),e=this.key_,i=e.length;if(0!==i){var r=0;if(1===i||t<=e[0])r=0;else if(t>=e[i-1])r=this.getSize()-1;else{var o=n.upperBound(e,0,i,t,n.less);r=o-1}r!==this.index&&r<this.getSize()&&this.sequence(this.index=r)}},set_previous__:function(){this.previous_.getValue()&&(this.index<=0?this.index=this.getSize()-1:--this.index,this.index<this.getSize()&&this.sequence(this.index))},set_next__:function(){this.next_.getValue()&&(this.index>=this.getSize()-1?this.index=0:++this.index,this.index<this.getSize()&&this.sequence(this.index))},set_index__:function(){this.index=-1}}),r}),define("x_ite/Components/EventUtilities/BooleanSequencer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DSequencerNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.BooleanSequencer)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOnly,"previous",new e.SFBool),new i(o.inputOnly,"next",new e.SFBool),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFBool),new i(o.outputOnly,"value_changed",new e.SFBool)]),getTypeName:function(){return"BooleanSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_index__",this)},getSize:function(){return this.keyValue_.length},sequence:function(t){this.value_changed_=this.keyValue_[t]}}),s}),define("x_ite/Components/EventUtilities/BooleanToggle",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.BooleanToggle)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_boolean",new e.SFBool),new i(o.inputOutput,"toggle",new e.SFBool)]),getTypeName:function(){return"BooleanToggle"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.set_boolean_.getValue()&&(this.toggle_=!this.toggle_.getValue())}}),s}),define("x_ite/Components/EventUtilities/X3DTriggerNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DTriggerNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/EventUtilities/BooleanTrigger",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.BooleanTrigger)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_triggerTime",new e.SFTime),new i(o.outputOnly,"triggerTrue",new e.SFBool)]),getTypeName:function(){return"BooleanTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_triggerTime_.addInterest("set_triggerTime__",this)},set_triggerTime__:function(){this.triggerTrue_=!0}}),s}),define("x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode",["jquery","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DParticlePhysicsModelNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,addForce:function(){}}),n}),define("x_ite/Components/ParticleSystems/BoundedPhysicsModel",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.BoundedPhysicsModel)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"BoundedPhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},initialize:function(){r.prototype.initialize.call(this),this.geometry_.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:function(){this.geometryNode&&this.geometryNode.removeInterest("addNodeEvent",this),this.geometryNode=s(o.X3DGeometryNode,this.geometry_),this.geometryNode&&this.geometryNode.addInterest("addNodeEvent",this)},addGeometry:function(t,e){if(this.geometryNode){for(var i=this.geometryNode.getNormals(),n=this.geometryNode.getVertices(),r=0,o=i.length;r<o;++r)t.push(i[r]);for(var r=0,o=n.length;r<o;++r)e.push(n[r])}}}),a}),define("x_ite/Components/Geometry3D/Box",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Box),this.size_.setUnit("length")}var u=new s(2,2,2);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"size",new e.SFVec3f(2,2,2)),new i(o.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){var t=this.getBrowser().getBoxOptions(),e=t.getGeometry(),i=this.size_.getValue();if(this.setNormals(e.getNormals()),this.setTexCoords(e.getTexCoords()),i.equals(u))this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{for(var n=s.divide(i,2),r=n.x,o=n.y,a=n.z,l=e.getVertices(),h=this.getVertices(),c=0;c<l.length;c+=4)h.push(r*l[c],o*l[c+1],a*l[c+2],1);r=Math.abs(r),o=Math.abs(o),a=Math.abs(a),this.getMin().set(-r,-o,-a),this.getMax().set(r,o,a)}this.setSolid(this.solid_.getValue())}}),a}),define("x_ite/Components/CADGeometry/X3DProductStructureChildNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DProductStructureChildNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/CADGeometry/CADAssembly",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.CADAssembly)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOnly,"addChildren",new e.MFNode),new i(s.inputOnly,"removeChildren",new e.MFNode),new i(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADAssembly"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"}}),a}),define("x_ite/Components/CADGeometry/CADFace",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),o.call(this,t),this.addType(a.CADFace),this.shapeNode=null}return u.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"name",new e.SFString),new i(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(a.initializeOnly,"bboxCenter",new e.SFVec3f),new i(a.inputOutput,"shape",new e.SFNode)]),getTypeName:function(){return"CADFace"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.shape_.addInterest("set_shape__",this),this.set_shape__()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=s(a.X3DBoundedObject,this.shape_);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_shape__:function(){this.shapeNode&&this.shapeNode.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.shapeNode=null;try{for(var t=this.shape_.getValue().getInnerNode(),e=t.getType(),i=e.length-1;i>=0;--i)switch(e[i]){case a.LOD:case a.Transform:case a.X3DShapeNode:t.isCameraObject_.addFieldInterest(this.isCameraObject_),this.shapeNode=t;break;default:continue}}catch(t){}this.shapeNode?delete this.traverse:this.traverse=Function.prototype},traverse:function(t,e){this.shapeNode.traverse(t,e)}}),u}),define("x_ite/Components/CADGeometry/CADLayer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.CADLayer)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"name",new e.SFString),new i(o.inputOutput,"visible",new e.MFBool),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADLayer"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.visible_.addInterest("set_children__",this)},getVisible:function(){return this.visible_},remove:function(){this.set_children__()}}),s}),define("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["jquery","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o){"use strict";function s(t){e.call(this,t),this.addType(i.X3DTransformMatrix3DNode),this.matrix=new o}return s.prototype=t.extend(Object.create(e.prototype),{constructor:s,getBBox:function(t){var t=e.prototype.getBBox.call(this,t);return this.traverse===s.prototype.traverse?t.multRight(this.matrix):t},setMatrix:function(t){t.equals(o.Identity)?(this.matrix.identity(),this.traverse=e.prototype.traverse):(this.matrix.assign(t),delete this.traverse)},getMatrix:function(){return this.matrix},setTransform:function(t,i,o,s,a){t.equals(n.Zero)&&i.equals(r.Identity)&&o.equals(n.One)?(this.matrix.identity(),this.traverse=e.prototype.traverse):(this.matrix.set(t,i,o,s,a),delete this.traverse)},traverse:function(t,i){var n=i.getModelViewMatrix();n.push(),n.multLeft(this.matrix),e.prototype.traverse.call(this,t,i),n.pop()}}),s}),define("x_ite/Components/Grouping/X3DTransformNode",["jquery","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DTransformNode),this.translation_.setUnit("length"),this.center_.setUnit("length")}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){e.prototype.eventsProcessed.call(this),this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),n}),define("x_ite/Components/CADGeometry/CADPart",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.CADPart)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"translation",new e.SFVec3f),new i(s.inputOutput,"rotation",new e.SFRotation),new i(s.inputOutput,"scale",new e.SFVec3f(1,1,1)),new i(s.inputOutput,"scaleOrientation",new e.SFRotation),new i(s.inputOutput,"center",new e.SFVec3f),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOnly,"addChildren",new e.MFNode),new i(s.inputOnly,"removeChildren",new e.MFNode),new i(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADPart"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this)}}),a}),define("x_ite/Components/Geometry2D/Circle2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Circle2D),this.setGeometryType(1),this.radius_.setUnit("length")}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"radius",new e.SFFloat(1))]),getTypeName:function(){return"Circle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCircle2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getCircle2DOptions().removeInterest("eventsProcessed",this)},build:function(){var t=this.getBrowser().getCircle2DOptions(),e=this.radius_.getValue(),i=t.getVertices(),n=this.getVertices();if(1===e)this.setVertices(i);else for(var r=0,o=i.length;r<o;r+=4)n.push(i[r]*e,i[r+1]*e,0,1);this.getMin().set(-e,-e,0),this.getMax().set(e,e,0)}}),s}),define("x_ite/Components/Rendering/ClipPlane",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(){this.plane=new u(s.Zero,s.Zero)}function c(t){r.call(this,t),this.addType(o.ClipPlane),this.enabled=!1,this.plane=new a(0,0,0,0)}var d=l(h);return h.prototype={constructor:h,isClipped:function(t){return this.plane.getDistanceToPoint(t)<0},set:function(t,e){var i=this.plane,n=t.plane;try{i.normal.assign(n),i.distanceFromOrigin=-n.w,i.multRight(e)}catch(t){i.normal.set(0,0,0),i.distanceFromOrigin=0}},setShaderUniforms:function(t,e,i){var n=this.plane,r=n.normal;t.uniform4f(e.x3d_ClipPlane[i],r.x,r.y,r.z,n.distanceFromOrigin)},dispose:function(){d.push(this)}},c.prototype=t.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"plane",new e.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.plane_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this.plane_.getValue()),this.enabled=this.enabled_.getValue()&&!this.plane.equals(a.Zero)},push:function(t){if(this.enabled){var e=d.pop();e.set(this,t.getModelViewMatrix().get()),t.getClipPlanes().push(e)}},pop:function(t){this.enabled&&t.getBrowser().getClipPlanes().push(t.getClipPlanes().pop())}}),c}),
define("x_ite/Components/Navigation/Collision",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(u.Collision),this.addAlias("collide",this.enabled_)}return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.inputOutput,"enabled",new e.SFBool(!0)),new i(u.outputOnly,"isActive",new e.SFBool),new i(u.outputOnly,"collideTime",new e.SFTime),new i(u.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(u.initializeOnly,"bboxCenter",new e.SFVec3f),new i(u.initializeOnly,"proxy",new e.SFNode),new i(u.inputOnly,"addChildren",new e.MFNode),new i(u.inputOnly,"removeChildren",new e.MFNode),new i(u.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.proxy_.addInterest("set_proxy__",this),this.set_live__(),this.set_proxy__()},set_live__:function(){this.isLive().getValue()&&this.enabled_.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(t){this.isActive_.getValue()!==t&&(this.isActive_=t,t&&(this.collideTime_=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=s(u.X3DChildNode,this.proxy_)},traverse:function(t,e){switch(t){case a.COLLISION:if(this.enabled_.getValue()){var i=e.getCollisions();i.push(this),this.proxyNode?this.proxyNode.traverse(t,e):r.prototype.traverse.call(this,t,e),i.pop()}break;default:r.prototype.traverse.call(this,t,e)}}}),l}),define("x_ite/Components/Rendering/X3DColorNode",["jquery","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DColorNode),this.color=this.color_.getValue()}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,get1Color:function(t){return t>=0&&t<this.color.length?this.color[t].getValue():this.color.length?this.color[this.color.length-1].getValue():this.getWhite()}}),n}),define("x_ite/Components/Rendering/Color",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.Color)}var l=new s(1,1,1);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"color",new e.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},isTransparent:function(){return!1},getWhite:function(){return l},getVectors:function(t){for(var e=this.color_.getValue(),i=0,n=e.length;i<n;++i){var r=e[i].getValue();t[i]=new a(r.r,r.g,r.b,1)}return t.length=n,t}}),u}),define("x_ite/Components/Followers/X3DFollowerNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},duplicate:function(t){return t.copy()},getBuffer:function(){return this.buffer},getValue:function(){return this.set_value_.getValue()},getDestination:function(){return this.set_destination_.getValue()},getInitialValue:function(){return this.initialValue_.getValue()},getInitialDestination:function(){return this.initialDestination_.getValue()},setValue:function(t){this.value_changed_=t},assign:function(t,e,i){t[e].assign(i)},equals:function(t,e,i){return this.a.assign(t).subtract(e).abs()<i},interpolate:function(t,e,i){return this.vector.assign(t).lerp(e,i)},set_live__:function(){this.isLive().getValue()&&this.isActive_.getValue()?(this.getBrowser().prepareEvents().addInterest("prepareEvents",this),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest("prepareEvents",this)},set_active:function(t){t!==this.isActive_.getValue()&&(this.isActive_=t,this.set_live__())}}),n}),define("x_ite/Components/Followers/X3DChaserNode",["jquery","x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getArray()}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this),this.duration_.addInterest("set_duration__",this),this.set_duration__();var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.duplicate(i),t[0]=this.duplicate(n);for(var o=1;o<r;++o)t[o]=this.duplicate(i);this.destination=this.duplicate(n),this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(t){this.previousValue.assign(t)},step:function(t,e,i){this.output.add(this.deltaOut.assign(t).subtract(e).multiply(i))},stepResponse:function(t){if(t<=0)return 0;var e=this.duration_.getValue();return t>=e?1:.5-.5*Math.cos(t/e*Math.PI)},set_value__:function(){this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var t=this.getBuffer(),e=this.getValue(),i=1,n=t.length;i<n;++i)this.assign(t,i,e);this.setPreviousValue(e),this.setValue(e),this.set_active(!0)},set_destination__:function(){this.destination=this.duplicate(this.getDestination()),this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime()),this.set_active(!0)},set_duration__:function(){this.stepTime=this.duration_.getValue()/this.getNumBuffers()},prepareEvents:function(){try{var t=this.getBuffer(),e=t.length,i=this.updateBuffer();this.output=this.interpolate(this.previousValue,t[e-1],this.stepResponse((e-1+i)*this.stepTime));for(var n=e-2;n>=0;--n)this.step(t[n],t[n+1],this.stepResponse((n+i)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)}catch(t){}},updateBuffer:function(){var t=this.getBuffer(),e=t.length,i=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(i>=1){var n=Math.floor(i);if(i-=n,n<e){this.setPreviousValue(t[e-n]);for(var r=e-1;r>=n;--r)this.assign(t,r,t[r-n]);for(var r=0;r<n;++r)try{var o=r/n;this.assign(t,r,this.interpolate(this.destination,t[n],o))}catch(t){}}else{this.setPreviousValue(n==e?t[0]:this.destination);for(var r=0;r<e;++r)this.assign(t,r,this.destination)}this.bufferEndTime+=n*this.stepTime}return i}}),n}),define("x_ite/Components/Followers/ColorChaser",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.ColorChaser)}var l=new a(0,0,0),h=new a(0,0,0),c=new a(0,0,0),d=new a(0,0,0);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFColor),new i(o.inputOnly,"set_destination",new e.SFColor),new i(o.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new i(o.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new i(o.initializeOnly,"duration",new e.SFTime(1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(d)},getDestination:function(){return this.set_destination_.getValue().getHSV(d)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(l)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(h)},setValue:function(t){this.value_changed_.setHSV(t.x,t.y,t.z)},interpolate:function(t,e,i){return s.lerp(t,e,i,d)},step:function(t,e,i){c.assign(this.output).add(t).subtract(e),s.lerp(this.output,c,i,this.output)}}),u}),define("x_ite/Components/Followers/X3DDamperNode",["jquery","x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DDamperNode)}return r.prototype=t.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.order_.addInterest("set_order__",this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this);var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination();t[0]=this.duplicate(n);for(var r=1,o=this.getOrder()+1;r<o;++r)t[r]=this.duplicate(i);this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getOrder:function(){return n.clamp(this.order_.getValue(),0,5)},getTolerance:function(){return this.tolerance_.getValue()<0?1e-4:this.tolerance_.getValue()},prepareEvents:function(){var t=this.getBuffer(),e=t.length-1;if(this.tau_.getValue()){for(var i=1/this.getBrowser().currentFrameRate,n=Math.exp(-i/this.tau_.getValue()),r=0;r<e;++r)try{this.assign(t,r+1,this.interpolate(t[r],t[r+1],n))}catch(t){}if(this.setValue(t[e]),!this.equals(t[e],t[0],this.getTolerance()))return}else this.setValue(t[0]),e=0;for(var r=1,o=t.length;r<o;++r)this.assign(t,r,t[e]);this.set_active(!1)},set_value__:function(){for(var t=this.getBuffer(),e=this.getValue(),i=1,n=t.length;i<n;++i)this.assign(t,i,e);this.setValue(e),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var t=this.getBuffer(),e=t[t.length-1],i=t.length,n=this.getOrder()+1;i<n;++i)t[i]=this.duplicate(e);t.length=n}}),r}),define("x_ite/Components/Followers/ColorDamper",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.ColorDamper)}var l=new a(0,0,0),h=new a(0,0,0),c=new a(0,0,0),d=new a(0,0,0);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFColor),new i(o.inputOnly,"set_destination",new e.SFColor),new i(o.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new i(o.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new i(o.initializeOnly,"order",new e.SFInt32(3)),new i(o.inputOutput,"tau",new e.SFTime(.3)),new i(o.inputOutput,"tolerance",new e.SFFloat(-1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(d)},getDestination:function(){return this.set_destination_.getValue().getHSV(d)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(h)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(c)},setValue:function(t){this.value_changed_.setHSV(t.x,t.y,t.z)},equals:function(t,e,i){return l.assign(t).subtract(e).abs()<i},interpolate:function(t,e,i){return s.lerp(t,e,i,d)}}),u}),define("x_ite/Components/Interpolation/ColorInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.ColorInterpolator),this.hsv=[]}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFColor),new i(o.outputOnly,"value_changed",new e.SFColor)]),value:[],getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.keyValue_.getValue();t.length<this.key_.length&&this.keyValue_.resize(this.key_.length,t.length?t[this.keyValue_.length-1]:new e.SFColor),this.hsv.length=0;for(var i=0,n=t.length;i<n;++i)this.hsv.push(t[i].getHSV([]))},interpolate:function(t,e,i){var n=s.lerp(this.hsv[t],this.hsv[e],i,this.value);this.value_changed_.setHSV(n[0],n[1],n[2])}}),a}),define("x_ite/Components/Rendering/ColorRGBA",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color4","standard/Math/Numbers/Vector4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.ColorRGBA)}var l=new s(1,1,1,1);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"color",new e.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},isTransparent:function(){return!0},getWhite:function(){return l},getVectors:function(t){for(var e=this.color_.getValue(),i=0,n=e.length;i<n;++i){var r=e[i].getValue();t[i]=new a(r.r,r.g,r.b,r.a)}return t.length=n,t}}),u}),define("x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode",["jquery","x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DEnvironmentTextureNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.target=t.TEXTURE_CUBE_MAP,this.targets=[t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y]},set_live__:function(){this.isLive().getValue()?(this.getBrowser().getBrowserOptions().TextureQuality_.addInterest("set_textureQuality__",this),this.set_textureQuality__()):this.getBrowser().getBrowserOptions().TextureQuality_.removeInterest("set_textureQuality__",this)},set_textureQuality__:function(){var t=this.getBrowser().getDefaultTextureProperties();this.updateTextureProperties(this.target,!1,t,128,128,!1,!1,!1)},getTarget:function(){return this.target},getTargets:function(){return this.targets},setShaderUniforms:function(t,e,i){e.textureTypeArray[i]=4,t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_CUBE_MAP,this.getTexture()),t.uniform1iv(e.x3d_TextureType,e.textureTypeArray)}}),n}),define("x_ite/Components/CubeMapTexturing/ComposedCubeMapTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.ComposedCubeMapTexture),this.textures=[null,null,null,null,null,null],this.loadStates=0}var u=new Uint8Array([255,255,255,255]);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"front",new e.SFNode),new i(s.inputOutput,"back",new e.SFNode),new i(s.inputOutput,"left",new e.SFNode),new i(s.inputOutput,"right",new e.SFNode),new i(s.inputOutput,"bottom",new e.SFNode),new i(s.inputOutput,"top",new e.SFNode)]),getTypeName:function(){return"ComposedCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this);var t=this.getBrowser().getContext();t.bindTexture(this.getTarget(),this.getTexture());for(var e=0;e<6;++e)t.texImage2D(this.getTargets()[e],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,u);this.isLive().addInterest("set_live__",this),this.front_.addInterest("set_texture__",this,0),this.back_.addInterest("set_texture__",this,1),this.left_.addInterest("set_texture__",this,2),this.right_.addInterest("set_texture__",this,3),this.top_.addInterest("set_texture__",this,5),this.bottom_.addInterest("set_texture__",this,4),this.set_texture__(this.front_,0),this.set_texture__(this.back_,1),this.set_texture__(this.left_,2),this.set_texture__(this.right_,3),this.set_texture__(this.top_,4),this.set_texture__(this.bottom_,5),this.set_live__()},set_texture__:function(t,e){var i=this.textures[e];if(i){var n="set_loadState__"+i.getId()+"_"+e;i.removeInterest("set_loadState__",this),i.loadState_.removeFieldCallback(n)}var i=this.textures[e]=o(s.X3DTexture2DNode,t);if(i){var n="set_loadState__"+i.getId()+"_"+e;i.addInterest("set_loadState__",this,i,e),i.loadState_.addFieldCallback(n,this.set_loadState__.bind(this,null,i,e))}this.set_loadState__(null,i,e)},set_loadState__:function(t,e,i){e?this.setLoadStateBit(e.checkLoadState(),i):this.setLoadStateBit(s.NOT_STARTED,i),this.setTextures()},setLoadStateBit:function(t,e){t===s.COMPLETE_STATE?this.loadStates|=1<<e:this.loadStates&=~(1<<e)},isComplete:function(){if(63!==this.loadStates)return!1;for(var t=this.textures,e=t[0].getWidth(),i=0;i<6;++i){var n=t[i];if(n.getWidth()!==e)return!1;if(n.getHeight()!==e)return!1}return!0},setTextures:function(){var t=this.getBrowser().getContext();if(t.bindTexture(this.getTarget(),this.getTexture()),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),this.isComplete()){for(var e=this.textures,i=0;i<6;++i){var t=this.getBrowser().getContext(),n=e[i],r=n.getWidth(),o=n.getHeight(),s=n.getData();t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!n.getFlipY()),t.pixelStorei(t.UNPACK_ALIGNMENT,1),s instanceof Uint8Array?t.texImage2D(this.getTargets()[i],0,t.RGBA,r,o,!1,t.RGBA,t.UNSIGNED_BYTE,s):t.texImage2D(this.getTargets()[i],0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s)}this.set_textureQuality__()}else for(var i=0;i<6;++i)t.texImage2D(this.getTargets()[i],0,t.RGBA,1,1,!1,t.RGBA,t.UNSIGNED_BYTE,u);this.set_transparent__()},set_transparent__:function(){var t=this.textures,e=!1;if(this.isComplete())for(var i=0;i<6;++i)if(t[i].transparent_.getValue()){e=!0;break}e!==this.transparent_.getValue()&&(this.transparent_=e)}}),a}),define("x_ite/Components/Geometry3D/Cone",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(o.Cone),this.height_.setUnit("length"),this.bottomRadius_.setUnit("length")}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"side",new e.SFBool(!0)),new i(o.initializeOnly,"bottom",new e.SFBool(!0)),new i(o.initializeOnly,"height",new e.SFFloat(2)),new i(o.initializeOnly,"bottomRadius",new e.SFFloat(1)),new i(o.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest("eventsProcessed",this):this.getBrowser().getConeOptions().removeInterest("eventsProcessed",this)},build:function(){var t=this.getBrowser().getConeOptions(),e=t.xDimension_.getValue(),i=this.height_.getValue(),n=this.bottomRadius_.getValue(),r=[],o=this.getNormals(),l=this.getVertices();this.getTexCoords().push(r);var h=i/2,c=-h,d=s.Polar(1,-Math.PI/2+Math.atan(n/i));if(this.side_.getValue())for(var p=0;p<e;++p){var f=(p+.5)/e,g=2*Math.PI*f,m=s.Polar(d.imag,g),x=p/e,y=2*Math.PI*x,_=s.Polar(-n,y),v=s.Polar(d.imag,y),w=(p+1)/e,b=2*Math.PI*w,S=s.Polar(-n,b),C=s.Polar(d.imag,b);r.push(f,1,0,1),o.push(m.imag,d.real,m.real),l.push(0,h,0,1),r.push(x,0,0,1),o.push(v.imag,d.real,v.real),l.push(_.imag,c,_.real,1),r.push(w,0,0,1),o.push(C.imag,d.real,C.real),l.push(S.imag,c,S.real,1)}if(this.bottom_.getValue()){for(var F=[],T=[],p=e-1;p>-1;--p){var N=p/e,O=2*Math.PI*N,M=s.Polar(-1,O),V=s.multiply(M,n);F.push(new a((M.imag+1)/2,(M.real+1)/2)),T.push(new u(V.imag,c,V.real))}for(var D=F[0],B=T[0],p=1,I=T.length-1;p<I;++p){var E=F[p],A=F[p+1],P=T[p],_=T[p+1];r.push(D.x,D.y,0,1),o.push(0,-1,0),l.push(B.x,B.y,B.z,1),r.push(E.x,E.y,0,1),o.push(0,-1,0),l.push(P.x,P.y,P.z,1),r.push(A.x,A.y,0,1),o.push(0,-1,0),l.push(_.x,_.y,_.z,1)}}this.setSolid(this.solid_.getValue()),this.setNormals(o),this.setExtents()},setExtents:function(){var t=this.bottomRadius_.getValue(),e=this.height_.getValue()/2,i=-e;this.side_.getValue()||this.bottom_.getValue()?this.side_.getValue()?(this.getMin().set(-t,i,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,i,-t),this.getMax().set(t,i,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),l}),define("x_ite/Components/ParticleSystems/ConeEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.ConeEmitter),this.position_.setUnit("length"),this.angle_.setUnit("angle"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.rotation=new a(0,0,1,0)}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"position",new e.SFVec3f),new i(o.inputOutput,"direction",new e.SFVec3f(0,1,0)),new i(o.inputOutput,"angle",new e.SFFloat(.7854)),new i(o.inputOutput,"speed",new e.SFFloat),new i(o.inputOutput,"variation",new e.SFFloat(.25)),new i(o.initializeOnly,"mass",new e.SFFloat),new i(o.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"ConeEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.direction_.addInterest("set_direction__",this),this.angle_.addInterest("set_angle__",this),this.set_position__(),this.set_direction__(),this.set_angle__()},set_position__:function(){this.position=this.position_.getValue()},set_direction__:function(){var t=this.direction_.getValue();this.rotation.setFromToVec(s.zAxis,t),t.equals(s.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_angle__:function(){this.angle=this.angle_.getValue()},getRandomPosition:function(t){return t.assign(this.position)},getRandomVelocity:function(t){return this.rotation.multVecRot(this.getRandomNormalWithAngle(this.angle,t).multiply(this.getRandomSpeed()))}}),u}),define("x_ite/Browser/Followers/X3DArrayFollowerTemplate",[],function(){"use strict";return function(t){function e(){this.array=this.getArray()}return e.prototype={getValue:function(){return this.set_value_},getDestination:function(){return this.set_destination_},getInitialValue:function(){return this.initialValue_},getInitialDestination:function(){return this.initialDestination_},assign:function(t,e,i){t[e].setValue(i)},equals:function(t,e,i){for(var n=this.a,r=t.getValue(),o=e.getValue(),s=0,a=0,u=r.length;a<u;++a)s=Math.max(n.assign(r[a].getValue()).subtract(o[a].getValue()).abs());return s<i},interpolate:function(t,e,i){var n=this.array.getValue(),r=t.getValue(),o=e.getValue();this.array.length=r.length;for(var s=0,a=r.length;s<a;++s)n[s].getValue().assign(r[s].getValue()).lerp(o[s].getValue(),i);return this.array},set_value__:function(){this.getBuffer()[0].length=this.set_value_.length,t.prototype.set_value__.call(this)},set_destination__:function(){for(var e=this.getBuffer(),i=this.set_destination_.length,n=0,r=e.length;n<r;++n)e[n].length=i;t.prototype.set_destination__.call(this)}},e}}),define("x_ite/Browser/Followers/X3DArrayChaserTemplate",["jquery","x_ite/Browser/Followers/X3DArrayFollowerTemplate"],function(t,e){"use strict";return function(i){function n(){this.array=this.getArray()}return n.prototype=t.extend(Object.create(e(i).prototype),{setPreviousValue:function(t){this.previousValue.setValue(t)},step:function(t,e,i){var n=this.output.getValue(),r=this.deltaOut.getValue();t=t.getValue(),e=e.getValue(),this.deltaOut.length=n.length;for(var o=0,s=n.length;o<s;++o)n[o].getValue().add(r[o].getValue().assign(t[o].getValue()).subtract(e[o].getValue()).multiply(i))}}),n}}),define("x_ite/Components/Followers/CoordinateChaser",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),l.call(this,t),this.addType(s.CoordinateChaser)}var l=o(r);return u.prototype=t.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_value",new e.MFVec3f),new i(s.inputOnly,"set_destination",new e.MFVec3f),new i(s.initializeOnly,"initialValue",new e.MFVec3f(new a(0,0,0))),new i(s.initializeOnly,"initialDestination",new e.MFVec3f(new a(0,0,0))),new i(s.initializeOnly,"duration",new e.SFTime(1)),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new e.MFVec3f}}),u}),define("x_ite/Components/Followers/CoordinateDamper",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),l.call(this,t),this.addType(s.CoordinateDamper)}var l=o(r);return u.prototype=t.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_value",new e.MFVec3f),new i(s.inputOnly,"set_destination",new e.MFVec3f),new i(s.initializeOnly,"initialValue",new e.MFVec3f(new a(0,0,0))),new i(s.initializeOnly,"initialDestination",new e.MFVec3f(new a(0,0,0))),new i(s.initializeOnly,"order",new e.SFInt32(3)),new i(s.inputOutput,"tau",new e.SFTime(.3)),new i(s.inputOutput,"tolerance",new e.SFFloat(-1)),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new e.MFVec3f}}),u}),define("x_ite/Components/NURBS/CoordinateDouble",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.CoordinateDouble)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"CoordinateDouble"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"coord"}}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.CoordinateInterpolator)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFVec3f),new i(o.outputOnly,"value_changed",new e.MFVec3f)]),keyValue:new s(0,0,0),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,i){var n=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length?Math.floor(n.length/this.key_.length):0;t*=o,e=t+(this.key_.length>1?o:0),this.value_changed_.length=o;for(var s=0;s<o;++s)r[s].getValue().assign(n[t+s].getValue()).lerp(n[e+s].getValue(),i);this.value_changed_.addEvent()}}),a}),define("x_ite/Components/Interpolation/CoordinateInterpolator2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.CoordinateInterpolator2D)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFVec2f),new i(o.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,i){var n=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length?Math.floor(n.length/this.key_.length):0;t*=o,e=t+(this.key_.length>1?o:0),this.value_changed_.length=o;for(var s=0;s<o;++s)r[s].getValue().assign(n[t+s].getValue()).lerp(n[e+s].getValue(),i);this.value_changed_.addEvent()}}),s}),
define("x_ite/Components/Geometry3D/Cylinder",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(o.Cylinder),this.height_.setUnit("length"),this.radius_.setUnit("length")}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"top",new e.SFBool(!0)),new i(o.initializeOnly,"side",new e.SFBool(!0)),new i(o.initializeOnly,"bottom",new e.SFBool(!0)),new i(o.initializeOnly,"height",new e.SFFloat(2)),new i(o.initializeOnly,"radius",new e.SFFloat(1)),new i(o.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest("eventsProcessed",this):this.getBrowser().getCylinderOptions().removeInterest("eventsProcessed",this)},build:function(){var t=this.getBrowser().getCylinderOptions(),e=t.xDimension_.getValue(),i=[],n=this.getNormals(),r=this.getVertices();this.getTexCoords().push(i);var o=this.radius_.getValue(),l=this.height_.getValue()/2,h=-l;if(this.side_.getValue())for(var c=0;c<e;++c){var d=c/e,p=2*Math.PI*d,f=s.Polar(-1,p),g=s.multiply(f,o),m=(c+1)/e,x=2*Math.PI*m,y=s.Polar(-1,x),_=s.multiply(y,o);i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(d,0,0,1),n.push(f.imag,0,f.real),r.push(g.imag,h,g.real,1),i.push(m,0,0,1),n.push(y.imag,0,y.real),r.push(_.imag,h,_.real,1),i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(m,0,0,1),n.push(y.imag,0,y.real),r.push(_.imag,h,_.real,1),i.push(m,1,0,1),n.push(y.imag,0,y.real),r.push(_.imag,l,_.real,1)}if(this.top_.getValue()){for(var v=[],w=[],c=0;c<e;++c){var b=c/e,S=2*Math.PI*b,C=s.Polar(-1,S);v.push(new a((C.imag+1)/2,-(C.real-1)/2)),w.push(new u(C.imag*o,l,C.real*o))}for(var F=v[0],T=w[0],c=1,N=w.length-1;c<N;++c){var O=v[c],M=v[c+1],g=w[c],_=w[c+1];i.push(F.x,F.y,0,1),n.push(0,1,0),r.push(T.x,T.y,T.z,1),i.push(O.x,O.y,0,1),n.push(0,1,0),r.push(g.x,g.y,g.z,1),i.push(M.x,M.y,0,1),n.push(0,1,0),r.push(_.x,_.y,_.z,1)}}if(this.bottom_.getValue()){for(var v=[],w=[],c=e-1;c>-1;--c){var b=c/e,S=2*Math.PI*b,C=s.Polar(-1,S);v.push(new a((C.imag+1)/2,(C.real+1)/2)),w.push(new u(C.imag*o,h,C.real*o))}for(var F=v[0],T=w[0],c=1,N=w.length-1;c<N;++c){var O=v[c],M=v[c+1],g=w[c],_=w[c+1];i.push(F.x,F.y,0,1),n.push(0,-1,0),r.push(T.x,T.y,T.z,1),i.push(O.x,O.y,0,1),n.push(0,-1,0),r.push(g.x,g.y,g.z,1),i.push(M.x,M.y,0,1),n.push(0,-1,0),r.push(_.x,_.y,_.z,1)}}this.setSolid(this.solid_.getValue()),this.setNormals(n),this.setExtents()},setExtents:function(){var t=this.radius_.getValue(),e=this.height_.getValue()/2,i=-e;this.top_.getValue()||this.side_.getValue()||this.bottom_.getValue()?this.top_.getValue()||this.side_.getValue()?this.bottom_.getValue()||this.side_.getValue()?(this.getMin().set(-t,i,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,e,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,i,-t),this.getMax().set(t,i,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),l}),define("x_ite/Components/PointingDeviceSensor/X3DDragSensorNode",["jquery","x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DDragSensorNode),this.trackPoint_changed_.setUnit("length")}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],function(t,e,i,n){"use strict";function r(t,e){this.axis=t.copy(),this.radius=e}return r.prototype={constructor:r,intersectsLine:function(r,o,s){var a=new e(this.axis.direction,new t(0,1,0)),u=i.Rotation(a),l=1/this.radius,h=new i;h.scale(new t(l,l,l)),h.multLeft(u);var c=t.subtract(r.point,this.axis.point),d=new n(c,r.direction),p=d.multLineMatrix(h),f=this.unitCylinderIntersectsLine(p,o,s);if(f){var g=h.inverse();g.multVecMatrix(o),o.add(this.axis.point),g.multVecMatrix(s),s.add(this.axis.point)}return f},unitCylinderIntersectsLine:function(t,e,i){var n,r,o=t.point,s=t.direction,a=s[0]*s[0]+s[2]*s[2],u=2*(o[0]*s[0]+o[2]*s[2]),l=o[0]*o[0]+o[2]*o[2]-1,h=u*u-4*a*l;if(h<0)return!1;var c=Math.sqrt(h);return u>0?(n=-2*l/(c+u),r=-(c+u)/(2*a)):(n=2*l/(c-u),r=(c-u)/(2*a)),e.assign(s).multiply(n).add(o),i.assign(s).multiply(r).add(o),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r}),define("x_ite/Components/PointingDeviceSensor/CylinderSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c,d){"use strict";function p(t){r.call(this,t),this.addType(o.CylinderSensor),this.diskAngle_.setUnit("angle"),this.minAngle_.setUnit("angle"),this.maxAngle_.setUnit("angle"),this.offset_.setUnit("angle")}return p.prototype=t.extend(Object.create(r.prototype),{constructor:p,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"axisRotation",new e.SFRotation),new i(o.inputOutput,"diskAngle",new e.SFFloat(.261792)),new i(o.inputOutput,"minAngle",new e.SFFloat),new i(o.inputOutput,"maxAngle",new e.SFFloat(-1)),new i(o.inputOutput,"offset",new e.SFFloat),new i(o.inputOutput,"autoOffset",new e.SFBool(!0)),new i(o.outputOnly,"trackPoint_changed",new e.SFVec3f),new i(o.outputOnly,"rotation_changed",new e.SFRotation),new i(o.outputOnly,"isOver",new e.SFBool),new i(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.cylinder=new c(new l(new s(0,0,0),new s(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startOffset=new a(0,0,1,0)},isBehind:function(t,e){var i=new s(0,0,0),n=new s(0,0,0);return this.cylinder.intersectsLine(t,i,n),s.subtract(e,i).abs()>s.subtract(e,n).abs()},getTrackPoint:function(t,e){var i=new s(0,0,0);this.zPlane.intersectsLine(t,i);var n=s.add(i,this.cylinder.axis.getPerpendicularVector(i)),r=this.sxPlane.getDistanceToPoint(i)/this.cylinder.radius,o=Math.floor((r+1)/2),u=d.interval(r,-1,1),l=0===o?Math.asin(u):u*Math.PI/2,h=l+o*Math.PI;new a(this.cylinder.axis.direction,h).multVecRot(e.assign(this.szNormal).multiply(this.cylinder.radius)),e.add(n)},getAngle:function(t){return s.dot(t.getAxis(),this.cylinder.axis.direction)>0?t.angle:-t.angle},set_active__:function(t,e,i,n,o){r.prototype.set_active__.call(this,t,e,i,n,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var u=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),d=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),p=this.axisRotation_.getValue().multVecRot(new s(0,1,0)),f=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize(),g=new l(new s(0,0,0),p),m=g.getPerpendicularVector(d).abs();this.cylinder=new c(g,m),this.disk=Math.abs(s.dot(f,p))>Math.cos(this.diskAngle_.getValue()),this.behind=this.isBehind(u,d),this.yPlane=new h(d,p),this.zPlane=new h(d,f);var x=this.invModelViewMatrix.origin,y=s.cross(p,x).normalize();this.sxPlane=new h(new s(0,0,0),y),this.szNormal=s.cross(y,p).normalize();var _=new s(0,0,0);this.disk?this.yPlane.intersectsLine(u,_):this.getTrackPoint(u,_),this.fromVector=this.cylinder.axis.getPerpendicularVector(_).negate(),this.startOffset=new a(p,this.offset_.getValue()),this.trackPoint_changed_=_,this.rotation_changed_=this.startOffset}else this.autoOffset_.getValue()&&(this.offset_=this.getAngle(this.rotation_changed_.getValue()))}catch(t){}},set_motion__:function(t){try{var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);this.disk?this.yPlane.intersectsLine(e,i):this.getTrackPoint(e,i),this.trackPoint_changed_=i;var n=this.cylinder.axis.getPerpendicularVector(i).negate(),r=new a(this.fromVector,n);if(this.disk){this.modelViewMatrix.multVecMatrix(i.copy()).z>0&&r.multRight(new a(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this.minAngle_.getValue()>this.maxAngle_.getValue())this.rotation_changed_=r;else{var o=d.interval(this.getAngle(r),-Math.PI,Math.PI),u=d.interval(this.minAngle_.getValue(),-Math.PI,Math.PI),l=d.interval(this.maxAngle_.getValue(),-Math.PI,Math.PI);o<u?r.setAxisAngle(this.cylinder.axis.direction,u):o>l&&r.setAxisAngle(this.cylinder.axis.direction,l),this.rotation_changed_.getValue().equals(r)||(this.rotation_changed_=r)}}catch(t){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),p}),define("x_ite/Components/Geometry2D/Disk2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){o.call(this,t),this.addType(s.Disk2D),this.innerRadius_.setUnit("length"),this.outerRadius_.setUnit("length")}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"innerRadius",new e.SFFloat),new i(s.inputOutput,"outerRadius",new e.SFFloat(1)),new i(s.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"Disk2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},getShader:function(t){return t.getLineShader()},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getDisk2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getDisk2DOptions().removeInterest("eventsProcessed",this)},build:function(){var t=this.getBrowser().getDisk2DOptions(),e=this.innerRadius_.getValue(),i=this.outerRadius_.getValue();if(e===i){var n=Math.abs(i),r=t.getCircleVertices(),o=this.getVertices();if(1===n)this.setVertices(r);else for(var s=0,a=r.length;s<a;s+=4)o.push(r[s]*n,r[s+1]*n,0,1);return this.getMin().set(-n,-n,0),this.getMax().set(n,n,0),void this.setGeometryType(1)}if(0===e||0===i){var n=Math.abs(Math.max(e,i)),r=t.getDiskVertices(),o=this.getVertices();if(this.getTexCoords().push(t.getDiskTexCoords()),this.setNormals(t.getDiskNormals()),1===n)this.setVertices(r);else for(var s=0,a=r.length;s<a;s+=4)o.push(r[s]*n,r[s+1]*n,0,1);return this.getMin().set(-n,-n,0),this.getMax().set(n,n,0),this.setGeometryType(2),void this.setSolid(this.solid_.getValue())}var u=Math.abs(Math.max(e,i)),l=Math.abs(Math.min(e,i)),h=l/u,c=(1-h)/2,d=t.getDiskTexCoords(),p=[],f=this.getNormals(),g=t.getDiskVertices(),m=this.getVertices();this.getTexCoords().push(p);for(var s=0,a=g.length;s<a;s+=12)p.push(d[s+4]*h+c,d[s+5]*h+c,0,1,d[s+4],d[s+5],0,1,d[s+8],d[s+9],0,1,d[s+4]*h+c,d[s+5]*h+c,0,1,d[s+8],d[s+9],0,1,d[s+8]*h+c,d[s+9]*h+c,0,1),f.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1),m.push(g[s+4]*l,g[s+5]*l,0,1,g[s+4]*u,g[s+5]*u,0,1,g[s+8]*u,g[s+9]*u,0,1,g[s+4]*l,g[s+5]*l,0,1,g[s+8]*u,g[s+9]*u,0,1,g[s+8]*l,g[s+9]*l,0,1);this.getMin().set(-u,-u,0),this.getMax().set(u,u,0),this.setGeometryType(2),this.setSolid(this.solid_.getValue())},intersectsLine:function(t,e,i,n){return this.getGeometryType()<2?o.prototype.intersectsLine.call(this,t,e,i,n):r.prototype.intersectsLine.call(this,t,e,i,n)},intersectsBox:function(t,e,i){return this.getGeometryType()<2?o.prototype.intersectsBox.call(this,t,e,i):r.prototype.intersectsBox.call(this,t,e,i)},display:function(t){return this.getGeometryType()<2?o.prototype.display.call(this,t):r.prototype.display.call(this,t)},displayParticles:function(t,e,i){return this.getGeometryType()<2?o.prototype.displayParticles.call(this,t,e,i):r.prototype.displayParticles.call(this,t,e,i)}}),u}),define("x_ite/Components/Geometry3D/ElevationGrid",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(s.ElevationGrid),this.xSpacing_.setUnit("length"),this.zSpacing_.setUnit("length"),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"xDimension",new e.SFInt32),new i(s.initializeOnly,"zDimension",new e.SFInt32),new i(s.initializeOnly,"xSpacing",new e.SFFloat(1)),new i(s.initializeOnly,"zSpacing",new e.SFFloat(1)),new i(s.initializeOnly,"solid",new e.SFBool(!0)),new i(s.initializeOnly,"ccw",new e.SFBool(!0)),new i(s.initializeOnly,"creaseAngle",new e.SFFloat),new i(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(s.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(s.inputOutput,"attrib",new e.MFNode),new i(s.inputOutput,"fogCoord",new e.SFNode),new i(s.inputOutput,"color",new e.SFNode),new i(s.inputOutput,"texCoord",new e.SFNode),new i(s.inputOutput,"normal",new e.SFNode),new i(s.inputOutput,"height",new e.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,i=t.length;e<i;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,i=this.attrib_.length;e<i;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&t.push(n)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=o(s.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=o(s.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(t){return t<this.height_.length?this.height_[t]:0},createTexCoords:function(){for(var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=e-1,r=i-1,o=0;o<i;++o)for(var s=0;s<e;++s)t.push(new u(s/n,o/r));return t},createNormals:function(t,e,i){for(var n=!this.ccw_.getValue(),r=[],o=[],s=0;s<t.length;++s)r[s]=[];for(var u=0;u<e.length;u+=3){var h=e[u],c=e[u+1],d=e[u+2];r[h].push(o.length),r[c].push(o.length+1),r[d].push(o.length+2);var p=a.normal(t[h],t[c],t[d],new l(0,0,0));n&&p.negate(),o.push(p),o.push(p),o.push(p)}return this.refineNormals(r,o,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=e-1,r=i-1,o=0;o<r;++o)for(var s=0;s<n;++s){var a=o*e+s,u=(o+1)*e+s,l=(o+1)*e+(s+1),h=o*e+(s+1);t.push(a),t.push(u),t.push(l),t.push(a),t.push(l),t.push(h)}return t},createPoints:function(){for(var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),r=this.zSpacing_.getValue(),o=0;o<i;++o)for(var s=0;s<e;++s)t.push(new l(n*s,this.getHeight(s+o*e),r*o));return t},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var t=this.colorPerVertex_.getValue(),e=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getAttrib(),r=n.length,o=this.getAttribs(),s=this.getColor(),a=this.getTexCoord(),u=this.getNormal(),l=this.createPoints(),h=0;if(a)a.init(this.getTexCoords());else{var c=this.createTexCoords();this.getTexCoords().push([])}for(var d=0,p=i.length;d<p;++h)for(var f=0;f<6;++f,++d){for(var g=i[d],m=0;m<r;++m)n[m].addValue(o[m],g);if(s&&(t?this.addColor(s.get1Color(g)):this.addColor(s.get1Color(h))),a)a.addTexCoord(this.getTexCoords(),g);else{var x=c[g];this.getTexCoords()[0].push(x.x,x.y,0,1)}u&&(e?this.addNormal(u.get1Vector(g)):this.addNormal(u.get1Vector(h))),this.addVertex(l[g])}if(!u)for(var y=this.createNormals(l,i),_=0;_<y.length;++_)this.addNormal(y[_]);this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),h}),define("x_ite/Components/ParticleSystems/ExplosionEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.ExplosionEmitter),this.position_.setUnit("length"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.getRandomVelocity=this.getSphericalRandomVelocity}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"position",new e.SFVec3f),new i(o.inputOutput,"speed",new e.SFFloat),new i(o.inputOutput,"variation",new e.SFFloat(.25)),new i(o.initializeOnly,"mass",new e.SFFloat),new i(o.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"ExplosionEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.set_position__()},set_position__:function(){this.position=this.position_.getValue()},isExplosive:function(){return!0},getRandomPosition:function(t){return t.assign(this.position)}}),s}),define("x_ite/Components/Geometry3D/Extrusion",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){r.call(this,t),this.addType(o.Extrusion),this.creaseAngle_.setUnit("angle"),this.crossSection_.setUnit("length"),this.spine_.setUnit("length")}var d=new h,p=[];return c.prototype=t.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"beginCap",new e.SFBool(!0)),new i(o.initializeOnly,"endCap",new e.SFBool(!0)),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"convex",new e.SFBool(!0)),new i(o.initializeOnly,"creaseAngle",new e.SFFloat),new i(o.inputOutput,"crossSection",new e.MFVec2f(new a(1,1),new a(1,-1),new a(-1,-1),new a(-1,1),new a(1,1))),new i(o.inputOutput,"orientation",new e.MFRotation(new l)),new i(o.inputOutput,"scale",new e.MFVec2f(new a(1,1))),new i(o.inputOutput,"spine",new e.MFVec3f(new u(0,0,0),new u(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getClosedOrientation:function(){var t=this.orientation_.getValue();if(t.length){var e=t[0].getValue(),i=t[t.length-1].getValue();return e.equals(i)}return!0},createPoints:function(){for(var t=this.crossSection_.getValue(),e=this.orientation_.getValue(),i=this.scale_.getValue(),n=this.spine_.getValue(),r=[],o=this.createRotations(),s=0,a=n.length;s<a;++s){if(d.identity(),d.translate(n[s].getValue()),e.length&&d.rotate(e[Math.min(s,e.length-1)].getValue()),d.multLeft(o[s]),i.length){var l=i[Math.min(s,i.length-1)].getValue();d.scale(new u(l.x,1,l.y))}for(var h=0,c=t.length;h<c;++h){var p=t[h].getValue();r.push(d.multVecMatrix(new u(p.x,0,p.y)))}}return r},createRotations:function(){for(var t=this.spine_.getValue(),e=t.length,i=t[0].getValue(),n=t[t.length-1].getValue(),r=i.equals(n)&&this.getClosedOrientation(),o=p.length;o<e;++o)p[o]=new h;p.length=e;var s,a,c=new u(0,0,0);if(r)a=u.subtract(t[1].getValue(),t[t.length-2].getValue()).normalize(),c=u.subtract(t[1].getValue(),t[0].getValue()).cross(u.subtract(t[t.length-2].getValue(),t[0].getValue())).normalize();else{a=u.subtract(t[1].getValue(),t[0].getValue()).normalize();for(var o=1,d=t.length-1;o<d&&(c=u.subtract(t[o+1].getValue(),t[o].getValue()).cross(u.subtract(t[o-1].getValue(),t[o].getValue())).normalize(),c.equals(u.Zero));++o);}a.equals(u.Zero)&&a.set(0,1,0),c.equals(u.Zero)&&(c=new l(new u(0,1,0),a).multVecRot(new u(0,0,1))),s=u.cross(a,c),p[0].set(s.x,s.y,s.z,0,a.x,a.y,a.z,0,c.x,c.y,c.z,0,0,0,0,1);for(var f=a,g=c,o=1,d=t.length-1;o<d;++o)a=u.subtract(t[o+1].getValue(),t[o-1].getValue()).normalize(),c=u.subtract(t[o+1].getValue(),t[o].getValue()).cross(u.subtract(t[o-1].getValue(),t[o].getValue())).normalize(),g.dot(c)<0&&c.negate(),a.equals(u.Zero)?a=f:f=a,c.equals(u.Zero)?c=g:g=c,s=u.cross(a,c),p[o].set(s.x,s.y,s.z,0,a.x,a.y,a.z,0,c.x,c.y,c.z,0,0,0,0,1);return r?p[e-1].assign(p[0]):(a=u.subtract(t[t.length-1].getValue(),t[t.length-2].getValue()).normalize(),t.length>2&&(c=u.subtract(t[t.length-1].getValue(),t[t.length-2].getValue()).cross(u.subtract(t[t.length-3].getValue(),t[t.length-2].getValue())).normalize()),g.dot(c)<0&&c.negate(),a.equals(u.Zero)&&(a=f),c.equals(u.Zero)&&(c=g),s=u.cross(a,c),p[e-1].set(s.x,s.y,s.z,0,a.x,a.y,a.z,0,c.x,c.y,c.z,0,0,0,0,1)),p},build:function(){function t(t,e){return t*o+e}var e=!this.ccw_.getValue(),i=this.crossSection_.getValue(),n=this.spine_.getValue(),r=[];if(!(n.length<2||i.length<2)){this.getTexCoords().push(r);for(var o=i.length,l=n[0].getValue(),h=n[n.length-1].getValue(),c=l.equals(h)&&this.getClosedOrientation(),d=i[0].getValue(),p=i[i.length-1].getValue(),f=d.equals(p),g=i[0].getValue().copy(),m=i[0].getValue().copy(),x=1,y=i.length;x<y;++x)g.min(i[x].getValue()),m.max(i[x].getValue());for(var _=a.subtract(m,g),v=Math.max(_.x,_.y),w=f?i.length-1:i.length,b=[],S=[],C=this.createPoints(),F=0,y=C.length;F<y;++F)b[F]=[];for(var T=i.length-1,N=n.length-1,O=t(0,0),M=t(0,f?0:T),V=0;V<N;++V)for(var x=0;x<T;++x){var D=c&&V===n.length-2?0:V+1,B=f&&x===i.length-2?0:x+1,I=t(V,x),E=t(V,B),A=t(D,B),P=t(D,x),L=C[I],R=C[E],k=C[A],z=C[P],X=R.distance(k)>=1e-7,j=z.distance(L)>=1e-7;if(e)var U=s.normal(k,R,L,new u(0,0,0)),G=s.normal(z,k,L,new u(0,0,0));else var U=s.normal(L,R,k,new u(0,0,0)),G=s.normal(L,k,z,new u(0,0,0));if(0==x&&(j?O=I:(I=O,L=C[I])),x==i.length-2&&(X?M=E:(A=M,k=C[A])),X){if(j)r.push(x/T,V/N,0,1);else{var q=(V/N+(V+1)/N)/2;r.push(x/T,q,0,1)}b[I].push(S.length),S.push(U),this.addVertex(L),r.push((x+1)/T,V/N,0,1),b[E].push(S.length),S.push(U),this.addVertex(R),r.push((x+1)/T,(V+1)/N,0,1),b[A].push(S.length),S.push(U),this.addVertex(k)}if(j){if(r.push(x/T,V/N,0,1),b[I].push(S.length),S.push(G),this.addVertex(L),X)r.push((x+1)/T,(V+1)/N,0,1);else{var q=((V+1)/N+V/N)/2;r.push((x+1)/T,q,0,1)}b[A].push(S.length),S.push(G),this.addVertex(k),r.push(x/T,(V+1)/N,0,1),b[P].push(S.length),S.push(G),this.addVertex(z)}}S=this.refineNormals(b,S,this.creaseAngle_.getValue());for(var H=0;H<S.length;++H)this.addNormal(S[H]);if(v&&i.length>2){if(this.beginCap_.getValue()){for(var W=0,Y=[],$=[],x=0;x<w;++x){var K=t(W,w-1-x),Z=C[K].copy();Z.index=K,Z.texCoord=a.subtract(i[w-1-x].getValue(),g).divide(v),Y.push(Z)}if(this.convex_.getValue()?s.triangulateConvexPolygon(Y,$):s.triangulatePolygon(Y,$),$.length>=3){var Q=s.normal(C[$[0].index],C[$[1].index],C[$[2].index],new u(0,0,0));e&&Q.negate(),this.addCap(r,Q,C,$)}}if(this.endCap_.getValue()){for(var W=n.length-1,Y=[],$=[],x=0;x<w;++x){var K=t(W,x),Z=C[K].copy();Z.index=K,Z.texCoord=a.subtract(i[x].getValue(),g).divide(v),Y.push(Z)}if(this.convex_.getValue()?s.triangulateConvexPolygon(Y,$):s.triangulatePolygon(Y,$),$.length>=3){var Q=s.normal(C[$[0].index],C[$[1].index],C[$[2].index],new u(0,0,0));e&&Q.negate(),this.addCap(r,Q,C,$)}}}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},addCap:function(t,e,i,n){for(var r=0;r<n.length;r+=3){var o=i[n[r].index],s=i[n[r+1].index],a=i[n[r+2].index],u=n[r].texCoord,l=n[r+1].texCoord,h=n[r+2].texCoord;t.push(u.x,u.y,0,1),t.push(l.x,l.y,0,1),t.push(h.x,h.y,0,1),this.addNormal(e),this.addNormal(e),this.addNormal(e),this.addVertex(o),this.addVertex(s),this.addVertex(a)}}}),c}),define("x_ite/Components/Shaders/X3DVertexAttributeNode",["jquery","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DVertexAttributeNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Shaders/FloatVertexAttribute",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.FloatVertexAttribute)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"name",new e.SFString),new i(o.initializeOnly,"numComponents",new e.SFInt32(4)),new i(o.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"FloatVertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},addValue:function(t,e){var i=s.clamp(this.numComponents_.getValue(),1,4),n=e*i,r=n+i;if(r<=this.value_.length)for(;n<r;++n)t.push(this.value_[n]);else for(;n<r;++n)t.push(0)},enable:function(t,e,i){e.enableFloatAttrib(t,this.name_.getValue(),i,s.clamp(this.numComponents_.getValue(),1,4))},disable:function(t,e){e.disableFloatAttrib(t,this.name_.getValue())}}),a}),define("x_ite/Components/ParticleSystems/ForcePhysicsModel",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.ForcePhysicsModel),this.force_.setUnit("force")}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"force",new e.SFVec3f(0,-9.8,0))]),getTypeName:function(){return"ForcePhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},addForce:function(t,e,i,n){this.enabled_.getValue()&&(i[t].assign(this.force_.getValue()),n[t]=0)}}),s}),define("x_ite/Rendering/DependentRenderer",["jquery","x_ite/Basic/X3DBaseNode","x_ite/Rendering/X3DRenderObject","x_ite/Bits/TraverseType"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),i.call(this,t),this.renderObject=null}return r.prototype=t.extend(Object.create(e.prototype),i.prototype,{constructor:r,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this)},isIndependent:function(){return!1},setRenderer:function(t){this.renderObject=t},getBrowser:function(){return this.renderObject.getBrowser()},getLayer:function(){return this.renderObject.getLayer()},getBackground:function(){return this.renderObject.getBackground()},getFog:function(){return this.renderObject.getFog()},getNavigationInfo:function(){return this.renderObject.getNavigationInfo()},getViewpoint:function(){return this.renderObject.getViewpoint()},getLightContainer:function(){return this.renderObject.getLights()[this.lightIndex++]},render:function(t,e){switch(t){case n.COLLISION:case n.DEPTH:i.prototype.render.call(this,t,e);break;case n.DISPLAY:this.lightIndex=0,i.prototype.render.call(this,t,e);for(var r=this.renderObject.getLights(),o=0,s=r.length;o<s;++o)r[o].getModelViewMatrix().pop()}}}),r}),define("x_ite/Components/CubeMapTexturing/GeneratedCubeMapTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Rendering/DependentRenderer","x_ite/Rendering/DepthBuffer","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g){"use strict";function m(t){r.call(this,t),this.addType(a.GeneratedCubeMapTexture),this.renderer=new o(t),this.projectionMatrix=new f,this.transformationMatrix=new f,this.viewVolume=new h}var x=[new c(d.zAxis,new d(0,0,-1)),new c(d.zAxis,new d(0,0,1)),new c(d.zAxis,new d(1,0,0)),new c(d.zAxis,new d(-1,0,0)),new c(d.zAxis,new d(0,-1,0)),new c(d.zAxis,new d(0,1,0))],y=[new d(-1,-1,1),new d(-1,-1,1),new d(-1,-1,1),new d(-1,-1,1),new d(1,1,1),new d(1,1,1)],_=new f;return m.prototype=t.extend(Object.create(r.prototype),{constructor:m,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"update",new e.SFString("NONE")),new i(a.initializeOnly,"size",new e.SFInt32(128)),new i(a.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"GeneratedCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.renderer.setup();var t=g.nextPowerOfTwo(this.size_.getValue());if(t>0){t=g.nextPowerOfTwo(t);var e=this.getBrowser().getContext(),i=new Uint8Array(t*t*4);e.bindTexture(this.getTarget(),this.getTexture());for(var n=0;n<6;++n)e.texImage2D(this.getTargets()[n],0,e.RGBA,t,t,0,e.RGBA,e.UNSIGNED_BYTE,i);this.viewport=new p(0,0,t,t),this.frameBuffer=new s(this.getBrowser(),t,t),this.isLive().addInterest("set_live__",this),this.set_live__()}},traverse:function(t,e){
t===u.DISPLAY&&"NONE"!==this.update_.getValue()&&this.frameBuffer&&e.isIndependent()&&(e.getGeneratedCubeMapTextures().push(this),this.transformationMatrix.assign(e.getModelViewMatrix().get()).multRight(e.getCameraSpaceMatrix().get()))},renderTexture:function(t,e){this.renderer.setRenderer(t);var i=this.renderer,n=t.getBrowser(),r=t.getLayer(),o=n.getContext(),s=i.getBackground(),a=i.getNavigationInfo(),h=i.getViewpoint(),c=n.getHeadlight(),d=a.headlight_.getValue(),p=a.getNearValue(),m=a.getFarValue(h),v=l.perspective(g.radians(90),p,m,1,1,this.projectionMatrix),w=s.isTransparent();w!==this.transparent_.getValue()&&(this.transparent_=w),this.frameBuffer.bind(),i.getViewVolumes().push(this.viewVolume.set(v,this.viewport,this.viewport)),i.getProjectionMatrix().pushMatrix(v),o.bindTexture(this.getTarget(),this.getTexture()),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);for(var b=0;b<6;++b){o.clear(o.COLOR_BUFFER_BIT),i.getCameraSpaceMatrix().pushMatrix(this.transformationMatrix),i.getCameraSpaceMatrix().rotate(x[b]),i.getCameraSpaceMatrix().scale(y[b]);try{i.getInverseCameraSpaceMatrix().pushMatrix(_.assign(i.getCameraSpaceMatrix().get()).inverse())}catch(t){console.log(t),i.getInverseCameraSpaceMatrix().pushMatrix(f.Identity)}i.getModelViewMatrix().pushMatrix(_),d&&(c.getModelViewMatrix().pushMatrix(_),c.getModelViewMatrix().multLeft(h.getCameraSpaceMatrix())),r.traverse(u.DISPLAY,i),d&&c.getModelViewMatrix().pop(),i.getModelViewMatrix().pop(),i.getCameraSpaceMatrix().pop(),i.getInverseCameraSpaceMatrix().pop();var S=this.frameBuffer.readPixels(),C=this.frameBuffer.getWidth(),F=this.frameBuffer.getHeight();o.texImage2D(this.getTargets()[b],0,o.RGBA,C,F,!1,o.RGBA,o.UNSIGNED_BYTE,S)}this.set_textureQuality__(),i.getProjectionMatrix().pop(),i.getViewVolumes().pop(),this.frameBuffer.unbind(),"NEXT_FRAME_ONLY"===this.update_.getValue()&&(this.update_="NONE")}}),m}),define("x_ite/Components/Geospatial/GeoCoordinate",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(s.GeoCoordinate),this.points=[],this.origin=new u(0,0,0)}return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"geoOrigin",new e.SFNode),new i(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(s.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"GeoCoordinate"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"coord"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){for(var t=this.point_.getValue(),e=this.points,i=0,n=Math.min(t.length,e.length);i<n;++i)this.getCoord(t[i].getValue(),e[i]);for(var n=t.length;i<n;++i){var r=e[i]=new u(0,0,0);this.getCoord(t[i].getValue(),r)}e.length=n,this.getCoord(u.Zero,this.origin)},isEmpty:function(){return 0==this.point_.length},getSize:function(){return this.point_.length},get1Point:function(t){return t<this.points.length?this.points[t]:this.origin},getNormal:function(t,e,i){var n=this.points,r=n.length;return t<r&&e<r&&i<r?a.normal(n[t],n[e],n[i],new u(0,0,0)):new u(0,0,0)},getQuadNormal:function(t,e,i,n){var r=this.points,o=r.length;return t<o&&e<o&&i<o&&n<o?a.quadNormal(r[t],r[e],r[i],r[n],new u(0,0,0)):new u(0,0,0)}}),l}),define("x_ite/Components/Geospatial/GeoElevationGrid",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){r.call(this,t),o.call(this,t),this.addType(s.GeoElevationGrid),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.colorNode=null,this.texCoordNode=null,this.normalNode=null}return c.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:c,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"geoOrigin",new e.SFNode),new i(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(s.initializeOnly,"geoGridOrigin",new e.SFVec3d),new i(s.initializeOnly,"xDimension",new e.SFInt32),new i(s.initializeOnly,"zDimension",new e.SFInt32),new i(s.initializeOnly,"xSpacing",new e.SFDouble(1)),new i(s.initializeOnly,"zSpacing",new e.SFDouble(1)),new i(s.inputOutput,"yScale",new e.SFFloat(1)),new i(s.initializeOnly,"solid",new e.SFBool(!0)),new i(s.initializeOnly,"ccw",new e.SFBool(!0)),new i(s.initializeOnly,"creaseAngle",new e.SFDouble),new i(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(s.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(s.inputOutput,"color",new e.SFNode),new i(s.inputOutput,"texCoord",new e.SFNode),new i(s.inputOutput,"normal",new e.SFNode),new i(s.inputOutput,"height",new e.MFDouble(0,0))]),getTypeName:function(){return"GeoElevationGrid"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=a(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=a(s.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=a(s.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(t){return t<this.height_.length?this.height_[t]*this.yScale_.getValue():0},createTexCoords:function(){for(var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=e-1,r=i-1,o=0;o<i;++o)for(var s=0;s<e;++s)t.push(new l(s/n,o/r));return t},createNormals:function(t,e,i){for(var n=!this.ccw_.getValue(),r=[],o=[],s=0;s<t.length;++s)r[s]=[];for(var a=0;a<e.length;a+=3){var l=e[a],c=e[a+1],d=e[a+2];r[l].push(o.length),r[c].push(o.length+1),r[d].push(o.length+2);var p=u.normal(t[l],t[c],t[d],new h(0,0,0));n&&p.negate(),o.push(p),o.push(p),o.push(p)}return this.refineNormals(r,o,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=e-1,r=i-1,o=0;o<r;++o)for(var s=0;s<n;++s){var a=o*e+s,u=(o+1)*e+s,l=(o+1)*e+(s+1),h=o*e+(s+1);t.push(a),t.push(l),t.push(u),t.push(a),t.push(h),t.push(l)}return t},createPoints:function(){var t=[],e=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),r=this.zSpacing_.getValue();if(this.getStandardOrder())for(var o=0;o<i;++o)for(var s=0;s<e;++s){var a=new h(r*o,n*s,this.getHeight(s+o*e));a.add(this.geoGridOrigin_.getValue()),t.push(this.getCoord(a,a))}else for(var o=0;o<i;++o)for(var s=0;s<e;++s){var a=new h(n*s,r*o,this.getHeight(s+o*e));a.add(this.geoGridOrigin_.getValue()),t.push(this.getCoord(a,a))}return t},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var t=this.colorPerVertex_.getValue(),e=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getColor(),r=this.getTexCoord(),o=this.getNormal(),s=this.createPoints(),a=0;if(r)r.init(this.getTexCoords());else{var u=this.createTexCoords();this.getTexCoords().push([])}for(var l=0;l<i.length;++a)for(var h=0;h<6;++h,++l){var c=i[l];if(n&&(t?this.addColor(n.get1Color(c)):this.addColor(n.get1Color(a))),r)r.addTexCoord(this.getTexCoords(),c);else{var d=u[c];this.getTexCoords()[0].push(d.x,d.y,0,1)}o&&(e?this.addNormal(o.get1Vector(c)):this.addNormal(o.get1Vector(a))),this.addVertex(s[c])}if(!o)for(var p=this.createNormals(s,i),f=0;f<p.length;++f)this.addNormal(p[f]);this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),c}),define("x_ite/Components/Networking/Inline",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),o.call(this,t),s.call(this,t),this.addType(u.Inline),this.addChildObjects("buffer",new e.SFTime),this.scene=this.getBrowser().getDefaultScene(),this.group=new a(t),this.getBBox=this.group.getBBox.bind(this.group),this.group.addParent(this)}return h.prototype=t.extend(Object.create(r.prototype),o.prototype,s.prototype,{constructor:h,fieldDefinitions:new n([new i(u.inputOutput,"metadata",new e.SFNode),new i(u.inputOutput,"load",new e.SFBool(!0)),new i(u.inputOutput,"url",new e.MFString),new i(u.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(u.initializeOnly,"bboxCenter",new e.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.load_.addInterest("set_load__",this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_live__:function(){this.getPrivate()||this.scene.setLive(this.isLive().getValue())},set_load__:function(){this.load_.getValue()?this.buffer_.addEvent():this.requestUnload()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.load_.getValue()&&(this.setLoadState(u.NOT_STARTED_STATE),this.requestAsyncLoad())},requestImmediateLoad:function(){try{if(this.checkLoadState()===u.COMPLETE_STATE||this.checkLoadState()===u.IN_PROGRESS_STATE)return;this.setLoadState(u.IN_PROGRESS_STATE),this.setInternalScene(new l(this).createX3DFromURL(this.url_,null))}catch(t){console.log(t),this.setInternalScene(this.getBrowser().getDefaultScene())}},requestAsyncLoad:function(){this.checkLoadState()!==u.COMPLETE_STATE&&this.checkLoadState()!==u.IN_PROGRESS_STATE&&(this.setLoadState(u.IN_PROGRESS_STATE),new l(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this)))},requestUnload:function(){this.checkLoadState()!==u.NOT_STARTED_STATE&&this.checkLoadState()!==u.FAILED_STATE&&(this.setLoadState(u.NOT_STARTED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalSceneAsync:function(t){t?(this.setLoadState(u.COMPLETE_STATE),this.setInternalScene(t)):(this.setLoadState(u.FAILED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalScene:function(t){this.scene.setLive(!1),this.scene.rootNodes.removeInterest("setValue",this.group.children_),this.scene=t,this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setPrivate(this.getExecutionContext().getPrivate()),this.scene.setup(),this.scene.rootNodes.addInterest("setValue",this.group.children_),this.group.children_=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getInternalScene:function(){return this.scene},traverse:function(t,e){this.group.traverse(t,e)}}),h}),define("x_ite/Components/Geospatial/GeoLOD",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","x_ite/Components/Grouping/Group","x_ite/Components/Networking/Inline","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p){"use strict";function f(t){r.call(this,t),o.call(this,t),s.call(this,t),this.addType(a.GeoLOD),this.range_.setUnit("length"),this.rootGroup=new l(this.getBrowser().getPrivateScene()),this.rootInline=new h(t),this.child1Inline=new h(t),this.child2Inline=new h(t),this.child3Inline=new h(t),this.child4Inline=new h(t),this.childrenLoaded=!1,this.childBBox=new p,this.keepCurrentLevel=!1,this.modelViewMatrix=new d}var g=new c(0,0,0);return f.prototype=t.extend(Object.create(r.prototype),o.prototype,s.prototype,{constructor:f,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.initializeOnly,"geoOrigin",new e.SFNode),new i(a.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(a.initializeOnly,"rootUrl",new e.MFString),new i(a.initializeOnly,"child1Url",new e.MFString),new i(a.initializeOnly,"child2Url",new e.MFString),new i(a.initializeOnly,"child3Url",new e.MFString),new i(a.initializeOnly,"child4Url",new e.MFString),new i(a.initializeOnly,"center",new e.SFVec3d),new i(a.initializeOnly,"range",new e.SFFloat(10)),new i(a.outputOnly,"level_changed",new e.SFInt32(-1)),new i(a.initializeOnly,"rootNode",new e.MFNode),new i(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(a.initializeOnly,"bboxCenter",new e.SFVec3f),new i(a.outputOnly,"children",new e.MFNode)]),getTypeName:function(){return"GeoLOD"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.rootNode_.addFieldInterest(this.rootGroup.children_),this.rootGroup.children_=this.rootNode_,this.rootGroup.setPrivate(!0),this.rootGroup.setup(),this.rootInline.loadState_.addInterest("set_rootLoadState__",this),this.child1Inline.loadState_.addInterest("set_childLoadState__",this),this.child2Inline.loadState_.addInterest("set_childLoadState__",this),this.child3Inline.loadState_.addInterest("set_childLoadState__",this),this.child4Inline.loadState_.addInterest("set_childLoadState__",this),this.rootUrl_.addFieldInterest(this.rootInline.url_),this.child1Url_.addFieldInterest(this.child1Inline.url_),this.child2Url_.addFieldInterest(this.child2Inline.url_),this.child3Url_.addFieldInterest(this.child3Inline.url_),this.child4Url_.addFieldInterest(this.child4Inline.url_),this.rootInline.load_=!0,this.child1Inline.load_=!1,this.child2Inline.load_=!1,this.child3Inline.load_=!1,this.child4Inline.load_=!1,this.rootInline.url_=this.rootUrl_,this.child1Inline.url_=this.child1Url_,this.child2Inline.url_=this.child2Url_,this.child3Inline.url_=this.child3Url_,this.child4Inline.url_=this.child4Url_,this.rootInline.setup(),this.child1Inline.setup(),this.child2Inline.setup(),this.child3Inline.setup(),this.child4Inline.setup()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=this.level_changed_.getValue();switch(this.childrenLoaded?e:0){case 0:return this.rootNode_.length?this.rootGroup.getBBox(t):this.rootInline.getBBox(t);case 1:return t.set(),t.add(this.child1Inline.getBBox(this.childBBox)),t.add(this.child2Inline.getBBox(this.childBBox)),t.add(this.child3Inline.getBBox(this.childBBox)),t.add(this.child4Inline.getBBox(this.childBBox)),t}return t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_rootLoadState__:function(){0===this.level_changed_.getValue()&&(this.rootNode_.length||this.rootInline.checkLoadState()===a.COMPLETE_STATE&&(this.children_=this.rootInline.getInternalScene().getRootNodes(),this.childrenLoaded=!1))},set_childLoadState__:function(){if(1===this.level_changed_.getValue()){var t=0;if(this.child1Inline.checkLoadState()===a.COMPLETE_STATE){for(var e=this.child1Inline.getInternalScene().getRootNodes(),i=0,n=e.length;i<n;++i)this.children_.push(e[i]);++t}else 0===this.child1Inline.url_.length&&++t;if(this.child2Inline.checkLoadState()===a.COMPLETE_STATE){for(var e=this.child2Inline.getInternalScene().getRootNodes(),i=0,n=e.length;i<n;++i)this.children_.push(e[i]);++t}else 0===this.child2Inline.url_.length&&++t;if(this.child3Inline.checkLoadState()===a.COMPLETE_STATE){for(var e=this.child3Inline.getInternalScene().getRootNodes(),i=0,n=e.length;i<n;++i)this.children_.push(e[i]);++t}else 0===this.child3Inline.url_.length&&++t;if(this.child4Inline.checkLoadState()===a.COMPLETE_STATE){for(var e=this.child4Inline.getInternalScene().getRootNodes(),i=0,n=e.length;i<n;++i)this.children_.push(e[i]);++t}else 0===this.child4Inline.url_.length&&++t;4===t&&(this.childrenLoaded=!0)}},getLevel:function(t){return this.getDistance(t)<this.range_.getValue()?1:0},getDistance:function(t){return t.translate(this.getCoord(this.center_.getValue(),g)),t.origin.abs()},traverse:function(t,e){if(t==u.DISPLAY){var i=this.getLevel(this.modelViewMatrix.assign(e.getModelViewMatrix().get()));if(i!==this.level_changed_.getValue())switch(this.level_changed_=i,i){case 0:this.rootNode_.length?(this.children_=this.rootNode_,this.childrenLoaded=!1):this.rootInline.checkLoadState()==a.COMPLETE_STATE&&(this.children_=this.rootInline.getInternalScene().getRootNodes(),this.childrenLoaded=!1),this.child1Inline.load_=!1,this.child2Inline.load_=!1,this.child3Inline.load_=!1,this.child4Inline.load_=!1;break;case 1:this.child1Inline.load_=!0,this.child2Inline.load_=!0,this.child3Inline.load_=!0,this.child4Inline.load_=!0}}switch(this.childrenLoaded?this.level_changed_.getValue():0){case 0:this.rootNode_.length?this.rootGroup.traverse(t,e):this.rootInline.traverse(t,e);break;case 1:this.child1Inline.traverse(t,e),this.child2Inline.traverse(t,e),this.child3Inline.traverse(t,e),this.child4Inline.traverse(t,e)}}}),f}),define("x_ite/Components/Geospatial/GeoLocation",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),o.call(this,t),this.addType(s.GeoLocation)}var l=new a;return u.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(s.inputOutput,"geoCoords",new e.SFVec3d),new i(s.initializeOnly,"geoOrigin",new e.SFNode),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOnly,"addChildren",new e.MFNode),new i(s.inputOnly,"removeChildren",new e.MFNode),new i(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoLocation"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setMatrix(this.getLocationMatrix(this.geoCoords_.getValue(),l))}}),u}),define("x_ite/Components/Core/X3DInfoNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DInfoNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Geospatial/GeoMetadata",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.GeoMetadata)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"url",new e.MFString),new i(o.inputOutput,"summary",new e.MFString),new i(o.inputOutput,"data",new e.MFNode)]),getTypeName:function(){return"GeoMetadata"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/Geospatial/GeoOrigin",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.GeoOrigin),this.radians=!1}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(o.inputOutput,"geoCoords",new e.SFVec3d),new i(o.initializeOnly,"rotateYUp",new e.SFBool)]),getTypeName:function(){return"GeoOrigin"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geoOrigin"},initialize:function(){r.prototype.initialize.call(this),this.geoSystem_.addInterest("set_geoSystem__",this),this.set_geoSystem__()},set_geoSystem__:function(){this.referenceFrame=s.getReferenceFrame(this.geoSystem_,this.radians)},getOrigin:function(t){return this.referenceFrame.convert(this.geoCoords_.getValue(),t)}}),a}),define("x_ite/Components/Geospatial/GeoPositionInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Browser/Geospatial/Geocentric","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(a.GeoPositionInterpolator),this.value_changed_.setUnit("length"),this.geocentric=new s}return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.initializeOnly,"geoOrigin",new e.SFNode),new i(a.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(a.inputOnly,"set_fraction",new e.SFFloat),new i(a.inputOutput,"key",new e.MFFloat),new i(a.inputOutput,"keyValue",new e.MFVec3d),new i(a.outputOnly,"value_changed",new e.SFVec3d),new i(a.outputOnly,"geovalue_changed",new e.SFVec3d)]),keyValue0:new u(0,0,0),keyValue1:new u(0,0,0),geovalue:new u(0,0,0),value:new u(0,0,0),getTypeName:function(){return"GeoPositionInterpolator"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},setup:function(){o.prototype.initialize.call(this),r.prototype.setup.call(this)},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(t,e,i){try{this.getCoord(this.keyValue_[t].getValue(),this.keyValue0),this.getCoord(this.keyValue_[e].getValue(),this.keyValue1);var n=this.geocentric.slerp(this.keyValue0,this.keyValue1,i);this.geovalue_changed_=this.getGeoCoord(n,this.geovalue),this.value_changed_=n}catch(t){}}}),l}),define("x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["jquery","x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r){"use strict";function o(t){i.call(this,t),this.addType(n.X3DEnvironmentalSensorNode),this.addChildObjects("traversed",new e.SFBool(!0)),this.size_.setUnit("length"),this.center_.setUnit("length"),this.currentTraversed=!0}return o.prototype=t.extend(Object.create(i.prototype),{constructor:o,initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.size_.addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.set_live__()},set_live__:function(){this.isLive().getValue()&&this.traversed_.getValue()&&this.enabled_.getValue()&&!this.size_.getValue().equals(r.Zero)?this.getBrowser().sensorEvents().addInterest("update",this):(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},setTraversed:function(t){t?!1===this.traversed_.getValue()&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=t},getTraversed:function(){return this.currentTraversed},update:function(){}}),o}),define("x_ite/Components/EnvironmentalSensor/ProximitySensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(s.ProximitySensor),this.setCameraObject(!0),this.centerOfRotation_changed_.setUnit("length"),this.position_changed_.setUnit("length"),this.viewpoint=null,this.modelViewMatrix=new l,this.invModelViewMatrix=new l,this.centerOfRotationMatrix=new l,this.position=new a(0,0,0),this.orientation=new u(0,0,1,0),this.centerOfRotation=new a(0,0,0),this.viewer=new a(0,0,0),this.inside=!1}function c(t,e){try{switch(t){case o.CAMERA:return this.viewpoint=e.getViewpoint(),void this.modelViewMatrix.assign(e.getModelViewMatrix().get());case o.DISPLAY:if(this.setTraversed(!0),this.inside)return;if(this.size_.getValue().equals(d))this.inside=!0;else{var i=this.invModelViewMatrix.assign(e.getModelViewMatrix().get()).inverse();this.viewer.set(i[12],i[13],i[14]),this.inside=this.intersectsPoint(this.viewer)}return}}catch(t){}}var d=new a(-1,-1,-1);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"size",new e.SFVec3f),new i(s.inputOutput,"center",new e.SFVec3f),new i(s.outputOnly,"enterTime",new e.SFTime),new i(s.outputOnly,"exitTime",new e.SFTime),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"position_changed",new e.SFVec3f),new i(s.outputOnly,"orientation_changed",new e.SFRotation),new i(s.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_extents__",this),this.center_.addInterest("set_extents__",this),this.traversed_.addFieldInterest(this.isCameraObject_),this.min=new a(0,0,0),this.max=new a(0,0,0),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this.enabled_.getValue()),this.enabled_.getValue()?this.traverse=c:delete this.traverse},set_extents__:function(){var t=this.size_.getValue(),e=this.center_.getValue(),i=t.x/2,n=t.y/2,r=t.z/2,o=e.x,s=e.y,a=e.z;this.min.set(o-i,s-n,a-r),this.max.set(o+i,s+n,a+r)},update:function(){try{if(this.inside&&this.getTraversed()){var t=this.modelViewMatrix,e=this.centerOfRotationMatrix;e.assign(this.viewpoint.getTransformationMatrix()),e.translate(this.viewpoint.getUserCenterOfRotation()),e.multRight(this.invModelViewMatrix.assign(t).inverse()),t.multRight(this.viewpoint.getInverseCameraSpaceMatrix()),t.get(null,this.orientation),t.inverse(),this.position.set(t[12],t[13],t[14]),this.orientation.inverse(),this.centerOfRotation.set(e[12],e[13],e[14]),this.isActive_.getValue()?(this.position_changed_.getValue().equals(this.position)||(this.position_changed_=this.position),this.orientation_changed_.getValue().equals(this.orientation)||(this.orientation_changed_=this.orientation),this.centerOfRotation_changed_.getValue().equals(this.centerOfRotation)||(this.centerOfRotation_changed_=this.centerOfRotation)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=this.position,this.orientation_changed_=this.orientation,this.centerOfRotation_changed_=this.centerOfRotation),this.inside=!1}else this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}catch(t){}this.setTraversed(!1)},traverse:function(){},intersectsPoint:function(t){var e=this.min,i=this.max;return e.x<=t.x&&i.x>=t.x&&e.y<=t.y&&i.y>=t.y&&e.z<=t.z&&i.z>=t.z}}),h}),define("x_ite/Components/Geospatial/GeoProximitySensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(a.GeoProximitySensor),this.position_changed_.setUnit("length"),this.centerOfRotation_changed_.setUnit("length"),this.proximitySensor=new s(t),this.setCameraObject(this.proximitySensor.getCameraObject())}var h=new u(0,0,0);return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.initializeOnly,"geoOrigin",new e.SFNode),new i(a.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(a.inputOutput,"enabled",new e.SFBool(!0)),new i(a.inputOutput,"size",new e.SFVec3f),new i(a.inputOutput,"center",new e.SFVec3f),new i(a.outputOnly,"isActive",new e.SFBool),new i(a.outputOnly,"enterTime",new e.SFTime),new i(a.outputOnly,"exitTime",new e.SFTime),new i(a.outputOnly,"geoCoord_changed",new e.SFVec3d),new i(a.outputOnly,"position_changed",new e.SFVec3f),new i(a.outputOnly,"orientation_changed",new e.SFRotation),new i(a.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"GeoProximitySensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.enabled_.addFieldInterest(this.proximitySensor.enabled_),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.proximitySensor.isActive_.addFieldInterest(this.isActive_),this.proximitySensor.enterTime_.addFieldInterest(this.enterTime_),this.proximitySensor.exitTime_.addFieldInterest(this.exitTime_),this.proximitySensor.position_changed_.addFieldInterest(this.position_changed_),this.proximitySensor.orientation_changed_.addFieldInterest(this.orientation_changed_),this.proximitySensor.centerOfRotation_changed_.addFieldInterest(this.centerOfRotation_changed_),
this.proximitySensor.position_changed_.addInterest("set_position__",this),this.proximitySensor.enabled_=this.enabled_,this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.proximitySensor.setup()},set_position__:function(t){this.geoCoord_changed_=this.getGeoCoord(this.proximitySensor.position_changed_.getValue(),h)},traverse:function(t,e){this.proximitySensor.traverse(t,e)}}),l}),define("x_ite/Components/Geospatial/GeoTouchSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(s.GeoTouchSensor),this.hitPoint_changed_.setUnit("length")}var h=new u,c=new a(0,0,0);return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"geoOrigin",new e.SFNode),new i(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"description",new e.SFString),new i(s.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new i(s.outputOnly,"hitNormal_changed",new e.SFVec3f),new i(s.outputOnly,"hitPoint_changed",new e.SFVec3f),new i(s.outputOnly,"hitGeoCoord_changed",new e.SFVec3d),new i(s.outputOnly,"isOver",new e.SFBool),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"GeoTouchSensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},set_over__:function(t,e,i,n,o){try{if(r.prototype.set_over__.call(this,t,e,i,n,o),this.isOver_.getValue()){var s=e.intersection;h.assign(i).inverse(),this.hitTexCoord_changed_=s.texCoord,this.hitNormal_changed_=i.multMatrixDir(s.normal.copy()).normalize(),this.hitPoint_changed_=h.multVecMatrix(s.point.copy()),this.hitGeoCoord_changed_=this.getGeoCoord(this.hitPoint_changed_.getValue(),c)}}catch(t){console.log(t)}}}),l}),define("x_ite/Components/Geospatial/GeoTransform",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),o.call(this,t),this.addType(s.GeoTransform),this.translation_.setUnit("length")}var l=new a,h=new a;return u.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"translation",new e.SFVec3f),new i(s.inputOutput,"rotation",new e.SFRotation),new i(s.inputOutput,"scale",new e.SFVec3f(1,1,1)),new i(s.inputOutput,"scaleOrientation",new e.SFRotation),new i(s.initializeOnly,"geoOrigin",new e.SFNode),new i(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new i(s.inputOutput,"geoCenter",new e.SFVec3d),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOnly,"addChildren",new e.MFNode),new i(s.inputOnly,"removeChildren",new e.MFNode),new i(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoTransform"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){try{this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.getLocationMatrix(this.geoCenter_.getValue(),h),l.set(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue()),this.setMatrix(l.multRight(h).multLeft(h.inverse()))}catch(t){this.setHidden(!0)}}}),u}),define("x_ite/Components/CubeMapTexturing/ImageCubeMapTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Numbers/Vector2","standard/Math/Algorithm","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){r.call(this,t),o.call(this,t),this.addType(s.ImageCubeMapTexture),this.urlStack=new e.MFString}var p=new Uint8Array([255,255,255,255]),f=[new l(1,1),new l(3,1),new l(0,1),new l(2,1),new l(1,0),new l(1,2)];return d.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:d,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"url",new e.MFString),new i(s.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"ImageCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);var e=this.getBrowser().getContext();e.bindTexture(this.getTarget(),this.getTexture());for(var i=0;i<6;++i)e.texImage2D(this.getTargets()[i],0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,p);this.url_.addInterest("set_url__",this),this.canvas=t("<canvas></canvas>"),this.image=t("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.requestAsyncLoad()},set_url__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.urlStack.setValue(this.url_),this.loadNext())},loadNext:function(){if(0===this.urlStack.length)return this.clear(),void this.setLoadState(s.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.image.attr("src",this.URL)},setError:function(){var t=this.URL.toString();c&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+t)),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){c&&"data"!==this.URL.scheme&&console.info("Done loading image cube map texture:",this.URL.toString());try{var t=this.image[0],e=t.width,i=t.height,n=Math.floor(e/4),r=Math.floor(i/3),o=this.canvas[0],a=o.getContext("2d");h.isPowerOfTwo(n)&&h.isPowerOfTwo(r)&&4*n===e&&3*r===i?(o.width=e,o.height=i,a.drawImage(t,0,0)):(n=h.nextPowerOfTwo(n),r=h.nextPowerOfTwo(r),e=4*n,i=3*r,o.width=e,o.height=i,a.drawImage(t,0,0,t.width,t.height,0,0,e,i));var u=this.getBrowser().getContext(),l=!0;u.bindTexture(this.getTarget(),this.getTexture()),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1);for(var d=0;d<6;++d){var p=a.getImageData(f[d].x*n,f[d].y*r,n,r).data;if(l)for(var g=3;g<p.length;g+=4)if(255!==p[g]){l=!1;break}u.texImage2D(this.getTargets()[d],0,u.RGBA,n,r,!1,u.RGBA,u.UNSIGNED_BYTE,new Uint8Array(p))}this.set_textureQuality__();var m=!l;m!==this.transparent_.getValue()&&(this.transparent_=m),this.setLoadState(s.COMPLETE_STATE)}catch(t){console.log(t.message),this.setError()}}}),d}),define("x_ite/Components/Rendering/IndexedLineSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.IndexedLineSet),this.setGeometryType(1),this.colorNode=null,this.coordNode=null}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(s.inputOutput,"colorIndex",new e.MFInt32),new i(s.inputOutput,"coordIndex",new e.MFInt32),new i(s.inputOutput,"attrib",new e.MFNode),new i(s.inputOutput,"fogCoord",new e.SFNode),new i(s.inputOutput,"color",new e.SFNode),new i(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,i=t.length;e<i;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,i=this.attrib_.length;e<i;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&t.push(n)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},getColorPerVertexIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:this.coordIndex_[t]},getColorIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:t},getPolylineIndices:function(){var t=this.coordIndex_.getValue(),e=[],i=[];if(this.coordIndex_.length){for(var n=0,n=0;n<t.length;++n){t[n].getValue()>=0?i.push(n):(e.push(i),i=[])}t[t.length-1].getValue()>=0&&e.push(i)}return e},getPolylines:function(t){if(t.length=0,!this.coordNode||this.coordNode.isEmpty())return t;for(var e=this.getPolylineIndices(),i=this.coordIndex_.getValue(),n=0;n<e.length;++n)for(var r=e[n],o=0,s=r.length-1;o<s;++o)for(var a=o,u=o+2;a<u;++a)t.push(this.coordNode.get1Point(i[r[a]].getValue()));return t},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var t=this.coordIndex_.getValue(),e=this.getPolylineIndices(),i=this.colorPerVertex_.getValue(),n=this.getAttrib(),r=n.length,o=this.getAttribs(),s=this.colorNode,a=this.coordNode,u=0,l=0;l<e.length;++l){var h=e[l];if(h.length>1)for(var c=0,d=h.length-1;c<d;++c)for(var p=c,f=c+2;p<f;++p){for(var g=h[p],m=t[g].getValue(),x=0;x<r;++x)n[x].addValue(o[x],m);s&&(i?this.addColor(s.get1Color(this.getColorPerVertexIndex(g))):this.addColor(s.get1Color(this.getColorIndex(u)))),this.addVertex(a.get1Point(m))}++u}}}),a}),define("x_ite/Components/CADGeometry/IndexedQuadSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IndexedQuadSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"index",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedQuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var t=this.index_.getValue(),e=t.length,i=this.triangleIndex;e-=e%4,i.length=0;for(var n=0;n<e;n+=4){var r=n,o=n+1,s=n+2,a=n+3;i.push(r,o,s,r,s,a)}},getTriangleIndex:function(t){return this.triangleIndex[t]},getPolygonIndex:function(t){return this.index_[t]},build:function(){r.prototype.build.call(this,4,this.index_.length,6,this.triangleIndex.length)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleFanSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IndexedTriangleFanSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"index",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var t=this.index_.getValue(),e=this.triangleIndex;e.length=0;for(var i=0,n=t.length;i<n;++i){var r=t[i].getValue();if(++i<n){var o=t[i].getValue();if(o<0)continue;for(++i;i<n;++i){var s=t[i].getValue();if(s<0)break;e.push(r,o,s),o=s}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IndexedTriangleSet)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"index",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(t){return this.index_[t]},build:function(){r.prototype.build.call(this,3,this.index_.length,3,this.index_.length)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleStripSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IndexedTriangleStripSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"index",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var t=this.index_.getValue(),e=this.triangleIndex;e.length=0;for(var i=0,n=t.length;i<n;++i){var r=t[i].getValue();if(!(r<0)&&++i<n){var o=t[i].getValue();if(o<0)continue;++i;for(var s=0;i<n;++i,++s){var a=t[i].getValue();if(a<0)break;e.push(r,o,a),1&s?o=a:r=a}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/EventUtilities/IntegerSequencer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DSequencerNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IntegerSequencer)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOnly,"previous",new e.SFBool),new i(o.inputOnly,"next",new e.SFBool),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFInt32),new i(o.outputOnly,"value_changed",new e.SFInt32)]),getTypeName:function(){return"IntegerSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_index__",this)},getSize:function(){return this.keyValue_.length},sequence:function(t){this.value_changed_=this.keyValue_[t]}}),s}),define("x_ite/Components/EventUtilities/IntegerTrigger",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.IntegerTrigger)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_boolean",new e.SFBool),new i(o.inputOutput,"integerKey",new e.SFInt32(-1)),new i(o.outputOnly,"triggerValue",new e.SFInt32)]),getTypeName:function(){return"IntegerTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.triggerValue_=this.integerKey_}}),s}),define("x_ite/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode",["jquery","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DKeyDeviceSensorNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.set_live__()},set_live__:function(){this.isLive().getValue()?(this.enabled_.addInterest("set_enabled__",this),this.enabled_.getValue()&&this.enable()):(this.enabled_.removeInterest("set_enabled__",this),this.enabled_.getValue()&&this.disable())},set_enabled__:function(){this.enabled_.getValue()?this.enable():this.disable()},enable:function(){if(!this.isActive_.getValue()){var t=this.getBrowser().getKeyDeviceSensorNode();t&&(t.enabled_=!1,t.isActive_=!1),this.getBrowser().setKeyDeviceSensorNode(this),this.isActive_=!0}},disable:function(){this.isActive_.getValue()&&(this.getBrowser().setKeyDeviceSensorNode(null),this.release(),this.isActive_=!1)},keydown:function(){},keyup:function(){},release:function(){}}),n}),define("x_ite/Components/KeyDeviceSensor/KeySensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.KeySensor)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.outputOnly,"controlKey",new e.SFBool),new i(o.outputOnly,"shiftKey",new e.SFBool),new i(o.outputOnly,"altKey",new e.SFBool),new i(o.outputOnly,"actionKeyPress",new e.SFInt32),new i(o.outputOnly,"actionKeyRelease",new e.SFInt32),new i(o.outputOnly,"keyPress",new e.SFString),new i(o.outputOnly,"keyRelease",new e.SFString),new i(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"KeySensor"},getComponentName:function(){return"KeyDeviceSensor"},getContainerField:function(){return"children"},keydown:function(t){switch(t.which){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 112:this.actionKeyPress_=1;break;case 113:this.actionKeyPress_=2;break;case 114:this.actionKeyPress_=3;break;case 115:this.actionKeyPress_=4;break;case 116:this.actionKeyPress_=5;break;case 117:this.actionKeyPress_=6;break;case 118:this.actionKeyPress_=7;break;case 119:this.actionKeyPress_=8;break;case 120:this.actionKeyPress_=9;break;case 121:this.actionKeyPress_=10;break;case 122:this.actionKeyPress_=11;break;case 123:this.actionKeyPress_=12;break;case 36:this.actionKeyPress_=13;break;case 35:this.actionKeyPress_=14;break;case 33:this.actionKeyPress_=15;break;case 34:this.actionKeyPress_=16;break;case 38:this.actionKeyPress_=17;break;case 40:this.actionKeyPress_=18;break;case 37:this.actionKeyPress_=19;break;case 39:this.actionKeyPress_=20;break;default:t.charCode&&(this.keyPress_=t.key)}},keyup:function(t){switch(t.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 112:this.actionKeyRelease_=1;break;case 113:this.actionKeyRelease_=2;break;case 114:this.actionKeyRelease_=3;break;case 115:this.actionKeyRelease_=4;break;case 116:this.actionKeyRelease_=5;break;case 117:this.actionKeyRelease_=6;break;case 118:this.actionKeyRelease_=7;break;case 119:this.actionKeyRelease_=8;break;case 120:this.actionKeyRelease_=9;break;case 121:this.actionKeyRelease_=10;break;case 122:this.actionKeyRelease_=11;break;case 123:this.actionKeyRelease_=12;break;case 36:this.actionKeyRelease_=13;break;case 35:this.actionKeyRelease_=14;break;case 33:this.actionKeyRelease_=15;break;case 34:this.actionKeyRelease_=16;break;case 38:this.actionKeyRelease_=17;break;case 40:this.actionKeyRelease_=18;break;case 37:this.actionKeyRelease_=19;break;case 39:this.actionKeyRelease_=20;break;default:t.charCode&&(this.keyRelease_=t.key)}},release:function(){this.shiftKey_.getValue()&&(this.shiftKey_=!1),this.controlKey_.getValue()&&(this.controlKey_=!1),this.altKey_.getValue()&&(this.altKey_=!1)}}),s}),define("x_ite/Components/Navigation/LOD",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(a.LOD),this.addAlias("level",this.children_),this.center_.setUnit("length"),this.range_.setUnit("length"),this.frameRate=60,this.keepCurrentLevel=!1}return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.initializeOnly,"forceTransitions",new e.SFBool),new i(a.initializeOnly,"center",new e.SFVec3f),new i(a.initializeOnly,"range",new e.MFFloat),new i(a.outputOnly,"level_changed",new e.SFInt32(-1)),new i(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(a.initializeOnly,"bboxCenter",new e.SFVec3f),new i(a.inputOnly,"addChildren",new e.MFNode),new i(a.inputOnly,"removeChildren",new e.MFNode),new i(a.inputOutput,"children",new e.MFNode)]),modelViewMatrix:new u,getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.child=this.getChild(this.level_changed_.getValue()),this.set_cameraObjects__()},set_cameraObjects__:function(){this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=o(a.X3DBoundedObject,this.child);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getLevel:function(t,e){if(0===this.range_.length){var i=this.children_.length;if(i<2)return 0;if(this.frameRate=(179*this.frameRate+t.currentFrameRate)/180,2===i)return Number(this.frameRate>55);var n=i-1,r=Math.max((this.frameRate-20)/35,0);return Math.min(Math.ceil(r*(n-1)),n)}var o=this.getDistance(e);return l.upperBound(this.range_,0,this.range_.length,o,l.less)},getDistance:function(t){return t.translate(this.center_.getValue()),t.origin.abs()},traverse:function(t,e){if(!this.keepCurrentLevel&&t===s.DISPLAY){var i=this.getLevel(e.getBrowser(),this.modelViewMatrix.assign(e.getModelViewMatrix().get())),n=this.level_changed_.getValue();this.forceTransitions_.getValue()&&(i>n?i=n+1:i<n&&(i=n-1)),i!==n&&(this.level_changed_=i,this.child=this.getChild(Math.min(i,this.children_.length-1)),this.set_cameraObjects__())}this.child&&this.child.traverse(t,e)}}),h}),define("x_ite/Components/Layout/X3DLayoutNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DLayoutNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Layout/Layout",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layout/X3DLayoutNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){r.call(this,t),this.addType(s.Layout),this.alignX=f,this.alignY=f,this.offsetUnitX=y,this.offsetUnitY=y,this.offsetX=0,this.offsetY=0,this.sizeUnitX=y,this.sizeUnitY=y,this.sizeX=1,this.sizeY=1,this.scaleModeX=w,this.scaleModeY=w,this.parent=null,this.rectangleCenter=new a(0,0),this.rectangleSize=new a(0,0),this.matrix=new h}var d=0,p=d++,f=d++,g=d++,m=d++,x=d++,y=d++,_=d++,v=d++,w=d++,b=d++;return c.prototype=t.extend(Object.create(r.prototype),{constructor:c,viewportPixel:new a(0,0),pixelSize:new a(0,0),translation:new u(0,0,0),offset:new u(0,0,0),scale:new u(1,1,1),currentTranslation:new u(0,0,0),currentRotation:new l(0,0,1,0),currentScale:new u(0,0,0),modelViewMatrix:new h,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"align",new e.MFString("CENTER","CENTER")),new i(s.inputOutput,"offsetUnits",new e.MFString("WORLD","WORLD")),new i(s.inputOutput,"offset",new e.MFFloat(0,0)),new i(s.inputOutput,"sizeUnits",new e.MFString("WORLD","WORLD")),new i(s.inputOutput,"size",new e.MFFloat(1,1)),new i(s.inputOutput,"scaleMode",new e.MFString("NONE","NONE"))]),getTypeName:function(){return"Layout"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layout"},initialize:function(){r.prototype.initialize.call(this),this.align_.addInterest("set_align__",this),this.offsetUnits_.addInterest("set_offsetUnits__",this),this.offset_.addInterest("set_offset__",this),this.sizeUnits_.addInterest("set_sizeUnits__",this),this.size_.addInterest("set_size__",this),this.scaleMode_.addInterest("set_scaleMode__",this),this.set_align__(),this.set_offsetUnits__(),this.set_offset__(),this.set_sizeUnits__(),this.set_size__(),this.set_scaleMode__()},set_align__:function(){this.align_.length>0?"LEFT"===this.align_[0]?this.alignX=p:"RIGHT"===this.align_[0]?this.alignX=g:this.alignX=f:this.alignX=f,this.align_.length>1?"BOTTOM"===this.align_[1]?this.alignY=m:"TOP"===this.align_[1]?this.alignY=x:this.alignY=f:this.alignY=f},set_offsetUnits__:function(){this.offsetUnits_.length>0?("FRACTION"===this.offsetUnits_[0]?this.offsetUnitX=_:"PIXEL"===this.offsetUnits_[0]?this.offsetUnitX=v:this.offsetUnitX=y,this.offsetUnits_.length>1?"FRACTION"===this.offsetUnits_[1]?this.offsetUnitY=_:"PIXEL"===this.offsetUnits_[1]?this.offsetUnitY=v:this.offsetUnitY=y:this.offsetUnitY=this.offsetUnitX):(this.offsetUnitX=y,this.offsetUnitY=y)},set_offset__:function(){this.offset_.length>0?(this.offsetX=this.offset_[0],this.offset_.length>1?this.offsetY=this.offset_[1]:this.offsetY=offsetX):(this.offsetX=0,this.offsetY=0)},set_sizeUnits__:function(){this.sizeUnits_.length>0?("FRACTION"===this.sizeUnits_[0]?this.sizeUnitX=_:"PIXEL"===this.sizeUnits_[0]?this.sizeUnitX=v:this.sizeUnitX=y,this.sizeUnits_.length>1?"FRACTION"===this.sizeUnits_[1]?this.sizeUnitY=_:"PIXEL"===this.sizeUnits_[1]?this.sizeUnitY=v:this.sizeUnitY=y:this.sizeUnitY=this.sizeUnitX):(this.sizeUnitX=y,this.sizeUnitY=y)},set_size__:function(){this.size_.length>0?(this.sizeX=this.size_[0],this.size_.length>1?this.sizeY=this.size_[1]:this.sizeY=this.sizeX):(this.sizeX=0,this.sizeY=0)},set_scaleMode__:function(){this.scaleMode_.length>0?("FRACTION"===this.scaleMode_[0]?this.scaleModeX=_:"PIXEL"===this.scaleMode_[0]?this.scaleModeX=v:"STRETCH"===this.scaleMode_[0]?this.scaleModeX=b:this.scaleModeX=w,this.scaleMode_.length>1?"FRACTION"===this.scaleMode_[1]?this.scaleModeY=_:"PIXEL"===this.scaleMode_[1]?this.scaleModeY=v:"STRETCH"===this.scaleMode_[1]?this.scaleModeY=b:this.scaleModeY=w:this.scaleModeY=this.scaleModeX):(this.scaleModeX=w,this.scaleModeY=w)},getRectangleCenter:function(){return this.rectangleCenter},getRectangleSize:function(){return this.rectangleSize},getAlignX:function(){return this.alignX},getAlignY:function(){return this.alignY},getOffsetUnitX:function(){return this.offsetUnitX===y?this.parent?this.parent.getOffsetUnitX():_:this.offsetUnitX},getOffsetUnitY:function(){return this.offsetUnitY===y?this.parent?this.parent.getOffsetUnitY():_:this.offsetUnitY},getOffsetX:function(){return this.offsetX},getOffsetY:function(){return this.offsetY},getSizeUnitX:function(){return this.sizeUnitX===y?this.parent?this.parent.getSizeUnitX():_:this.sizeUnitX},getSizeUnitY:function(){return this.sizeUnitY===y?this.parent?this.parent.getSizeUnitY():_:this.sizeUnitY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getScaleModeX:function(){return this.parent?this.scaleModeX:this.scaleModeX===w?_:this.scaleModeX},getScaleModeY:function(){return this.parent?this.scaleModeY:this.scaleModeY===w?_:this.scaleModeY},transform:function(t,e){var i=this.matrix,n=o(s.OrthoViewpoint,e.getViewpoint());if(n){
var r=this.parent=e.getParentLayout(),a=e.getViewVolume().getScissor(),u=n.getViewportSize(a),l=this.viewportPixel,h=this.pixelSize,c=r?r.getRectangleSize():u,d=this.rectangleSize,y=this.rectangleCenter;switch(l.set(a[2],a[3]),h.assign(u).divVec(l),this.getSizeUnitX()){case _:d.x=this.sizeX*c.x;break;case v:d.x=this.sizeX*h.x}switch(this.getSizeUnitY()){case _:d.y=this.sizeY*c.y;break;case v:d.y=this.sizeY*h.y}var S=this.translation.set(0,0,0);switch(this.getAlignX()){case p:S.x=-(c.x-d.x)/2;break;case f:this.getSizeUnitX()===v&&1&l.x&&(S.x=-h.x/2);break;case g:S.x=(c.x-d.x)/2}switch(this.getAlignY()){case m:S.y=-(c.y-d.y)/2;break;case f:this.getSizeUnitX===v&&1&l.y&&(S.y=-h.y/2);break;case x:S.y=(c.y-d.y)/2}var C=this.offset.set(0,0,0);switch(this.getOffsetUnitX()){case _:C.x=this.offsetX*c.x;break;case v:C.x=this.offsetX*u.x/l.x}switch(this.getOffsetUnitY()){case _:C.y=this.offsetY*c.y;break;case v:C.y=this.offsetY*u.y/l.y}var F=this.scale.set(1,1,1),T=this.currentTranslation,N=this.currentRotation,O=this.currentScale;switch(e.getModelViewMatrix().get().get(T,N,O),this.getScaleModeX()){case w:F.x=O.x;break;case _:F.x=d.x;break;case b:break;case v:F.x=u.x/l.x}switch(this.getScaleModeY()){case w:F.y=O.y;break;case _:F.y=d.y;break;case b:break;case v:F.y=u.y/l.y}this.getScaleModeX()===b?this.getScaleModeY()===b?d.x>d.y?(F.x=d.x,F.y=F.x):(F.y=d.y,F.x=F.y):F.x=F.y:this.getScaleModeY()===b&&(F.y=F.x),y.assign(S).add(C),i.set(T,N),i.translate(S.add(C)),i.scale(F)}else i.identity();return i}}),c}),define("x_ite/Components/Layout/LayoutGroup",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(a.LayoutGroup),this.viewportNode=null,this.layoutNode=null,this.modelViewMatrix=new u,this.screenMatrix=new u}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"layout",new e.SFNode),new i(a.inputOutput,"viewport",new e.SFNode),new i(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(a.initializeOnly,"bboxCenter",new e.SFVec3f),new i(a.inputOnly,"addChildren",new e.MFNode),new i(a.inputOnly,"removeChildren",new e.MFNode),new i(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LayoutGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.viewport_.addInterest("set_viewport__",this),this.layout_.addInterest("set_layout__",this),this.set_viewport__(),this.set_layout__()},set_viewport__:function(){this.viewportNode=o(a.X3DViewportNode,this.viewport_)},set_layout__:function(){this.layoutNode=o(a.X3DLayoutNode,this.layout_)},getBBox:function(t){return r.prototype.getBBox.call(this,t).multRight(this.getMatrix())},getMatrix:function(){try{this.layoutNode?this.matrix.assign(this.modelViewMatrix).inverse().multLeft(this.screenMatrix):this.matrix.identity()}catch(t){}return this.matrix},traverse:function(t,e){switch(t){case s.POINTER:case s.CAMERA:case s.DEPTH:case s.DISPLAY:if(this.viewportNode&&this.viewportNode.push(),this.layoutNode){var i=e.getModelViewMatrix();this.modelViewMatrix.assign(i.get()),i.push(),i.set(this.screenMatrix.assign(this.layoutNode.transform(t,e))),e.getLayouts().push(this.layoutNode),r.prototype.traverse.call(this,t,e),e.getLayouts().pop(),i.pop()}else r.prototype.traverse.call(this,t,e);this.viewportNode&&this.viewportNode.pop()}}}),l}),define("x_ite/Components/Layout/LayoutLayer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Layout/LayoutGroup","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t,new s(t),new o(t)),this.addType(a.LayoutLayer)}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"isPickable",new e.SFBool(!0)),new i(a.inputOutput,"layout",new e.SFNode),new i(a.inputOutput,"viewport",new e.SFNode),new i(a.inputOnly,"addChildren",new e.MFNode),new i(a.inputOnly,"removeChildren",new e.MFNode),new i(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LayoutLayer"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layers"},initialize:function(){this.layout_.addFieldInterest(this.getGroup().layout_),this.getGroup().layout_=this.layout_,r.prototype.initialize.call(this)}}),u}),define("x_ite/Components/Shape/LineProperties",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.LineProperties)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"applied",new e.SFBool(!0)),new i(o.inputOutput,"linetype",new e.SFInt32(1)),new i(o.inputOutput,"linewidthScaleFactor",new e.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){r.prototype.initialize.call(this),this.linewidthScaleFactor_.addInterest("set_linewidthScaleFactor__",this),this.set_linewidthScaleFactor__()},getLinewidthScaleFactor:function(){return this.linewidthScaleFactor},set_linewidthScaleFactor__:function(){this.linewidthScaleFactor=Math.max(1,this.linewidthScaleFactor_.getValue())}}),s}),define("x_ite/Components/Rendering/LineSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.LineSet),this.setGeometryType(1),this.colorNode=null,this.coordNode=null}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"vertexCount",new e.MFInt32),new i(s.inputOutput,"attrib",new e.MFNode),new i(s.inputOutput,"fogCoord",new e.SFNode),new i(s.inputOutput,"color",new e.SFNode),new i(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,i=t.length;e<i;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,i=this.attrib_.length;e<i;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&t.push(n)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var t=this.vertexCount_.getValue(),e=this.getAttrib(),i=e.length,n=this.getAttribs(),r=this.colorNode,o=this.coordNode,s=o.getSize(),a=0,u=0,l=t.length;u<l;++u){var h=t[u].getValue();if(a+h>s)break;if(h>1){h=2*h-2;for(var c=0;c<h;++c,a+=1&c){for(var d=0;d<i;++d)attrib[d].addValue(n[d],a);r&&this.addColor(r.get1Color(a)),this.addVertex(o.get1Point(a))}++a}else a+=h}}}),a}),define("x_ite/Components/EnvironmentalEffects/LocalFog",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.LocalFog)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"fogType",new e.SFString("LINEAR")),new i(s.inputOutput,"color",new e.SFColor(1,1,1)),new i(s.inputOutput,"visibilityRange",new e.SFFloat)]),getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},push:function(t){this.enabled_.getValue()&&t.pushLocalFog(this)},pop:function(t){this.enabled_.getValue()&&t.popLocalFog()}}),a}),define("x_ite/Components/Shape/X3DMaterialNode",["jquery","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DMaterialNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Shape/Material",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Material),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new i(o.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new i(o.inputOutput,"specularColor",new e.SFColor),new i(o.inputOutput,"emissiveColor",new e.SFColor),new i(o.inputOutput,"shininess",new e.SFFloat(.2)),new i(o.inputOutput,"transparency",new e.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){r.prototype.initialize.call(this),this.addChildObjects("transparent",new e.SFBool),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var t=this.diffuseColor,e=this.diffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularColor__:function(){var t=this.specularColor,e=this.specularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveColor__:function(){var t=this.emissiveColor,e=this.emissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_shininess__:function(){this.shininess=s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){var t=s.clamp(this.transparency_.getValue(),0,1);this.transparency=t,t!=this.transparent_.getValue()&&(this.transparent_=t)},setShaderUniforms:function(t,e){t.uniform1i(e.x3d_SeparateBackColor,!1),t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Shininess,this.shininess),t.uniform1f(e.x3d_Transparency,this.transparency)}}),a}),define("x_ite/Components/Shaders/Matrix3VertexAttribute",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Matrix3VertexAttribute)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"name",new e.SFString),new i(o.inputOutput,"value",new e.MFMatrix3f)]),getTypeName:function(){return"Matrix3VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},addValue:function(t,e){if(e<this.value_.length)for(var i=this.value_[e].getValue(),n=0;n<9;++n)t.push(i[n]);else for(var i=s.Identity,n=0;n<9;++n)t.push(i[n])},enable:function(t,e,i){e.enableMatrix3Attrib(t,this.name_.getValue(),i)},disable:function(t,e){e.disableMatrix3Attrib(t,this.name_.getValue())}}),a}),define("x_ite/Components/Shaders/Matrix4VertexAttribute",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Matrix4VertexAttribute)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"name",new e.SFString),new i(o.inputOutput,"value",new e.MFMatrix4f)]),getTypeName:function(){return"Matrix4VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},addValue:function(t,e){if(e<this.value_.length)for(var i=this.value_[e].getValue(),n=0;n<16;++n)t.push(i[n]);else for(var i=Matrix4.Identity,n=0;n<16;++n)t.push(i[n])},enable:function(t,e,i){e.enableMatrix4Attrib(t,this.name_.getValue(),i)},disable:function(t,e){e.disableMatrix4Attrib(t,this.name_.getValue())}}),s}),define("x_ite/Components/Core/X3DMetadataObject",["jquery","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function i(t){this.addType(e.X3DMetadataObject)}return i.prototype={constructor:i,initialize:function(){}},i}),define("x_ite/Components/Core/MetadataBoolean",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataBoolean)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Core/MetadataDouble",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataDouble)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Core/MetadataFloat",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataFloat)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Core/MetadataInteger",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataInteger)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Core/MetadataSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataSet)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Core/MetadataString",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),o.call(this,t),this.addType(s.MetadataString)}return a.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"name",new e.SFString),new i(s.inputOutput,"reference",new e.SFString),new i(s.inputOutput,"value",new e.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("x_ite/Components/Texturing/MovieTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){r.call(this,t),o.call(this,t),s.call(this,t),this.addType(a.MovieTexture),this.addChildObjects("buffer",new e.SFTime),this.urlStack=new e.MFString}return d.prototype=t.extend(Object.create(r.prototype),o.prototype,s.prototype,{constructor:d,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"enabled",new e.SFBool(!0)),new i(a.inputOutput,"description",new e.SFString),new i(a.inputOutput,"url",new e.MFString),new i(a.inputOutput,"speed",new e.SFFloat(1)),new i(a.inputOutput,"pitch",new e.SFFloat(1)),new i(a.inputOutput,"loop",new e.SFBool),new i(a.inputOutput,"startTime",new e.SFTime),new i(a.inputOutput,"resumeTime",new e.SFTime),new i(a.inputOutput,"pauseTime",new e.SFTime),new i(a.inputOutput,"stopTime",new e.SFTime),new i(a.outputOnly,"isPaused",new e.SFBool),new i(a.outputOnly,"isActive",new e.SFBool),new i(a.outputOnly,"cycleTime",new e.SFTime),new i(a.outputOnly,"elapsedTime",new e.SFTime),new i(a.outputOnly,"duration_changed",new e.SFTime(-1)),new i(a.initializeOnly,"repeatS",new e.SFBool(!0)),new i(a.initializeOnly,"repeatT",new e.SFBool(!0)),new i(a.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.canvas=t("<canvas></canvas>"),this.video=t("<video></video>"),this.video.on("error",this.setError.bind(this)),this.video.bind("abort",this.setError.bind(this)),this.video[0].preload="auto",this.video[0].volume=0,this.video[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==a.COMPLETE_STATE&&this.checkLoadState()!==a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.setMedia(null),this.urlStack.setValue(this.url_),this.video.bind("canplaythrough",this.setVideo.bind(this)),this.loadNext())},loadNext:function(){if(0===this.urlStack.length)return this.duration_changed_=-1,this.clear(),void this.setLoadState(a.FAILED_STATE);this.URL=new l(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.video.attr("src",this.URL)},setError:function(){var t=this.URL.toString();c&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(u.fallbackExpression)||this.urlStack.unshift(u.fallbackUrl+t)),"data"!==this.URL.scheme&&console.warn("Error loading movie:",this.URL.toString()),this.loadNext()},setVideo:function(){c&&"data"!==this.URL.scheme&&console.info("Done loading movie:",this.URL.toString());var t=this.video[0];try{var e=t.videoWidth,i=t.videoHeight,n=this.canvas[0],r=n.getContext("2d");if(!h.isPowerOfTwo(e)||!h.isPowerOfTwo(i))throw new Error("The movie texture is a non power-of-two texture.");n.width=e,n.height=i,r.drawImage(t,0,0);var o=r.getImageData(0,0,e,i).data;setTimeout(function(){this.video.unbind("canplaythrough"),this.setMedia(this.video),this.setTexture(e,i,!1,new Uint8Array(o),!0),this.setLoadState(a.COMPLETE_STATE)}.bind(this),16)}catch(t){console.log(t.message),this.setError()}},set_time:function(){o.prototype.set_time.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this.updateTexture(this.getMedia()[0],!0)},traverse:r.prototype.traverse}),d}),define("x_ite/Components/Rendering/X3DNormalNode",["jquery","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DNormalNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Rendering/Normal",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DNormalNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Normal),this.vector=this.vector_.getValue()}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"vector",new e.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},get1Vector:function(t){return t>=0&&t<this.vector.length?this.vector[t].getValue():new s(0,0,0)}}),a}),define("x_ite/Components/Interpolation/NormalInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.NormalInterpolator)}return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFVec3f),new i(o.outputOnly,"value_changed",new e.MFVec3f)]),keyValue0:new s(0,0,0),keyValue1:new s(0,0,0),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){},interpolate:function(t,e,i){var n=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length>1?Math.floor(n.length/this.key_.length):0;t*=o,e=t+o,this.value_changed_.length=o;for(var s=0;s<o;++s)try{r[s].set(a.simpleSlerp(this.keyValue0.assign(n[t+s].getValue()),this.keyValue1.assign(n[e+s].getValue()),i))}catch(t){}this.value_changed_.addEvent()}}),u}),define("x_ite/Components/Followers/OrientationChaser",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.OrientationChaser)}var u=new s(0,0,1,0),l=new s(0,0,1,0);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFRotation),new i(o.inputOnly,"set_destination",new e.SFRotation),new i(o.initializeOnly,"initialValue",new e.SFRotation),new i(o.initializeOnly,"initialDestination",new e.SFRotation),new i(o.initializeOnly,"duration",new e.SFTime(1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(t,e,i){return u.assign(t).inverse().multRight(e),Math.abs(u.angle)<i},interpolate:function(t,e,i){return l.assign(t).slerp(e,i)},step:function(t,e,i){this.deltaOut.assign(e).inverse().multRight(t).multLeft(this.output),this.output.slerp(this.deltaOut,i)}}),a}),define("x_ite/Components/Followers/OrientationDamper",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.OrientationDamper)}var u=new s(0,0,1,0),l=new s(0,0,1,0);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFRotation),new i(o.inputOnly,"set_destination",new e.SFRotation),new i(o.initializeOnly,"initialValue",new e.SFRotation),new i(o.initializeOnly,"initialDestination",new e.SFRotation),new i(o.initializeOnly,"order",new e.SFInt32(3)),new i(o.inputOutput,"tau",new e.SFTime(.3)),new i(o.inputOutput,"tolerance",new e.SFFloat(-1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(t,e,i){return u.assign(t).inverse().multRight(e),Math.abs(u.angle)<i},interpolate:function(t,e,i){return l.assign(t).slerp(e,i)}}),a}),define("x_ite/Components/Shape/X3DShapeNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(t,e,i,n,r,o){"use strict";function s(t){e.call(this,t),i.call(this,t),this.addType(r.X3DShapeNode),this.bbox=new o}return s.prototype=t.extend(Object.create(e.prototype),i.prototype,{constructor:s,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this),this.bboxSize_.addInterest("set_bbox__",this),this.bboxCenter_.addInterest("set_bbox__",this),this.appearance_.addInterest("set_apparance__",this),this.geometry_.addInterest("set_geometry__",this),this.set_apparance__(),this.set_geometry__(),this.set_bbox__()},getBBox:function(t){return t.assign(this.bbox)},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},setTransparent:function(t){this.transparent=t},isTransparent:function(){return this.transparent},set_bbox__:function(){this.bboxSize_.getValue().equals(this.defaultBBoxSize)?this.getGeometry()?this.bbox.assign(this.getGeometry().getBBox()):this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize=this.bbox.size,this.bboxCenter=this.bbox.center},set_apparance__:function(){this.apparanceNode&&this.apparanceNode.removeInterest("set_transparent__",this),this.apparanceNode=n(r.X3DAppearanceNode,this.appearance_),this.apparanceNode?this.apparanceNode.addInterest("set_transparent__",this):this.apparanceNode=this.getBrowser().getDefaultAppearance(),this.set_transparent__()},set_geometry__:function(){this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.geometryNode=n(r.X3DGeometryNode,this.geometry_),this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.set_transparent__(),this.set_bbox__()},set_transparent__:function(){this.transparent=this.apparanceNode&&this.apparanceNode.transparent_.getValue()||this.geometryNode&&this.geometryNode.transparent_.getValue()}}),s}),define("standard/Math/Utility/BVH",["standard/Math/Numbers/Vector3","standard/Math/Geometry/Plane3","standard/Math/Algorithms/QuickSort"],function(t,e,i){"use strict";function n(t,e){function i(t,n){var r=i.vertices;return e=i.axis,Math.min(r[t+e],r[t+4+e],r[t+8+e])<Math.min(r[n+e],r[n+4+e],r[n+8+e])}return i.vertices=t,i.axis=e,i}function r(t,e){this.vertices=t.vertices,this.normals=t.normals,this.i4=12*e,this.i3=9*e}function o(i,n,s,h){this.min=new t(0,0,0),this.max=new t(0,0,0),this.planes=[],this.intersection=new t(0,0,0);var d=i.vertices,p=this.min,f=this.max,g=s+h,m=12*n[s];p.set(d[m],d[m+1],d[m+2]),f.assign(p);for(var x=s;x<g;++x)m=12*n[x],a.set(d[m+0],d[m+1],d[m+2]),u.set(d[m+4],d[m+5],d[m+6]),l.set(d[m+8],d[m+9],d[m+10]),p.min(a,u,l),f.max(a,u,l);for(var x=0;x<5;++x)this.planes[x]=new e(x%2?p:f,c[x])
;if(h>2){i.sorter.compare.axis=this.getLongestAxis(p,f),i.sorter.sort(s,g);var y=h>>>1}else var y=1;var _=h-y;this.left=y>1?new o(i,n,s,y):new r(i,n[s]),this.right=_>1?new o(i,n,s+y,_):new r(i,n[s+y])}function s(t,e){this.vertices=t,this.normals=e;var s=t.length/12;switch(s){case 0:this.root=null;break;case 1:this.root=new r(this,0);break;default:for(var a=[],u=0;u<s;++u)a.push(u);this.sorter=new i(a,n(t,0)),this.root=new o(this,a,0,s)}}var a=new t(0,0,0),u=new t(0,0,0),l=new t(0,0,0),h={u:0,v:0,t:0},c=[new t(0,0,1),new t(0,0,-1),new t(0,1,0),new t(0,-1,0),new t(1,0,0)];return r.prototype={intersectsLine:function(e,i,n){var r=this.vertices,o=this.normals,s=this.i4,c=this.i3;if(a.x=r[s+0],a.y=r[s+1],a.z=r[s+2],u.x=r[s+4],u.y=r[s+5],u.z=r[s+6],l.x=r[s+8],l.y=r[s+9],l.z=r[s+10],e.intersectsTriangle(a,u,l,h)){var d=h.u,p=h.v,f=1-d-p,g=i.size++;g>=i.length&&(i.push(new t(0,0,0)),n.push(new t(0,0,0))),i[g].set(f*r[s+0]+d*r[s+4]+p*r[s+8],f*r[s+1]+d*r[s+5]+p*r[s+9],f*r[s+2]+d*r[s+6]+p*r[s+10]),n[g].set(f*o[c+0]+d*o[c+3]+p*o[c+6],f*o[c+1]+d*o[c+4]+p*o[c+7],f*o[c+2]+d*o[c+5]+p*o[c+8])}}},o.prototype={intersectsLine:function(t,e,i){this.intersectsBBox(t)&&(this.left.intersectsLine(t,e,i),this.right.intersectsLine(t,e,i))},intersectsBBox:function(t){var e=this.planes,i=this.min,n=this.max,r=i.x,o=n.x,s=i.y,a=n.y,u=i.z,l=n.z,h=this.intersection;return!!(e[0].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.y>=s&&h.y<=a)||(!!(e[1].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.y>=s&&h.y<=a)||(!!(e[2].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.z>=u&&h.z<=l)||(!!(e[3].intersectsLine(t,h)&&h.x>=r&&h.x<=o&&h.z>=u&&h.z<=l)||!!(e[4].intersectsLine(t,h)&&h.y>=s&&h.y<=a&&h.z>=u&&h.z<=l))))},getLongestAxis:function(t,e){var i=e.x-t.x,n=e.y-t.y,r=e.z-t.z;return i<n?n<r?2:1:i<r?2:0}},s.prototype={constructor:s,intersectsLine:function(t,e,i){return e.size=0,this.root?(this.root.intersectsLine(t,e,i),e.size):0}},s}),define("x_ite/Components/ParticleSystems/ParticleSystem",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Numbers/Color4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/QuickSort","standard/Math/Algorithm","standard/Math/Utility/BVH"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g){"use strict";function m(t,e){return t.distance<e.distance}function x(t){r.call(this,t),this.addType(s.ParticleSystem),this.particleSize_.setUnit("length"),this.createParticles=!0,this.particles=[],this.velocities=[],this.speeds=[],this.turbulences=[],this.geometryType=_,this.maxParticles=0,this.numParticles=0,this.particleLifetime=0,this.lifetimeVariation=0,this.emitterNode=null,this.forcePhysicsModelNodes=[],this.boundedPhysicsModelNodes=[],this.boundedNormals=[],this.boundedVertices=[],this.boundedVolume=null,this.creationTime=0,this.pauseTime=0,this.deltaTime=0,this.numForces=0,this.colorKeys=[],this.colorRamppNode=null,this.colorRamp=[],this.colorMaterial=!1,this.texCoordKeys=[],this.texCoordRampNode=null,this.texCoordRamp=[],this.texCoordAnim=!1,this.vertexCount=0,this.shaderNode=this.getBrowser().getPointShader(),this.rotation=new d,this.particleSorter=new p(this.particles,m),this.sortParticles=!1}var y=0,_=y++,v=y++,w=y++,b=y++,S=y++,C=y++,F={POINT:_,LINE:v,TRIANGLE:w,QUAD:b,GEOMETRY:S,SPRITE:C},T=new c,N=new l(0,0,0),O=new l(0,0,0),M=new l(0,0,0),V=new l(0,0,0),D=new l(0,0,0),B=new l(0,0,0),I=new l(0,0,0),E=new l(0,0,0),A=new l(0,0,0),P=new l(0,0,0);return x.prototype=t.extend(Object.create(r.prototype),{constructor:x,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"createParticles",new e.SFBool(!0)),new i(s.initializeOnly,"geometryType",new e.SFString("QUAD")),new i(s.inputOutput,"maxParticles",new e.SFInt32(200)),new i(s.inputOutput,"particleLifetime",new e.SFFloat(5)),new i(s.inputOutput,"lifetimeVariation",new e.SFFloat(.25)),new i(s.inputOutput,"particleSize",new e.SFVec2f(.02,.02)),new i(s.initializeOnly,"emitter",new e.SFNode),new i(s.initializeOnly,"physics",new e.MFNode),new i(s.initializeOnly,"colorKey",new e.MFFloat),new i(s.initializeOnly,"colorRamp",new e.SFNode),new i(s.initializeOnly,"texCoordKey",new e.MFFloat),new i(s.initializeOnly,"texCoordRamp",new e.SFNode),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOutput,"appearance",new e.SFNode),new i(s.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"ParticleSystem"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.isLive().addInterest("set_live__",this),this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shader__",this),this.enabled_.addInterest("set_enabled__",this),this.createParticles_.addInterest("set_createParticles__",this),this.geometryType_.addInterest("set_geometryType__",this),this.maxParticles_.addInterest("set_enabled__",this),this.particleLifetime_.addInterest("set_particleLifetime__",this),this.lifetimeVariation_.addInterest("set_lifetimeVariation__",this),this.emitter_.addInterest("set_emitter__",this),this.physics_.addInterest("set_physics__",this),this.colorKey_.addInterest("set_color__",this),this.colorRamp_.addInterest("set_colorRamp__",this),this.texCoordKey_.addInterest("set_texCoord__",this),this.texCoordRamp_.addInterest("set_texCoordRamp__",this),this.colorBuffer=t.createBuffer(),this.texCoordBuffers=[t.createBuffer()],this.normalBuffer=t.createBuffer(),this.vertexBuffer=t.createBuffer(),this.colorArray=new Float32Array,this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array,this.set_emitter__(),this.set_enabled__(),this.set_createParticles__(),this.set_particleLifetime__(),this.set_lifetimeVariation__(),this.set_physics__(),this.set_colorRamp__(),this.set_texCoordRamp__()},set_bbox__:function(){this.bboxSize_.getValue().equals(this.defaultBBoxSize)?this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize=this.bbox.size,this.bboxCenter=this.bbox.center},set_transparent__:function(){switch(this.geometryType){case _:this.setTransparent(!0);break;default:this.setTransparent(this.getAppearance()&&this.getAppearance().transparent_.getValue()||this.colorRampNode&&this.colorRampNode.isTransparent()||this.geometryType===S&&this.geometryNode&&this.geometryNode.transparent_.getValue())}},set_live__:function(){this.isLive().getValue()?this.isActive_.getValue()&&this.maxParticles_.getValue()&&(this.getBrowser().sensorEvents().addInterest("animateParticles",this),this.pauseTime&&(this.creationTime+=performance.now()/1e3-this.pauseTime,this.pauseTime=0)):this.isActive_.getValue()&&this.maxParticles_.getValue()&&(this.getBrowser().sensorEvents().removeInterest("animateParticles",this),0===this.pauseTime&&(this.pauseTime=performance.now()/1e3))},set_enabled__:function(){this.enabled_.getValue()&&this.maxParticles_.getValue()?this.isActive_.getValue()||(this.isLive().getValue()?(this.getBrowser().sensorEvents().addInterest("animateParticles",this),this.pauseTime=0):this.pauseTime=performance.now()/1e3,this.isActive_=!0):this.isActive_.getValue()&&(this.isLive().getValue()&&this.getBrowser().sensorEvents().removeInterest("animateParticles",this),this.isActive_=!1),this.set_maxParticles__()},set_createParticles__:function(){this.createParticles=this.createParticles_.getValue()},set_geometryType__:function(){var t=this.getBrowser().getContext(),e=this.maxParticles;switch(this.geometryType=F[this.geometryType_.getValue()],this.geometryType||(this.geometryType=_),this.geometryType){case _:this.colorArray=new Float32Array(4*e),this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array(4*e),this.colorArray.fill(1),this.vertexArray.fill(1),this.texCoordCount=0,this.vertexCount=1;break;case v:this.colorArray=new Float32Array(8*e),this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array(8*e),this.colorArray.fill(1),this.vertexArray.fill(1),this.texCoordCount=2,this.vertexCount=2,this.shaderNode=this.getBrowser().getLineShader();break;case w:case b:case C:this.colorArray=new Float32Array(24*e),this.texCoordArray=new Float32Array(24*e),this.normalArray=new Float32Array(18*e),this.vertexArray=new Float32Array(24*e),this.colorArray.fill(1),this.vertexArray.fill(1);for(var i=this.texCoordArray,n=this.normalArray,r=0,o=18*e;r<o;r+=3)n[r]=0,n[r+1]=0,n[r+2]=1;t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,this.normalArray,t.STATIC_DRAW);for(var r=0;r<e;++r){var s=24*r;i[s]=i[s+12]=0,i[s+1]=i[s+13]=0,i[s+2]=i[s+14]=0,i[s+3]=i[s+15]=1,i[s+4]=1,i[s+5]=0,i[s+6]=0,i[s+7]=1,i[s+8]=i[s+16]=1,i[s+9]=i[s+17]=1,i[s+10]=i[s+18]=0,i[s+11]=i[s+19]=1,i[s+20]=0,i[s+21]=1,i[s+22]=0,i[s+23]=1}t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[0]),t.bufferData(t.ARRAY_BUFFER,this.texCoordArray,t.STATIC_DRAW),this.texCoordCount=4,this.vertexCount=6;break;case S:this.texCoordCount=0,this.vertexCount=0}this.set_shader__(),this.set_transparent__()},set_shader__:function(){switch(this.geometryType){case _:this.shaderGeometryType=0,this.shaderNode=this.getBrowser().getPointShader();break;case v:this.shaderGeometryType=1,this.shaderNode=this.getBrowser().getLineShader();break;case w:case b:case C:case S:this.shaderGeometryType=3,this.shaderNode=this.getBrowser().getDefaultShader()}},set_maxParticles__:function(){for(var t=this.particles,e=Math.max(0,this.maxParticles_.getValue()),i=this.numParticles,n=Math.min(t.length,e);i<n;++i)t[i].lifetime=-1;for(var i=t.length,n=e;i<n;++i)t[i]={lifetime:-1,elapsedTime:0,position:new l(0,0,0),velocity:new l(0,0,0),color:new h(1,1,1,1),distance:0};this.maxParticles=e,this.numParticles=Math.min(this.numParticles,e),this.emitterNode.isExplosive()||(this.creationTime=performance.now()/1e3),this.set_geometryType__()},set_particleLifetime__:function(){this.particleLifetime=this.particleLifetime_.getValue()},set_lifetimeVariation__:function(){this.lifetimeVariation=this.lifetimeVariation_.getValue()},set_emitter__:function(){this.emitterNode=a(s.X3DParticleEmitterNode,this.emitter_),this.emitterNode||(this.emitterNode=this.getBrowser().getDefaultEmitter())},set_physics__:function(){for(var t=this.physics_.getValue(),e=this.forcePhysicsModelNodes,i=this.boundedPhysicsModelNodes,n=0,r=i.length;n<r;++n)i[n].removeInterest("set_boundedPhysics__",this);e.length=0,i.length=0;for(var n=0,r=t.length;n<r;++n)try{for(var o=t[n].getValue().getInnerNode(),a=o.getType(),u=a.length-1;u>=0;--u){switch(a[u]){case s.ForcePhysicsModel:case s.WindPhysicsModel:e.push(o);break;case s.BoundedPhysicsModel:o.addInterest("set_boundedPhysics__",this),i.push(o);break;default:continue}break}}catch(t){}this.set_boundedPhysics__()},set_boundedPhysics__:function(){var t=this.boundedPhysicsModelNodes,e=this.boundedNormals,i=this.boundedVertices;e.length=0,i.length=0;for(var n=0,r=t.length;n<r;++n)t[n].addGeometry(e,i);this.boundedVolume=new g(i,e)},set_colorRamp__:function(){this.colorRampNode&&this.colorRampNode.removeInterest("set_color__",this),this.colorRampNode=a(s.X3DColorNode,this.colorRamp_),this.colorRampNode&&this.colorRampNode.addInterest("set_color__",this),this.set_color__(),this.set_transparent__()},set_color__:function(){for(var t=this.colorKey_.getValue(),e=this.colorKeys,i=this.colorRamp,n=0,r=t.length;n<r;++n)e[n]=t[n].getValue();e.length=r,this.colorRampNode&&this.colorRampNode.getVectors(this.colorRamp);for(var n=i.length,r=t.length;n<r;++n)i[n]=new h(1,1,1,1);i.length=r,this.colorMaterial=Boolean(e.length&&this.colorRampNode)},set_texCoordRamp__:function(){this.texCoordRampNode&&this.texCoordRampNode.removeInterest("set_texCoord__",this),this.texCoordRampNode=a(s.X3DTextureCoordinateNode,this.texCoordRamp_),this.texCoordRampNode&&this.texCoordRampNode.addInterest("set_texCoord__",this),this.set_texCoord__()},set_texCoord__:function(){for(var t=this.texCoordKey_.getValue(),e=this.texCoordKeys,i=this.texCoordRamp,n=0,r=t.length;n<r;++n)e[n]=t[n].getValue();e.length=r,this.texCoordRampNode&&this.texCoordRampNode.getTexCoord(i);for(var n=i.length,r=t.length*this.texCoordCount;n<r;++n)i[n]=new h(0,0,0,0);i.length=r,this.texCoordAnim=Boolean(e.length&&this.texCoordRampNode)},intersectsBox:function(t,e){},animateParticles:function(){var t=this.emitterNode,e=1/this.getBrowser().getCurrentFrameRate(),i=this.deltaTime=(14*this.deltaTime+e)/15;if(t.isExplosive()){var n=performance.now()/1e3,r=this.particleLifetime+this.particleLifetime*this.lifetimeVariation;0===this.numParticles||n-this.creationTime>r?(this.creationTime=n,this.numParticles=this.maxParticles,this.createParticles=this.createParticles_.getValue(),i=Number.POSITIVE_INFINITY):this.createParticles=!1}else if(this.numParticles<this.maxParticles){var n=performance.now()/1e3,o=Math.max(0,Math.ceil((n-this.creationTime)*this.maxParticles/this.particleLifetime));o&&(this.creationTime=n),this.numParticles=Math.floor(Math.min(this.maxParticles,this.numParticles+o))}if(t.getMass()){for(var s=this.forcePhysicsModelNodes,a=this.velocities,u=this.speeds,h=this.turbulences,c=this.deltaTime/t.getMass(),d=a.length,p=s.length;d<p;++d)a[d]=new l(0,0,0);for(var d=0,p=s.length;d<p;++d)s[d].addForce(d,t,a,h);for(var d=0,p=a.length;d<p;++d)a[d].multiply(c),u[d]=a[d].abs();this.numForces=p}else this.numForces=0;t.animate(this,i),this.updateGeometry(null),this.getBrowser().addBrowserEvent(this)},updateGeometry:function(t){switch(this.geometryType){case _:t||this.updatePoint();break;case v:t||this.updateLine();break;case w:case b:case C:this.updateQuad(t)}},updatePoint:function(){var t=this.getBrowser().getContext(),e=this.particles,i=this.numParticles,n=this.colorArray,r=this.vertexArray;if(this.colorMaterial){for(var o=0;o<i;++o){var s=e[o].color,a=4*o;n[a]=s.x,n[a+1]=s.y,n[a+2]=s.z,n[a+3]=s.w}t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW)}for(var o=0;o<i;++o){var u=e[o].position,a=4*o;r[a]=u.x,r[a+1]=u.y,r[a+2]=u.z}t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW)},updateLine:function(){var t=this.getBrowser().getContext(),e=this.particles,i=this.numParticles,n=this.colorArray,r=this.vertexArray,o=this.particleSize_.y/2;if(this.colorMaterial){for(var s=0;s<i;++s){var a=e[s].color,u=8*s;n[u]=a.x,n[u+1]=a.y,n[u+2]=a.z,n[u+3]=a.w,n[u+4]=a.x,n[u+5]=a.y,n[u+6]=a.z,n[u+7]=a.w}t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW)}for(var s=0;s<i;++s){var l=e[s],h=l.position,u=8*s;V.assign(l.velocity).normalize(),r[u]=h.x-V.x*o,r[u+1]=h.y-V.y*o,r[u+2]=h.z-V.z*o,r[u+4]=h.x+V.x*o,r[u+5]=h.y+V.y*o,r[u+6]=h.z+V.z*o}t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW)},updateQuad:function(t){try{var e=this.getBrowser().getContext(),i=this.particles,n=this.maxParticles,r=this.numParticles,o=this.colorArray,s=this.texCoordArray,a=this.normalArray,u=this.vertexArray,l=this.particleSize_.x/2,h=this.particleSize_.y/2;if(!t){if(this.colorMaterial){for(var c=0;c<n;++c){var d=i[c].color,p=24*c;o[p]=o[p+4]=o[p+8]=o[p+12]=o[p+16]=o[p+20]=d.x,o[p+1]=o[p+5]=o[p+9]=o[p+13]=o[p+17]=o[p+21]=d.y,o[p+2]=o[p+6]=o[p+10]=o[p+14]=o[p+18]=o[p+22]=d.z,o[p+3]=o[p+7]=o[p+11]=o[p+15]=o[p+19]=o[p+23]=d.w}e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW)}if(this.texCoordAnim&&this.texCoordArray.length){for(var g=this.texCoordKeys,m=this.texCoordRamp,x=g.length,y=0,c=0;c<n;++c){var _=i[c],v=_.elapsedTime/_.lifetime;if(1==x||v<=g[0])y=0;else if(v>=g[x-1])y=x-2;else{var w=f.upperBound(g,0,x,v,f.less);y=w<x?w-1:0}y*=this.texCoordCount;var b=m[y],S=m[y+1],F=m[y+2],T=m[y+3],p=24*c;s[p]=s[p+12]=b.x,s[p+1]=s[p+13]=b.y,s[p+2]=s[p+14]=b.z,s[p+3]=s[p+15]=b.w,s[p+4]=S.x,s[p+5]=S.y,s[p+6]=S.z,s[p+7]=S.w,s[p+8]=s[p+16]=F.x,s[p+9]=s[p+17]=F.y,s[p+10]=s[p+18]=F.z,s[p+11]=s[p+19]=F.w,s[p+20]=T.x,s[p+21]=T.y,s[p+22]=T.z,s[p+23]=T.w}e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[0]),e.bufferData(e.ARRAY_BUFFER,this.texCoordArray,e.STATIC_DRAW)}}if(this.geometryType===C){if(t){var N=this.getScreenAlignedRotation(t);V.set(N[0],N[1],N[2]).cross(M.set(N[4],N[5],N[6])).normalize();for(var O=V.x,A=V.y,P=V.z,c=0,x=18*n;c<x;c+=3)a[c]=O,a[c+1]=A,a[c+2]=P;e.bindBuffer(e.ARRAY_BUFFER,this.normalBuffer),e.bufferData(e.ARRAY_BUFFER,this.normalArray,e.STATIC_DRAW),D.set(-l,-h,0),B.set(l,-h,0),I.set(l,h,0),E.set(-l,h,0),N.multVecMatrix(D),N.multVecMatrix(B),N.multVecMatrix(I),N.multVecMatrix(E);for(var c=0;c<r;++c){var L=i[c].position,R=L.x,k=L.y,z=L.z,p=24*c;u[p]=u[p+12]=R+D.x,u[p+1]=u[p+13]=k+D.y,u[p+2]=u[p+14]=z+D.z,u[p+4]=R+B.x,u[p+5]=k+B.y,u[p+6]=z+B.z,u[p+8]=u[p+16]=R+I.x,u[p+9]=u[p+17]=k+I.y,u[p+10]=u[p+18]=z+I.z,u[p+20]=R+E.x,u[p+21]=k+E.y,u[p+22]=z+E.z}e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW)}}else if(!t){for(var c=0;c<r;++c){var L=i[c].position,R=L.x,k=L.y,z=L.z,p=24*c;u[p]=u[p+12]=R-l,u[p+1]=u[p+13]=k-h,u[p+2]=u[p+14]=z,u[p+4]=R+l,u[p+5]=k-h,u[p+6]=z,u[p+8]=u[p+16]=R+l,u[p+9]=u[p+17]=k+h,u[p+10]=u[p+18]=z,u[p+20]=R-l,u[p+21]=k+h,u[p+22]=z}e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW)}}catch(t){console.log(t)}},traverse:function(t,e){if(this.isActive_.getValue()){switch(t){case o.POINTER:case o.COLLISION:break;case o.DEPTH:e.addDepthShape(this);break;case o.DISPLAY:e.addDisplayShape(this)&&this.getAppearance().traverse(t,e)}if(this.geometryType===S){if(!this.getGeometry())return;this.getGeometry().traverse(t,e)}}},depth:function(t,e){if(this.updateGeometry(t.modelViewMatrix),this.geometryType===S){var i=this.getGeometry();i&&i.displayParticlesDepth(t,e,this.particles,this.numParticles)}else{if(this.numParticles<=0)return;var n=t.renderer.getBrowser().getContext();e.enableVertexAttribute(n,this.vertexBuffer),n.drawArrays(this.shaderNode.primitiveMode,0,this.numParticles*this.vertexCount)}},display:function(t){try{if(this.getAppearance().display(t),this.updateGeometry(t.modelViewMatrix),this.geometryType===S){var e=this.getGeometry();e&&e.displayParticles(t,this.particles,this.numParticles)}else{var i=t.renderer.getBrowser(),n=i.getContext(),r=t.shaderNode;if(r===i.getDefaultShader()&&(r=this.shaderNode),this.numParticles<=0)return;t.geometryType=this.shaderGeometryType,t.colorMaterial=this.colorMaterial,r.setLocalUniforms(n,t),this.colorMaterial&&r.enableColorAttribute(n,this.colorBuffer),this.texCoordArray.length&&r.enableTexCoordAttribute(n,this.texCoordBuffers),this.normalArray.length&&r.enableNormalAttribute(n,this.normalBuffer),r.enableVertexAttribute(n,this.vertexBuffer);var o=!1;switch(this.geometryType){case _:case v:break;case w:case b:case C:o=!0}if(r.wireframe&&o)for(var s=0,a=this.numParticles*this.vertexCount;s<a;s+=3)n.drawArrays(r.primitiveMode,s,3);else{var u=c.prototype.determinant3.call(t.modelViewMatrix)>0;n.frontFace(u?n.CCW:n.CW),n.enable(n.CULL_FACE),n.cullFace(n.BACK),n.drawArrays(this.shaderNode.primitiveMode,0,this.numParticles*this.vertexCount)}r.disableColorAttribute(n),r.disableTexCoordAttribute(n),r.disableNormalAttribute(n)}}catch(t){console.log(t)}},getScreenAlignedRotation:function(t){T.assign(t).inverse(),T.multDirMatrix(N.assign(l.zAxis)),T.multDirMatrix(O.assign(l.yAxis)),A.assign(O).cross(N),P.assign(N).cross(A);var e=N;return A.normalize(),P.normalize(),e.normalize(),this.rotation.set(A.x,A.y,A.z,P.x,P.y,P.z,e.x,e.y,e.z)}}),x}),define("x_ite/Components/Texturing/PixelTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PixelTexture),this.addChildObjects("loadState",new e.SFInt32(o.NOT_STARTED_STATE))}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"image",new e.SFImage(0,0,0,[])),new i(o.initializeOnly,"repeatS",new e.SFBool(!0)),new i(o.initializeOnly,"repeatT",new e.SFBool(!0)),new i(o.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.image_.addInterest("set_image__",this),this.set_image__()},checkLoadState:function(){return this.loadState_.getValue()},convert:function(t,e,i){switch(e){case 1:for(var n=0,r=0,o=i.length;n<o;++n,r+=4){var s=i[n].getValue();t[r]=t[r+1]=t[r+2]=255&s,t[r+3]=255}break;case 2:for(var n=0,r=0,o=i.length;n<o;++n,r+=4){var s=i[n].getValue();t[r]=t[r+1]=t[r+2]=s>>>8&255,t[r+3]=255&s}break;case 3:for(var n=0,r=0,o=i.length;n<o;++n,r+=4){var s=i[n].getValue();t[r]=s>>>16&255,t[r+1]=s>>>8&255,t[r+2]=255&s,t[r+3]=255}break;case 4:for(var n=0,r=0,o=i.length;n<o;++n,r+=4){var s=i[n].getValue();t[r]=s>>>24,t[r+1]=s>>>16&255,t[r+2]=s>>>8&255,t[r+3]=255&s}}},set_image__:function(){var e=this.image_.width,i=this.image_.height,n=this.image_.comp,r=this.image_.array.getValue(),a=!(n%2),u=null;if(e>0&&i>0&&n>0&&n<5){if(s.isPowerOfTwo(e)&&s.isPowerOfTwo(i))u=new Uint8Array(e*i*4),this.convert(u,n,r);else if(Math.max(e,i)<this.getBrowser().getMinTextureSize()&&!this.textureProperties_.getValue()){u=new Uint8Array(e*i*4),this.convert(u,n,r);var l=e,h=i;e=4*s.nextPowerOfTwo(l),i=4*s.nextPowerOfTwo(h),u=this.resize(u,l,h,e,i)}else{var c=t("<canvas></canvas>")[0],d=t("<canvas></canvas>")[0],p=c.getContext("2d"),f=d.getContext("2d"),g=p.createImageData(e,i);c.width=e,c.height=i,this.convert(g.data,n,r),p.putImageData(g,0,0),e=s.nextPowerOfTwo(e),i=s.nextPowerOfTwo(i),d.width=e,d.height=i,f.drawImage(c,0,0,c.width,c.height,0,0,e,i),u=f.getImageData(0,0,e,i).data}this.setTexture(e,i,a,new Uint8Array(u),!1),this.loadState_=o.COMPLETE_STATE}else this.clear(),this.loadState_=o.FAILED_STATE}}),a}),define("x_ite/Components/PointingDeviceSensor/PlaneSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p){"use strict";function f(t){r.call(this,t),this.addType(o.PlaneSensor),this.offset_.setUnit("length"),this.minPosition_.setUnit("length"),this.maxPosition_.setUnit("length"),this.translation_changed_.setUnit("length")}var g=new h(a.Zero,a.Zero),m=new a(0,0,0),x=new h(a.Zero,a.Zero);return f.prototype=t.extend(Object.create(r.prototype),{constructor:f,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"axisRotation",new e.SFRotation),new i(o.inputOutput,"autoOffset",new e.SFBool(!0)),new i(o.inputOutput,"offset",new e.SFVec3f),new i(o.inputOutput,"minPosition",new e.SFVec2f),new i(o.inputOutput,"maxPosition",new e.SFVec2f(-1,-1)),new i(o.outputOnly,"trackPoint_changed",new e.SFVec3f),new i(o.outputOnly,"translation_changed",new e.SFVec3f),new i(o.outputOnly,"isOver",new e.SFBool),new i(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new l,this.invModelViewMatrix=new l,this.projectionMatrix=new l,this.viewport=new u,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new a(0,0,0),this.startPoint=new a(0,0,0)},getLineTrackPoint:function(t,e,i){return d.projectLine(e,this.modelViewMatrix,this.projectionMatrix,this.viewport,g),g.getClosestPointToPoint(new a(t.pointer.x,t.pointer.y,0),m),d.unProjectRay(m.x,m.y,this.modelViewMatrix,this.projectionMatrix,this.viewport,x),e.getClosestPointToLine(x,i)},set_active__:function(t,e,i,n,o){r.prototype.set_active__.call(this,t,e,i,n,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.projectionMatrix.assign(n),this.viewport.assign(o),this.invModelViewMatrix.assign(i).inverse();var s=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),u=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),l=this.axisRotation_.getValue();if(this.minPosition_.x===this.maxPosition_.x){this.planeSensor=!1;var d=l.multVecRot(new a(0,Math.abs(this.maxPosition_.y-this.minPosition_.y),0));this.line=new h(u,d.normalize())}else if(this.minPosition_.y===this.maxPosition_.y){this.planeSensor=!1;var d=l.multVecRot(new a(Math.abs(this.maxPosition_.x-this.minPosition_.x),0,0));this.line=new h(u,d.normalize())}else this.planeSensor=!0,this.plane=new c(u,l.multVecRot(new a(0,0,1)));if(this.planeSensor)this.plane.intersectsLine(s,this.startPoint)&&this.trackStart(this.startPoint);else if(this.getLineTrackPoint(e,this.line,this.startPoint)){var p=new a(0,0,0);try{this.getLineTrackPoint(e,new h(this.line.direction,this.line.direction),p)}catch(t){p=this.startPoint}this.trackStart(p)}}else this.autoOffset_.getValue()&&(this.offset_=this.translation_changed_)}catch(t){console.log(t)}},trackStart:function(t){this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=t,this.translation_changed_=this.offset_.getValue()},set_motion__:function(t){try{if(this.planeSensor){var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new a(0,0,0);if(!this.plane.intersectsLine(e,i))throw new Error("Plane and line are parallel.");this.track(i,i.copy())}else{var i=new a(0,0,0),n=new a(0,0,0);if(!this.getLineTrackPoint(t,this.line,i))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(t,new h(a.Zero,this.line.direction),n)}catch(t){n.assign(i)}this.track(i,n)}}catch(t){this.trackPoint_changed_.addEvent(),this.translation_changed_.addEvent()}},track:function(t,e){var i=this.axisRotation_.getValue(),n=s.inverse(i).multVecRot(t.add(this.startOffset).subtract(this.startPoint));this.minPosition_.x>this.maxPosition_.x||(n.x=p.clamp(n.x,this.minPosition_.x,this.maxPosition_.x)),this.minPosition_.y>this.maxPosition_.y||(n.y=p.clamp(n.y,this.minPosition_.y,this.maxPosition_.y)),i.multVecRot(n),this.trackPoint_changed_.getValue().equals(e)||(this.trackPoint_changed_=e),this.translation_changed_.getValue().equals(n)||(this.translation_changed_=n)}}),f}),define("x_ite/Components/Lighting/PointLight",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x){"use strict";function y(){var t=l.perspective(m.radians(120),.125,1e3,1,1,new f);this.location=new c(0,0,0),this.direction=new c(0,0,0),this.shadowBuffer=null,this.viewVolume=new h,this.viewport=new d(0,0,0,0),this.projectionMatrix=t,this.modelViewMatrix=new g(f),this.transformationMatrix=new f,this.invLightSpaceMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new f,this.rotation=new p,this.rotationMatrix=new f,this.textureUnit=0}function _(t){r.call(this,t),this.addType(a.PointLight),this.location_.setUnit("length"),this.radius_.setUnit("length")}var v=new f(1/6,0,0,0,0,.25,0,0,0,0,.5,0,1/6,.25,.5,1),w=[new c(1,0,0),new c(-1,0,0),new c(0,0,1),new c(0,0,-1),new c(0,1,0),new c(0,-1,0)],b=x(y);return y.prototype={constructor:y,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.transformationMatrix.assign(this.modelViewMatrix.get()).multRight(i),r=this.invLightSpaceMatrix.assign(e.getGlobal()?n:f.Identity);r.translate(e.getLocation()),r.inverse();var o=e.getShadowMapSize()/2,a=e.getShadowMapSize()/3,u=this.projectionMatrix,l=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.shadowBuffer.bind(),t.getProjectionMatrix().pushMatrix(this.projectionMatrix);for(var h=0;h<2;++h)for(var d=0;d<3;++d){var p=this.rotation.setFromToVec(this.direction.assign(w[3*h+d]),c.zAxis),g=this.viewport.set(d*a,h*o,a,o);t.getViewVolumes().push(this.viewVolume.set(u,g,g)),t.getModelViewMatrix().pushMatrix(this.rotationMatrix.setRotation(p)),t.getModelViewMatrix().multLeft(r),t.getModelViewMatrix().multLeft(l),t.render(s.DEPTH,this.groupNode),t.getModelViewMatrix().pop(),t.getViewVolumes().pop()}t.getProjectionMatrix().pop(),this.shadowBuffer.unbind(),e.getGlobal()||r.multLeft(n.inverse())}catch(t){console.log(t)}},setGlobalVariables:function(t){this.modelViewMatrix.get().multVecMatrix(this.location.assign(this.lightNode.location_.getValue())),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e,i){var n=this.lightNode,r=n.getColor(),o=n.getAttenuation(),s=this.location,a=n.getShadowColor();t.uniform1i(e.x3d_LightType[i],2),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[i],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),t.uniform3f(e.x3d_LightLocation[i],s.x,s.y,s.z),t.uniform1f(e.x3d_LightRadius[i],n.getRadius()),this.textureUnit?(t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowDiffusion[i],n.getShadowDiffusion()),t.uniform3f(e.x3d_ShadowColor[i],a.r,a.g,a.b),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):t.uniform1f(e.x3d_ShadowIntensity[i],0)},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,b.push(this)}},_.prototype=t.extend(Object.create(r.prototype),{constructor:_,
fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"global",new e.SFBool(!0)),new i(a.inputOutput,"on",new e.SFBool(!0)),new i(a.inputOutput,"color",new e.SFColor(1,1,1)),new i(a.inputOutput,"intensity",new e.SFFloat(1)),new i(a.inputOutput,"ambientIntensity",new e.SFFloat),new i(a.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new i(a.inputOutput,"location",new e.SFVec3f),new i(a.inputOutput,"radius",new e.SFFloat(100)),new i(a.inputOutput,"shadowColor",new e.SFColor),new i(a.inputOutput,"shadowIntensity",new e.SFFloat),new i(a.inputOutput,"shadowDiffusion",new e.SFFloat),new i(a.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getBiasMatrix:function(){return v},getLights:function(){return b}}),_}),define("x_ite/Components/Rendering/PointSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.PointSet),this.setGeometryType(0),this.colorNode=null,this.coordNode=null,this.transparent_=!0}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"attrib",new e.MFNode),new i(s.inputOutput,"fogCoord",new e.SFNode),new i(s.inputOutput,"color",new e.SFNode),new i(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this);var t=this.getBrowser();this.setPrimitiveMode(t.getContext().POINTS),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},getShader:function(t){return t.getPointShader()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,i=t.length;e<i;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,i=this.attrib_.length;e<i;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&t.push(n)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&this.colorNode.removeInterest("addNodeEvent",this),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode&&this.colorNode.addInterest("addNodeEvent",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){for(var t=this.getAttrib(),e=t.length,i=this.getAttribs(),n=this.colorNode,r=this.coordNode,o=0;o<e;++o)for(var s=0,a=r.point_.length;s<a;++s)t[o].addValue(i[o],s);if(this.colorNode)for(var s=0,a=r.point_.length;s<a;++s)this.addColor(n.get1Color(s));for(var s=0,a=r.point_.length;s<a;++s)this.addVertex(r.get1Point(s))}}}),a}),define("x_ite/Components/Geometry2D/Polyline2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Polyline2D),this.setGeometryType(1),this.lineSegments_.setUnit("length")}var u=new s(0,0,0);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"lineSegments",new e.MFVec2f)]),getTypeName:function(){return"Polyline2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_STRIP)},build:function(){for(var t=this.lineSegments_.getValue(),e=0,i=t.length;e<i;++e){var n=t[e];this.addVertex(u.set(n.x,n.y,0))}this.setSolid(!1)}}),a}),define("x_ite/Components/ParticleSystems/PolylineEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Components/Rendering/IndexedLineSet","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(s.PolylineEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new a(0,0,0),this.polylineNode=new o(t),this.polylines=[],this.lengthSoFarArray=[0]}function h(t){return t.set(0,0,0)}var c=new a(0,0,0);return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"direction",new e.SFVec3f(0,1,0)),new i(s.inputOutput,"speed",new e.SFFloat),new i(s.inputOutput,"variation",new e.SFFloat(.25)),new i(s.initializeOnly,"mass",new e.SFFloat),new i(s.initializeOnly,"surfaceArea",new e.SFFloat),new i(s.inputOutput,"coordIndex",new e.MFInt32(-1)),new i(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"PolylineEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.direction_.addInterest("set_direction__",this),this.coordIndex_.addFieldInterest(this.polylineNode.coordIndex_),this.coord_.addFieldInterest(this.polylineNode.coord_),this.polylineNode.coordIndex_=this.coordIndex_,this.polylineNode.coord_=this.coord_,this.polylineNode.addInterest("set_polyline",this),this.polylineNode.setPrivate(!0),this.polylineNode.setup(),this.set_direction__(),this.set_polyline()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(a.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_polyline:function(){var t=this.polylineNode.getPolylines(this.polylines);if(t.length){delete this.getRandomPosition;var e=0,i=this.lengthSoFarArray;i.length=1;for(var n=0,r=t.length;n<r;n+=2)e+=c.assign(t[n+1]).subtract(t[n]).abs(),i.push(e)}else this.getRandomPosition=h},getRandomPosition:function(t){var e=this.lengthSoFarArray,i=e.length,n=Math.random()*e[i-1],r=0,o=0,s=0;if(1==i||n<=e[0])r=0,s=0;else if(n>=e[i-1])r=i-2,s=1;else{var a=u.upperBound(e,0,i,n,u.less);if(a<i){o=a,r=a-1;var l=e[r],h=e[o];s=u.clamp((n-l)/(h-l),0,1)}else r=0,s=0}r*=2,o=r+1;var c=this.polylines[r],d=this.polylines[o];return t.x=c.x+s*(d.x-c.x),t.y=c.y+s*(d.y-c.y),t.z=c.z+s*(d.z-c.z),t},getRandomVelocity:function(t){var e=this.direction,i=this.getRandomSpeed();return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t}}),l}),define("x_ite/Components/Geometry2D/Polypoint2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.Polypoint2D),this.setGeometryType(0),this.point_.setUnit("length"),this.transparent_=!0}var u=new s(0,0,0);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec2f)]),getTypeName:function(){return"Polypoint2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this);var t=this.getBrowser();this.setPrimitiveMode(t.getContext().POINTS),this.setSolid(!1)},getShader:function(t){return t.getPointShader()},build:function(){for(var t=this.point_.getValue(),e=0,i=t.length;e<i;++e){var n=t[e];this.addVertex(u.set(n.x,n.y,0))}}}),a}),define("x_ite/Components/Followers/PositionChaser",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionChaser)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFVec3f),new i(o.inputOnly,"set_destination",new e.SFVec3f),new i(o.initializeOnly,"initialValue",new e.SFVec3f),new i(o.initializeOnly,"initialDestination",new e.SFVec3f),new i(o.initializeOnly,"duration",new e.SFTime(1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"PositionChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("x_ite/Components/Followers/PositionChaser2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionChaser2D)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFVec2f),new i(o.inputOnly,"set_destination",new e.SFVec2f),new i(o.initializeOnly,"initialValue",new e.SFVec2f),new i(o.initializeOnly,"initialDestination",new e.SFVec2f),new i(o.initializeOnly,"duration",new e.SFTime(1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),a}),define("x_ite/Components/Followers/PositionDamper",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionDamper)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFVec3f),new i(o.inputOnly,"set_destination",new e.SFVec3f),new i(o.initializeOnly,"initialValue",new e.SFVec3f),new i(o.initializeOnly,"initialDestination",new e.SFVec3f),new i(o.initializeOnly,"order",new e.SFInt32(3)),new i(o.inputOutput,"tolerance",new e.SFFloat(-1)),new i(o.inputOutput,"tau",new e.SFTime(.3)),new i(o.outputOnly,"value_changed",new e.SFVec3f),new i(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("x_ite/Components/Followers/PositionDamper2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionDamper2D)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFVec2f),new i(o.inputOnly,"set_destination",new e.SFVec2f),new i(o.initializeOnly,"initialValue",new e.SFVec2f),new i(o.initializeOnly,"initialDestination",new e.SFVec2f),new i(o.initializeOnly,"order",new e.SFInt32(3)),new i(o.inputOutput,"tau",new e.SFTime(.3)),new i(o.inputOutput,"tolerance",new e.SFFloat(-1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),a}),define("x_ite/Components/Interpolation/PositionInterpolator2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PositionInterpolator2D)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_fraction",new e.SFFloat),new i(o.inputOutput,"key",new e.MFFloat),new i(o.inputOutput,"keyValue",new e.MFVec2f),new i(o.outputOnly,"value_changed",new e.SFVec2f)]),keyValue:new s(0,0),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f)},interpolate:function(t,e,i){this.value_changed_=this.keyValue.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[e].getValue(),i)}}),a}),define("x_ite/Components/CADGeometry/QuadSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.QuadSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"QuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(t){return this.triangleIndex[t]},build:function(){if(this.getCoord()){var t=this.getCoord().getSize(),e=this.triangleIndex;t-=t%4,e.length=0;for(var i=0;i<t;i+=4){var n=i,o=i+1,s=i+2,a=i+3;e.push(n,o,s,n,s,a)}r.prototype.build.call(this,4,t,6,e.length)}},createNormals:function(t,e){return this.createFaceNormals(t,e)}}),s}),define("x_ite/Components/Geometry2D/Rectangle2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.Rectangle2D),this.setGeometryType(2),this.size_.setUnit("length")}var l=new s(2,2);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"size",new e.SFVec2f(2,2)),new i(o.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"Rectangle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){var t=this.getBrowser().getRectangle2DOptions(),e=t.getGeometry(),i=this.size_.getValue();if(this.setTexCoords(e.getTexCoords()),this.setNormals(e.getNormals()),i.equals(l))this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{for(var n=a.divide(i,2),r=n.x,o=n.y,s=e.getVertices(),u=this.getVertices(),h=0;h<s.length;h+=4)u.push(r*s[h],o*s[h+1],s[h+2],1);this.getMin().set(-r,-o,0),this.getMax().set(r,o,0)}this.setSolid(this.solid_.getValue())}}),u}),define("x_ite/Components/Followers/ScalarChaser",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.ScalarChaser)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFFloat),new i(o.inputOnly,"set_destination",new e.SFFloat),new i(o.initializeOnly,"initialValue",new e.SFFloat),new i(o.initializeOnly,"initialDestination",new e.SFFloat),new i(o.initializeOnly,"duration",new e.SFTime(1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(t){this.previousValue=t},duplicate:function(t){return t},assign:function(t,e,i){t[e]=i},equals:function(t,e,i){return Math.abs(t-e)<i},interpolate:function(t,e,i){return s.lerp(t,e,i)},step:function(t,e,i){this.output+=(t-e)*i}}),a}),define("x_ite/Components/Followers/ScalarDamper",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.ScalarDamper)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_value",new e.SFFloat),new i(o.inputOnly,"set_destination",new e.SFFloat),new i(o.initializeOnly,"initialValue",new e.SFFloat),new i(o.initializeOnly,"initialDestination",new e.SFFloat),new i(o.initializeOnly,"order",new e.SFInt32(3)),new i(o.inputOutput,"tau",new e.SFTime(.3)),new i(o.inputOutput,"tolerance",new e.SFFloat(-1)),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},duplicate:function(t){return t},assign:function(t,e,i){t[e]=i},equals:function(t,e,i){return Math.abs(t-e)<i},interpolate:function(t,e,i){return s.lerp(t,e,i)}}),a}),define("x_ite/Browser/Layout/ScreenText",["jquery","x_ite/Browser/Text/X3DTextGeometry","x_ite/Browser/Text/TextAlignment","x_ite/Components/Texturing/PixelTexture","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(i,r){e.call(this,i,r),i.transparent_=!0,this.texCoords=[],this.texture=new n(i.getExecutionContext()),this.canvas=t("<canvas></canvas>"),this.context=this.canvas[0].getContext("2d"),this.screenMatrix=new u,this.matrix=new u,this.texture.textureProperties_=r.getBrowser().getScreenTextureProperties(),this.texture.setup()}var p=[],f=new s(0,0,0),g=new s(1,1,0),m=new s(0,0,0),x=new a(0,0,1,0),y=new s(1,1,1),_=new s(0,0,0),v=new l;return d.prototype=t.extend(Object.create(e.prototype),{constructor:d,modelViewMatrix:new u,getMatrix:function(){return this.matrix},update:function(){e.prototype.update.call(this);var t=this.getFontStyle(),n=this.getText();switch(n.textBounds_.x=Math.ceil(n.textBounds_.x)+1,n.textBounds_.y=Math.ceil(n.textBounds_.y)+1,this.getBBox().getExtents(f,g),f.x-=1,f.y-=1,t.getMajorAlignment()){case i.BEGIN:case i.FIRST:f.x=Math.floor(f.x),g.x=f.x+n.textBounds_.x;break;case i.MIDDLE:f.x=Math.round(f.x),g.x=f.x+n.textBounds_.x;break;case i.END:g.x=Math.ceil(g.x),f.x=g.x-n.textBounds_.x}switch(t.getMinorAlignment()){case i.BEGIN:case i.FIRST:g.y=Math.ceil(g.y),f.y=g.y-n.textBounds_.y;break;case i.MIDDLE:g.y=Math.round(g.y),f.y=g.y-n.textBounds_.y;break;case i.END:f.y=Math.floor(f.y),g.y=f.y+n.textBounds_.y}n.origin_.x=f.x,n.origin_.y=g.y,this.getBBox().setExtents(f,g)},build:function(){var t=this.getFontStyle(),e=t.getFont();if(e){var i=this.getText(),n=this.getGlyphs(),r=this.getMinorAlignment(),o=this.getTranslations(),s=this.getCharSpacings(),a=t.getScale(),u=a/e.unitsPerEm,l=this.texCoords,h=i.getNormals(),d=i.getVertices(),p=this.canvas[0],m=this.context;l.length=0,i.getTexCoords().push(l),this.getBBox().getExtents(f,g),h.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1),d.push(f.x,f.y,0,1,g.x,f.y,0,1,g.x,g.y,0,1,f.x,f.y,0,1,g.x,g.y,0,1,f.x,g.y,0,1);var x=i.textBounds_.x,y=i.textBounds_.y;c.isPowerOfTwo(x)&&c.isPowerOfTwo(y)?(p.width=x,p.height=y):(p.width=c.nextPowerOfTwo(x),p.height=c.nextPowerOfTwo(y));var _=x/p.width,v=y/p.height,w=1-v;if(l.push(0,w,0,1,_,w,0,1,_,1,0,1,0,w,0,1,_,1,0,1,0,1,0,1),m.fillStyle="rgba(255,255,255,0)",m.fillRect(0,0,p.width,p.height),m.fillStyle="rgba(255,255,255,1)",t.horizontal_.getValue())for(var b=0,S=n.length;b<S;++b)for(var C=n[b],F=s[b],T=o[b],N=0,O=0,M=C.length;O<M;++O){var V=C[O],D=r.x+T.x+N+O*F-f.x,w=r.y+T.y-g.y;this.drawGlyph(m,e,V,D,w,a);var B=0;O+1<C.length&&(B=e.getKerningValue(V,C[O+1])),N+=(V.advanceWidth+B)*u}else for(var I=t.leftToRight_.getValue(),E=t.topToBottom_.getValue(),A=I?0:i.string_.length-1,P=I?i.string_.length:-1,L=I?1:-1,b=A,R=0;b!==P;b+=L)for(var C=n[b],k=C.length,z=E?0:k-1,X=E?k:-1,j=E?1:-1,O=z;O!==X;O+=j,++R){var T=o[R],D=r.x+T.x-f.x,w=r.y+T.y-g.y;this.drawGlyph(m,e,C[O],D,w,a)}var U=m.getImageData(0,0,p.width,p.height);U?this.texture.setTexture(p.width,p.height,!0,new Uint8Array(U.data),!0):this.texture.clear()}},drawGlyph:function(t,e,i,n,r,o){var s=i.components;if(p.length=0,i.isComposite)for(var a=0,u=s.length;a<u;++a){var l=s[a];p.push(i.getPath(l.dx/e.unitsPerEm*o+n,l.dy/e.unitsPerEm*o-r,o))}else p.push(i.getPath(n,-r,o));for(var h=0,c=p.length;h<c;++h){var d=p[h],f=d.commands;t.beginPath();for(var g=0,u=f.length;g<u;++g){var m=f[g];switch(m.type){case"M":t.moveTo(m.x,m.y);continue;case"Z":t.closePath();continue;case"L":t.lineTo(m.x,m.y);continue;case"C":t.bezierCurveTo(m.x1,m.y1,m.x2,m.y2,m.x,m.y);continue;case"Q":t.quadraticCurveTo(m.x1,m.y1,m.x,m.y);continue}}d.fill&&t.fill(),d.stroke&&(t.lineWidth=d.strokeWidth,t.stroke())}},getGlyphExtents:function(t,e,i,n){var r=this.getFontStyle(),o=r.getFont(),s=o.unitsPerEm;i.set((t.xMin||0)/s,(t.yMin||0)/s,0),n.set((t.xMax||0)/s,(t.yMax||0)/s,0)},transform:function(t){var e=this.getText(),i=t.getProjectionMatrix().get(),n=t.getModelViewMatrix().get(),r=t.getViewVolume().getViewport(),o=this.screenMatrix;o.assign(n),o.get(m,x,y);var a=t.getViewpoint().getScreenScale(m,r);o.set(m,x,y.set(a.x*(c.signum(y.x)<0?-1:1),a.y*(c.signum(y.y)<0?-1:1),a.z*(c.signum(y.z)<0?-1:1))),h.projectPoint(s.Zero,o,i,r,_),_.x=Math.round(_.x),_.y=Math.round(_.y),h.unProjectPoint(_.x,_.y,_.z,o,i,r,_),_.z=0,o.translate(_),this.matrix.assign(n).inverse().multLeft(o),v.assign(this.getBBox()).multRight(this.matrix),e.setBBox(v)},traverse:function(t,e){this.transform(e)},display:function(t){u.prototype.multLeft.call(t.modelViewMatrix,this.matrix),t.textureNode=this.texture,t.textureTransformNode=this.getBrowser().getDefaultTextureTransform()},transformLine:function(t){return t.multLineMatrix(u.inverse(this.matrix))},transformMatrix:function(t){return t.multLeft(this.matrix)}}),d}),define("x_ite/Components/Layout/ScreenFontStyle",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Layout/ScreenText","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.ScreenFontStyle)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"language",new e.SFString),new i(s.initializeOnly,"family",new e.MFString("SERIF")),new i(s.initializeOnly,"style",new e.SFString("PLAIN")),new i(s.initializeOnly,"pointSize",new e.SFFloat(12)),new i(s.initializeOnly,"spacing",new e.SFFloat(1)),new i(s.initializeOnly,"horizontal",new e.SFBool(!0)),new i(s.initializeOnly,"leftToRight",new e.SFBool(!0)),new i(s.initializeOnly,"topToBottom",new e.SFBool(!0)),new i(s.initializeOnly,"justify",new e.MFString("BEGIN"))]),getTypeName:function(){return"ScreenFontStyle"},getComponentName:function(){return"Layout"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(t){return new o(t,this)},getScale:function(){return this.pointSize_.getValue()*this.getBrowser().getPointSize()}}),a}),define("x_ite/Components/Layout/ScreenGroup",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/ViewVolume"],function(t,e,i,n,r,o,s,a,u,l,h){"use strict";function c(t){r.call(this,t),this.addType(o.ScreenGroup),this.screenMatrix=new l,this.modelViewMatrix=new l}var d=new a(0,0,0),p=new u(0,0,1,0),f=new a(1,1,1),g=new a(0,0,0);return c.prototype=t.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"ScreenGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},getBBox:function(t){return r.prototype.getBBox.call(this,t).multRight(this.getMatrix())},getMatrix:function(){try{this.matrix.assign(this.modelViewMatrix).inverse().multLeft(this.screenMatrix)}catch(t){}return this.matrix},scale:function(t){this.modelViewMatrix.assign(t.getModelViewMatrix().get()),this.modelViewMatrix.get(d,p,f);var e=t.getProjectionMatrix().get(),i=t.getViewVolume().getViewport(),n=t.getViewpoint().getScreenScale(d,i),r=this.screenMatrix;return r.set(d,p,f.set(n.x*(f.x<0?-1:1),n.y*(f.y<0?-1:1),n.z*(f.z<0?-1:1))),h.projectPoint(a.Zero,r,e,i,g),g.x=Math.round(g.x),g.y=Math.round(g.y),h.unProjectPoint(g.x,g.y,g.z,r,e,i,g),g.z=0,r.translate(g),r},traverse:function(t,e){try{var i=e.getModelViewMatrix();switch(t){case s.CAMERA:case s.DEPTH:i.pushMatrix(this.screenMatrix);break;default:i.pushMatrix(this.scale(e))}r.prototype.traverse.call(this,t,e),i.pop()}catch(t){}}}),c}),define("x_ite/Browser/Scripting/evaluate",[],function(){return function(){with(arguments[0])return eval(arguments[1])}}),define("x_ite/Components/Scripting/X3DScriptNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants"],function(t,e,i,n){"use strict";function r(t){e.call(this,t),i.call(this,t),this.addType(n.X3DScriptNode)}return r.prototype=t.extend(Object.create(e.prototype),i.prototype,{constructor:r}),r}),define("x_ite/Components/Scripting/Script",["jquery","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Browser/Scripting/evaluate","x_ite/Components/Scripting/X3DScriptNode","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_,v,w,b,S,C){function F(t){b.call(this,t),this.addChildObjects("buffer",new o.SFTime),this.addType(C.Script)}return F.prototype=t.extend(Object.create(b.prototype),{constructor:F,fieldDefinitions:new i([new e(C.inputOutput,"metadata",new o.SFNode),new e(C.inputOutput,"url",new o.MFString),new e(C.initializeOnly,"directOutput",new o.SFBool),new e(C.initializeOnly,"mustEvaluate",new o.SFBool)]),getTypeName:function(){return"Script"},getComponentName:function(){return"Scripting"},getContainerField:function(){return"children"},initialize:function(){b.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.setLoadState(C.NOT_STARTED_STATE),this.requestAsyncLoad()},getExtendedEventHandling:function(){return!1},hasUserDefinedFields:function(){return!0},getSourceText:function(){return this.url_},requestAsyncLoad:function(){this.checkLoadState()!==C.COMPLETE_STATE&&this.checkLoadState()!==C.IN_PROGRESS_STATE&&0!==this.url_.length&&(this.setLoadState(C.IN_PROGRESS_STATE),this.getScene().addInitLoadCount(this),new S(this).loadScript(this.url_,function(t){this.getScene().removeInitLoadCount(this),null===t?this.setLoadState(C.FAILED_STATE):(this.setLoadState(C.COMPLETE_STATE),this.initialize__(t))}.bind(this)))},getContext:function(t){try{var e=["initialize","prepareEvents","eventsProcessed","shutdown"],i=this.getUserDefinedFields();for(var n in i){var r=i[n];switch(r.getAccessType()){case C.inputOnly:e.push(r.getName());break;case C.inputOutput:e.push("set_"+r.getName())}}t+="\n;var "+e.join(",")+";",t+="\n["+e.join(",")+"];";for(var o=this.getGlobal(),s=w(o,t),a={},u=0;u<e.length;++u)"function"==typeof s[u]?a[e[u]]=s[u]:a[e[u]]=null;return a}catch(t){return this.setError("preprocessing",t),{}}},getGlobal:function(){function w(t){var e=b.createX3DFromString(String(t));if(e.getRootNodes().length&&e.getRootNodes()[0])return o.SFNode.call(this,e.getRootNodes()[0].getValue());throw new Error("SFNode.new: invalid argument, must be 'string' is 'undefined'.")}var b=this.getBrowser();w.prototype=Object.create(o.SFNode.prototype),w.prototype.constructor=w;var S={$:{value:t},NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:function(){this.print.apply(this,arguments)}.bind(b)},trace:{value:function(){this.print.apply(this,arguments)}.bind(b)},Browser:{value:b},X3DConstants:{value:C},X3DBrowser:{value:s},X3DExecutionContext:{value:p},X3DScene:{value:f},ComponentInfo:{value:a},ComponentInfoArray:{value:u},ProfileInfo:{value:l},ProfileInfoArray:{value:h},UnitInfo:{value:c},UnitInfoArray:{value:d},ExternProtoDeclarationArray:{value:g},ProtoDeclarationArray:{value:m},X3DExternProtoDeclaration:{value:x},X3DProtoDeclaration:{value:y},RouteArray:{value:_},X3DRoute:{value:v},X3DFieldDefinition:{value:e},FieldDefinitionArray:{value:i},X3DField:{value:n},X3DArrayField:{value:r},SFColor:{value:o.SFColor},SFColorRGBA:{value:o.SFColorRGBA},SFImage:{value:o.SFImage},SFMatrix3d:{value:o.SFMatrix3d},SFMatrix3f:{value:o.SFMatrix3f},SFMatrix4d:{value:o.SFMatrix4d},SFMatrix4f:{value:o.SFMatrix4f},
SFNode:{value:w},SFRotation:{value:o.SFRotation},SFVec3d:{value:o.SFVec2d},SFVec2f:{value:o.SFVec2f},SFVec2d:{value:o.SFVec3d},SFVec3f:{value:o.SFVec3f},SFVec4d:{value:o.SFVec4d},SFVec4f:{value:o.SFVec4f},VrmlMatrix:{value:o.VrmlMatrix},MFBool:{value:o.MFBool},MFColor:{value:o.MFColor},MFColorRGBA:{value:o.MFColorRGBA},MFDouble:{value:o.MFDouble},MFFloat:{value:o.MFFloat},MFImage:{value:o.MFImage},MFInt32:{value:o.MFInt32},MFMatrix3d:{value:o.MFMatrix3d},MFMatrix3f:{value:o.MFMatrix3f},MFMatrix4d:{value:o.MFMatrix4d},MFMatrix4f:{value:o.MFMatrix4f},MFNode:{value:o.MFNode},MFRotation:{value:o.MFRotation},MFString:{value:o.MFString},MFTime:{value:o.MFTime},MFVec2d:{value:o.MFVec2d},MFVec2f:{value:o.MFVec2f},MFVec3d:{value:o.MFVec3d},MFVec3f:{value:o.MFVec3f},MFVec4d:{value:o.MFVec4d},MFVec4f:{value:o.MFVec4f}},F=this.getUserDefinedFields();for(var T in F){var N=F[T];N.getAccessType()!==C.inputOnly&&(T in S||(S[T]={get:N.valueOf.bind(N),set:N.setValue.bind(N)}),N.getAccessType()===C.inputOutput&&(S[T+"_changed"]={get:N.valueOf.bind(N),set:N.setValue.bind(N)}))}return Object.create(Object.prototype,S)},set_live__:function(){var e=this.getUserDefinedFields();if(this.isLive().getValue()){t.isFunction(this.context.prepareEvents)&&this.getBrowser().prepareEvents().addInterest("prepareEvents__",this),t.isFunction(this.context.eventsProcessed)&&this.addInterest("eventsProcessed__",this);for(var i in e){var n=e[i];switch(n.getAccessType()){case C.inputOnly:var r=this.context[n.getName()];t.isFunction(r)&&n.addInterest("set_field__",this,r);break;case C.inputOutput:var r=this.context["set_"+n.getName()];t.isFunction(r)&&n.addInterest("set_field__",this,r)}}}else{this.context.prepareEvents&&this.getBrowser().prepareEvents().removeInterest("prepareEvents__",this),this.context.eventsProcessed&&this.removeInterest("eventsProcessed__",this);for(var i in e){var n=e[i];switch(n.getAccessType()){case C.inputOnly:case C.inputOutput:n.removeInterest("set_field__",this)}}}},initialize__:function(t){if(this.context=this.getContext(t),this.isLive().addInterest("set_live__",this),this.set_live__(),this.context.initialize){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.initialize()}catch(t){this.setError("initialize",t)}e.getScriptStack().pop()}},prepareEvents__:function(){var t=this.getBrowser();t.getScriptStack().push(this);try{this.context.prepareEvents(),t.addBrowserEvent()}catch(t){this.setError("prepareEvents",t)}t.getScriptStack().pop()},set_field__:function(t,e){var i=this.getBrowser();t.setTainted(!0),i.getScriptStack().push(this);try{e(t.valueOf(),i.getCurrentTime())}catch(e){this.setError(t.getName(),e)}i.getScriptStack().pop(),t.setTainted(!1)},eventsProcessed__:function(){var t=this.getBrowser();t.getScriptStack().push(this);try{this.context.eventsProcessed()}catch(t){this.setError("eventsProcessed",t)}t.getScriptStack().pop()},shutdown__:function(){var t=this.getBrowser();t.getScriptStack().push(this);try{this.context.shutdown()}catch(t){this.setError("shutdown",t)}t.getScriptStack().pop()},setError:function(t,e){console.error("JavaScript Error in Script '"+this.getName()+"', function '"+t+"'\nworld url is '"+this.getExecutionContext().getURL()+"':"),console.error(e)}}),F}),define("x_ite/Components/Shape/Shape",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Geometry/Line3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/QuickSort"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){r.call(this,t),this.addType(s.Shape)}var p=[];return d.prototype=t.extend(Object.create(r.prototype),{constructor:d,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOutput,"appearance",new e.SFNode),new i(s.inputOutput,"geometry",new e.SFNode)]),modelViewMatrix:new h,invModelViewMatrix:new h,hitRay:new u(new l(0,0,0),new l(0,0,0)),intersections:p,intersectionSorter:new c(p,function(t,e){return t.point.z>e.point.z}),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},set_geometry__:function(){r.prototype.set_geometry__.call(this),this.getGeometry()?delete this.traverse:this.traverse=Function.prototype},intersectsBox:function(t,e,i){return this.getGeometry().intersectsBox(t,e,i)},traverse:function(t,e){switch(t){case o.POINTER:this.pointer(e);break;case o.COLLISION:e.addCollisionShape(this);break;case o.DEPTH:e.addDepthShape(this);break;case o.DISPLAY:e.addDisplayShape(this)&&this.getAppearance().traverse(t,e)}this.getGeometry().traverse(t,e)},pointer:function(t){try{var e=this.getGeometry();if(e.getGeometryType()<2)return;var i=t.getBrowser(),n=this.modelViewMatrix.assign(t.getModelViewMatrix().get()),r=this.invModelViewMatrix.assign(n).inverse(),o=this.intersections;if(this.hitRay.assign(i.getHitRay()).multLineMatrix(r),e.intersectsLine(this.hitRay,t.getClipPlanes(),n,o)){for(var s=0;s<o.length;++s)n.multVecMatrix(o[s].point);this.intersectionSorter.sort(0,o.length);var u=a.lowerBound(o,0,o.length,-t.getNavigationInfo().getNearValue(),function(t,e){return t.point.z>e});u!==o.length&&(r.multMatrixDir(o[u].normal).normalize(),i.addHit(o[u],t.getLayer())),o.length=0}}catch(t){console.log(t)}},depth:function(t,e){this.getGeometry().depth(t,e)},display:function(t){this.getAppearance().display(t),this.getGeometry().display(t)}}),d}),define("x_ite/Components/Sound/X3DSoundNode",["jquery","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DSoundNode)}return n.prototype=t.extend(Object.create(e.prototype),{constructor:n}),n}),define("x_ite/Components/Sound/Sound",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,n,r,o,s,a,u,l,h,c){"use strict";function d(t){r.call(this,t),this.addType(a.Sound),this.location_.setUnit("length"),this.minBack_.setUnit("length"),this.minFront_.setUnit("length"),this.maxBack_.setUnit("length"),this.maxFront_.setUnit("length"),this.min={radius:0,distance:0},this.max={radius:0,distance:0}}return d.prototype=t.extend(Object.create(r.prototype),{constructor:d,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"intensity",new e.SFFloat(1)),new i(a.initializeOnly,"spatialize",new e.SFBool(!0)),new i(a.inputOutput,"location",new e.SFVec3f),new i(a.inputOutput,"direction",new e.SFVec3f(0,0,1)),new i(a.inputOutput,"minBack",new e.SFFloat(1)),new i(a.inputOutput,"minFront",new e.SFFloat(1)),new i(a.inputOutput,"maxBack",new e.SFFloat(10)),new i(a.inputOutput,"maxFront",new e.SFFloat(10)),new i(a.inputOutput,"priority",new e.SFFloat),new i(a.inputOutput,"source",new e.SFNode)]),transformationMatrix:new c,translation:new l(0,0,0),rotation:new h,scale:new l(1,1,1),viewer:new l(0,0,0),zAxis:new l(0,0,1),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.source_.addInterest("set_source__",this),this.set_source__()},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=o(a.X3DSoundSourceNode,this.source_)},traverse:function(t,e){if(t===s.DISPLAY&&this.sourceNode&&this.sourceNode.isActive_.getValue()&&!this.sourceNode.isPaused_.getValue())try{var i=e.getModelViewMatrix().get();if(this.getEllipsoidParameter(i,this.maxBack_.getValue(),this.maxFront_.getValue(),this.max),this.getEllipsoidParameter(i,this.minBack_.getValue(),this.minFront_.getValue(),this.min),this.max.distance<this.max.radius)if(this.min.distance<this.min.radius)this.sourceNode.setVolume(this.intensity_.getValue());else{var n=this.max.radius-this.max.distance,r=this.max.radius-this.min.radius;this.sourceNode.setVolume(this.intensity_.getValue()*(n/r))}else this.sourceNode.setVolume(0)}catch(t){console.log(t),this.sourceNode.setVolume(0)}},getEllipsoidParameter:function(t,e,i,n){var r=(e+i)/2,o=r-e,s=Math.sqrt(r*r-o*o);this.translation.z=o,this.rotation.setFromToVec(this.zAxis,this.direction_.getValue()),this.scale.z=r/s;var a=this.transformationMatrix;a.assign(t),a.translate(this.location_.getValue()),a.rotate(this.rotation),a.translate(this.translation),a.scale(this.scale),a.inverse(),this.viewer.set(a[12],a[13],a[14]),n.radius=s,n.distance=this.viewer.abs()}}),d}),define("x_ite/Components/Geometry3D/Sphere",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Sphere),this.radius_.setUnit("length")}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"radius",new e.SFFloat(1)),new i(o.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest("eventsProcessed",this):this.getBrowser().getSphereOptions().removeInterest("eventsProcessed",this)},build:function(){var t=this.getBrowser().getSphereOptions(),e=t.getGeometry(),i=this.radius_.getValue();if(this.setNormals(e.getNormals()),this.setTexCoords(e.getTexCoords()),1===i)this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{for(var n=e.getVertices(),r=this.getVertices(),o=0;o<n.length;o+=4)r.push(i*n[o],i*n[o+1],i*n[o+2],1);i=Math.abs(i),this.getMin().set(-i,-i,-i),this.getMax().set(i,i,i)}this.setSolid(this.solid_.getValue())}}),s}),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(t,e){this.radius=t,this.center=e.copy()}var i=new t(0,0,0),n=new t(0,0,0),r=new t(0,0,0),o=new t(0,0,0),s=new t(0,0,0),a=new t(0,0,0),u=new t(0,0,0),l=new t(0,0,0);return e.prototype={constructor:e,set:function(t,e){this.radius=t,this.center.assign(e)},intersectsLine:function(e,n,r){i.assign(this.center).subtract(e.point);var o=t.dot(i,e.direction);if(o<0)return!1;var s=t.dot(i,i)-Math.pow(o,2),a=Math.pow(this.radius,2);if(s>a)return!1;var u=Math.sqrt(a-s),l=o-u,h=o+u;return n.assign(e.direction).multiply(l).add(e.point),r.assign(e.direction).multiply(h).add(e.point),!0},intersectsTriangle:function(e,i,h){var c=this.center,d=this.radius;e.subtract(c),i.subtract(c),h.subtract(c),n.assign(i).subtract(e),r.assign(h).subtract(e);var p=d*d,f=n.cross(r),g=t.dot(e,f);if(g*g>p*t.dot(f,f))return!1;var m=t.dot(e,e),x=t.dot(e,i),y=t.dot(e,h),_=t.dot(i,i),v=t.dot(i,h),w=t.dot(h,h),b=m>p&&x>m&&y>m,S=_>p&&x>_&&v>_,C=w>p&&y>w&&v>w;if(b||S||C)return!1;n.assign(i).subtract(e),o.assign(h).subtract(i),s.assign(e).subtract(h);var F=x-m,T=v-_,N=y-w,O=t.dot(n,n),M=t.dot(o,o),V=t.dot(s,s);a.assign(e).multiply(O).subtract(n.multiply(F)),u.assign(i).multiply(M).subtract(o.multiply(T)),l.assign(h).multiply(V).subtract(s.multiply(N));var D=h.multiply(O).subtract(a),B=e.multiply(M).subtract(u),I=i.multiply(V).subtract(l),E=t.dot(a,a)>p*O*O&&t.dot(a,D)>0,A=t.dot(u,u)>p*M*M&&t.dot(u,B)>0,P=t.dot(l,l)>p*V*V&&t.dot(l,I)>0;return!(E||A||P)},toString:function(){return this.radius+" "+this.center.toString()}},e}),define("x_ite/Components/PointingDeviceSensor/SphereSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],function(t,e,i,n,r,o,s,a,u,l,h,c,d){"use strict";function p(t){r.call(this,t),this.addType(o.SphereSensor)}return p.prototype=t.extend(Object.create(r.prototype),{constructor:p,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"autoOffset",new e.SFBool(!0)),new i(o.inputOutput,"offset",new e.SFRotation),new i(o.outputOnly,"trackPoint_changed",new e.SFVec3f),new i(o.outputOnly,"rotation_changed",new e.SFRotation),new i(o.outputOnly,"isOver",new e.SFBool),new i(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startPoint=new s(0,0,0),this.startOffset=new a(0,0,1,0)},getTrackPoint:function(t,e,i){var n=new s(0,0,0);return!!this.sphere.intersectsLine(t,e,n)&&((s.subtract(t.point,n).abs()<s.subtract(t.point,e).abs())-i&&e.assign(n),!0)},set_active__:function(t,e,i,n,o){r.prototype.set_active__.call(this,t,e,i,n,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var a=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),u=new s(0,0,0);this.zPlane=new c(u,this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize()),this.sphere=new d(a.abs(),u),this.behind=this.zPlane.getDistanceToPoint(a)<0,this.fromVector.assign(a),this.startPoint.assign(a),this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=a,this.rotation_changed_=this.offset_.getValue()}else this.autoOffset_.getValue()&&(this.offset_=this.rotation_changed_)}catch(t){}},set_motion__:function(t){try{var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);if(this.getTrackPoint(e,i,this.behind)){var n=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize();this.zPlane=new c(i,n)}else{var r=new s(0,0,0);this.zPlane.intersectsLine(e,r),e=new h(r,s.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(e,i,!1);var o=l.normal(this.sphere.center,i,this.startPoint,new s(0,0,0)),u=s.subtract(i,this.sphere.center).normalize(),d=s.cross(o,u).normalize(),p=s.subtract(i,d.multiply(s.subtract(r,i).abs()));e=new h(p,s.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(e,i,!1)}this.trackPoint_changed_=i;var f=s.subtract(i,this.sphere.center),g=new a(this.fromVector,f);this.behind&&g.inverse(),this.rotation_changed_=a.multRight(this.startOffset,g)}catch(t){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),p}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function i(){this.T0=[],this.T1=[]}var n=[],r=[],o=[],s=new t(0,0,0,0),a=new e(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);return i.prototype={constructor:i,generate:function(t,e,i,s,a){var u=this.T0,l=this.T1;if(u.length=0,l.length=0,n.length=0,r.length=0,o.length=0,e.length>1){if(0===s.length){t?n.push(this.divide(this.subtract(i[1].getValue(),i[i.size()-2].getValue()),2)):n.push(this.create());for(var h=1,c=i.length-1;h<c;++h)n.push(this.divide(this.subtract(i[h+1].getValue(),i[h-1].getValue()),2));n.push(this.copy(n[0]))}else{for(var h=0,c=s.length;h<c;++h)n.push(this.copy(s[h].getValue()));if(a){for(var d=0,h=0,c=i.length-1;h<c;++h)d+=this.abs(this.subtract(i[h].getValue(),i[h+1].getValue()));for(var h=0,c=n.length-1;h<c;++h){var p=this.abs(n[h]);p&&(n[h]=this.multiply(n[h],d/p))}}}if(t){var f=e.length-1,g=e.length-2,m=e[1].getValue()-e[0].getValue()+e[f].getValue()-e[g].getValue();o.push(2*(e[1].getValue()-e[0].getValue())/m),r.push(2*(e[f].getValue()-e[g].getValue())/m)}else o.push(1),r.push(1);for(var h=1,c=e.length-1;h<c;++h){var m=e[h+1].getValue()-e[h-1].getValue();o.push(2*(e[h+1].getValue()-e[h].getValue())/m),r.push(2*(e[h].getValue()-e[h-1].getValue())/m)}o.push(o[0]),r.push(r[0]);for(var h=0,c=n.length;h<c;++h)u.push(this.multiply(n[h],r[h])),l.push(this.multiply(n[h],o[h]))}else u.push(this.create()),l.push(this.create())},interpolate:function(t,e,i,n){return s.set(Math.pow(i,3),Math.pow(i,2),i,1),this.dot(a.multVecMatrix(s),n[t].getValue(),n[e].getValue(),this.T0[t],this.T1[e])}},i}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["jquery","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(t,e){"use strict";return function(i){function n(){this.T0=[],this.T1=[]}var r=new i(0,0,0,0),o=new i(0,0,0,0),s=new i(0,0,0,0),a=new i(0,0,0,0);return n.prototype=t.extend(Object.create(e.prototype),{constructor:n,create:function(){return new i(0,0,0,0)},copy:function(t){return t.copy()},subtract:function(t,e){return i.subtract(t,e)},multiply:function(t,e){return i.multiply(t,e)},divide:function(t,e){return i.divide(t,e)},abs:function(t){return t.abs()},dot:function(t,e,i,n,u){return r.assign(e).multiply(t[0]),o.assign(i).multiply(t[1]),s.assign(n).multiply(t[2]),a.assign(u).multiply(t[3]),r.add(o).add(s).add(a)}}),n}}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],function(t,e){"use strict";return t(e)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.SplinePositionInterpolator),this.spline=new o}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_fraction",new e.SFFloat),new i(s.inputOutput,"closed",new e.SFBool),new i(s.inputOutput,"key",new e.MFFloat),new i(s.inputOutput,"keyValue",new e.MFVec3f),new i(s.inputOutput,"keyVelocity",new e.MFVec3f),new i(s.inputOutput,"normalizeVelocity",new e.SFBool),new i(s.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec3f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(t,e,i){this.value_changed_=this.spline.interpolate(t,e,i,this.keyValue_.getValue())}}),a}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],function(t,e){"use strict";return t(e)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.SplinePositionInterpolator2D),this.spline=new o}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_fraction",new e.SFFloat),new i(s.inputOutput,"closed",new e.SFBool),new i(s.inputOutput,"key",new e.MFFloat),new i(s.inputOutput,"keyValue",new e.MFVec2f),new i(s.inputOutput,"keyVelocity",new e.MFVec2f),new i(s.inputOutput,"normalizeVelocity",new e.SFBool),new i(s.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec2f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(t,e,i){this.value_changed_=this.spline.interpolate(t,e,i,this.keyValue_.getValue())}}),a}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1",["jquery","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(t,e){"use strict";function i(){this.T0=[],this.T1=[]}return i.prototype=t.extend(Object.create(e.prototype),{constructor:i,create:function(){return 0},copy:function(t){return t},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e},abs:function(t){return Math.abs(t)},dot:function(t,e,i,n,r){return e*t[0]+i*t[1]+n*t[2]+r*t[3]}}),i}),define("x_ite/Components/Interpolation/SplineScalarInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.SplineScalarInterpolator),this.spline=new o}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_fraction",new e.SFFloat),new i(s.inputOutput,"closed",new e.SFBool),new i(s.inputOutput,"key",new e.MFFloat),new i(s.inputOutput,"keyValue",new e.MFFloat),new i(s.inputOutput,"keyVelocity",new e.MFFloat),new i(s.inputOutput,"normalizeVelocity",new e.SFBool),new i(s.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFFloat),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(t,e,i){this.value_changed_=this.spline.interpolate(t,e,i,this.keyValue_.getValue())}}),a}),define("x_ite/Components/Lighting/SpotLight",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x){"use strict";function y(){this.location=new c(0,0,0),this.direction=new c(0,0,0),this.renderShadow=!0,this.shadowBuffer=null,this.bbox=new u,this.viewVolume=new h,this.viewport=new d(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.transformationMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new f,this.rotation=new p,this.lightBBoxMin=new c(0,0,0),this.lightBBoxMax=new c(0,0,0),this.textureUnit=0}function _(t){r.call(this,t),this.addType(a.SpotLight),this.location_.setUnit("length"),this.radius_.setUnit("length"),this.beamWidth_.setUnit("angle"),this.cutOffAngle_.setUnit("angle")}var v=x(y);return y.prototype={constructor:y,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.transformationMatrix.assign(this.modelViewMatrix.get()).multRight(i),r=this.invLightSpaceMatrix.assign(e.getGlobal()?n:f.Identity);r.translate(e.getLocation()),r.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),r.inverse();var a=o.prototype.getBBox.call(this.groupNode,this.bbox),u=a.multRight(r),h=e.getShadowMapSize(),d=(u.getExtents(this.lightBBoxMin,this.lightBBoxMax),Math.min(e.getRadius(),-this.lightBBoxMin.z)),p=this.viewport.set(0,0,h,h),g=l.perspective(2*e.getCutOffAngle(),.125,d,h,h,this.projectionMatrix),m=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.renderShadow=d>0,this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(g,p,p)),t.getProjectionMatrix().pushMatrix(g),t.getModelViewMatrix().pushMatrix(r),t.getModelViewMatrix().multLeft(m),t.render(s.DEPTH,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||r.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(r).multRight(g).multRight(e.getBiasMatrix())}catch(t){console.log(t)}},setGlobalVariables:function(t){var e=this.lightNode,i=this.modelViewMatrix.get();i.multVecMatrix(this.location.assign(e.location_.getValue())),i.multDirMatrix(this.direction.assign(e.direction_.getValue())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e,i){var n=this.lightNode,r=n.getColor(),o=n.getAttenuation(),s=(this.modelViewMatrix.get(),this.location),a=this.direction,u=n.getShadowColor();t.uniform1i(e.x3d_LightType[i],3),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[i],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),t.uniform3f(e.x3d_LightLocation[i],s.x,s.y,s.z),t.uniform3f(e.x3d_LightDirection[i],a.x,a.y,a.z),t.uniform1f(e.x3d_LightRadius[i],n.getRadius()),t.uniform1f(e.x3d_LightBeamWidth[i],n.getBeamWidth()),t.uniform1f(e.x3d_LightCutOffAngle[i],n.getCutOffAngle()),this.renderShadow&&this.textureUnit?(this.shadowMatrixArray.set(this.shadowMatrix),t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowDiffusion[i],n.getShadowDiffusion()),t.uniform3f(e.x3d_ShadowColor[i],u.r,u.g,u.b),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):t.uniform1f(e.x3d_ShadowIntensity[i],0)},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,v.push(this)}},_.prototype=t.extend(Object.create(r.prototype),{constructor:_,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"global",new e.SFBool(!0)),new i(a.inputOutput,"on",new e.SFBool(!0)),new i(a.inputOutput,"color",new e.SFColor(1,1,1)),new i(a.inputOutput,"intensity",new e.SFFloat(1)),new i(a.inputOutput,"ambientIntensity",new e.SFFloat),new i(a.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new i(a.inputOutput,"location",new e.SFVec3f),new i(a.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new i(a.inputOutput,"radius",new e.SFFloat(100)),new i(a.inputOutput,"beamWidth",new e.SFFloat(.785398)),new i(a.inputOutput,"cutOffAngle",new e.SFFloat(1.5708)),new i(a.inputOutput,"shadowColor",new e.SFColor),new i(a.inputOutput,"shadowIntensity",new e.SFFloat),new i(a.inputOutput,"shadowDiffusion",new e.SFFloat),new i(a.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getBeamWidth:function(){var t=this.beamWidth_.getValue(),e=this.getCutOffAngle();return t>e?e:m.clamp(t,0,Math.PI/2)},getCutOffAngle:function(){return m.clamp(this.cutOffAngle_.getValue(),0,Math.PI/2)},getLights:function(){return v}}),_}),define("x_ite/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],function(t){"use strict";function e(){this.s=[]}var i=new t(0,0,1,0);return e.prototype={constructor:e,generate:function(e,i,n){var r=this.s;if(r.length=0,i.length>1){e?r.push(t.spline(n[i.length-2].getValue(),n[0].getValue(),n[1].getValue())):r.push(n[0].getValue());for(var o=1,s=i.length-1;o<s;++o)r.push(t.spline(n[o-1].getValue(),n[o].getValue(),n[o+1].getValue()));e?r.push(t.spline(n[i.length-2].getValue(),n[i.length-1].getValue(),n[1].getValue())):r.push(n[i.length-1].getValue())}else i.length>0&&r.push(n[0].getValue().copy())},interpolate:function(t,e,n,r){return i.assign(r[t].getValue()).squad(this.s[t],this.s[e],r[e].getValue(),n)}},e}),
define("x_ite/Components/Interpolation/SquadOrientationInterpolator",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/SquatInterpolator","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.SquadOrientationInterpolator),this.squad=new o}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_fraction",new e.SFFloat),new i(s.inputOutput,"closed",new e.SFBool),new i(s.inputOutput,"key",new e.MFFloat),new i(s.inputOutput,"keyValue",new e.MFRotation),new i(s.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation),this.squad.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue())},interpolate:function(t,e,i){try{this.value_changed_=this.squad.interpolate(t,e,i,this.keyValue_.getValue())}catch(t){console.log(t)}}}),a}),define("x_ite/Components/Grouping/StaticGroup",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),o.call(this,t),this.addType(a.StaticGroup),this.group=new s(this.getExecutionContext()),this.bbox=new u}return l.prototype=t.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(a.initializeOnly,"bboxCenter",new e.SFVec3f),new i(a.initializeOnly,"children",new e.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.bboxSize_.addFieldInterest(this.group.bboxSize_),this.bboxCenter_.addFieldInterest(this.group.bboxCenter_),this.children_.addFieldInterest(this.group.children_),this.group.bboxSize_=this.bboxSize_,this.group.bboxCenter_=this.bboxCenter_,this.group.children_=this.children_,this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(t){return t.assign(this.bbox)},set_children__:function(){this.group.getBBox(this.bbox)},traverse:function(t,e){this.group.traverse(t,e)}}),l}),define("x_ite/Components/ParticleSystems/SurfaceEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(o.SurfaceEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.surfaceNode=null,this.areaSoFarArray=[0]}function c(t){return t.set(0,0,0)}var d=new u(0,0,0),p=new u(0,0,0),f=new u(0,0,0),g=new u(0,0,0);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"speed",new e.SFFloat),new i(o.inputOutput,"variation",new e.SFFloat(.25)),new i(o.initializeOnly,"mass",new e.SFFloat),new i(o.initializeOnly,"surfaceArea",new e.SFFloat),new i(o.initializeOnly,"surface",new e.SFNode)]),getTypeName:function(){return"SurfaceEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.surface_.addInterest("set_surface__",this),this.set_surface__()},set_surface__:function(){this.surfaceNode&&this.surfaceNode.removeInterest("set_geometry__",this),this.surfaceNode=s(o.X3DGeometryNode,this.surface_),this.surfaceNode&&this.surfaceNode.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:function(){if(this.surfaceNode){delete this.getRandomPosition,delete this.getRandomVelocity;var t=0,e=this.areaSoFarArray,i=this.surfaceNode.getVertices();e.length=1;for(var n=0,r=i.length;n<r;n+=12)d.set(i[n+0],i[n+1],i[n+2]),p.set(i[n+4],i[n+5],i[n+6]),f.set(i[n+8],i[n+9],i[n+10]),t+=a.area(d,p,f),e.push(t)}else this.getRandomPosition=c,this.getRandomVelocity=this.getSphericalRandomVelocity,g.set(0,0,0)},getRandomPosition:function(t){var e=this.areaSoFarArray,i=e.length,n=Math.random()*e[i-1],r=0;if(1==i||n<=e[0])r=0;else if(n>=e[i-1])r=i-2;else{var o=l.upperBound(e,0,i,n,l.less);r=o<i?o-1:0}var s=Math.random(),a=Math.random();s+a>1&&(s=1-s,a=1-a);var u=12*r,h=this.surfaceNode.getVertices(),c=1-s-a;t.x=s*h[u+0]+a*h[u+4]+c*h[u+8],t.y=s*h[u+1]+a*h[u+5]+c*h[u+9],t.z=s*h[u+2]+a*h[u+6]+c*h[u+10];var u=9*r,d=this.surfaceNode.getNormals();return g.x=s*d[u+0]+a*d[u+3]+c*d[u+6],g.y=s*d[u+1]+a*d[u+4]+c*d[u+7],g.z=s*d[u+2]+a*d[u+5]+c*d[u+8],t},getRandomVelocity:function(t){var e=this.getRandomSpeed();return t.x=g.x*e,t.y=g.y*e,t.z=g.z*e,t}}),h}),define("x_ite/Components/Grouping/Switch",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.Switch),this.addAlias("choice",this.children_)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"whichChoice",new e.SFInt32(-1)),new i(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(s.initializeOnly,"bboxCenter",new e.SFVec3f),new i(s.inputOnly,"addChildren",new e.MFNode),new i(s.inputOnly,"removeChildren",new e.MFNode),new i(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.whichChoice_.addInterest("set_whichChoice__",this),this.set_whichChoice__()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=o(s.X3DBoundedObject,this.child);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_whichChoice__:function(){this.set_cameraObjects__()},set_cameraObjects__:function(){this.child=this.getChild(this.whichChoice_.getValue()),this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},traverse:function(t,e){this.child&&this.child.traverse(t,e)}}),a}),define("x_ite/Components/Followers/TexCoordChaser2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),l.call(this,t),this.addType(s.TexCoordChaser2D)}var l=o(r);return u.prototype=t.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_value",new e.MFVec2f),new i(s.inputOnly,"set_destination",new e.MFVec2f),new i(s.initializeOnly,"initialValue",new e.MFVec2f),new i(s.initializeOnly,"initialDestination",new e.MFVec2f),new i(s.initializeOnly,"duration",new e.SFTime(1)),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0)},getArray:function(){return new e.MFVec2f}}),u}),define("x_ite/Components/Followers/TexCoordDamper2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),l.call(this,t),this.addType(s.TexCoordDamper2D)}var l=o(r);return u.prototype=t.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_value",new e.MFVec2f),new i(s.inputOnly,"set_destination",new e.MFVec2f),new i(s.initializeOnly,"initialValue",new e.MFVec2f),new i(s.initializeOnly,"initialDestination",new e.MFVec2f),new i(s.initializeOnly,"order",new e.SFInt32(3)),new i(s.inputOutput,"tau",new e.SFTime(.3)),new i(s.inputOutput,"tolerance",new e.SFFloat(-1)),new i(s.outputOnly,"isActive",new e.SFBool),new i(s.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new e.MFVec2f}}),u}),define("x_ite/Components/Text/Text",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.Text),this.length_.setUnit("length"),this.maxExtent_.setUnit("length"),this.origin_.setUnit("length"),this.textBounds_.setUnit("length"),this.lineBounds_.setUnit("length")}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"string",new e.MFString),new i(s.inputOutput,"length",new e.MFFloat),new i(s.inputOutput,"maxExtent",new e.SFFloat),new i(s.initializeOnly,"solid",new e.SFBool),new i(s.outputOnly,"origin",new e.SFVec3f),new i(s.outputOnly,"textBounds",new e.SFVec2f),new i(s.outputOnly,"lineBounds",new e.MFVec2f),new i(s.inputOutput,"fontStyle",new e.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.fontStyle_.addInterest("set_fontStyle__",this),this.set_fontStyle__(),this.eventsProcessed()},getMatrix:function(){return this.textGeometry.getMatrix()},getLength:function(t){return t<this.length_.length?Math.max(0,this.length_[t]):0},set_live__:function(){r.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getBrowserOptions().PrimitiveQuality_.addInterest("eventsProcessed",this):this.getBrowser().getBrowserOptions().PrimitiveQuality_.removeInterest("eventsProcessed",this)},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest("addNodeEvent",this),this.fontStyleNode=o(s.X3DFontStyleNode,this.fontStyle_),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest("addNodeEvent",this),this.textGeometry=this.fontStyleNode.getTextGeometry(this)},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this.solid_.getValue())},traverse:function(t,e){try{this.textGeometry.traverse(t,e),r.prototype.traverse.call(this,t,e)}catch(t){console.log(t)}},display:function(t){try{this.textGeometry.display(t),r.prototype.display.call(this,t)}catch(t){console.log(t)}},transformLine:function(t){return this.textGeometry.transformLine(t)},transformMatrix:function(t){return this.textGeometry.transformMatrix(t)}}),a}),define("x_ite/Components/EnvironmentalEffects/TextureBackground",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(s.TextureBackground)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOnly,"set_bind",new e.SFBool),new i(s.inputOutput,"skyAngle",new e.MFFloat),new i(s.inputOutput,"skyColor",new e.MFColor(0,0,0)),new i(s.inputOutput,"groundAngle",new e.MFFloat),new i(s.inputOutput,"groundColor",new e.MFColor),new i(s.inputOutput,"transparency",new e.SFFloat),new i(s.outputOnly,"isBound",new e.SFBool),new i(s.outputOnly,"bindTime",new e.SFTime),new i(s.inputOutput,"frontTexture",new e.SFNode),new i(s.inputOutput,"backTexture",new e.SFNode),new i(s.inputOutput,"leftTexture",new e.SFNode),new i(s.inputOutput,"rightTexture",new e.SFNode),new i(s.inputOutput,"topTexture",new e.SFNode),new i(s.inputOutput,"bottomTexture",new e.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.frontTexture_.addInterest("set_frontTexture__",this),this.backTexture_.addInterest("set_backTexture__",this),this.leftTexture_.addInterest("set_leftTexture__",this),this.rightTexture_.addInterest("set_rightTexture__",this),this.topTexture_.addInterest("set_topTexture__",this),this.bottomTexture_.addInterest("set_bottomTexture__",this),this.set_frontTexture__(this.frontTexture_),this.set_backTexture__(this.backTexture_),this.set_leftTexture__(this.leftTexture_),this.set_rightTexture__(this.rightTexture_),this.set_topTexture__(this.topTexture_),this.set_bottomTexture__(this.bottomTexture_)},set_frontTexture__:function(){r.prototype.set_frontTexture__.call(this,o(s.X3DTextureNode,this.frontTexture_))},set_backTexture__:function(){r.prototype.set_backTexture__.call(this,o(s.X3DTextureNode,this.backTexture_))},set_leftTexture__:function(){r.prototype.set_leftTexture__.call(this,o(s.X3DTextureNode,this.leftTexture_))},set_rightTexture__:function(){r.prototype.set_rightTexture__.call(this,o(s.X3DTextureNode,this.rightTexture_))},set_topTexture__:function(){r.prototype.set_topTexture__.call(this,o(s.X3DTextureNode,this.topTexture_))},set_bottomTexture__:function(){r.prototype.set_bottomTexture__.call(this,o(s.X3DTextureNode,this.bottomTexture_))}}),a}),define("x_ite/Components/Texturing3D/TextureCoordinate3D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TextureCoordinate3D)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec3f)]),getTypeName:function(){return"TextureCoordinate3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(t,e){if(e>=0&&e<this.point_.length){var i=this.point_[e];t.push(i.x,i.y,i.z,1)}else t.push(0,0,0,1)},getTexCoord:function(t){for(var e=this.point_.getValue(),i=0,n=e.length;i<n;++i){var r=e[i].getValue();t[i]=new Vector4(r.x,r.y,r.z,1)}return t.length=n,t}}),s}),define("x_ite/Components/Texturing3D/TextureCoordinate4D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TextureCoordinate4D)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"point",new e.MFVec4f)]),getTypeName:function(){return"TextureCoordinate4D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(t,e){if(e>=0&&e<this.point_.length){var i=this.point_[e];t.push(i.x,i.y,i.z,i.w)}else t.push(0,0,0,1)},getTexCoord:function(t){for(var e=this.point_.getValue(),i=0,n=e.length;i<n;++i){var r=e[i].getValue();t[i]=new Vector4(r.x,r.y,r.z,r.w)}return t.length=n,t}}),s}),define("x_ite/Components/Texturing3D/TextureTransform3D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.TextureTransform3D)}var l=new s(0,0,0);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"translation",new e.SFVec3f),new i(o.inputOutput,"rotation",new e.SFRotation),new i(o.inputOutput,"scale",new e.SFVec3f(1,1,1)),new i(o.inputOutput,"center",new e.SFVec3f)]),getTypeName:function(){return"TextureTransform3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},initialize:function(){r.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var t=this.translation_.getValue(),e=this.rotation_.getValue(),i=this.scale_.getValue(),n=this.center_.getValue(),o=this.getMatrix();o.identity(),n.equals(s.Zero)||o.translate(l.assign(n).negate()),i.equals(s.One)||o.scale(i),e.equals(a.Identity)||o.rotate(e),n.equals(s.Zero)||o.translate(n),t.equals(s.Zero)||o.translate(t),this.setMatrix(o)}}),u});define("x_ite/Components/Texturing3D/TextureTransformMatrix3D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TextureTransformMatrix3D)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"matrix",new e.SFMatrix4f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1))]),getTypeName:function(){return"TextureTransformMatrix3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var t=this.getMatrix();t.assign(this.matrix_.getValue()),this.setMatrix(t)}}),s}),define("x_ite/Components/EventUtilities/TimeTrigger",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TimeTrigger)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOnly,"set_boolean",new e.SFBool),new i(o.outputOnly,"triggerTime",new e.SFTime)]),getTypeName:function(){return"TimeTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.triggerTime_=this.getBrowser().getCurrentTime()}}),s}),define("x_ite/Components/Grouping/Transform",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.Transform)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"translation",new e.SFVec3f),new i(o.inputOutput,"rotation",new e.SFRotation),new i(o.inputOutput,"scale",new e.SFVec3f(1,1,1)),new i(o.inputOutput,"scaleOrientation",new e.SFRotation),new i(o.inputOutput,"center",new e.SFVec3f),new i(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new i(o.initializeOnly,"bboxCenter",new e.SFVec3f),new i(o.inputOnly,"addChildren",new e.MFNode),new i(o.inputOnly,"removeChildren",new e.MFNode),new i(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/EnvironmentalSensor/TransformSensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Box3"],function(t,e,i,n,r,o,s,a,u,l){"use strict";function h(t){r.call(this,t),this.addType(o.TransformSensor),this.position_changed_.setUnit("length"),this.bbox=new l,this.targetObjectNode=null}var c=new l,d=new a(0,0,0),p=new u(0,0,1,0),f=new a(-1,-1,-1);return h.prototype=t.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"size",new e.SFVec3f),new i(o.inputOutput,"center",new e.SFVec3f),new i(o.outputOnly,"enterTime",new e.SFTime),new i(o.outputOnly,"exitTime",new e.SFTime),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"position_changed",new e.SFVec3f),new i(o.outputOnly,"orientation_changed",new e.SFRotation),new i(o.inputOutput,"targetObject",new e.SFNode)]),getTypeName:function(){return"TransformSensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.isLive().addInterest("set_enabled__",this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_enabled__",this),this.size_.addInterest("set_bbox__",this),this.center_.addInterest("set_bbox__",this),this.targetObject_.addInterest("set_targetObject__",this),this.set_bbox__(),this.set_targetObject__()},set_live__:function(){},set_enabled__:function(){this.isLive().getValue()&&this.targetObjectNode&&this.enabled_.getValue()&&!this.size_.getValue().equals(a.Zero)?this.getBrowser().sensorEvents().addInterest("update",this):(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},set_bbox__:function(){this.bbox.set(this.size_.getValue(),this.center_.getValue())},set_targetObject__:function(){this.targetObjectNode=s(o.X3DBoundedObject,this.targetObject_),this.set_enabled__()},update:function(){this.targetObjectNode.getBBox(c),this.size_.getValue().equals(f)||this.bbox.intersectsBox(c)?(c.getMatrix().get(d,p),this.isActive_.getValue()?(this.position_changed_.getValue().equals(d)||(this.position_changed_=d),this.orientation_changed_.getValue().equals(p)||(this.orientation_changed_=p)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=d,this.orientation_changed_=p)):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}}),h}),define("x_ite/Components/Rendering/TriangleFanSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TriangleFanSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"fanCount",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.fanCount_.addInterest("set_fanCount__",this),this.set_fanCount__()},set_fanCount__:function(){var t=this.fanCount_.getValue(),e=this.triangleIndex;e.length=0;for(var i=0,n=t.length,r=0;i<n;++i){for(var o=t[i].getValue(),s=1,a=o-1;s<a;++s)e.push(r,r+s,r+s+1);r+=o}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/Rendering/TriangleSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TriangleSet)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&r.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(t,e){return this.createFaceNormals(t,e)}}),s}),define("x_ite/Components/Geometry2D/TriangleSet2D",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.TriangleSet2D),this.setGeometryType(2),this.vertices_.setUnit("length")}var u=new s(0,0,1),l=new s(0,0,0);return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"vertices",new e.MFVec2f),new i(o.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"TriangleSet2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){for(var t=this.vertices_.getValue(),e=0,i=t.length;e<i;++e){var n=t[e];this.addNormal(u),this.addVertex(l.set(n.x,n.y,0))}this.setSolid(this.solid_.getValue())},buildTexCoords:function(){var t=this.getTexCoordParams(),e=t.min,i=t.Ssize,n=[],r=this.vertices;this.texCoords.push(n);for(var o=0,s=this.vertices.length;o<s;o+=4)n.push((r[o]-e[0])/i,(r[o+1]-e[1])/i,0,1)}}),a}),define("x_ite/Components/Rendering/TriangleStripSet",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.TriangleStripSet),this.triangleIndex=[]}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"solid",new e.SFBool(!0)),new i(o.initializeOnly,"ccw",new e.SFBool(!0)),new i(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new i(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new i(o.inputOutput,"stripCount",new e.MFInt32),new i(o.inputOutput,"attrib",new e.MFNode),new i(o.inputOutput,"fogCoord",new e.SFNode),new i(o.inputOutput,"color",new e.SFNode),new i(o.inputOutput,"texCoord",new e.SFNode),new i(o.inputOutput,"normal",new e.SFNode),new i(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.stripCount_.addInterest("set_stripCount__",this),this.set_stripCount__()},set_stripCount__:function(){var t=this.stripCount_.getValue(),e=this.triangleIndex;e.length=0;for(var i=0,n=t.length,r=0;i<n;++i){for(var o=t[i].getValue(),s=0,a=o-2;s<a;++s){var u=1&s;e.push(r+(u?s+1:s),r+(u?s:s+1),r+(s+2))}r+=o}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/Shape/TwoSidedMaterial",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,i,n,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.TwoSidedMaterial),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return a.prototype=t.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"separateBackColor",new e.SFBool),new i(o.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new i(o.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new i(o.inputOutput,"specularColor",new e.SFColor),new i(o.inputOutput,"emissiveColor",new e.SFColor),new i(o.inputOutput,"shininess",new e.SFFloat(.2)),new i(o.inputOutput,"transparency",new e.SFFloat),new i(o.inputOutput,"backAmbientIntensity",new e.SFFloat(.2)),new i(o.inputOutput,"backDiffuseColor",new e.SFColor(.8,.8,.8)),new i(o.inputOutput,"backSpecularColor",new e.SFColor),new i(o.inputOutput,"backEmissiveColor",new e.SFColor),new i(o.inputOutput,"backShininess",new e.SFFloat(.2)),new i(o.inputOutput,"backTransparency",new e.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){r.prototype.initialize.call(this),this.addChildObjects("transparent",new e.SFBool),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.backAmbientIntensity_.addInterest("set_backAmbientIntensity__",this),this.backDiffuseColor_.addInterest("set_backDiffuseColor__",this),this.backSpecularColor_.addInterest("set_backSpecularColor__",this),
this.backEmissiveColor_.addInterest("set_backEmissiveColor__",this),this.backShininess_.addInterest("set_backShininess__",this),this.backTransparency_.addInterest("set_backTransparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var t=this.diffuseColor,e=this.diffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularColor__:function(){var t=this.specularColor,e=this.specularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveColor__:function(){var t=this.emissiveColor,e=this.emissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_shininess__:function(){this.shininess=s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){this.transparency=s.clamp(this.transparency_.getValue(),0,1),this.set_transparent__()},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this.backAmbientIntensity_.getValue(),0)},set_backDiffuseColor__:function(){var t=this.backDiffuseColor,e=this.backDiffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backSpecularColor__:function(){var t=this.backSpecularColor,e=this.backSpecularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backEmissiveColor__:function(){var t=this.backEmissiveColor,e=this.backEmissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backShininess__:function(){this.backShininess=s.clamp(this.backShininess_.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=s.clamp(this.backTransparency_.getValue(),0,1),this.set_transparent__()},set_transparent__:function(){var t=this.transparency_.getValue()||this.backTransparency_.getValue();t!=this.transparent_.getValue()&&(this.transparent_=t)},setShaderUniforms:function(t,e){t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Shininess,this.shininess),t.uniform1f(e.x3d_Transparency,this.transparency),this.separateBackColor_.getValue()?(t.uniform1i(e.x3d_SeparateBackColor,!0),t.uniform1f(e.x3d_BackAmbientIntensity,this.backAmbientIntensity),t.uniform3fv(e.x3d_BackDiffuseColor,this.backDiffuseColor),t.uniform3fv(e.x3d_BackSpecularColor,this.backSpecularColor),t.uniform3fv(e.x3d_BackEmissiveColor,this.backEmissiveColor),t.uniform1f(e.x3d_BackShininess,this.backShininess),t.uniform1f(e.x3d_BackTransparency,this.backTransparency)):t.uniform1i(e.x3d_SeparateBackColor,!1)}}),a}),define("x_ite/Components/Navigation/ViewpointGroup",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a,u){"use strict";function l(t){r.call(this,t),this.addType(a.ViewpointGroup),this.size_.setUnit("length"),this.center_.setUnit("length"),this.proximitySensor=new o(t),this.cameraObjects=[],this.viewpointGroups=[]}function h(t,e){switch(t){case s.CAMERA:if(this.proximitySensor.traverse(t,e),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(t,e);return;case s.DISPLAY:if(this.proximitySensor.traverse(t,e),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(t,e);return}}function c(t,e){switch(t){case s.CAMERA:for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(t,e);return;case s.DISPLAY:for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(t,e);return}}return l.prototype=t.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"displayed",new e.SFBool(!0)),new i(a.inputOutput,"description",new e.SFString),new i(a.inputOutput,"retainUserOffsets",new e.SFBool),new i(a.inputOutput,"size",new e.SFVec3f),new i(a.inputOutput,"center",new e.SFVec3f),new i(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.proximitySensor.setup(),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.displayed_.addInterest("set_displayed__",this),this.size_.addInterest("set_displayed__",this),this.children_.addInterest("set_children__",this),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor.isActive_.getValue()},set_displayed__:function(){var t=!this.size_.getValue().equals(u.Zero),e=this.displayed_.getValue();this.proximitySensor.enabled_=e&&t,e&&t?(this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.setCameraObject(this.proximitySensor.getCameraObject()),this.traverse=h):(this.proximitySensor.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.setCameraObject(e),e?this.traverse=c:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var t=this.children_,e=0,i=t.length;e<i;++e)try{for(var n=t[e].getValue().getInnerNode(),r=n.getType(),o=r.length-1;o>=0;--o)switch(r[o]){case a.X3DViewpointNode:this.cameraObjects.push(n);break;case a.ViewpointGroup:this.cameraObjects.push(n),this.viewpointGroups.push(n)}}catch(t){}},traverse:function(){}}),l}),define("x_ite/Components/EnvironmentalSensor/VisibilitySensor",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(s.VisibilitySensor),this.visible=!1}var l=new a(-1,-1,-1);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"enabled",new e.SFBool(!0)),new i(s.inputOutput,"size",new e.SFVec3f),new i(s.inputOutput,"center",new e.SFVec3f),new i(s.outputOnly,"enterTime",new e.SFTime),new i(s.outputOnly,"exitTime",new e.SFTime),new i(s.outputOnly,"isActive",new e.SFBool)]),size:new a(0,0,0),center:new a(0,0,0),getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},update:function(){this.visible&&this.getTraversed()?(this.isActive_.getValue()||(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime()),this.visible=!1):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(t,e){if(t===o.DISPLAY&&(this.setTraversed(!0),!this.visible))if(this.size_.getValue().equals(l))this.visible=!0;else{var i=e.getViewVolume(),n=e.getModelViewMatrix().get(),r=n.multDirMatrix(this.size.assign(this.size_.getValue())),s=n.multVecMatrix(this.center.assign(this.center_.getValue()));this.visible=i.intersectsSphere(r.abs()/2,s)}}}),u}),define("x_ite/Components/ParticleSystems/VolumeEmitter",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm","standard/Math/Utility/BVH","standard/Math/Algorithms/QuickSort"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f){"use strict";function g(t,e){return C.getDistanceToPoint(t)<C.getDistanceToPoint(e)}function m(t){r.call(this,t),this.addType(s.VolumeEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new a(0,0,0),this.volumeNode=new o(t),this.areaSoFarArray=[0],this.intersections=[],this.intersectionNormals=[],this.sorter=new f(this.intersections,g)}var x=new a(0,0,0),y=new a(0,0,0),_=new a(0,0,0),v=new a(0,0,0),w=new a(0,0,0),b=new u(0,0,1,0),S=new l(a.Zero,a.zAxis),C=new h(a.Zero,a.zAxis);return m.prototype=t.extend(Object.create(r.prototype),{constructor:m,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.initializeOnly,"internal",new e.SFBool(!0)),new i(s.inputOutput,"direction",new e.SFVec3f(0,1,0)),new i(s.inputOutput,"speed",new e.SFFloat),new i(s.inputOutput,"variation",new e.SFFloat(.25)),new i(s.initializeOnly,"mass",new e.SFFloat),new i(s.initializeOnly,"surfaceArea",new e.SFFloat),new i(s.inputOutput,"coordIndex",new e.MFInt32(-1)),new i(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"VolumeEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){r.prototype.initialize.call(this),this.direction_.addInterest("set_direction__",this),this.coordIndex_.addFieldInterest(this.volumeNode.coordIndex_),this.coord_.addFieldInterest(this.volumeNode.coord_),this.volumeNode.creaseAngle_=Math.PI,this.volumeNode.convex_=!1,this.volumeNode.coordIndex_=this.coordIndex_,this.volumeNode.coord_=this.coord_,this.volumeNode.addInterest("set_geometry__",this),this.volumeNode.setPrivate(!0),this.volumeNode.setup(),this.set_geometry__()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(a.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_geometry__:function(){var t=0,e=this.areaSoFarArray,i=this.volumeNode.getVertices(),n=this.volumeNode.getNormals();e.length=1;for(var r=0,o=i.length;r<o;r+=12)x.set(i[r+0],i[r+1],i[r+2]),y.set(i[r+4],i[r+5],i[r+6]),_.set(i[r+8],i[r+9],i[r+10]),t+=c.area(x,y,_),e.push(t);this.bvh=new p(i,n)},getRandomPosition:function(t){var e=this.areaSoFarArray,i=e.length,n=Math.random()*e[i-1],r=0;if(1==i||n<=e[0])r=0;else if(n>=e[i-1])r=i-2;else{var o=d.upperBound(e,0,i,n,d.less);r=o<i?o-1:0}var s=Math.random(),u=Math.random();s+u>1&&(s=1-s,u=1-u);var l=1-s-u,h=12*r,c=this.volumeNode.getVertices();v.x=s*c[h+0]+u*c[h+4]+l*c[h+8],v.y=s*c[h+1]+u*c[h+5]+l*c[h+9],v.z=s*c[h+2]+u*c[h+6]+l*c[h+10];var h=9*r,p=this.volumeNode.getNormals();w.x=s*p[h+0]+u*p[h+3]+l*p[h+6],w.y=s*p[h+1]+u*p[h+4]+l*p[h+7],w.z=s*p[h+2]+u*p[h+5]+l*p[h+8],b.setFromToVec(a.zAxis,w),b.multVecRot(this.getRandomSurfaceNormal(w)),S.set(v,w),C.set(v,w);var f=this.intersections,g=this.bvh.intersectsLine(S,f,this.intersectionNormals);if(g-=g%2){this.sorter.sort(0,g);var o=2*Math.round(this.getRandomValue(0,g/2-1)),m=f[o],x=f[o+1],l=Math.random();return t.x=m.x+(x.x-m.x)*l,t.y=m.y+(x.y-m.y)*l,t.z=m.z+(x.z-m.z)*l,t}return t.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)},getRandomVelocity:function(t){var e=this.direction,i=this.getRandomSpeed();return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t}}),m}),define("x_ite/Components/ParticleSystems/WindPhysicsModel",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,i,n,r,o,s,a){"use strict";function u(t){r.call(this,t),this.addType(o.WindPhysicsModel),this.speed_.setUnit("speed")}var l=new s(0,0,0);return u.prototype=t.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"direction",new e.SFVec3f),new i(o.inputOutput,"speed",new e.SFFloat(.1)),new i(o.inputOutput,"gustiness",new e.SFFloat(.1)),new i(o.inputOutput,"turbulence",new e.SFFloat)]),getTypeName:function(){return"WindPhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},getRandomSpeed:function(t){var e=Math.max(0,this.speed_.getValue()),i=e*Math.max(0,this.gustiness_.getValue());return t.getRandomValue(Math.max(0,e-i),e+i)},addForce:function(t,e,i,n){var r=e.surfaceArea_.getValue();if(this.enabled_.getValue()){var o=this.getRandomSpeed(e),u=.64615*Math.pow(10,2*Math.log(o));this.direction_.getValue().equals(s.Zero)?e.getRandomNormal(l):l.assign(this.direction_.getValue()).normalize(),i[t].assign(l.multiply(r*u)),n[t]=Math.PI*a.clamp(this.turbulence_.getValue(),0,1)}}}),u}),define("x_ite/Components/Core/WorldInfo",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o){"use strict";function s(t){r.call(this,t),this.addType(o.WorldInfo)}return s.prototype=t.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.initializeOnly,"title",new e.SFString),new i(o.initializeOnly,"info",new e.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"}}),s}),define("x_ite/Configuration/SupportedNodes",["x_ite/Components/Networking/Anchor","x_ite/Components/Shape/Appearance","x_ite/Components/Geometry2D/Arc2D","x_ite/Components/Geometry2D/ArcClose2D","x_ite/Components/Sound/AudioClip","x_ite/Components/EnvironmentalEffects/Background","x_ite/Components/Navigation/Billboard","x_ite/Components/EventUtilities/BooleanFilter","x_ite/Components/EventUtilities/BooleanSequencer","x_ite/Components/EventUtilities/BooleanToggle","x_ite/Components/EventUtilities/BooleanTrigger","x_ite/Components/ParticleSystems/BoundedPhysicsModel","x_ite/Components/Geometry3D/Box","x_ite/Components/CADGeometry/CADAssembly","x_ite/Components/CADGeometry/CADFace","x_ite/Components/CADGeometry/CADLayer","x_ite/Components/CADGeometry/CADPart","x_ite/Components/Geometry2D/Circle2D","x_ite/Components/Rendering/ClipPlane","x_ite/Components/Navigation/Collision","x_ite/Components/Rendering/Color","x_ite/Components/Followers/ColorChaser","x_ite/Components/Followers/ColorDamper","x_ite/Components/Interpolation/ColorInterpolator","x_ite/Components/Rendering/ColorRGBA","x_ite/Components/CubeMapTexturing/ComposedCubeMapTexture","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Geometry3D/Cone","x_ite/Components/ParticleSystems/ConeEmitter","x_ite/Components/Rendering/Coordinate","x_ite/Components/Followers/CoordinateChaser","x_ite/Components/Followers/CoordinateDamper","x_ite/Components/NURBS/CoordinateDouble","x_ite/Components/Interpolation/CoordinateInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator2D","x_ite/Components/Geometry3D/Cylinder","x_ite/Components/PointingDeviceSensor/CylinderSensor","x_ite/Components/Lighting/DirectionalLight","x_ite/Components/Geometry2D/Disk2D","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Geometry3D/ElevationGrid","x_ite/Components/ParticleSystems/ExplosionEmitter","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/Shaders/FloatVertexAttribute","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/Text/FontStyle","x_ite/Components/ParticleSystems/ForcePhysicsModel","x_ite/Components/CubeMapTexturing/GeneratedCubeMapTexture","x_ite/Components/Geospatial/GeoCoordinate","x_ite/Components/Geospatial/GeoElevationGrid","x_ite/Components/Geospatial/GeoLOD","x_ite/Components/Geospatial/GeoLocation","x_ite/Components/Geospatial/GeoMetadata","x_ite/Components/Geospatial/GeoOrigin","x_ite/Components/Geospatial/GeoPositionInterpolator","x_ite/Components/Geospatial/GeoProximitySensor","x_ite/Components/Geospatial/GeoTouchSensor","x_ite/Components/Geospatial/GeoTransform","x_ite/Components/Geospatial/GeoViewpoint","x_ite/Components/Grouping/Group","x_ite/Components/CubeMapTexturing/ImageCubeMapTexture","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/CADGeometry/IndexedQuadSet","x_ite/Components/Rendering/IndexedTriangleFanSet","x_ite/Components/Rendering/IndexedTriangleSet","x_ite/Components/Rendering/IndexedTriangleStripSet","x_ite/Components/Networking/Inline","x_ite/Components/EventUtilities/IntegerSequencer","x_ite/Components/EventUtilities/IntegerTrigger","x_ite/Components/KeyDeviceSensor/KeySensor","x_ite/Components/Navigation/LOD","x_ite/Components/Layering/Layer","x_ite/Components/Layering/LayerSet","x_ite/Components/Layout/Layout","x_ite/Components/Layout/LayoutGroup","x_ite/Components/Layout/LayoutLayer","x_ite/Components/Shape/LineProperties","x_ite/Components/Rendering/LineSet","x_ite/Components/Networking/LoadSensor","x_ite/Components/EnvironmentalEffects/LocalFog","x_ite/Components/Shape/Material","x_ite/Components/Shaders/Matrix3VertexAttribute","x_ite/Components/Shaders/Matrix4VertexAttribute","x_ite/Components/Core/MetadataBoolean","x_ite/Components/Core/MetadataDouble","x_ite/Components/Core/MetadataFloat","x_ite/Components/Core/MetadataInteger","x_ite/Components/Core/MetadataSet","x_ite/Components/Core/MetadataString","x_ite/Components/Texturing/MovieTexture","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/Rendering/Normal","x_ite/Components/Interpolation/NormalInterpolator","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Followers/OrientationDamper","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Components/ParticleSystems/ParticleSystem","x_ite/Components/Texturing/PixelTexture","x_ite/Components/PointingDeviceSensor/PlaneSensor","x_ite/Components/ParticleSystems/PointEmitter","x_ite/Components/Lighting/PointLight","x_ite/Components/Rendering/PointSet","x_ite/Components/Geometry2D/Polyline2D","x_ite/Components/ParticleSystems/PolylineEmitter","x_ite/Components/Geometry2D/Polypoint2D","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/PositionChaser2D","x_ite/Components/Followers/PositionDamper","x_ite/Components/Followers/PositionDamper2D","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/PositionInterpolator2D","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Components/CADGeometry/QuadSet","x_ite/Components/Geometry2D/Rectangle2D","x_ite/Components/Followers/ScalarChaser","x_ite/Components/Followers/ScalarDamper","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Layout/ScreenFontStyle","x_ite/Components/Layout/ScreenGroup","x_ite/Components/Scripting/Script","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Shape/Shape","x_ite/Components/Sound/Sound","x_ite/Components/Geometry3D/Sphere","x_ite/Components/PointingDeviceSensor/SphereSensor","x_ite/Components/Interpolation/SplinePositionInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator2D","x_ite/Components/Interpolation/SplineScalarInterpolator","x_ite/Components/Lighting/SpotLight","x_ite/Components/Interpolation/SquadOrientationInterpolator","x_ite/Components/Grouping/StaticGroup","x_ite/Components/ParticleSystems/SurfaceEmitter","x_ite/Components/Grouping/Switch","x_ite/Components/Followers/TexCoordChaser2D","x_ite/Components/Followers/TexCoordDamper2D","x_ite/Components/Text/Text","x_ite/Components/EnvironmentalEffects/TextureBackground","x_ite/Components/Texturing/TextureCoordinate","x_ite/Components/Texturing3D/TextureCoordinate3D","x_ite/Components/Texturing3D/TextureCoordinate4D","x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing3D/TextureTransform3D","x_ite/Components/Texturing3D/TextureTransformMatrix3D","x_ite/Components/Time/TimeSensor","x_ite/Components/EventUtilities/TimeTrigger","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Components/Grouping/Transform","x_ite/Components/EnvironmentalSensor/TransformSensor","x_ite/Components/Rendering/TriangleFanSet","x_ite/Components/Rendering/TriangleSet","x_ite/Components/Geometry2D/TriangleSet2D","x_ite/Components/Rendering/TriangleStripSet","x_ite/Components/Shape/TwoSidedMaterial","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Navigation/ViewpointGroup","x_ite/Components/Layering/Viewport","x_ite/Components/EnvironmentalSensor/VisibilitySensor","x_ite/Components/ParticleSystems/VolumeEmitter","x_ite/Components/ParticleSystems/WindPhysicsModel","x_ite/Components/Core/WorldInfo"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_,v,w,b,S,C,F,T,N,O,M,V,D,B,I,E,A,P,L,R,k,z,X,j,U,G,q,H,W,Y,$,K,Z,Q,J,tt,et,it,nt,rt,ot,st,at,ut,lt,ht,ct,dt,pt,ft,gt,mt,xt,yt,_t,vt,wt,bt,St,Ct,Ft,Tt,Nt,Ot,Mt,Vt,Dt,Bt,It,Et,At,Pt,Lt,Rt,kt,zt,Xt,jt,Ut,Gt,qt,Ht,Wt,Yt,$t,Kt,Zt,Qt,Jt,te,ee,ie,ne,re,oe,se,ae,ue,le,he,ce,de,pe,fe,ge,me,xe,ye,_e,ve,we,be,Se,Ce,Fe,Te,Ne,Oe,Me,Ve,De,Be,Ie,Ee,Ae,Pe,Le,Re,ke,ze,Xe,je,Ue,Ge,qe,He,We,Ye,$e,Ke,Ze,Qe,Je,ti,ei){"use strict";function ii(t){return new this(t)}var ni={MetadataBool:Dt,Anchor:t,Appearance:e,Arc2D:i,ArcClose2D:n,AudioClip:r,Background:o,Billboard:s,BooleanFilter:a,BooleanSequencer:u,BooleanToggle:l,BooleanTrigger:h,BoundedPhysicsModel:c,Box:d,CADAssembly:p,CADFace:f,CADLayer:g,CADPart:m,Circle2D:x,ClipPlane:y,Collision:_,Color:v,ColorChaser:w,ColorDamper:b,ColorInterpolator:S,ColorRGBA:C,ComposedCubeMapTexture:F,ComposedShader:T,Cone:N,ConeEmitter:O,Coordinate:M,CoordinateChaser:V,CoordinateDamper:D,CoordinateDouble:B,CoordinateInterpolator:I,CoordinateInterpolator2D:E,Cylinder:A,CylinderSensor:P,DirectionalLight:L,Disk2D:R,EaseInEaseOut:k,ElevationGrid:z,ExplosionEmitter:X,Extrusion:j,FloatVertexAttribute:U,Fog:G,FontStyle:q,ForcePhysicsModel:H,GeneratedCubeMapTexture:W,GeoCoordinate:Y,GeoElevationGrid:$,GeoLOD:K,GeoLocation:Z,GeoMetadata:Q,GeoOrigin:J,GeoPositionInterpolator:tt,GeoProximitySensor:et,GeoTouchSensor:it,GeoTransform:nt,GeoViewpoint:rt,Group:ot,ImageCubeMapTexture:st,ImageTexture:at,IndexedFaceSet:ut,IndexedLineSet:lt,IndexedQuadSet:ht,IndexedTriangleFanSet:ct,IndexedTriangleSet:dt,IndexedTriangleStripSet:pt,Inline:ft,IntegerSequencer:gt,IntegerTrigger:mt,KeySensor:xt,LOD:yt,Layer:_t,LayerSet:vt,Layout:wt,LayoutGroup:bt,LayoutLayer:St,LineProperties:Ct,LineSet:Ft,LoadSensor:Tt,LocalFog:Nt,Material:Ot,Matrix3VertexAttribute:Mt,Matrix4VertexAttribute:Vt,MetadataBoolean:Dt,MetadataDouble:Bt,MetadataFloat:It,MetadataInteger:Et,MetadataSet:At,MetadataString:Pt,MovieTexture:Lt,NavigationInfo:Rt,Normal:kt,NormalInterpolator:zt,OrientationChaser:Xt,OrientationDamper:jt,OrientationInterpolator:Ut,OrthoViewpoint:Gt,ParticleSystem:qt,PixelTexture:Ht,PlaneSensor:Wt,PointEmitter:Yt,PointLight:$t,PointSet:Kt,Polyline2D:Zt,PolylineEmitter:Qt,Polypoint2D:Jt,PositionChaser:te,PositionChaser2D:ee,PositionDamper:ie,PositionDamper2D:ne,PositionInterpolator:re,PositionInterpolator2D:oe,ProximitySensor:se,QuadSet:ae,Rectangle2D:ue,ScalarChaser:le,ScalarDamper:he,ScalarInterpolator:ce,ScreenFontStyle:de,ScreenGroup:pe,Script:fe,ShaderPart:ge,Shape:me,Sound:xe,Sphere:ye,SphereSensor:_e,SplinePositionInterpolator:ve,SplinePositionInterpolator2D:we,SplineScalarInterpolator:be,SpotLight:Se,SquadOrientationInterpolator:Ce,StaticGroup:Fe,SurfaceEmitter:Te,Switch:Ne,TexCoordChaser2D:Oe,TexCoordDamper2D:Me,Text:Ve,TextureBackground:De,TextureCoordinate:Be,TextureCoordinate3D:Ie,TextureCoordinate4D:Ee,TextureProperties:Ae,TextureTransform:Pe,TextureTransform3D:Le,TextureTransformMatrix3D:Re,TimeSensor:ke,TimeTrigger:ze,TouchSensor:Xe,Transform:je,TransformSensor:Ue,TriangleFanSet:Ge,TriangleSet:qe,TriangleSet2D:He,TriangleStripSet:We,TwoSidedMaterial:Ye,Viewpoint:$e,ViewpointGroup:Ke,Viewport:Ze,VisibilitySensor:Qe,VolumeEmitter:Je,WindPhysicsModel:ti,WorldInfo:ei};for(var ri in ni)ni[ri].createInstance=ii.bind(ni[ri]),ni[ri.toUpperCase()]=ni[ri],ni[ri.toUpperCase()].createInstance=ii.bind(ni[ri]);return ni}),define("x_ite/Browser/X3DBrowser",["jquery","x_ite/Browser/VERSION","x_ite/Base/Events","x_ite/Fields","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/ComponentInfo","x_ite/Configuration/SupportedProfiles","x_ite/Configuration/SupportedComponents","x_ite/Configuration/SupportedNodes","x_ite/Execution/Scene","x_ite/Execution/X3DScene","x_ite/InputOutput/FileLoader","x_ite/Parser/XMLParser","x_ite/Bits/X3DConstants","locale/gettext"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f){"use strict";function g(t){r.call(this,t),this.currentSpeed=0,this.currentFrameRate=0,this.description_="",this.supportedNodes=u,this.supportedComponents=a(this),this.supportedProfiles=s(this),this.components={},this.replaceWorld(this.createScene())}return g.prototype=t.extend(Object.create(r.prototype),{constructor:g,getTypeName:function(){return"X3DBrowser"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browser"},initialize:function(){r.prototype.initialize.call(this),this.getLoadSensor().isLoaded_.addInterest("set_loaded__",this)},set_loaded__:function(t){this.getLoadSensor().isLoaded_.removeInterest("set_loaded__",this),this.getLoadSensor().enabled_=!1;var e=this.getElement()[0].getAttribute("src");e=e?'"'+e+'"':this.getElement()[0].getAttribute("url"),e?(this.initialized().set(this.getCurrentTime()),this.load(e)):this.initialized().setValue(this.getCurrentTime()),this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n        Current Graphics Renderer\n                Name: "+this.getVendor()+" "+this.getWebGLVersion()+"\n                Shading language: "+this.getShadingLanguageVersion()+"\n        Rendering Properties\n                Antialiased: "+this.getAntialiased()+"\n                Depth size: "+this.getDepthSize()+" bits\n                Color depth: "+this.getColorDepth()+" bits\n                Max clip planes: 6\n                Max lights: 8\n                Texture units: "+this.getMaxTextureUnits()+" / "+this.getMaxCombinedTextureUnits()+"\n                Max texture size: "+this.getMaxTextureSize()+" Ã "+this.getMaxTextureSize()+" pixel\n                Texture memory: "+this.getTextureMemory()+"\n                Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n                Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n                Max vertex attribs: "+this.getMaxVertexAttribs()+"\n")},getName:function(){return this.name},getVersion:function(){return this.version},getCurrentSpeed:function(){return this.currentSpeed},getCurrentFrameRate:function(){return this.currentFrameRate},setDescription:function(t){this.description=t},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(t){var e=this.supportedProfiles.get(t);if(e)return e;throw Error("Profile '"+t+"' is not supported.")},getComponent:function(t,e){var i=this.supportedComponents.get(t);if(i)return new o(this,{title:i.title,name:t,level:e,providerUrl:this.getProviderUrl()});throw Error("Component '"+t+"' at level '"+e+"' is not supported.")},createScene:function(){var t=new l(this);return t.setup(),this.isExternal()?t:(t.setLive(!0),t)},replaceWorld:function(t){if(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.getWorld()&&(this.getExecutionContext().setLive(!1),this.shutdown().processInterests()),i.clear(),t instanceof n.MFNode){var e=t;t=this.createScene();for(var r=0,o=e.length;r<o;++r)t.isLive().addInterest(e[r].getValue().getExecutionContext().isLive());t.setRootNodes(e)}t instanceof h||(t=this.createScene()),this.description="",this.setBrowserLoading(!0),this.loadCount_.addInterest("set_loadCount__",this);for(var s in t.getLoadingObjects())this.addLoadCount(t.getLoadingObjects()[s]);t.setLive(this.isLive().getValue()),this.setExecutionContext(t),this.initialized().getValue()&&this.initialized().setValue(this.getCurrentTime())},set_loadCount__:function(t){t.getValue()||(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().addInterest("bind",this),this.addBrowserEvent())},bind:function(){this.prepareEvents().removeInterest("bind",this),this.getWorld().bind(),this.setBrowserLoading(!1)},createVrmlFromString:function(t){var e=new n.MFNode;return e.setValue(this.createX3DFromString(t).rootNodes),e},createX3DFromString:function(t){var e=this.currentScene,i=this.isExternal(),n=new c(this.getWorld()).createX3DFromString(this.currentScene.getURL(),t);return i||(n.setExecutionContext(e),e.isLive().addInterest("setLive",n),e.isLive().getValue()&&n.setLive(!0)),n.setup(),n},createVrmlFromURL:function(t,e,i){if(!(e instanceof n.SFNode))throw new Error("Browser.createVrmlFromURL: node must be of type SFNode.");if(!e.getValue())throw new Error("Browser.createVrmlFromURL: node IS NULL.");var r=e.getValue().getField(i);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be a input field.");if(r.getType()!==p.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be of type MFNode.");var o=this.currentScene,s=this.isExternal(),a=new c(this.getWorld());this.addLoadCount(a),a.createX3DFromURL(t,null,function(t){this.removeLoadCount(a),t&&(s||(t.setExecutionContext(o),o.isLive().addInterest("setLive",t),o.isLive().getValue()&&t.setLive(!0)),t.setup(),r.setValue(t.rootNodes))}.bind(this))},createX3DFromURL:function(t,e,i){if(3===arguments.length)return this.createVrmlFromURL(t,e,i);var n=this.currentScene,r=this.isExternal(),o=new c(this.getWorld()).createX3DFromURL(t,null);return r||(o.setExecutionContext(n),n.isLive().addInterest("setLive",o),n.isLive().getValue()&&o.setLive(!0)),o.setup(),o},loadURL:function(t,e){this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.setBrowserLoading(!0),this.addLoadCount(this),this.loader=new c(this.getWorld()),this.loader.createX3DFromURL(t,e,function(t){this.getBrowserOptions().getSplashScreen()||this.getCanvas().fadeIn(0),t?this.replaceWorld(t):setTimeout(function(){this.getSplashScreen().find(".x_ite-private-spinner-text").text(f("Failed loading world."))}.bind(this),31)}.bind(this),function(t){this.currentScene.changeViewpoint(t),this.removeLoadCount(id),this.setBrowserLoading(!1)}.bind(this),function(t,e){e?window.open(t,e):location=t,this.removeLoadCount(id),this.setBrowserLoading(!1)}.bind(this))},addBrowserListener:function(t,e){},removeBrowserListener:function(t){},addBrowserCallback:function(t,e){},removeBrowserCallback:function(t){},importDocument:function(t){if(t){var e=this.currentScene,i=this.isExternal(),n=this.createScene();return new d(n).parseIntoScene(t),i||(n.setExecutionContext(e),e.isLive().addInterest("setLive",n),e.isLive().getValue()&&n.setLive(!0)),n.setup(),n}},getBrowserProperty:function(t){return this.getBrowserProperties().getField(t).getValue()},setBrowserOption:function(t,e){this.getBrowserOptions().getField(t).setValue(e)},getBrowserOption:function(t){return this.getBrowserOptions().getField(t).getValue()},getRenderingProperty:function(t){this.getRenderingProperties().getField(t).getValue()},firstViewpoint:function(){var t=this.getActiveLayer()
;if(t){var e=t.getUserViewpoints();e.length&&this.bindViewpoint(e[0])}},previousViewpoint:function(){var t=this.getActiveLayer();if(t){var e=t.getUserViewpoints();if(0===e.length)return;for(var i=0,n=0;n<e.length&&!e[n].isBound_.getValue();++n)++i;i<e.length?0===i?this.bindViewpoint(e[e.length-1]):this.bindViewpoint(e[i-1]):this.bindViewpoint(e[e.length-1])}},nextViewpoint:function(){var t=this.getActiveLayer();if(t){var e=t.getUserViewpoints();if(0===e.length)return;for(var i=0,n=0;n<e.length&&!e[n].isBound_.getValue();++n)++i;i<e.length?i===e.length-1?this.bindViewpoint(e[0]):this.bindViewpoint(e[i+1]):this.bindViewpoint(e[0])}},lastViewpoint:function(){var t=this.getActiveLayer();if(t){var e=t.getUserViewpoints();e.length&&this.bindViewpoint(e[e.length-1])}},changeViewpoint:function(t){try{this.currentScene.changeViewpoint(t)}catch(t){console.log(t.message)}},bindViewpoint:function(t){t.isBound_.getValue()?t.transitionStart(t):t.set_bind_=!0},addRoute:function(t,e,i,n){this.currentScene.addRoute(t,e,i,n)},deleteRoute:function(t,e,i,n){try{var r=this.currentScene.getRoute(t,e,i,n);r&&this.currentScene.deleteRoute(r)}catch(t){console.log(t)}},beginUpdate:function(){this.setLive(!0),this.getExecutionContext().setLive(!0),this.advanceTime(performance.now())},endUpdate:function(){this.setLive(!1),this.getExecutionContext().setLive(!1)},print:function(){for(var e="",i=0;i<arguments.length;++i)e+=arguments[i];console.log(e),t(".x_ite-console").append(e)},println:function(){for(var e="",i=0;i<arguments.length;++i)e+=arguments[i];console.log(e),e+="\n",t(".x_ite-console").append(e)}}),Object.defineProperty(g.prototype,"name",{get:function(){return"X_ITE"},enumerable:!0,configurable:!1}),Object.defineProperty(g.prototype,"version",{get:function(){return e},enumerable:!0,configurable:!1}),Object.defineProperty(g.prototype,"description",{get:function(){return this.description_},set:function(t){this.description_=t,this.getNotification().string_=t},enumerable:!0,configurable:!1}),Object.defineProperty(g.prototype,"currentScene",{get:function(){return this.getScriptStack()[this.getScriptStack().length-1].getExecutionContext()},enumerable:!0,configurable:!1}),g}),define("x_ite/X3D",["jquery","x_ite/Error","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DConstants"],function(t,e,i,n,r,o,s,a,u,l,h,c,d,p,f,g,m,x,y,_,v,w,b){"use strict";function S(e,i){var n=t("<X3DCanvas></X3DCanvas>");return e instanceof s.MFString&&n.attr("url",e.toString()),F(n),n[0]}function C(e){return t(e).data("browser")}function F(e){if(e=t(e),!e.find(".x_ite-private-browser").length){var i=new a(e);return e.data("browser",i),i.setup(),i}}function T(i,n){"function"==typeof i&&M.done(i),"function"==typeof n&&V.done(n),O||(O=!0,t(function(){var i=t("X3DCanvas");i.children().hide();try{var n=t.map(i,F);if(D=n.length,i.length)for(var r=0;r<D;++r){var o=n[r];o.initialized().addFieldCallback("initialized"+o.getId(),N.bind(null,o))}else N(null)}catch(t){e.fallback(i),V.resolve(t)}}))}function N(t){t&&t.initialized().removeFieldCallback("initialized"+t.getId()),--D>0||M.resolve()}console||(console={}),console.log||(console.log=function(){}),console.info||(console.info=console.log),console.warn||(console.warn=console.log),console.error||(console.error=console.log);var O=!1,M=t.Deferred(),V=t.Deferred(),D=0;return t.extend(T,s,{require:require,define:define,getBrowser:C,createBrowser:S,X3DConstants:b,X3DFieldDefinition:i,FieldDefinitionArray:n,X3DField:r,X3DArrayField:o,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:h,ProfileInfoArray:c,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:m,ProtoDeclarationArray:x,X3DExterProtonDeclaration:y,X3DProtoDeclaration:_,RouteArray:v,X3DRoute:w}),T}),function(){"use strict";function t(t,e){r?r(t,e):(o.push(t),s.push(e))}function e(t){console.log(t),require(["x_ite/Error"],function(e){e(t,s)})}function i(){return window.X3D===t&&(window.X3D=n),t}require(["jquery"],function(t){t.noConflict(!0)});var n=window.X3D,r=null;if(t.noConfict=i,t.require=require,t.define=define,window.X3D=t,document.createElement("X3DCanvas"),void 0===window.Proxy)return e("Proxy is not defined");var o=[],s=[];require(["x_ite/X3D"],function(e){r=e;for(var i in e)t[i]=e[i];e();for(var n=0;n<o.length;++n)e(o[n],s[n])},e)}(),define("x_ite",function(){});for(var key in x_iteNoConfict)void 0===x_iteNoConfict[key]?delete window[key]:window[key]=x_iteNoConfict[key]}();