---
title: Controlling Shading on Coordinate-Based Geometry
date: 2022-11-28
nav: tutorials-animation-sensors-and-geometry
categories: [Tutorials]
tags: [Controlling, Shading, Coordinate, Geometry]
---
## Motivation

- When shaded, the faces on a shape are obvious
- To create a smooth shape you can use a large number of small faces
  - Requires lots of faces, disk space, memory, and drawing time
- Instead, use smooth shading to create the illusion of a smooth shape, but with a small number of faces

## Controlling shading using the crease angle

By default, faces are drawn with faceted shading.

You can enable smooth shading using the creaseAngle field for:

- [IndexedFaceSet](/x_ite/components/geometry3d/indexedfaceset/)
- [ElevationGrid](/x_ite/components/geometry3d/elevationgrid/)
- [Extrusion](/x_ite/components/geometry3d/extrusion/)

## Selecting crease angles

A crease angle is a threshold angle between two faces:

- If face angle \>= crease angle, use facet shading
- If face angle \< crease angle, use smooth shading

## Using normals

A normal vector indicates the direction a face is facing

- If it faces a light, the face is shaded bright

By default, normals are automatically generated by the X3D browser:

- You can specify your own normals with a [Normal](/x_ite/components/rendering/normal/) node
- Usually automatically generated normals are good enough

## Syntax: Normal

A Normal node contains a list of normal vectors that override use of a crease angle.

### XML Encoding

```x3d
<Normal
    vector='0.0 1.0 0.0, ...'/>
```

### Classic VRML Encoding

```vrml
Normal {
  vector [ 0.0 1.0 0.0, ... ]
}
```

Normals can be given for [IndexedFaceSet](/x_ite/components/geometry3d/indexedfaceset/) and [ElevationGrid](/x_ite/components/geometry3d/elevationgrid/) nodes.

## Syntax: IndexedFaceSet

An [IndexedFaceSet](/x_ite/components/geometry3d/indexedfaceset/) geometry node creates geometry out of faces:

- *normal* - list of normals
- *normalIndex* - selects normals from list
- *normalPerVertex* - control normal binding

### XML Encoding

```x3d
<Shape>
  <Appearance><!-- ... --><Appearance>
  <IndexedFaceSet
      normalPerVertex='true'
      normalIndex='...'
      coordIndex='...'>
    <Normal ... />
    <Coordinate ... />
  </IndexedFaceSet>
</Shape>
```

### Classic VRML Encoding

```vrml
Shape {
  appearance Appearance { ... }
  geometry IndexedFaceSet {
    normalPerVertex TRUE
    normalIndex [ ... ]
    coordIndex [ ... ]
    normal Normal { ... }
    coord Coordinate { ... }
  }
}
```

### Example

<x3d-canvas src="https://create3000.github.io/media/tutorials/scenes/faces2/faces2.x3dv" update="auto">
  <img src="https://create3000.github.io/media/tutorials/scenes/faces2/screenshot.png" alt="Normal"/>
</x3d-canvas>

- [Download ZIP Archive](https://create3000.github.io/media/tutorials/scenes/faces2/faces2.zip)
- [View Source in Playground](/x_ite/playground/?url=https://create3000.github.io/media/tutorials/scenes/faces2/faces2.x3dv)
{: .example-links }

## Controlling normal binding for face sets

The *normalPerVertex* field controls how normal indexes are used

- **FALSE:** one normal index to each face (ending at -1 coordinate indexes)
- **TRUE:** one normal index to each coordinate index of each face (including -1 coordinate indexes)

## Syntax: ElevationGrid

An [ElevationGrid](/x_ite/components/geometry3d/elevationgrid/) geometry node creates terrains:

- *normal* - list of normals
- *normalPerVertex* - control normal binding
- Always binds one normal to each grid point or square, in order

### XML Encoding

```x3d
<Shape>
  <Appearance><!-- ... --><Appearance>
  <ElevationGrid
      normalPerVertex='true'
      height='...'>
    <Normal ... />
  </ElevationGrid>
</Shape>
```

### Classic VRML Encoding

```vrml
Shape {
  appearance Appearance { ... }
  geometry ElevationGrid {
    normalPerVertex TRUE
    normal Normal { ... }
    height [ ... ]
  }
}
```

## Controlling normal binding for elevation grids

The *normalPerVertex* field controls how normal indexes are used (similar to face sets):

- **FALSE:** one normal to each grid square
- **TRUE:** one normal to each height for each grid square

## Syntax: NormalInterpolator

A [NormalInterpolator](/x_ite/components/interpolation/normalinterpolator/) node describes a normal set:

- *keys* - key fractions
- *keyValues* - key normal lists (X,Y,Z lists)
- Interpolates lists of normals, similar to the [CoordinateInterpolator](/x_ite/components/interpolation/coordinateinterpolator/)

### XML Encoding

```x3d
<NormalInterpolator
    key='0.0, ...'
    keyValue='0.0 1.0 1.0, ...'/>
```

### Classic VRML Encoding

```vrml
NormalInterpolator {
  key [ 0.0, ... ]
  keyValue [ 0.0 1.0 1.0, ... ]
}
```

Typically route into a [Normal](/x_ite/components/rendering/normal/) node's set\_vector input.

## Summary

- The *creaseAngle* field controls faceted or smooth shading
- The [Normal](/x_ite/components/rendering/normal/) node lists normal vectors to use for parts of a shape
  - Used as the value of the normal field
  - Normal indexes select normals to use
- Normals override *creaseAngle* value
- The *normalPerVertex* field selects normal per face/grid square or normal per coordinate
- The [NormalInterpolator](/x_ite/components/interpolation/normalinterpolator/) node converts times to normals
